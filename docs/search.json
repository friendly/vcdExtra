[{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"forms-of-frequency-data","dir":"Articles","previous_headings":"","what":"Forms of frequency data","title":"1. Creating and manipulating frequency tables","text":"first thing need know categorical data can represented three different forms R, sometimes necessary convert one form another, carrying statistical tests, fitting models visualizing results. data object exists R, can examine complete structure str() function, view names components names() function.","code":""},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"case-form","dir":"Articles","previous_headings":"Forms of frequency data","what":"Case form","title":"1. Creating and manipulating frequency tables","text":"Categorical data case form simply data frames containing individual observations, one factors, used classifying variables. case form, may also numeric covariates. total number observations nrow(X), number variables ncol(X). Example: Arthritis data available case form vcd package. two explanatory factors: Treatment Sex. Age numeric covariate, Improved response— ordered factor, levels None < < Marked. Excluding Age, represents \\(2 \\times 2 \\times 3\\) contingency table Treatment, Sex Improved, case form.","code":"names(Arthritis)      # show the variables ## [1] \"ID\"        \"Treatment\" \"Sex\"       \"Age\"       \"Improved\"  str(Arthritis)        # show the structure ## 'data.frame':    84 obs. of  5 variables: ##  $ ID       : int  57 46 77 17 36 23 75 39 33 55 ... ##  $ Treatment: Factor w/ 2 levels \"Placebo\",\"Treated\": 2 2 2 2 2 2 2 2 2 2 ... ##  $ Sex      : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ... ##  $ Age      : int  27 29 30 32 46 58 59 59 63 63 ... ##  $ Improved : Ord.factor w/ 3 levels \"None\"<\"Some\"<..: 2 1 1 3 3 3 1 3 1 1 ...  head(Arthritis,5)     # first 5 observations, same as Arthritis[1:5,]  ##   ID Treatment  Sex Age Improved ## 1 57   Treated Male  27     Some ## 2 46   Treated Male  29     None ## 3 77   Treated Male  30     None ## 4 17   Treated Male  32   Marked ## 5 36   Treated Male  46   Marked"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"frequency-form","dir":"Articles","previous_headings":"Forms of frequency data","what":"Frequency form","title":"1. Creating and manipulating frequency tables","text":"Data frequency form also data frame containing one factors, frequency variable, often called Freq count. total number observations : sum(X$Freq), sum(X[,\"Freq\"]) equivalent form. number cells table given nrow(X). Example: small frequency tables, often convenient enter frequency form using expand.grid() factors c() list counts vector. example , (Agresti, 2002) gives results 1991 General Social Survey, respondents classified sex party identification.","code":"# Agresti (2002), table 3.11, p. 106 GSS <- data.frame(   expand.grid(sex = c(\"female\", \"male\"),                party = c(\"dem\", \"indep\", \"rep\")),   count = c(279,165,73,47,225,191))  GSS ##      sex party count ## 1 female   dem   279 ## 2   male   dem   165 ## 3 female indep    73 ## 4   male indep    47 ## 5 female   rep   225 ## 6   male   rep   191 names(GSS) ## [1] \"sex\"   \"party\" \"count\" str(GSS) ## 'data.frame':    6 obs. of  3 variables: ##  $ sex  : Factor w/ 2 levels \"female\",\"male\": 1 2 1 2 1 2 ##  $ party: Factor w/ 3 levels \"dem\",\"indep\",..: 1 1 2 2 3 3 ##  $ count: num  279 165 73 47 225 191  sum(GSS$count) ## [1] 980"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"table-form","dir":"Articles","previous_headings":"Forms of frequency data","what":"Table form","title":"1. Creating and manipulating frequency tables","text":"Table form data represented matrix, array table object, whose elements frequencies \\(n\\)-way table. variable names (factors) levels given dimnames(X). total number observations sum(X). number dimensions table length(dimnames(X)), table sizes given sapply(dimnames(X), length). Example: HairEyeColor stored table form vcd. Example: Enter frequencies matrix, assign dimnames, giving variable names category labels. Note , default, matrix() uses elements supplied columns result, unless specify byrow=TRUE. JobSat matrix, object class(\"table\"), functions happier tables matrices. can coerce table .table(),","code":"str(HairEyeColor)                      # show the structure ##  'table' num [1:4, 1:4, 1:2] 32 53 10 3 11 50 10 30 10 25 ... ##  - attr(*, \"dimnames\")=List of 3 ##   ..$ Hair: chr [1:4] \"Black\" \"Brown\" \"Red\" \"Blond\" ##   ..$ Eye : chr [1:4] \"Brown\" \"Blue\" \"Hazel\" \"Green\" ##   ..$ Sex : chr [1:2] \"Male\" \"Female\"  sum(HairEyeColor)                      # number of cases ## [1] 592  sapply(dimnames(HairEyeColor), length) # table dimension sizes ## Hair  Eye  Sex  ##    4    4    2 # A 4 x 4 table  Agresti (2002, Table 2.8, p. 57) Job Satisfaction JobSat <- matrix(c( 1, 2, 1, 0,                      3, 3, 6, 1,                     10,10,14, 9,                      6, 7,12,11), 4, 4)  dimnames(JobSat) = list(   income = c(\"< 15k\", \"15-25k\", \"25-40k\", \"> 40k\"),   satisfaction = c(\"VeryD\", \"LittleD\", \"ModerateS\", \"VeryS\")   )  JobSat ##         satisfaction ## income   VeryD LittleD ModerateS VeryS ##   < 15k      1       3        10     6 ##   15-25k     2       3        10     7 ##   25-40k     1       6        14    12 ##   > 40k      0       1         9    11 JobSat <- as.table(JobSat) str(JobSat) ##  'table' num [1:4, 1:4] 1 2 1 0 3 3 6 1 10 10 ... ##  - attr(*, \"dimnames\")=List of 2 ##   ..$ income      : chr [1:4] \"< 15k\" \"15-25k\" \"25-40k\" \"> 40k\" ##   ..$ satisfaction: chr [1:4] \"VeryD\" \"LittleD\" \"ModerateS\" \"VeryS\""},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"sec:ordered-factors","dir":"Articles","previous_headings":"","what":"Ordered factors and reordered tables","title":"1. Creating and manipulating frequency tables","text":"table form, values table factors ordered position table. Thus JobSat data, income satisfaction represent ordered factors, positions values rows columns reflects ordered nature. Yet, analysis, times need numeric values levels ordered factors table, e.g., treat factor quantitative variable. cases, can simply re-assign dimnames attribute table variables. example, , assign numeric values income middle ranges, treat satisfaction equally spaced integer scores. HairEyeColor data, hair color eye color ordered arbitrarily. visualizing data using mosaic plots methods described , turns useful assure hair color eye color ordered dark light. Hair colors actually ordered way already, easiest re-order eye colors indexing. str() friend. also order hair color eye color shown result correspondence analysis ((ref?)(fig:ca-haireye) . data case form frequency form, ordered factors represented character values, must ensure treated ordered R. Imagine Arthritis data read text file. default Improved ordered alphabetically: Marked, None, — want. case, function ordered() (others) can useful. dataset Arthritis vcd package data.frame form order Improved, response data, mosaic display Treatment Improved ((ref?)(fig:arthritis) shows clearly interpretable pattern. original version mosaic vcd package required input contingency table array form, convert using xtabs(). Mosaic plot Arthritis data, showing marginal model independence Treatment Improved. Age, covariate, Sex ignored . Several data sets package illustrate salutary effects reordering factor levels mosaic displays analyses. See: help(AirCrash) help(Glass) help(HouseTasks) seriate package now contains general method permute row column variables table according result correspondence analysis, using scores first CA dimension.","code":"dimnames(JobSat)$income <- c(7.5,20,32.5,60) dimnames(JobSat)$satisfaction <- 1:4 HairEyeColor <- HairEyeColor[, c(1,3,4,2), ] str(HairEyeColor) ##  'table' num [1:4, 1:4, 1:2] 32 53 10 3 10 25 7 5 3 15 ... ##  - attr(*, \"dimnames\")=List of 3 ##   ..$ Hair: chr [1:4] \"Black\" \"Brown\" \"Red\" \"Blond\" ##   ..$ Eye : chr [1:4] \"Brown\" \"Hazel\" \"Green\" \"Blue\" ##   ..$ Sex : chr [1:2] \"Male\" \"Female\" Arthritis <- read.csv(\"arthritis.txt\",header=TRUE) Arthritis$Improved <- ordered(Arthritis$Improved,                                levels=c(\"None\", \"Some\", \"Marked\")                               ) data(Arthritis, package=\"vcd\") art <- xtabs(~Treatment + Improved, data = Arthritis) mosaic(art, gp = shading_max, split_vertical = TRUE, main=\"Arthritis: [Treatment] [Improved]\")"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"re-ordering-dimensions","dir":"Articles","previous_headings":"Ordered factors and reordered tables","what":"Re-ordering dimensions","title":"1. Creating and manipulating frequency tables","text":"Finally, situations , particularly display purposes, want re-order dimensions \\(n\\)-way table, change labels variables levels. easy data table form: aperm() permutes dimensions, assigning names dimnames changes variable names level labels respectively. use following version UCBAdmissions @ref(sec:mantel) . 1","code":"UCB <- aperm(UCBAdmissions, c(2, 1, 3)) dimnames(UCB)[[2]] <- c(\"Yes\", \"No\") names(dimnames(UCB)) <- c(\"Sex\", \"Admit?\", \"Department\")  # display as a flattened table stats::ftable(UCB) ##               Department   A   B   C   D   E   F ## Sex    Admit?                                    ## Male   Yes               512 353 120 138  53  22 ##        No                313 207 205 279 138 351 ## Female Yes                89  17 202 131  94  24 ##        No                 19   8 391 244 299 317"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"sec:structable","dir":"Articles","previous_headings":"","what":"structable()","title":"1. Creating and manipulating frequency tables","text":"3-way larger tables structable() function vcd provides convenient flexible tabular display. variables assigned rows columns two-way display can specified model formula. also returns object class \"structable\" may plotted mosaic() (shown ).","code":"structable(HairEyeColor)                   # show the table: default ##              Eye Brown Hazel Green Blue ## Hair  Sex                               ## Black Male          32    10     3   11 ##       Female        36     5     2    9 ## Brown Male          53    25    15   50 ##       Female        66    29    14   34 ## Red   Male          10     7     7   10 ##       Female        16     7     7    7 ## Blond Male           3     5     8   30 ##       Female         4     5     8   64  structable(Hair+Sex ~ Eye, HairEyeColor)   # specify col ~ row variables ##       Hair Black        Brown         Red        Blond        ##       Sex   Male Female  Male Female Male Female  Male Female ## Eye                                                           ## Brown         32     36    53     66   10     16     3      4 ## Hazel         10      5    25     29    7      7     5      5 ## Green          3      2    15     14    7      7     8      8 ## Blue          11      9    50     34   10      7    30     64 HSE < - structable(Hair+Sex ~ Eye, HairEyeColor)   # save structable object mosaic(HSE)                                        # plot it"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"sec:table","dir":"Articles","previous_headings":"","what":"table() and friends","title":"1. Creating and manipulating frequency tables","text":"can generate frequency tables factor variables using table() function, tables proportions using prop.table() function, marginal frequencies using margin.table(). examples, create categorical vectors: lines illustrate table-related functions: table() can also generate multidimensional tables based 3 categorical variables. case, can use ftable() structable() function print results attractively. table() ignores missing values default. include NA category counts, include table option exclude=NULL variable vector. variable factor create new factor using .","code":"n=500  A <- factor(sample(c(\"a1\",\"a2\"), n, rep=TRUE))  B <- factor(sample(c(\"b1\",\"b2\"), n, rep=TRUE))  C <- factor(sample(c(\"c1\",\"c2\"), n, rep=TRUE))  mydata <- data.frame(A,B,C) # 2-Way Frequency Table attach(mydata) mytable <- table(A,B)   # A will be rows, B will be columns mytable                 # print table ##     B ## A     b1  b2 ##   a1 116 114 ##   a2 138 132  margin.table(mytable, 1) # A frequencies (summed over B) ## A ##  a1  a2  ## 230 270 margin.table(mytable, 2) # B frequencies (summed over A) ## B ##  b1  b2  ## 254 246  prop.table(mytable)    # cell percentages ##     B ## A       b1    b2 ##   a1 0.232 0.228 ##   a2 0.276 0.264 prop.table(mytable, 1) # row percentages ##     B ## A           b1        b2 ##   a1 0.5043478 0.4956522 ##   a2 0.5111111 0.4888889 prop.table(mytable, 2) # column percentages ##     B ## A           b1        b2 ##   a1 0.4566929 0.4634146 ##   a2 0.5433071 0.5365854 # 3-Way Frequency Table mytable <- table(A, B, C) ftable(mytable) ##       C c1 c2 ## A  B          ## a1 b1   45 71 ##    b2   59 55 ## a2 b1   62 76 ##    b2   76 56"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"sec:xtabs","dir":"Articles","previous_headings":"","what":"xtabs()","title":"1. Creating and manipulating frequency tables","text":"xtabs() function allows create cross-tabulations data using formula style input. typically works case-form data supplied data frame matrix. result contingency table array format, whose dimensions determined terms right side formula. variable included left side formula, assumed vector frequencies (useful data already tabulated frequency form).","code":"# 3-Way Frequency Table mytable <- xtabs(~A+B+C, data=mydata)  ftable(mytable)    # print table ##       C c1 c2 ## A  B          ## a1 b1   45 71 ##    b2   59 55 ## a2 b1   62 76 ##    b2   76 56  summary(mytable)   # chi-square test of indepedence ## Call: xtabs(formula = ~A + B + C, data = mydata) ## Number of cases in table: 500  ## Number of factors: 3  ## Test for independence of all factors: ##  Chisq = 9.888, df = 4, p-value = 0.04235 (GSStab <- xtabs(count ~ sex + party, data=GSS)) ##         party ## sex      dem indep rep ##   female 279    73 225 ##   male   165    47 191  summary(GSStab) ## Call: xtabs(formula = count ~ sex + party, data = GSS) ## Number of cases in table: 980  ## Number of factors: 2  ## Test for independence of all factors: ##  Chisq = 7.01, df = 2, p-value = 0.03005"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"collapsing-over-table-factors-aggregate-margin-table-and-apply","dir":"Articles","previous_headings":"","what":"Collapsing over table factors: aggregate(), margin.table() and apply()","title":"1. Creating and manipulating frequency tables","text":"sometimes happens data set variables factors want analyse, else, done initial analyses, decide certain factors important, excluded graphic displays collapsing (summing) . example, mosaic plots fourfold displays often simpler construct versions data collapsed factors shown plots. appropriate tools use depend form data represented— case-form data frame, frequency-form data frame (aggregate()), table-form array table object (margin.table() apply()). data frequency form, want produce another frequency data frame, aggregate() handy tool, using argument FUN=sum sum frequency variable factors mentioned formula. Example: data frame DaytonSurvey vcdExtra package represents \\(2^5\\) table giving frequencies reported use (``ever used?’’) alcohol, cigarettes marijuana sample high school seniors, also classified sex race. focus associations among substances, want collapse sex race. right-hand side formula used call aggregate() gives factors retained new frequency data frame, Dayton.ACM.df. data table form, want produce another table, apply() FUN=sum can used similar way sum table dimensions mentioned MARGIN argument. margin.table() just wrapper apply() using sum() function. Example: illustrate, first convert DaytonSurvey 5-way table using xtabs(), giving Dayton.tab. , use apply() Dayton.tab give 3-way table Dayton.ACM.tab summed sex race. elements new table column sums Dayton.tab shown structable() just . Many operations can performed using **ply() functions plyr package. example, data frequency form data frame, use ddply() collapse unmentioned factors, plyr::summarise() function applied piece.","code":"data(\"DaytonSurvey\", package=\"vcdExtra\") str(DaytonSurvey) ## 'data.frame':    32 obs. of  6 variables: ##  $ cigarette: Factor w/ 2 levels \"Yes\",\"No\": 1 2 1 2 1 2 1 2 1 2 ... ##  $ alcohol  : Factor w/ 2 levels \"Yes\",\"No\": 1 1 2 2 1 1 2 2 1 1 ... ##  $ marijuana: Factor w/ 2 levels \"Yes\",\"No\": 1 1 1 1 2 2 2 2 1 1 ... ##  $ sex      : Factor w/ 2 levels \"female\",\"male\": 1 1 1 1 1 1 1 1 2 2 ... ##  $ race     : Factor w/ 2 levels \"white\",\"other\": 1 1 1 1 1 1 1 1 1 1 ... ##  $ Freq     : num  405 13 1 1 268 218 17 117 453 28 ... head(DaytonSurvey) ##   cigarette alcohol marijuana    sex  race Freq ## 1       Yes     Yes       Yes female white  405 ## 2        No     Yes       Yes female white   13 ## 3       Yes      No       Yes female white    1 ## 4        No      No       Yes female white    1 ## 5       Yes     Yes        No female white  268 ## 6        No     Yes        No female white  218 # data in frequency form # collapse over sex and race Dayton.ACM.df <- aggregate(Freq ~ cigarette+alcohol+marijuana,                             data=DaytonSurvey,                             FUN=sum) Dayton.ACM.df ##   cigarette alcohol marijuana Freq ## 1       Yes     Yes       Yes  911 ## 2        No     Yes       Yes   44 ## 3       Yes      No       Yes    3 ## 4        No      No       Yes    2 ## 5       Yes     Yes        No  538 ## 6        No     Yes        No  456 ## 7       Yes      No        No   43 ## 8        No      No        No  279 # in table form Dayton.tab <- xtabs(Freq ~ cigarette+alcohol+marijuana+sex+race,                      data=DaytonSurvey) structable(cigarette+alcohol+marijuana ~ sex+race,             data=Dayton.tab) ##              cigarette Yes              No             ##              alcohol   Yes      No     Yes      No     ##              marijuana Yes  No Yes  No Yes  No Yes  No ## sex    race                                            ## female white           405 268   1  17  13 218   1 117 ##        other            23  23   0   1   2  19   0  12 ## male   white           453 228   1  17  28 201   1 133 ##        other            30  19   1   8   1  18   0  17 # collapse over sex and race Dayton.ACM.tab <- apply(Dayton.tab, MARGIN=1:3, FUN=sum) Dayton.ACM.tab <- margin.table(Dayton.tab, 1:3)   # same result  structable(cigarette+alcohol ~ marijuana, data=Dayton.ACM.tab) ##           cigarette Yes      No     ##           alcohol   Yes  No Yes  No ## marijuana                           ## Yes                 911   3  44   2 ## No                  538  43 456 279 library(plyr) Dayton.ACM.df <- plyr::ddply(DaytonSurvey,                               .(cigarette, alcohol, marijuana),                               plyr::summarise, Freq=sum(Freq))  Dayton.ACM.df ##   cigarette alcohol marijuana Freq ## 1       Yes     Yes       Yes  911 ## 2       Yes     Yes        No  538 ## 3       Yes      No       Yes    3 ## 4       Yes      No        No   43 ## 5        No     Yes       Yes   44 ## 6        No     Yes        No  456 ## 7        No      No       Yes    2 ## 8        No      No        No  279"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"collapsing-table-levels-collapse-table","dir":"Articles","previous_headings":"","what":"Collapsing table levels: collapse.table()","title":"1. Creating and manipulating frequency tables","text":"related problem arises table array purpose want reduce number levels factors summing subsets frequencies. example, may initially coded Age 10-year intervals, decide , either analysis display purposes, want reduce Age 20-year intervals. collapse.table() function vcdExtra designed purpose. Example: Create 3-way table, collapse Age 10-year 20-year intervals. First, generate \\(2 \\times 6 \\times 3\\) table random counts Poisson distribution mean 100. Now collapse age 20-year intervals, education 2 levels. arguments, levels age education given label summed resulting smaller table.","code":"# create some sample data in frequency form sex <- c(\"Male\", \"Female\") age <- c(\"10-19\", \"20-29\",  \"30-39\", \"40-49\", \"50-59\", \"60-69\") education <- c(\"low\", 'med', 'high') data <- expand.grid(sex=sex, age=age, education=education) counts <- rpois(36, 100)   # random Possion cell frequencies data <- cbind(data, counts)  # make it into a 3-way table t1 <- xtabs(counts ~ sex + age + education, data=data) structable(t1) ##                  age 10-19 20-29 30-39 40-49 50-59 60-69 ## sex    education                                         ## Male   low              98   105   104    90    90   101 ##        med              97   105   101    88    97   107 ##        high             99   101   109    88    99    96 ## Female low             102   117   101   105    85    88 ##        med             106    84    92   116   110    96 ##        high            106    96   121    91   107   102 # collapse age to 3 levels, education to 2 levels t2 <- collapse.table(t1,           age=c(\"10-29\", \"10-29\",  \"30-49\", \"30-49\", \"50-69\", \"50-69\"),          education=c(\"<high\", \"<high\", \"high\")) structable(t2) ##                  age 10-29 30-49 50-69 ## sex    education                       ## Male   <high           405   383   395 ##        high            200   197   195 ## Female <high           409   414   379 ##        high            202   212   209"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"collapsing-table-levels-dplyr","dir":"Articles","previous_headings":"","what":"Collapsing table levels: dplyr","title":"1. Creating and manipulating frequency tables","text":"data sets frequency form case form, factor levels can collapsed recoding levels grouping. One handy function dplyr::case_match() Example: vcdExtra::Titanicp data set contains information 1309 passengers RMS Titanic, including sibsp, number (0:8) siblings spouses aboard, parch (0:6), number parents children aboard, table quite sparse. purposes analysis, might want collapse levels 0, 1, 2+. ’s : car::recode() similar function, less convenient interface. forcats package provides collection functions reordering levels factor grouping categories according frequency: forcats::fct_reorder(): Reorder factor another variable. forcats::fct_infreq(): Reorder factor frequency values. forcats::fct_relevel(): Change order factor hand. forcats::fct_lump(): Collapse least/frequent values factor “”. forcats::fct_collapse(): Collapse factor levels manually defined groups. forcats::fct_recode(): Change factor levels hand.","code":"table(Titanicp$sibsp, Titanicp$parch) ##     ##       0   1   2   3   4   5   6   9 ##   0 790  52  43   2   2   2   0   0 ##   1 183  90  29   5   4   4   2   2 ##   2  26   9   6   1   0   0   0   0 ##   3   3   9   8   0   0   0   0   0 ##   4   0  10  12   0   0   0   0   0 ##   5   0   0   6   0   0   0   0   0 ##   8   0   0   9   0   0   0   0   0 library(dplyr) Titanicp <- Titanicp |>   mutate(sibspF = case_match(sibsp,                             0 ~ \"0\",                             1 ~ \"1\",                             2:max(sibsp) ~ \"2+\")) |>   mutate(sibspF = ordered(sibspF)) |>   mutate(parchF = case_match(parch,                              0 ~ \"0\",                              1 ~ \"1\",                              2:max(parch) ~ \"2+\")) |>   mutate(parchF = ordered(parchF))   table(Titanicp$sibspF, Titanicp$parchF) ##      ##        0   1  2+ ##   0  790  52  49 ##   1  183  90  46 ##   2+  29  28  42"},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"converting-among-frequency-tables-and-data-frames","dir":"Articles","previous_headings":"","what":"Converting among frequency tables and data frames","title":"1. Creating and manipulating frequency tables","text":"’ve seen, given contingency table can represented equivalently different forms, R functions designed one particular representation. table shows handy tools converting one form another. example, contingency table table form (object class(table)) can converted data.frame .data.frame(). 2 resulting data.frame contains columns representing classifying factors table entries (column named responseName argument, defaulting Freq. inverse xtabs(). Example: Convert GSStab table form data.frame frequency form. Example: Convert Arthritis data case form 3-way table Treatment \\(\\times\\) Sex \\(\\times\\) Improved. Note use () avoid use Arthritis\\$Treatment etc. within call table().% 3 may also times need equivalent case form data.frame factors representing table variables rather frequency table. example, mca() function package MASS operates data format. Marc Schwartz initially provided code expand.dft() Rhelp mailing list converting table back case form data.frame. function included vcdExtra. Example: Convert Arthritis data table form (Art.tab) back data.frame case form, factors Treatment, Sex Improved.","code":"as.data.frame(GSStab) ##      sex party Freq ## 1 female   dem  279 ## 2   male   dem  165 ## 3 female indep   73 ## 4   male indep   47 ## 5 female   rep  225 ## 6   male   rep  191 Art.tab <- with(Arthritis, table(Treatment, Sex, Improved)) str(Art.tab) ##  'table' int [1:2, 1:2, 1:3] 19 6 10 7 7 5 0 2 6 16 ... ##  - attr(*, \"dimnames\")=List of 3 ##   ..$ Treatment: chr [1:2] \"Placebo\" \"Treated\" ##   ..$ Sex      : chr [1:2] \"Female\" \"Male\" ##   ..$ Improved : chr [1:3] \"None\" \"Some\" \"Marked\"  ftable(Art.tab) ##                  Improved None Some Marked ## Treatment Sex                              ## Placebo   Female            19    7      6 ##           Male              10    0      1 ## Treated   Female             6    5     16 ##           Male               7    2      5 Art.df <- expand.dft(Art.tab) str(Art.df) ## 'data.frame':    84 obs. of  3 variables: ##  $ Treatment: chr  \"Placebo\" \"Placebo\" \"Placebo\" \"Placebo\" ... ##  $ Sex      : chr  \"Female\" \"Female\" \"Female\" \"Female\" ... ##  $ Improved : chr  \"None\" \"None\" \"None\" \"None\" ..."},{"path":"https://friendly.github.io/vcdExtra/articles/a1-creating.html","id":"sec:complex","dir":"Articles","previous_headings":"","what":"A complex example","title":"1. Creating and manipulating frequency tables","text":"’ve followed far, ’re ready complicated example. data file, tv.dat represents 4-way table size \\(5 \\times 11 \\times 5 \\times 3\\) table variables (unnamed file) read V1 – V4, cell frequency read V5. file, stored doc/extdata directory vcdExtra, can read follows: local file, just use read.table() form: data tv.dat came initial implementation mosaic displays R Jay Emerson. turn, came initial development mosaic displays (Hartigan & Kleiner, 1984) illustrated method data large sample TV viewers whose behavior recorded Neilsen ratings. data set contains sample television audience data Neilsen Media Research week starting November 6, 1995. table variables : V1– values 1:5 correspond days Monday–Friday; V2– values 1:11 correspond quarter hour times 8:00PM 10:30PM; V3– values 1:5 correspond ABC, CBS, NBC, Fox, non-network choices; V4– values 1:3 correspond transition states: turn television , Switch channels, Persist viewing current channel. interested just cell frequencies, rely facts table complete— missing cells, nrow(tv.data) = 825; observations ordered V1 varies rapidly V4 slowly. , can just extract frequency column reshape array. [dangerous observations order.] generally (even missing cells), can use xtabs() (plyr::daply()) cross-tabulation, using V5 frequency variable. ’s operation xtabs(): 4-way table large awkward work . Among networks, Fox occur infrequently. can also cut 3-way table considering viewers persist current station. 4 Finally, purposes, might want collapse 11 times smaller number. Half-hour time slots make sense. , use .data.frame.table() convert table back data frame, levels() re-assign values Time, finally, xtabs() give new, collapsed frequency table. ’ve come far, might well show mosaic display. analogous used Hartigan & Kleiner (1984).  mosaic displays can read several levels, corresponding successive splits tiles residual shading. Several trends clear viewers persist: Overall, number viewers weekday, slightly Thursday. Looking time slots, viewership slightly greater 9:00 - 10:00 overall also 8:00 - 9:00 Thursday Friday residual shading tiles: Monday: CBS dominates time slots. Tuesday” ABC CBS dominate 9:00 Thursday: largely NBC day Friday: ABC dominates early evening","code":"tv.data<-read.table(system.file(\"extdata\",\"tv.dat\", package=\"vcdExtra\")) head(tv.data,5) ##   V1 V2 V3 V4 V5 ## 1  1  1  1  1  6 ## 2  2  1  1  1 18 ## 3  3  1  1  1  6 ## 4  4  1  1  1  2 ## 5  5  1  1  1 11 tv.data<-read.table(\"C:/R/data/tv.dat\") TV <- array(tv.data[,5], dim=c(5,11,5,3))                                         dimnames(TV) <- list(c(\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\"),                       c(\"8:00\",\"8:15\",\"8:30\",\"8:45\",\"9:00\",\"9:15\",\"9:30\",                                 \"9:45\",\"10:00\",\"10:15\",\"10:30\"),                                                  c(\"ABC\",\"CBS\",\"NBC\",\"Fox\",\"Other\"),                       c(\"Off\",\"Switch\",\"Persist\"))  names(dimnames(TV))<-c(\"Day\", \"Time\", \"Network\", \"State\") TV <- xtabs(V5 ~ ., data=tv.data) dimnames(TV) <- list(Day = c(\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\"),                       Time = c(\"8:00\",\"8:15\",\"8:30\",\"8:45\",\"9:00\",\"9:15\",\"9:30\",                                        \"9:45\",\"10:00\",\"10:15\",\"10:30\"),                                                  Network = c(\"ABC\",\"CBS\",\"NBC\",\"Fox\",\"Other\"),                       State = c(\"Off\",\"Switch\",\"Persist\"))  # table dimensions dim(TV) TV2 <- TV[,,1:3,]      # keep only ABC, CBS, NBC TV2 <- TV2[,,,3]       # keep only Persist -- now a 3 way table structable(TV2) ##                   Time 8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30 ## Day       Network                                                                ## Monday    ABC           146  151  156   83  325  350  386  340   352   280   278 ##           CBS           337  293  304  233  311  251  241  164   252   265   272 ##           NBC           263  219  236  140  226  235  239  246   279   263   283 ## Tuesday   ABC           244  181  231  205  385  283  345  192   329   351   364 ##           CBS           173  180  184  109  218  235  256  250   274   263   261 ##           NBC           315  254  280  241  370  214  195  111   188   190   210 ## Wednesday ABC           233  161  194  156  339  264  279  140   237   228   203 ##           CBS           158  126  207   59   98  103  122   86   109   105   110 ##           NBC           134  146  166   66  194  230  264  143   274   289   306 ## Thursday  ABC           174  183  197  181  187  198  211   86   110   122   117 ##           CBS           196  185  195  104  106  116  116   47   102    84    84 ##           NBC           515  463  472  477  590  473  446  349   649   705   747 ## Friday    ABC           294  281  305  239  278  246  245  138   246   232   233 ##           CBS           130  144  154   81  129  153  136  126   138   136   152 ##           NBC           195  220  248  160  172  164  169   85   183   198   204 TV.df <- as.data.frame.table(TV2) levels(TV.df$Time) <- c(rep(\"8:00\", 2),                         rep(\"8:30\", 2),                         rep(\"9:00\", 2),                          rep(\"9:30\", 2),                          rep(\"10:00\",2),                             \"10:30\"                         )  TV3 <- xtabs(Freq ~ Day + Time + Network, TV.df)  structable(Day ~ Time+Network, TV3) ##               Day Monday Tuesday Wednesday Thursday Friday ## Time  Network                                              ## 8:00  ABC            297     425       394      357    575 ##       CBS            630     353       284      381    274 ##       NBC            482     569       280      978    415 ## 8:30  ABC            239     436       350      378    544 ##       CBS            537     293       266      299    235 ##       NBC            376     521       232      949    408 ## 9:00  ABC            675     668       603      385    524 ##       CBS            562     453       201      222    282 ##       NBC            461     584       424     1063    336 ## 9:30  ABC            726     537       419      297    383 ##       CBS            405     506       208      163    262 ##       NBC            485     306       407      795    254 ## 10:00 ABC            632     680       465      232    478 ##       CBS            517     537       214      186    274 ##       NBC            542     378       563     1354    381 ## 10:30 ABC            278     364       203      117    233 ##       CBS            272     261       110       84    152 ##       NBC            283     210       306      747    204 mosaic(TV3, shade = TRUE,        labeling = labeling_border(rot_labels = c(0, 0, 0, 90)))"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"crosstable","dir":"Articles","previous_headings":"","what":"CrossTable","title":"2. Tests of Independence","text":"tabular displays, CrossTable() function gmodels package produces cross-tabulations modeled PROC FREQ SAS CROSSTABS SPSS. wealth options quantities can shown cell. Recall GSS data used earlier. Generate cross-table showing cell frequency cell contribution \\(\\chi^2\\). options report percentages (row, column, cell), specify decimal places, produce Chi-square, Fisher, McNemar tests independence, report expected residual values (pearson, standardized, adjusted standardized), include missing values valid, annotate row column titles, format SAS SPSS style output! See help(CrossTable) details.","code":"# Agresti (2002), table 3.11, p. 106 GSS <- data.frame(   expand.grid(sex = c(\"female\", \"male\"),                party = c(\"dem\", \"indep\", \"rep\")),   count = c(279,165,73,47,225,191))  (GSStab <- xtabs(count ~ sex + party, data=GSS)) ##         party ## sex      dem indep rep ##   female 279    73 225 ##   male   165    47 191 # 2-Way Cross Tabulation library(gmodels) CrossTable(GSStab, prop.t=FALSE, prop.r=FALSE, prop.c=FALSE) ##  ##   ##    Cell Contents ## |-------------------------| ## |                       N | ## | Chi-square contribution | ## |-------------------------| ##  ##   ## Total Observations in Table:  980  ##  ##   ##              | party  ##          sex |       dem |     indep |       rep | Row Total |  ## -------------|-----------|-----------|-----------|-----------| ##       female |       279 |        73 |       225 |       577 |  ##              |     1.183 |     0.078 |     1.622 |           |  ## -------------|-----------|-----------|-----------|-----------| ##         male |       165 |        47 |       191 |       403 |  ##              |     1.693 |     0.112 |     2.322 |           |  ## -------------|-----------|-----------|-----------|-----------| ## Column Total |       444 |       120 |       416 |       980 |  ## -------------|-----------|-----------|-----------|-----------| ##  ##"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"chi-square-test","dir":"Articles","previous_headings":"","what":"Chi-square test","title":"2. Tests of Independence","text":"2-way tables can use chisq.test() test independence row column variable. default, \\(p\\)-value calculated asymptotic chi-squared distribution test statistic. Optionally, \\(p\\)-value can derived via Monte Carlo simulation.","code":"(HairEye <- margin.table(HairEyeColor, c(1, 2))) ##        Eye ## Hair    Brown Blue Hazel Green ##   Black    68   20    15     5 ##   Brown   119   84    54    29 ##   Red      26   17    14    14 ##   Blond     7   94    10    16  chisq.test(HairEye) ##  ##  Pearson's Chi-squared test ##  ## data:  HairEye ## X-squared = 138.29, df = 9, p-value < 2.2e-16  chisq.test(HairEye, simulate.p.value = TRUE) ##  ##  Pearson's Chi-squared test with simulated p-value (based on 2000 ##  replicates) ##  ## data:  HairEye ## X-squared = 138.29, df = NA, p-value = 0.0004998"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"sec:Fisher","dir":"Articles","previous_headings":"","what":"Fisher Exact Test","title":"2. Tests of Independence","text":"fisher.test(X) provides exact test independence. X must two-way contingency table table form. Another form, fisher.test(X, Y) takes two categorical vectors length. tables larger \\(2 \\times 2\\) method can computationally intensive (can fail) frequencies small. Fisher’s test meant tables small total sample size. generates error HairEye data \\(n\\)=592 total frequency.","code":"fisher.test(GSStab) ##  ##  Fisher's Exact Test for Count Data ##  ## data:  GSStab ## p-value = 0.03115 ## alternative hypothesis: two.sided fisher.test(HairEye) ## Error in `fisher.test()`: ## ! FEXACT error 6 (f5xact).  LDKEY=618 is too small for this problem: kval=238045028. ## Try increasing the size of the workspace."},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"sec:mantel","dir":"Articles","previous_headings":"","what":"Mantel-Haenszel test and conditional association","title":"2. Tests of Independence","text":"Use mantelhaen.test(X) function perform Cochran-Mantel-Haenszel \\(\\chi^2\\) chi test null hypothesis two nominal variables conditionally independent, \\(\\perp B \\; | \\; C\\), stratum, assuming three-way interaction. X 3 dimensional contingency table, last dimension refers strata. UCBAdmissions serves example \\(2 \\times 2 \\times 6\\) table, Dept stratifying variable. results show evidence association admission gender adjusted department. However, can easily see assumption equal association across strata (3-way association) probably violated. \\(2 \\times 2 \\times k\\) tables, can examined odds ratios \\(2 \\times 2\\) table (oddsratio()), tested using woolf_test() vcd.","code":"# UC Berkeley Student Admissions mantelhaen.test(UCBAdmissions) ##  ##  Mantel-Haenszel chi-squared test with continuity correction ##  ## data:  UCBAdmissions ## Mantel-Haenszel X-squared = 1.4269, df = 1, p-value = 0.2323 ## alternative hypothesis: true common odds ratio is not equal to 1 ## 95 percent confidence interval: ##  0.7719074 1.0603298 ## sample estimates: ## common odds ratio  ##         0.9046968 oddsratio(UCBAdmissions, log=FALSE) ##  odds ratios for Admit and Gender by Dept  ##  ##         A         B         C         D         E         F  ## 0.3492120 0.8025007 1.1330596 0.9212838 1.2216312 0.8278727  lor <- oddsratio(UCBAdmissions)  # capture log odds ratios summary(lor) ##  ## z test of coefficients: ##  ##    Estimate Std. Error z value  Pr(>|z|)     ## A -1.052076   0.262708 -4.0047 6.209e-05 *** ## B -0.220023   0.437593 -0.5028    0.6151     ## C  0.124922   0.143942  0.8679    0.3855     ## D -0.081987   0.150208 -0.5458    0.5852     ## E  0.200187   0.200243  0.9997    0.3174     ## F -0.188896   0.305164 -0.6190    0.5359     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  woolf_test(UCBAdmissions)  ##  ## Woolf-test on Homogeneity of Odds Ratios (no 3-way association)  ##  ## Data:          UCBAdmissions  ## OR variables:  Admit, Gender  ## Strata:        Dept  ##  ## X-squared = 17.9017, df = 5, p-value = 0.003072"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"fourfold-displays","dir":"Articles","previous_headings":"Some plot methods","what":"Fourfold displays","title":"2. Tests of Independence","text":"can visualize odds ratios Admission department fourfold displays using fourfold(). cell frequencies \\(n_{ij}\\) \\(2 \\times  2\\) table shown quarter circle whose radius proportional \\(\\sqrt{n_{ij}}\\), area proportional cell frequency. Confidence rings odds ratio allow visual test null association; rings adjacent quadrants overlap iff observed counts consistent null hypothesis. extended version (default), brighter colors used odds ratio significantly different 1. following lines produce (ref?)(fig:fourfold1). Fourfold display UCBAdmissions data. odds ratio differs significantly 1.0, confidence bands overlap, circle quadrants shaded intensely. Another vcd function, cotabplot(), provides general approach visualizing conditional associations contingency tables, similar trellis-like plots produced coplot() lattice graphics. panel argument supplies function used render conditional subtable. following gives display (shown) similar (ref?)(fig:fourfold1).","code":"UCB <- aperm(UCBAdmissions, c(2, 1, 3)) dimnames(UCB)[[2]] <- c(\"Yes\", \"No\") names(dimnames(UCB)) <- c(\"Sex\", \"Admit?\", \"Department\") col <- c(\"#99CCFF\", \"#6699CC\", \"#F9AFAF\", \"#6666A0\", \"#FF0000\", \"#000080\") fourfold(UCB, mfrow=c(2,3), color=col) cotabplot(UCB, panel = cotab_fourfold)"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"doubledecker-plots","dir":"Articles","previous_headings":"Some plot methods","what":"Doubledecker plots","title":"2. Tests of Independence","text":"want view conditional probabilities response variable (e.g., Admit) relation several factors, alternative visualization doubledecker() plot. plot specialized version mosaic plot, highlights levels response variable (plotted vertically) relation factors (shown horizontally). following call produces (ref?)(fig:doubledecker), use indexing first factor (Admit) make Admitted highlighted level. plot, association Admit Gender shown heights highlighted conditional probabilities align. excess females admitted Dept stands . Doubledecker display UCBAdmissions data. heights highlighted bars show conditional probabilities Admit, given Dept Gender.","code":"doubledecker(Admit ~ Dept + Gender, data=UCBAdmissions[2:1,,])"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"odds-ratio-plots","dir":"Articles","previous_headings":"Some plot methods","what":"Odds ratio plots","title":"2. Tests of Independence","text":"Finally, plot() method oddsratio objects. default, shows 95% confidence interval log odds ratio. (ref?)(fig:oddsratio) produced : Log odds ratio plot UCBAdmissions data. {#fig:oddsratio}","code":"plot(lor,       xlab=\"Department\",       ylab=\"Log Odds Ratio (Admit | Gender)\")"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"sec:CMH","dir":"Articles","previous_headings":"","what":"Cochran-Mantel-Haenszel tests for ordinal factors","title":"2. Tests of Independence","text":"standard \\(\\chi^2\\) tests association two-way table treat table factors nominal (unordered) categories. one factors two-way table quantitative ordinal, powerful tests association may obtained taking ordinality account, using row column scores test linear trends differences row column means. general versions CMH tests (Landis etal., 1978) (Landis, Heyman, Koch 1978) provided assigning numeric scores row /column variables. example, two ordinal factors (assumed equally spaced), assigning integer scores, 1:R 1:C tests linear \\(\\times\\) linear component association. statistically equivalent Pearson correlation integer-scored table variables, \\(\\chi^2 = (n-1) r^2\\), 1 \\(df\\) rather \\((R-1)\\times(C-1)\\) test general association. one table variable ordinal, general CMH tests analogous ANOVA, testing whether row mean scores column mean scores equal, consuming fewer \\(df\\) test general association. CMHtest() function vcdExtra calculates various CMH tests two possibly ordered factors, optionally stratified factor(s). Example: Recall \\(4 \\times 4\\) table, JobSat introduced @ref(sec:creating), Treating satisfaction levels equally spaced, using midpoints income categories row scores gives following results: Note relatively small cell frequencies, test general give evidence association. However, cor test linear x linear association 1 df nearly significant. coin package contains functions cmh_test() lbl_test() CMH tests general association linear x linear association respectively.","code":"JobSat ##         satisfaction ## income   VeryD LittleD ModerateS VeryS ##   < 15k      1       3        10     6 ##   15-25k     2       3        10     7 ##   25-40k     1       6        14    12 ##   > 40k      0       1         9    11 CMHtest(JobSat, rscores=c(7.5,20,32.5,60)) ## Cochran-Mantel-Haenszel Statistics for income by satisfaction  ##  ##                  AltHypothesis  Chisq Df     Prob ## cor        Nonzero correlation 3.8075  1 0.051025 ## rmeans  Row mean scores differ 4.4774  3 0.214318 ## cmeans  Col mean scores differ 3.8404  3 0.279218 ## general    General association 5.9034  9 0.749549"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"measures-of-association","dir":"Articles","previous_headings":"","what":"Measures of Association","title":"2. Tests of Independence","text":"variety statistical measures strength association contingency tables— similar spirit \\(r\\) \\(r^2\\) continuous variables. large sample size, even small degree association can show significant \\(\\chi^2\\), example GSS data. assocstats() function vcd calculates \\(\\phi\\) contingency coefficient, Cramer’s V \\(r \\times c\\) table. input must table form, two-way \\(r \\times c\\) table. won’t work GSS frequency form, now know convert. tables ordinal variables, like JobSat, people prefer Goodman-Kruskal \\(\\gamma\\) statistic (Agresti 2002, 2.4.3) based comparison concordant discordant pairs observations case-form equivalent two-way table.","code":"assocstats(GSStab) ##                     X^2 df P(> X^2) ## Likelihood Ratio 7.0026  2 0.030158 ## Pearson          7.0095  2 0.030054 ##  ## Phi-Coefficient   : NA  ## Contingency Coeff.: 0.084  ## Cramer's V        : 0.085 GKgamma(JobSat) ## gamma        : 0.221  ## std. error   : 0.117  ## CI           : -0.009 0.451"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"measures-of-agreement","dir":"Articles","previous_headings":"","what":"Measures of Agreement","title":"2. Tests of Independence","text":"Kappa() function vcd package calculates Cohen’s \\(\\kappa\\) weighted \\(\\kappa\\) square two-way table row column categories (Cohen 1960). Normal-theory \\(z\\)-tests obtained dividing \\(\\kappa\\) asymptotic standard error (ASE). confint() method Kappa objects provides confidence intervals. visualization agreement (Bangdiwala 1987), unweighted weighted degree departure exact agreement provided agreementplot() function. (fig?)(fig:agreesex) shows agreementplot SexualFun data, produced shown . Bangdiwala measures (returned function) represent proportion shaded areas diagonal rectangles, using weights \\(w_1\\) exact agreement, \\(w_2\\) partial agreement one step main diagonal. Agreement plot SexualFun data. examples, agreement plot can help show sources disagreement. example, shaded boxes diagonal (red) line, lack exact agreement can attributed part different frequency use categories two raters– lack marginal homogeneity.","code":"data(SexualFun, package = \"vcd\") (K <- Kappa(SexualFun)) ##             value     ASE     z ## Unweighted 0.1293 0.06860 1.885 ## Weighted   0.2374 0.07832 3.031 confint(K) ##              ## Kappa                 lwr       upr ##   Unweighted -0.005120399 0.2637809 ##   Weighted    0.083883432 0.3908778 agree <- agreementplot(SexualFun, main=\"Is sex fun?\") unlist(agree) ##          Bangdiwala Bangdiwala_Weighted            weights1            weights2  ##           0.1464624           0.4981723           1.0000000           0.8888889"},{"path":"https://friendly.github.io/vcdExtra/articles/a2-tests.html","id":"correspondence-analysis","dir":"Articles","previous_headings":"","what":"Correspondence analysis","title":"2. Tests of Independence","text":"Correspondence analysis technique visually exploring relationships rows columns contingency tables. ca package gives one implementation. \\(r \\times c\\) table, method provides breakdown Pearson \\(\\chi^2\\) association \\(M = \\min(r-1, c-1)\\) dimensions, finds scores row (\\(x_{im}\\)) column (\\(y_{jm}\\)) categories observations maximum possible correlations.% 1 , carry simple correspondence analysis HairEye data. printed results show nearly 99% association hair color eye color can accounted 2 dimensions, first dimension accounts 90%. resulting ca object can plotted just running plot() method ca object, giving result @ref(fig:ca-haireye). plot.ca() allow labels dimensions; can added title(). can seen association accounted ordering hair color eye color along Dimension 1, dark light dimension. Correspondence analysis plot HairEye data","code":"library(ca) ca(HairEye) ##  ##  Principal inertias (eigenvalues): ##            1        2        3        ## Value      0.208773 0.022227 0.002598 ## Percentage 89.37%   9.52%    1.11%    ##  ##  ##  Rows: ##             Black     Brown       Red    Blond ## Mass     0.182432  0.483108  0.119932 0.214527 ## ChiDist  0.551192  0.159461  0.354770 0.838397 ## Inertia  0.055425  0.012284  0.015095 0.150793 ## Dim. 1  -1.104277 -0.324463 -0.283473 1.828229 ## Dim. 2   1.440917 -0.219111 -2.144015 0.466706 ##  ##  ##  Columns: ##             Brown     Blue     Hazel     Green ## Mass     0.371622 0.363176  0.157095  0.108108 ## ChiDist  0.500487 0.553684  0.288654  0.385727 ## Inertia  0.093086 0.111337  0.013089  0.016085 ## Dim. 1  -1.077128 1.198061 -0.465286  0.354011 ## Dim. 2   0.592420 0.556419 -1.122783 -2.274122 plot(ca(HairEye), main=\"Hair Color and Eye Color\")"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/articles/a3-loglinear.html","id":"sec:loglm","dir":"Articles","previous_headings":"","what":"Fitting with loglm()","title":"3. Loglinear Models","text":"example, can fit model mutual independence among hair color, eye color sex HairEyeColor Similarly, models conditional independence joint independence specified Note printing model gives brief summary goodness fit. set models can compared using anova() function.","code":"library(MASS) ## Independence model of hair and eye color and sex.   hec.1 <- loglm(~Hair+Eye+Sex, data=HairEyeColor) hec.1 ## Call: ## loglm(formula = ~Hair + Eye + Sex, data = HairEyeColor) ##  ## Statistics: ##                       X^2 df P(> X^2) ## Likelihood Ratio 166.3001 24        0 ## Pearson          164.9247 24        0 ## Conditional independence hec.2 <- loglm(~(Hair + Eye) * Sex, data=HairEyeColor) hec.2 ## Call: ## loglm(formula = ~(Hair + Eye) * Sex, data = HairEyeColor) ##  ## Statistics: ##                       X^2 df P(> X^2) ## Likelihood Ratio 156.6779 18        0 ## Pearson          147.9440 18        0 ## Joint independence model.   hec.3 <- loglm(~Hair*Eye + Sex, data=HairEyeColor) hec.3 ## Call: ## loglm(formula = ~Hair * Eye + Sex, data = HairEyeColor) ##  ## Statistics: ##                       X^2 df  P(> X^2) ## Likelihood Ratio 19.85656 15 0.1775045 ## Pearson          19.56712 15 0.1891745 anova(hec.1, hec.2, hec.3) ## LR tests for hierarchical log-linear models ##  ## Model 1: ##  ~Hair + Eye + Sex  ## Model 2: ##  ~(Hair + Eye) * Sex  ## Model 3: ##  ~Hair * Eye + Sex  ##  ##            Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) ## Model 1   166.30014 24                                     ## Model 2   156.67789 18    9.62225         6        0.14149 ## Model 3    19.85656 15  136.82133         3        0.00000 ## Saturated   0.00000  0   19.85656        15        0.17750"},{"path":"https://friendly.github.io/vcdExtra/articles/a3-loglinear.html","id":"sec:glm","dir":"Articles","previous_headings":"","what":"Fitting with glm() and gnm()","title":"3. Loglinear Models","text":"glm() approach, extensions gnm package allows much wider class models frequency data fit can handled loglm(). particular importance models ordinal factors square tables, can test structured hypotheses patterns association provided tests general association loglm(). similar spirit non-parametric CMH tests described @ref(sec:CMH). Example: data Mental vcdExtra package gives two-way table frequency form classifying young people mental health status parents’ socioeconomic status (SES), variables ordered factors. Simple ways handling ordinal variables involve assigning scores table categories, simplest cases use integer scores, either row variable (column effects'' model), column variable (row effects’’ model), (``uniform association’’ model). fit parsimonious models general association, can define numeric scores row column categories , row effects model, column effects model, uniform association model can fit follows. essential idea replace factor variable numeric equivalent model formula association term. LRstats() function vcdExtra provides nice, compact summary fit statistics set models, collected glmlist object. Smaller better AIC BIC. specific model comparisons, can also carry tests nested models anova() models listed smallest largest. , two separate paths restrictive (independence) model model uniform association, allow one row effects column effects. model linear linear association seems best accounts. comparison, one might try CMH tests data:","code":"data(Mental, package = \"vcdExtra\") str(Mental) ## 'data.frame':    24 obs. of  3 variables: ##  $ ses   : Ord.factor w/ 6 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 1 1 1 1 2 2 2 2 3 3 ... ##  $ mental: Ord.factor w/ 4 levels \"Well\"<\"Mild\"<..: 1 2 3 4 1 2 3 4 1 2 ... ##  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ... xtabs(Freq ~ mental + ses, data=Mental)   # display the frequency table ##           ses ## mental       1   2   3   4   5   6 ##   Well      64  57  57  72  36  21 ##   Mild      94  94 105 141  97  71 ##   Moderate  58  54  65  77  54  54 ##   Impaired  46  40  60  94  78  71 indep <- glm(Freq ~ mental + ses, family = poisson, data = Mental)  # independence model # Use integer scores for rows/cols  Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental) # column effects model (ses) coleff <- glm(Freq ~ mental + ses + Rscore:ses, family = poisson, data = Mental)  # row effects model (mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore, family = poisson, data = Mental)  # linear x linear association linlin <- glm(Freq ~ mental + ses + Rscore:Cscore, family = poisson, data = Mental) # compare models using AIC, BIC, etc vcdExtra::LRstats(glmlist(indep, roweff, coleff, linlin)) ## Likelihood summary table: ##           AIC    BIC LR Chisq Df Pr(>Chisq)     ## indep  209.59 220.19   47.418 15  3.155e-05 *** ## roweff 174.45 188.59    6.281 12     0.9013     ## coleff 179.00 195.50    6.829 10     0.7415     ## linlin 174.07 185.85    9.895 14     0.7698     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(indep, linlin, coleff, test=\"Chisq\")   ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Rscore:Cscore ## Model 3: Freq ~ mental + ses + Rscore:ses ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        15     47.418                           ## 2        14      9.895  1   37.523 9.035e-10 *** ## 3        10      6.829  4    3.066    0.5469     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(indep, linlin, roweff, test=\"Chisq\")   ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Rscore:Cscore ## Model 3: Freq ~ mental + ses + mental:Cscore ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        15     47.418                           ## 2        14      9.895  1   37.523 9.035e-10 *** ## 3        12      6.281  2    3.614    0.1641     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 CMHtest(xtabs(Freq~ses+mental, data=Mental)) ## Cochran-Mantel-Haenszel Statistics for ses by mental  ##  ##                  AltHypothesis  Chisq Df       Prob ## cor        Nonzero correlation 37.156  1 1.0907e-09 ## rmeans  Row mean scores differ 40.297  5 1.3012e-07 ## cmeans  Col mean scores differ 40.666  3 7.6971e-09 ## general    General association 45.958 15 5.4003e-05"},{"path":"https://friendly.github.io/vcdExtra/articles/a3-loglinear.html","id":"non-linear-terms","dir":"Articles","previous_headings":"","what":"Non-linear terms","title":"3. Loglinear Models","text":"strength gnm package handles wide variety models handle non-linear terms, parameters enter model beyond simple linear function. simplest example Goodman RC(1) model (Goodman, 1979), allows multiplicative term account association table variables. notation generalized linear models log link, can expressed \\[ \\log \\mu_{ij} = \\alpha_i + \\beta_j + \\gamma_{} \\delta_{j}   ,\\] row-multiplicative effect parameters \\(\\gamma_i\\) corresponding column parameters \\(\\delta_j\\) estimated data.% 2 Similarly, RC(2) model adds two multiplicative terms independence model, \\[ \\log \\mu_{ij} = \\alpha_i + \\beta_j + \\gamma_{i1} \\delta_{j1} + \\gamma_{i2} \\delta_{j2} . \\] gnm package, models may fit using Mult() specify multiplicative term, instances() specify several terms. Example: Mental data, fit RC(1) RC(2) models, compare independence model.","code":"RC1 <- gnm(Freq ~ mental + ses + Mult(mental,ses), data=Mental,               family=poisson, verbose=FALSE) RC2 <- gnm(Freq ~ mental+ses + instances(Mult(mental,ses),2), data=Mental,               family=poisson, verbose=FALSE) anova(indep, RC1, RC2, test=\"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Mult(mental, ses) ## Model 3: Freq ~ mental + ses + Mult(mental, ses, inst = 1) + Mult(mental,  ##     ses, inst = 2) ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        15     47.418                           ## 2         8      3.571  7   43.847 2.288e-07 *** ## 3         3      0.523  5    3.048    0.6926     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/articles/a4-mosaics.html","id":"permuting-variable-levels","dir":"Articles","previous_headings":"","what":"Permuting variable levels","title":"4. Mosaic plots","text":"Mosaic plots using tables frequency data frames input typically take levels table variables order presented dataset. character variables, often alphabetical order. might helpful looking value, unhelpful seeing understanding pattern association. usually much better order levels row column variables help reveal nature association. example effect ordering data display (Friendly & Kwan, 2003). Example: Data Glass (1954) gave 5 x 5 table occupations 3500 British fathers sons, occupational categories listed alphabetic order. mosaic display shows strong association, aside diagonal cells, pattern unclear. Note use set_varnames give descriptive labels variables abbreviate occupational category labels. interpolate set shading levels mosaic.  occupational categories differ status, can reordered correctly follows, Professional Unskilled. revised mosaic plot can produced indexing rows columns table using ord.  , examples next section, useful re-define father son ordered factors original Glass frequency data.frame.","code":"data(Glass, package=\"vcdExtra\") (glass.tab <- xtabs(Freq ~ father + son, data=Glass)) ##               son ## father         Managerial Professional Skilled Supervisory Unskilled ##   Managerial          174           28     154          84        55 ##   Professional         45           50      18           8         8 ##   Skilled             150           14     714         185       447 ##   Supervisory          78           11     223         110        96 ##   Unskilled            42            3     320          72       411 largs <- list(set_varnames=list(father=\"Father's Occupation\",                                  son=\"Son's Occupation\"),               abbreviate=10) gargs <- list(interpolate=c(1,2,4,8))  mosaic(glass.tab,    shade=TRUE,    labeling_args=largs,    gp_args=gargs,   main=\"Alphabetic order\",    legend=FALSE,    rot_labels=c(20,90,0,70)) # reorder by status ord <- c(2, 1, 4, 3, 5)  row.names(glass.tab)[ord] ## [1] \"Professional\" \"Managerial\"   \"Supervisory\"  \"Skilled\"      \"Unskilled\" mosaic(glass.tab[ord, ord],    shade=TRUE,    labeling_args=largs,     gp_args=gargs,   main=\"Effect order\",    legend=FALSE,    rot_labels=c(20,90,0,70)) Glass.ord <- Glass Glass.ord$father <- ordered(Glass.ord$father, levels=levels(Glass$father)[ord]) Glass.ord$son    <- ordered(Glass.ord$son,    levels=levels(Glass$son)[ord]) str(Glass.ord) ## 'data.frame':    25 obs. of  3 variables: ##  $ father: Ord.factor w/ 5 levels \"Professional\"<..: 1 1 1 1 1 2 2 2 2 2 ... ##  $ son   : Ord.factor w/ 5 levels \"Professional\"<..: 1 2 3 4 5 1 2 3 4 5 ... ##  $ Freq  : int  50 45 8 18 8 28 174 84 154 55 ..."},{"path":"https://friendly.github.io/vcdExtra/articles/a4-mosaics.html","id":"square-tables","dir":"Articles","previous_headings":"","what":"Square tables","title":"4. Mosaic plots","text":"mobility tables , rows columns refer occupational categories comes surprise strong association diagonal cells: often, sons remain occupational categories fathers. However, re-ordered mosaic display also reveals something subtler: son differs occupation father, likely appear category one-step removed steps removed. residuals seem decrease number steps diagonal. tables, specialized loglinear models provide interesting cases intermediate independence model, [] [B], saturated model, [B]. can fit using glm(), data frequency form, assoc special term handle restricted form association, different :B specifies saturated model notation. Quasi-independence: Asserts independence, ignores diagonal cells fitting exactly. loglinear model : \\(\\log m_{ij} = \\mu + \\lambda^A_i + \\lambda^B_j + \\delta_i (= j)\\), \\(()\\) indicator function. Symmetry: model asserts joint distribution row column variables symmetric, \\(\\pi_{ij} = \\pi_{ji}\\): son equally likely move father’s occupational category \\(\\) another category, \\(j\\), reverse, moving \\(j\\) \\(\\). Symmetry quite strong, also implies marginal homogeneity, marginal probabilities row column variables equal, \\(\\pi{+} = \\sum_j \\pi_{ij} = \\sum_j \\pi_{ji} = \\pi_{+}\\) \\(\\). Quasi-symmetry: model uses standard main-effect terms loglinear model, asserts association parameters symmetric, \\(\\log m_{ij} = \\mu + \\lambda^A_i + \\lambda^B_j + \\lambda^{AB}_{ij}\\), \\(\\lambda^{AB}_{ij} = \\lambda^{AB}_{ji}\\). gnm package provides variety functions: gnm::Diag(), gnm::Symm() gnm::Topo() interaction factor specified array levels, may arbitrarily structured. example, following generates term diagonal factor \\(4 \\times 4\\) table. diagonal values reflect parameters fitted diagonal cell. -diagonal values, “.” ignored. Symm() constructs parameters symmetric cells. particular values don’t matter. matter value, e.g., 1:2 appears (1,2) (2,1) cells. Example: illustrate, fit four models , starting independence model Freq ~ father + son adding terms reflect restricted forms association, e.g., Diag(father, son) diagonal terms Symm(father, son) symmetry. can visualize using vcdExtra::mosaic.glm() method, extends mosaic displays handle fitted glm objects. Technical note: models fitted using glm(), standardized residuals, residuals_type=\"rstandard\" better statistical properties default Pearson residuals mosaic plots analysis.  Mosaic plots models give visual assessment models, however can also test differences among . nested models, anova() gives tests much better complex model compared previous one. Alternatively, vcdExtra::LRstats() gives model summaries collection models, necessarily nested, AIC BIC statistics reflecting model parsimony. criteria, model quasi symmetry fits best. residual deviance $G^2 significant. mosaic largely unshaded, indicating good fit, shaded cells indicate remaining positive negative residuals. comparative mosaic displays, sometimes useful show \\(G^2\\) statistic main title, using vcdExtra::modFit() purpose.","code":"glm(Freq ~ A + B + assoc, data = ..., family = poisson) rowfac <- gl(4, 4, 16) colfac <- gl(4, 1, 16) diag4by4 <- Diag(rowfac, colfac) matrix(Diag(rowfac, colfac, binary = FALSE), 4, 4) ##      [,1] [,2] [,3] [,4] ## [1,] \"1\"  \".\"  \".\"  \".\"  ## [2,] \".\"  \"2\"  \".\"  \".\"  ## [3,] \".\"  \".\"  \"3\"  \".\"  ## [4,] \".\"  \".\"  \".\"  \"4\" symm4by4 <- Symm(rowfac, colfac) matrix(symm4by4, 4, 4) ##      [,1]  [,2]  [,3]  [,4]  ## [1,] \"1:1\" \"1:2\" \"1:3\" \"1:4\" ## [2,] \"1:2\" \"2:2\" \"2:3\" \"2:4\" ## [3,] \"1:3\" \"2:3\" \"3:3\" \"3:4\" ## [4,] \"1:4\" \"2:4\" \"3:4\" \"4:4\" library(gnm) glass.indep <- glm(Freq ~ father + son,                     data = Glass.ord, family=poisson) glass.quasi <- glm(Freq ~ father + son + Diag(father, son),                      data = Glass.ord, family=poisson) glass.symm  <- glm(Freq ~ Symm(father, son),                      data = Glass.ord, family=poisson) glass.qsymm <- glm(Freq ~ father + son + Symm(father, son),                      data = Glass.ord, family=poisson) mosaic(glass.quasi,    residuals_type=\"rstandard\",    shade=TRUE,    labeling_args=largs,     gp_args=gargs,   main=\"Quasi-Independence\",   legend=FALSE,    rot_labels=c(20,90,0,70)   ) # model comparisons: for *nested* models anova(glass.indep, glass.quasi, glass.qsymm, test=\"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ father + son ## Model 2: Freq ~ father + son + Diag(father, son) ## Model 3: Freq ~ father + son + Symm(father, son) ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        16     792.19                           ## 2        11     235.78  5   556.41 < 2.2e-16 *** ## 3         6       4.66  5   231.12 < 2.2e-16 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 models <- glmlist(glass.indep, glass.quasi, glass.symm, glass.qsymm) LRstats(models) ## Likelihood summary table: ##                AIC    BIC LR Chisq Df Pr(>Chisq)     ## glass.indep 960.91 971.88   792.19 16  < 2.2e-16 *** ## glass.quasi 414.50 431.57   235.78 11  < 2.2e-16 *** ## glass.symm  218.18 236.47    37.46 10  4.704e-05 *** ## glass.qsymm 193.38 216.54     4.66  6     0.5876     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(glass.qsymm,    residuals_type=\"rstandard\",    shade=TRUE,    labeling_args=largs,     gp_args=gargs,   main = paste(\"Quasi-Symmetry\", modFit(glass.qsymm)),   legend=FALSE,    rot_labels=c(20,90,0,70)   )"},{"path":"https://friendly.github.io/vcdExtra/articles/a4-mosaics.html","id":"correspondence-analysis-ordering","dir":"Articles","previous_headings":"","what":"Correspondence analysis ordering","title":"4. Mosaic plots","text":"natural orders row column levels given priori, can find orderings make sense using correspondence analysis. general ideas : Correspondence analysis assigns scores row column variables best account association 1, 2, … dimensions first CA dimension accounts largest proportion Pearson \\(\\chi^2\\) Therefore, permuting levels row column variables CA Dim1 scores gives coherent mosaic plot, clearly showing nature association. seriation package now method order variables frequency tables using CA. Example: example, consider HouseTasks dataset, 13 x 4 table frequencies household tasks performed couples, either Husband, Wife, Alternating Jointly. can see table tasks (Repairs) done largely husband; (laundry, main meal) largely done wife, others done jointly alternating husband wife. Task levels alphabetical order. naive mosaic plot dataset shown , splitting first Task . Due length factor labels, features labeling used make display readable.  Correspondence analysis, using ca package, shows nearly 89% \\(\\chi^2\\) can accounted two dimensions. CA plot fairly simple interpretation: Dim1 largely distinction tasks primarily done wife vs. husband. Dim2 distinguishes tasks done singly vs. done jointly.  , can use CA method seriation::seriate() find order permutations Task along CA dimensions. Now, use seriation::permute() use order permutations Task , plot resulting mosaic:  now easy see cluster tasks (laundry cooking) done largely wife top, (repairs, driving) done largely husband bottom.","code":"data(\"HouseTasks\", package = \"vcdExtra\") HouseTasks ##            Who ## Task        Alternating Husband Jointly Wife ##   Breakfast          36      15       7   82 ##   Dinner             11       7      13   77 ##   Dishes             24       4      53   32 ##   Driving            51      75       3   10 ##   Finances           13      21      66   13 ##   Holidays            1       6     153    0 ##   Insurance           1      53      77    8 ##   Laundry            14       2       4  156 ##   Main_meal          20       5       4  124 ##   Official           46      23      15   12 ##   Repairs             3     160       2    0 ##   Shopping           23       9      55   33 ##   Tidying            11       1      57   53 require(vcd) mosaic(HouseTasks, shade = TRUE,        labeling = labeling_border(rot_labels = c(45,0, 0, 0),                                    offset_label =c(.5,5,0, 0),                                   varnames = c(FALSE, TRUE),                                   just_labels=c(\"center\",\"right\"),                                   tl_varnames = FALSE),        legend = FALSE) require(ca) ## Loading required package: ca HT.ca <- ca(HouseTasks) summary(HT.ca, rows=FALSE, columns=FALSE) ##  ## Principal inertias (eigenvalues): ##  ##  dim    value      %   cum%   scree plot                ##  1      0.542889  48.7  48.7  ************              ##  2      0.445003  39.9  88.6  **********                ##  3      0.127048  11.4 100.0  ***                       ##         -------- -----                                  ##  Total: 1.114940 100.0 plot(HT.ca, lines = TRUE) require(seriation) order <- seriate(HouseTasks, method = \"CA\") # the permuted row and column labels rownames(HouseTasks)[order[[1]]] ##  [1] \"Laundry\"   \"Main_meal\" \"Dinner\"    \"Breakfast\" \"Tidying\"   \"Dishes\"    ##  [7] \"Shopping\"  \"Official\"  \"Holidays\"  \"Finances\"  \"Insurance\" \"Driving\"   ## [13] \"Repairs\" colnames(HouseTasks)[order[[2]]] ## [1] \"Wife\"        \"Alternating\" \"Jointly\"     \"Husband\" # do the permutation HT_perm <- permute(HouseTasks, order, margin=1)  mosaic(HT_perm, shade = TRUE,        labeling = labeling_border(rot_labels = c(45,0, 0, 0),                                    offset_label =c(.5,5,0, 0),                                   varnames = c(FALSE, TRUE),                                   just_labels=c(\"center\",\"right\"),                                   tl_varnames = FALSE),        legend = FALSE)"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"5. Demo - Housing Data","text":"’ll use following packages vignette.","code":"library(vcdExtra) library(MASS) library(effects)"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"housing-data","dir":"Articles","previous_headings":"","what":"Housing data","title":"5. Demo - Housing Data","text":"content dataset MASS::housing, giving 4-way, \\(3 \\times 3 \\times 4 \\times 2\\) frequency table 1681 individuals Copenhagen Housing Conditions Survey, classified : Satisfaction (Sat) housing circumstances (low, medium high), Type rental dwelling (Tower, Apartment, Atrium Terrace) perceived influence (Infl) management property (low, medium, high), degree contact (Cont) residents (low high) Load data:","code":"data(housing, package=\"MASS\") str(housing) ## 'data.frame':    72 obs. of  5 variables: ##  $ Sat : Ord.factor w/ 3 levels \"Low\"<\"Medium\"<..: 1 2 3 1 2 3 1 2 3 1 ... ##  $ Infl: Factor w/ 3 levels \"Low\",\"Medium\",..: 1 1 1 2 2 2 3 3 3 1 ... ##  $ Type: Factor w/ 4 levels \"Tower\",\"Apartment\",..: 1 1 1 1 1 1 1 1 1 2 ... ##  $ Cont: Factor w/ 2 levels \"Low\",\"High\": 1 1 1 1 1 1 1 1 1 1 ... ##  $ Freq: int  21 21 28 34 22 36 10 11 36 61 ..."},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"variables-levels-and-models","dir":"Articles","previous_headings":"Housing data","what":"Variables, levels and models","title":"5. Demo - Housing Data","text":"Satisfaction (Sat) householders present housing circumstances outcome variable . purposes analysis, note Sat ordered factor levels \"Low\" < \"Medium\" < \"High\". Note also Influence, levels just “Factor”, ordered one. consider just models using glm(..., family=poisson) equivalent MASS::loglm(). ordering factor levels important graphical displays. don’t want see ordered alphabetically, “High”, “Low”, “Medium”. housing data.frame constructed levels Sat Infl appear dataset appropriate order. models, e.g., proportional odds model, fit using MASS:polr() can take ordinal nature satisfaction account. glm() one re-assign Infl ordered factor examine linear vs. non-linear associations factor. don’t .","code":"levels(housing$Sat) ## [1] \"Low\"    \"Medium\" \"High\" levels(housing$Infl) ## [1] \"Low\"    \"Medium\" \"High\""},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"null-model","dir":"Articles","previous_headings":"","what":"Null model","title":"5. Demo - Housing Data","text":"ignorant model asserts table factors mutually independent. symbolic notation, [S] [] [T] [C] terms separate [ ] supposed independent. Freq ~ Sat + Infl + Type + Cont formula glm().","code":"house.null <- glm(Freq ~ Sat + Infl + Type + Cont, family = poisson,                   data = housing)"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"baseline-model","dir":"Articles","previous_headings":"","what":"Baseline model","title":"5. Demo - Housing Data","text":"Sat outcome variable, minimal baseline model allow associations among predictors, symbolized [S] [T C]. , Influence, Type Contact may associated arbitrary ways, just multiple predictors can correlated regression models. framework, remains explained whether/Sat depends combinations variables. baseline model therefore includes full three-way term predictors. models fit terribly, can always use anova(mod1, mod2,...) compare relative fits nested models.","code":"house.glm0 <- glm(Freq ~ Sat + Infl*Type*Cont, family = poisson,                   data = housing) anova(house.null, house.glm0, test = \"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ Sat + Infl + Type + Cont ## Model 2: Freq ~ Sat + Infl * Type * Cont ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        63     295.35                           ## 2        46     217.46 17   77.896 9.045e-10 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"visualising-model-fit","dir":"Articles","previous_headings":"","what":"Visualising model fit","title":"5. Demo - Housing Data","text":"baseline model shown mosaic plot . Note applied housing data, rather house.glm0 object (class glm) resulting call vcdExtra::mosaic.glm(). four variables mosaic, labeling variable names factor levels bit tricky, labels must appear four sides plot. labeling_args argument can used set informative variable names abbreviate factor levels necessary.  plot can see largish positive residuals blocks corresponding (low satisfaction, low influence) (high satisfaction, high influence) clusters largish negative residuals opposite corners. default, variables used mosaic display order data table frequency data.frame. warning reminds us order conditioning used ~Sat + Infl + Type + Cont.","code":"# labeling_args for mosaic() largs <- list(set_varnames = c(       Infl=\"Influence on management\",              Cont=\"Contact among residents\",              Type=\"Type of dwelling\",              Sat=\"Satisfaction\"),     abbreviate=c(Type=3))  mosaic(house.glm0,         labeling_args=largs,         main='Baseline model: [ITC][Sat]') ## Warning: no formula provided, assuming ~Sat + Infl + Type + Cont"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"ordering-the-variables-in-the-mosaic","dir":"Articles","previous_headings":"Visualising model fit","what":"Ordering the variables in the mosaic","title":"5. Demo - Housing Data","text":"mosaic.glm(), conditioning order variables mosaic can set using formula argument. , rearrange variables put Sat last variable splitting / conditioning sequence. also use vcdExtra::modFit() add LR \\(G^2\\) fit statistic plot title.","code":"mosaic(house.glm0,         formula = ~ Type + Infl + Cont + Sat,         labeling_args=largs,         main=paste('Baseline model: [ITC][Sat],', modFit(house.glm0))   )"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"adding-association-terms","dir":"Articles","previous_headings":"","what":"Adding association terms","title":"5. Demo - Housing Data","text":"Clearly, satisfaction depends one predictors, Infl, Type Cont possibly interactions. first step useful consider sequentially adding association terms Infl:Sat, Type:Sat, Cont:Sat one time. analysis carried using MASS::addterm(). Based , useful consider “main-effects” model satisfaction, adding three two-way terms involving satisfaction. update() method provides easy way add (subtract) terms fitted model object. model formula, . stands whatever left side (Freq) right side (Sat + Infl*Type*Cont) model (house.glm0) updated. comparison, note model can fit using iterative proportional scaling algorithm MASS::loglm().","code":"MASS::addterm(house.glm0,                ~ . + Sat:(Infl + Type + Cont),                test = \"Chisq\") ## Single term additions ##  ## Model: ## Freq ~ Sat + Infl * Type * Cont ##          Df Deviance    AIC     LRT   Pr(Chi)     ## <none>        217.46 610.43                       ## Sat:Infl  4   111.08 512.05 106.371 < 2.2e-16 *** ## Sat:Type  6   156.79 561.76  60.669 3.292e-11 *** ## Sat:Cont  2   212.33 609.30   5.126   0.07708 .   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 house.glm1 <- update(house.glm0,                       . ~ . + Sat*(Infl + Type + Cont)) (house.loglm1 <- MASS::loglm(Freq ~ Infl * Type * Cont +                                Sat*(Infl + Type + Cont), data = housing)) ## Call: ## MASS::loglm(formula = Freq ~ Infl * Type * Cont + Sat * (Infl +  ##     Type + Cont), data = housing) ##  ## Statistics: ##                       X^2 df  P(> X^2) ## Likelihood Ratio 38.66222 34 0.2671359 ## Pearson          38.90831 34 0.2582333"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"did-the-model-get-better","dir":"Articles","previous_headings":"","what":"Did the model get better?","title":"5. Demo - Housing Data","text":", anova() tests added contribution complex model one . residual deviance \\(G^2\\) reduced \\(G^2 (46) = 217.46\\) baseline model house.glm0 \\(G^2 (34) = 38.66\\) revised model house.glm1. difference, \\(G^2(M1 | M0) = G^2 (12) = 178.79\\) tests collective additional fit provided two-way association satisfaction predictors.","code":"anova(house.glm0, house.glm1, test=\"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ Sat + Infl * Type * Cont ## Model 2: Freq ~ Sat + Infl + Type + Cont + Infl:Type + Infl:Cont + Type:Cont +  ##     Sat:Infl + Sat:Type + Sat:Cont + Infl:Type:Cont ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        46    217.456                           ## 2        34     38.662 12   178.79 < 2.2e-16 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"visualize-model-glm1","dir":"Articles","previous_headings":"","what":"Visualize model glm1","title":"5. Demo - Housing Data","text":"model house.glm1 fits reasonably well, G^2(34)=38.66, residuals small. mosaic , use gp=shading_Friendly shade tiles positive negative residuals distinguished color, filled absolute value residual outside \\(\\pm 2, 4\\).  One cell highlighted : combination medium influence, low contact tower type, likely give low satisfaction model predicts. just outlier, something can interpreted perhaps improve model fit? hard tell, virtues mosaic displays help : diagnose overall patterns associations, spot unusual cells relation lack fit given model.","code":"mosaic(house.glm1,         labeling_args=largs,         main=paste('Model [IS][TS][CS],', modFit(house.glm1) ),         gp=shading_Friendly)"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"can-we-drop-any-terms","dir":"Articles","previous_headings":"","what":"Can we drop any terms?","title":"5. Demo - Housing Data","text":"add terms using MASS::addterm(), added sequentially. might case term added, previously added term longer important. Running MASS::dropterm() housel.glm1 model checks . Note three-way term Infl:Type:Cont significant. However, Sat response, associations predictors must included model.","code":"MASS::dropterm(house.glm1, test = \"Chisq\") ## Single term deletions ##  ## Model: ## Freq ~ Sat + Infl + Type + Cont + Infl:Type + Infl:Cont + Type:Cont +  ##     Sat:Infl + Sat:Type + Sat:Cont + Infl:Type:Cont ##                Df Deviance    AIC     LRT   Pr(Chi)     ## <none>              38.662 455.63                       ## Sat:Infl        4  147.780 556.75 109.117 < 2.2e-16 *** ## Sat:Type        6  100.889 505.86  62.227 1.586e-11 *** ## Sat:Cont        2   54.722 467.69  16.060 0.0003256 *** ## Infl:Type:Cont  6   43.952 448.92   5.290 0.5072454     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"what-about-two-way-interactions","dir":"Articles","previous_headings":"","what":"What about two-way interactions?","title":"5. Demo - Housing Data","text":"model far says influence, type control separate, additive effects level satisfaction, called “main-effects” model. might case predictors interaction effects, e.g., effect influence satisfaction might vary type dwelling level control. easy way test update main-effects model, adding possible two-way interactions Sat, one time, addterm(). result shows adding term Infl:Type:Sat reduces deviance \\(G^2\\) 38.66 16.11. difference, \\(G^2(M1 + | M1) = G^2 (12) = 22.55\\) reflects substantial improvement. remaining two-way interaction terms reduce deviance smaller non-significant amounts, relative house.glm1. Model fitting guided substance, just statistical machinery. Nonetheless, seems arguably sensible add one two-way term model, giving house.glm2.","code":"MASS::addterm(house.glm1,                ~. + Sat:(Infl + Type + Cont)^2,                test  =  \"Chisq\") ## Single term additions ##  ## Model: ## Freq ~ Sat + Infl + Type + Cont + Infl:Type + Infl:Cont + Type:Cont +  ##     Sat:Infl + Sat:Type + Sat:Cont + Infl:Type:Cont ##               Df Deviance    AIC     LRT Pr(Chi)   ## <none>             38.662 455.63                   ## Sat:Infl:Type 12   16.107 457.08 22.5550 0.03175 * ## Sat:Infl:Cont  4   37.472 462.44  1.1901 0.87973   ## Sat:Type:Cont  6   28.256 457.23 10.4064 0.10855   ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 house.glm2 <- update(house.glm1,                      . ~ . + Sat:Infl:Type)"},{"path":"https://friendly.github.io/vcdExtra/articles/a5-demo-housing.html","id":"model-parsimony-aic-bic","dir":"Articles","previous_headings":"","what":"Model parsimony: AIC & BIC","title":"5. Demo - Housing Data","text":"Adding association terms model always improve . question , whether “worth ”? “Worth ” concerns trade-model fit parsimony. Sometimes might prefer model fewer parameters one slightly better fit, requires model terms parameters. AIC BIC statistics designed adjust assessment model fit penalizing using parameters. Equivalently, deduct likelihood ratio \\(G^2\\) term proportional residual \\(\\text{df}\\) model. case – smaller better AIC BIC. \\[AIC = G^2 - 2 \\: \\text{df}\\] \\[BIC = G^2 - \\log(n) \\: \\text{df}\\] measures provided AIC(), BIC(), can used compare models using vcdExtra::LRstats(). metrics, model house.glm1 best AIC BIC. increased goodness--fit (smaller \\(G^2\\)) model house.glm2 worth extra cost parameters house.glm2 model.","code":"LRstats(house.glm0, house.glm1, house.glm2) ## Likelihood summary table: ##               AIC    BIC LR Chisq Df Pr(>Chisq)     ## house.glm0 610.43 669.62  217.456 46     <2e-16 *** ## house.glm1 455.63 542.15   38.662 34     0.2671     ## house.glm2 457.08 570.91   16.107 22     0.8105     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"social-mobility","dir":"Articles","previous_headings":"","what":"Social mobility","title":"6. Mobility tables","text":"Social mobility important concept sociology, ’ study led wide range developments categorical data analysis often called mobility tables. idea study movement individuals, families, households categories people within social strata society, across time space. refers change social status relative one’s current social location within given society. Using survey data, frequent examples relate changes income wealth, often studied via classification occupational categories (“professional,”managerial”, “skilled manual”, …). often studied intergenerationaly using occupational categories fathers sons. Mobility tables nearly always square tables, categories row column variables. , nearly always exhibit positive associations along diagonal cells. interest specialized models, intermediate null model independence saturated model.","code":""},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"models","dir":"Articles","previous_headings":"Social mobility","what":"Models","title":"6. Mobility tables","text":"models include important special cases: quasi-independence: Ignoring diagonal cells, row column variables independent? symmetry: associations diagonal equal corresponding ones diagonal? row effects, col effects, linear x linear: Typically, factors tables ordinal. extent can models simplified assigning integer scores row, column categories ? multiplicative RC: RC models attempt estimate scores row column categories. topographical models: possible associations among occupational categories exhibit consistent patterns according nature. models allow specifying theoretically interesting pattern. crossings models: assert different difficulty parameters crossing category next associations categories decrease separation. standard loglinear models can fit using MASS::loglm, models require use `stats::glm() gnm::gnm(), illustrate .","code":""},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"hauser-data","dir":"Articles","previous_headings":"","what":"Hauser data","title":"6. Mobility tables","text":"vignette uses vcdExtra::Hauser79 dataset, cross-classification 19,912 individuals father’s occupation son’s first occupation U.S. men aged 20-64 1973. data comes Hauser (1980) also analysed Powers & Xie (2008). discussion draws Friendly & Meyer (2016), Ch. 10. can seen, Hauser79 data.frame frequency form. factor levels table coarse grouping occupational categories, : UpNM = professional kindred workers, managers officials, non-retail sales workers; LoNM = proprietors, clerical kindred workers, retail sales workers; UpM = craftsmen, foremen, kindred workers; LoM = service workers, operatives kindred workers, laborers (except farm); Farm = farmers farm managers, farm laborers, foremen.","code":"data(\"Hauser79\", package=\"vcdExtra\") str(Hauser79) ## 'data.frame':    25 obs. of  3 variables: ##  $ Son   : Factor w/ 5 levels \"UpNM\",\"LoNM\",..: 1 2 3 4 5 1 2 3 4 5 ... ##  $ Father: Factor w/ 5 levels \"UpNM\",\"LoNM\",..: 1 1 1 1 1 2 2 2 2 2 ... ##  $ Freq  : num  1414 521 302 643 40 ... (Hauser_tab <- xtabs(Freq ~ Father + Son, data=Hauser79)) ##       Son ## Father UpNM LoNM  UpM  LoM Farm ##   UpNM 1414  521  302  643   40 ##   LoNM  724  524  254  703   48 ##   UpM   798  648  856 1676  108 ##   LoM   756  914  771 3325  237 ##   Farm  409  357  441 1611 1832"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"load-packages","dir":"Articles","previous_headings":"Hauser data","what":"Load packages","title":"6. Mobility tables","text":"","code":"library(vcdExtra) library(gnm) library(dplyr)"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"mosaic-plots","dir":"Articles","previous_headings":"Hauser data","what":"Mosaic plots","title":"6. Mobility tables","text":"Hauser_tab table object, simplest plot frequencies default plot() method, giving graphics::mosaicplot().  frequencies first split according father’s occupational category (first table dimension) sons’ occupation. common category fathers lower manual, followed farm. mosaicplot(), using shade=TRUE colors tiles according sign magnitude residuals independence model: shades positive positive residuals negative red negative residuals. vcd::mosaic() gives similar display, much flexible labeling row column variable, labels categories, scheme used shading tiles. , simply assign longer labels row column variables, using labeling_args argument mosaic().","code":"plot(Hauser_tab, shade=TRUE) labels <- list(set_varnames = c(Father=\"Father's occupation\",                                  Son=\"Son's occupation\"))  mosaic(Freq ~ Father + Son, data=Hauser79,        labeling_args = labels,        shade=TRUE,        legend = FALSE)"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"fitting-and-graphing-models","dir":"Articles","previous_headings":"Hauser data","what":"Fitting and graphing models","title":"6. Mobility tables","text":"call vcd::mosaic() takes Hauser79 dataset input. Internally, fits model independence displays result, complex tables, control fitted model limited. Unlike mosaicplot() even ggmosaic package, vcdExtra::mosaic.glm() mosaic method glm objects. means can fit model, supply model object mosaic(). (Note mosaic(), formula argument determines order splitting mosaic, loglinear formula.)","code":"hauser.indep <- glm(Freq ~ Father + Son,    data=Hauser79,    family=poisson)  # the same mosaic, using the fitted model mosaic(hauser.indep, formula = ~ Father + Son,         labeling_args = labels,        legend = FALSE,        main=\"Independence model\")"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"quasi-independence","dir":"Articles","previous_headings":"","what":"Quasi-independence","title":"6. Mobility tables","text":"Among important advances social mobility literature idea associations row column variables square tables can explored greater depth ignore obvious association diagonal cells. result model quasi-independence, asserting fathers’ sons’ occupations independent, ignoring diagonal cells. two-way table, quasi-independence can expressed \\[ \\pi_{ij} = \\pi_{+} \\pi_{+j} \\quad\\quad \\mbox{} \\ne j \\] loglinear form : \\[ \\log m_{ij} = \\mu + \\lambda_i^+ \\lambda_j^B + \\delta_i (=j) \\quad . \\] model effectively adds one parameter, \\(\\delta_i\\), main diagonal cell fits frequencies perfectly. gnm package, gnm::Diag() creates appropriate term model formula, using symbol diagonal cells “.” otherwise. proceed fit plot quasi-independence model updating independence model, adding term Diag(Father, Son).  Note pattern residuals shows systematic pattern positive negative residuals diagonal tiles. turn next.","code":"# with symbols with(Hauser79, Diag(Father, Son)) |> matrix(nrow=5) ##      [,1]   [,2]   [,3]  [,4]  [,5]   ## [1,] \"UpNM\" \".\"    \".\"   \".\"   \".\"    ## [2,] \".\"    \"LoNM\" \".\"   \".\"   \".\"    ## [3,] \".\"    \".\"    \"UpM\" \".\"   \".\"    ## [4,] \".\"    \".\"    \".\"   \"LoM\" \".\"    ## [5,] \".\"    \".\"    \".\"   \".\"   \"Farm\" hauser.quasi <-  update(hauser.indep,                          ~ . + Diag(Father, Son))  mosaic(hauser.quasi, ~ Father+Son,         labeling_args = labels,        legend = FALSE,        main=\"Quasi-independence model\")"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"symmetry-and-quasi-symmetry","dir":"Articles","previous_headings":"Quasi-independence","what":"Symmetry and quasi-symmetry","title":"6. Mobility tables","text":"Another advance social mobility literature idea test differences occupational categories fathers sons. null hypothesis systematic differences can formulated test symmetry table, \\[ \\pi_{ij} = \\pi_{ji} \\quad\\quad \\mbox{} \\ne j \\quad , \\] asserts sons likely move father’s occupation \\(\\) another category \\(j\\) move reverse direction, \\(j\\) \\(\\). alternative, “Upward mobility”, .e., sons stay father’s occupational category moved higher category average mean \\[ \\pi_{ij} < \\pi_{ji} \\quad\\quad \\mbox{} \\ne j \\] Yet model overly strong, also asserts marginal homogeneity, marginal probabilities row column values equal, \\(\\pi_{+} = \\pi_{+}\\) \\(\\). Consequently, hypothesis often tested model quasi-symmetry, also ignores diagonal cells. Symmetry modeled function gnm::Symm(). returns factor labels positions diagonal. fit model quasi-symmetry, add Diag() Symm() model independence. compare models far, can use anova() `vcdExtra::LRstats(): hauser.qsymm model represents huge improvement goodness fit. large sample size, might considered acceptable fit. , model quasi-symmetry still shows residual lack fit. visualize mosaic, can label cells standardized residuals.  cells largest lack symmetry (using standardized residuals) upper lower non-manual occupations, son upper manual worker less likely move lower non-manual work reverse.","code":"with(Hauser79, Symm(Father, Son)) |> matrix(nrow=5) ##      [,1]        [,2]        [,3]       [,4]       [,5]        ## [1,] \"UpNM:UpNM\" \"UpNM:LoNM\" \"UpNM:UpM\" \"UpNM:LoM\" \"UpNM:Farm\" ## [2,] \"UpNM:LoNM\" \"LoNM:LoNM\" \"LoNM:UpM\" \"LoNM:LoM\" \"LoNM:Farm\" ## [3,] \"UpNM:UpM\"  \"LoNM:UpM\"  \"UpM:UpM\"  \"UpM:LoM\"  \"UpM:Farm\"  ## [4,] \"UpNM:LoM\"  \"LoNM:LoM\"  \"UpM:LoM\"  \"LoM:LoM\"  \"LoM:Farm\"  ## [5,] \"UpNM:Farm\" \"LoNM:Farm\" \"UpM:Farm\" \"LoM:Farm\" \"Farm:Farm\" hauser.qsymm <-  update(hauser.indep,                          ~ . + Diag(Father,Son) + Symm(Father,Son)) anova(hauser.indep, hauser.quasi, hauser.qsymm, test=\"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ Father + Son ## Model 2: Freq ~ Father + Son + Diag(Father, Son) ## Model 3: Freq ~ Father + Son + Diag(Father, Son) + Symm(Father, Son) ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        16     6170.1                           ## 2        11      683.3  5   5486.8 < 2.2e-16 *** ## 3         6       27.4  5    655.9 < 2.2e-16 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  LRstats(hauser.indep, hauser.quasi, hauser.qsymm) ## Likelihood summary table: ##                 AIC    BIC LR Chisq Df Pr(>Chisq)     ## hauser.indep 6390.8 6401.8   6170.1 16  < 2.2e-16 *** ## hauser.quasi  914.1  931.1    683.3 11  < 2.2e-16 *** ## hauser.qsymm  268.2  291.3     27.4  6  0.0001193 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(hauser.qsymm, ~ Father+Son,         labeling_args = labels,        labeling = labeling_residuals,        residuals_type =\"rstandard\",        legend = FALSE,        main=\"Quasi-symmetry model\")"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"topological-models","dir":"Articles","previous_headings":"Quasi-independence","what":"Topological models","title":"6. Mobility tables","text":"also possible subtle patterns association one might want model, specific parameters particular combinations occupational categories (beyond idea symmetry). Hauser (1980) developed idea now called topological models levels models, arbitrary pattern associations can specified, implemented gnm::Topo().  Comparing models, can see model quasi-symmetry best far, using AIC measure:","code":"# Levels for Hauser 5-level model levels <- matrix(c(       2,  4,  5,  5,  5,       3,  4,  5,  5,  5,       5,  5,  5,  5,  5,       5,  5,  5,  4,  4,       5,  5,  5,  4,  1),        nrow = 5, ncol = 5,        byrow=TRUE) hauser.topo <- update(hauser.indep,                        ~ . + Topo(Father, Son, spec=levels))  mosaic(hauser.topo, ~Father+Son,         labeling_args = labels,        labeling = labeling_residuals,        residuals_type =\"rstandard\",        legend = FALSE,        main=\"Topological model\") LRstats(hauser.indep, hauser.quasi, hauser.qsymm, hauser.topo, sortby = \"AIC\") ## Likelihood summary table: ##                 AIC    BIC LR Chisq Df Pr(>Chisq)     ## hauser.indep 6390.8 6401.8   6170.1 16  < 2.2e-16 *** ## hauser.quasi  914.1  931.1    683.3 11  < 2.2e-16 *** ## hauser.topo   295.3  311.1     66.6 12  1.397e-09 *** ## hauser.qsymm  268.2  291.3     27.4  6  0.0001193 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"ordinal-tables","dir":"Articles","previous_headings":"","what":"Ordinal tables","title":"6. Mobility tables","text":"factors mobility tables ordered, another path simplifying saturated model consider assigning numerical scores (typically consecutive integers) categories. variables assigned scores, gives linear--linear model, \\[ \\log ( m_{ij} ) = \\mu  +  \\lambda_i^+  \\lambda_j^B  +  \\gamma \\: a_i b_j \\quad , \\] \\(a_i\\) \\(b_j\\) row column numeric scores. model also called model uniform association (Goodman, 1979) , integer scores, \\(a_i=\\), \\(b_j=j\\), model one extra parameter, \\(\\gamma\\), common odds local ratio. independence model special case, \\(\\gamma=0\\). contrast, saturated model, allowing general association \\(\\lambda_{ij}^{AB}\\), uses \\((-1)(J-1)\\) additional parameters. square tables, like mobility tables, model can amended include diagonal term, Diag() fit model, use Fscore * Sscore linear x linear association add Diag(Father, Son) fit diagonal cells exactly. model, estimated common local log odds ratio—coefficient \\(\\gamma\\) linear--linear term Fscore:Sscore, given : comparisons involving diagonal cells, step scale occupational categories father multiplies odds son also one lower category \\(\\exp (0.158) = 1.172\\), increase 17%. model seem improvement quasi-symmetry. pattern residuals mosaic, see number large residuals various signs lower triangular, son’s occupation higher level father.","code":"Sscore <- as.numeric(Hauser79$Son) Fscore <- as.numeric(Hauser79$Father)  Hauser79 |> cbind(Fscore, Fscore) |> head() ##    Son Father Freq Fscore Fscore ## 1 UpNM   UpNM 1414      1      1 ## 2 LoNM   UpNM  521      1      1 ## 3  UpM   UpNM  302      1      1 ## 4  LoM   UpNM  643      1      1 ## 5 Farm   UpNM   40      1      1 ## 6 UpNM   LoNM  724      2      2 hauser.UAdiag <- update(hauser.indep,                         . ~ . + Fscore : Sscore + Diag(Father, Son))  LRstats(hauser.UAdiag) ## Likelihood summary table: ##                  AIC BIC LR Chisq Df Pr(>Chisq)     ## hauser.UAdiag 305.72 324   73.007 10  1.161e-11 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 coef(hauser.UAdiag)[[\"Fscore:Sscore\"]] ## [1] 0.1584003 mosaic(hauser.UAdiag, ~ Father+Son,         labeling_args = labels,        labeling = labeling_residuals,        residuals_type =\"rstandard\",        legend = FALSE,        main=\"Uniform association + Diag()\")"},{"path":"https://friendly.github.io/vcdExtra/articles/a6-mobility.html","id":"model-comparison-plots","dir":"Articles","previous_headings":"","what":"Model comparison plots","title":"6. Mobility tables","text":"Finally, comparing largish collection models, model comparison plot can show trade-goodness--fit parsimony plotting measures like \\(G^2/df\\), AIC, BIC degrees freedom. plot , including quite models, uses log scale BIC emphasize differences among better fitting models. (code plot shown p. 399 Friendly & Meyer (2016)).","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/articles/a7-continuous.html","id":"sec:spine","dir":"Articles","previous_headings":"","what":"Spine and conditional density plots","title":"7. Continuous predictors","text":"don’t go fitting models , remiss illustrate visualizations vcd helpful . first spine plot spinogram (Hummel, 1996), produced spine(). special cases mosaic plots specific spacing shading show categorical response varies continuous categorical predictor. also generalization stacked bar plots heights widths bars corresponds relative frequencies x. heights bars correspond conditional relative frequencies y every x group. Example: Arthritis data, can see Improved varies Age follows. spine() takes formula form y ~ x single dependent factor single explanatory variable x (numeric variable factor). range numeric variablex divided intervals based breaks argument, stacked bars drawn show distribution y x varies. shown , discrete table visualized returned function. Spine plots Arthritis data conditional density plot (Hofmann & Theus, 2005) generalization. visualization technique similar spinograms, uses smoothing approach rather discretizing explanatory variable. well, uses original x axis distorted one. Conditional density plot Arthritis data showing variation Improved Age. plots, useful also see distribution observations across horizontal axis, e.g., rug() plot. @ref{fig:cd-plot} uses cdplot() graphics package rather cd_plot() vcd, produced  figure can easily seen proportion patients reporting Marked improvement increases Age, peculiar bumps distribution. may real artifactual, hard see visualization methods. switch non-parametric data exploration parametric statistical models, effects easily missed.","code":"(spine(Improved ~ Age, data = Arthritis, breaks = 3)) ##          Improved ## Age       None Some Marked ##   [20,40]   10    3      2 ##   (40,60]   21    3     17 ##   (60,80]   11    8      9 (spine(Improved ~ Age, data = Arthritis, breaks = \"Scott\")) ##          Improved ## Age       None Some Marked ##   [20,30]    6    1      0 ##   (30,40]    4    2      2 ##   (40,50]    9    0      3 ##   (50,60]   12    3     14 ##   (60,70]   11    8      8 ##   (70,80]    0    0      1 cdplot(Improved ~ Age, data = Arthritis) cdplot(Improved ~ Age, data = Arthritis) with(Arthritis, rug(jitter(Age), col=\"white\", quiet=TRUE))"},{"path":"https://friendly.github.io/vcdExtra/articles/a7-continuous.html","id":"sec:modelplots","dir":"Articles","previous_headings":"","what":"Model-based plots: effect plots and ggplot2 plots","title":"7. Continuous predictors","text":"nonparametric conditional density plot uses smoothing methods convey distributions response variable, displays simpler interpret can often obtained plotting predicted response parametric model. complex glm() models interaction effects, effects package provides useful displays, plotting predicted values given term, averaging predictors included term. don’t illustrate , see Fox & Weisberg (2018),Fox (2003) help(package=\"effects\"). just briefly illustrate capabilities ggplot2 package model-smoothed plots categorical responses glm() models. Example: Donner data frame vcdExtra gives details survival 90 members Donner party, group people attempted migrate California 1846. trapped early blizzard eastern side Sierra Nevada mountains, rescued, nearly half party died. factors affected lived died? potential model interest logistic regression model \\(Pr(survived)\\), allowing separate fits males females function age. key stat_smooth() function, using method = \"glm\", method.args = list(family = binomial). formula = y ~ x specifies linear fit logit scale (@ref{fig:donner3}, left) Alternatively, can allow quadratic relation age specifying formula = y ~ poly(x,2) ((ref?)(fig:donner3), right). Logistic regression plots Donner data showing survival vs. age, sex. Left: linear logistic model; right: quadratic model {#fig:donner3} plots nicely show () fitted \\(Pr(survived)\\) males females; (b) confidence bands around smoothed model fits (c) individual observations jittered points 0 1 died survived, respectively.","code":"data(Donner, package=\"vcdExtra\") str(Donner) ## 'data.frame':    90 obs. of  5 variables: ##  $ family  : Factor w/ 10 levels \"Breen\",\"Donner\",..: 9 1 1 1 1 1 1 1 1 1 ... ##  $ age     : int  23 13 1 5 14 40 51 9 3 8 ... ##  $ sex     : Factor w/ 2 levels \"Female\",\"Male\": 2 2 1 2 2 1 2 2 2 2 ... ##  $ survived: int  0 1 1 1 1 1 1 1 1 1 ... ##  $ death   : POSIXct, format: \"1846-12-29\" NA ... # separate linear fits on age for M/F ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\",                method.args = list(family = binomial),                formula = y ~ x,               alpha = 0.2, size=2, aes(fill = sex)) # separate quadratics ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\",                method.args = list(family = binomial),                formula = y ~ poly(x,2),                alpha = 0.2, size=2, aes(fill = sex))"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/articles/datasets.html","id":"processing-tags","dir":"Articles","previous_headings":"","what":"Processing tags","title":"Datasets for categorical data analysis","text":"Using result vcdExtra::datasets(package=\"vcdExtra\") created spreadsheet, vcdExtra-datasets.xlsx, added method tags. invert table, need split tags separate observations, collapse rows tag.","code":"dsets_tagged <- read_excel(here::here(\"inst\", \"extdata\", \"vcdExtra-datasets.xlsx\"),                             sheet=\"vcdExtra-datasets\")  dsets_tagged <- dsets_tagged |>   dplyr::select(-Title, -dim) |>   dplyr::rename(dataset = Item)  head(dsets_tagged) ## # A tibble: 6 × 3 ##   dataset   class      tags                                 ##   <chr>     <chr>      <chr>                                ## 1 Abortion  table      loglinear;logit;2x2                  ## 2 Accident  data.frame loglinear; glm; logistic             ## 3 AirCrash  data.frame reorder; ca                          ## 4 Alligator data.frame loglinear;multinomial;zeros          ## 5 Bartlett  table      2x2;loglinear; homogeneity;oddsratio ## 6 Burt      data.frame ca dset_split <- dsets_tagged |>   tidyr::separate_longer_delim(tags, delim = \";\") |>   dplyr::mutate(tag = stringr::str_trim(tags)) |>   dplyr::select(-tags)  #' ## collapse the rows for the same tag tag_dset <- dset_split |>   arrange(tag) |>   dplyr::group_by(tag) |>   dplyr::summarise(datasets = paste(dataset, collapse = \"; \")) |> ungroup()  # get a list of the unique tags unique(tag_dset$tag) ##  [1] \"2x2\"         \"agree\"       \"binomial\"    \"ca\"          \"glm\"         ##  [6] \"homogeneity\" \"lm\"          \"logistic\"    \"logit\"       \"loglinear\"   ## [11] \"mobility\"    \"multinomial\" \"oddsratio\"   \"one-way\"     \"ordinal\"     ## [16] \"poisson\"     \"reorder\"     \"square\"      \"zeros\""},{"path":"https://friendly.github.io/vcdExtra/articles/datasets.html","id":"make-this-into-a-nice-table","dir":"Articles","previous_headings":"","what":"Make this into a nice table","title":"Datasets for categorical data analysis","text":"Another sheet spreadsheet gives descriptive topic corresponding tag. Now, join tag_dset created .","code":"tags <- read_excel(here::here(\"inst\", \"extdata\", \"vcdExtra-datasets.xlsx\"),                     sheet=\"tags\") head(tags) ## # A tibble: 6 × 2 ##   tag         topic                      ##   <chr>       <chr>                      ## 1 2x2         2 by 2 tables              ## 2 agree       observer agreement         ## 3 binomial    binomial distributions     ## 4 ca          correspondence analysis    ## 5 glm         generalized linear models  ## 6 homogeneity homogeneity of association tag_dset <- tag_dset |>   dplyr::left_join(tags, by = \"tag\") |>   dplyr::relocate(topic, .after = tag)  tag_dset |>   dplyr::select(-tag) |>   head() ## # A tibble: 6 × 2 ##   topic                      datasets                                            ##   <chr>                      <chr>                                               ## 1 2 by 2 tables              Abortion; Bartlett; Heart                           ## 2 observer agreement         Mammograms                                          ## 3 binomial distributions     Geissler                                            ## 4 correspondence analysis    AirCrash; Burt; Draft1970table; Gilby; HospVisits;… ## 5 generalized linear models  Accident; Cormorants; DaytonSurvey; Donner; Draft1… ## 6 homogeneity of association Bartlett"},{"path":"https://friendly.github.io/vcdExtra/articles/datasets.html","id":"add-links-to-help","dir":"Articles","previous_headings":"Make this into a nice table","what":"Add links to help()","title":"Datasets for categorical data analysis","text":"’re almost . nice dataset names linked documentation. function designed work pkgdown site. different ways can done, seems work link ../reference/{dataset}.html Unfortunately, won’t work actual vignette.","code":"add_links <- function(dsets,                        style = c(\"reference\", \"help\", \"rdrr.io\"),                       sep = \"; \") {    style <- match.arg(style)   names <- stringr::str_split_1(dsets, sep)    names <- dplyr::case_when(     style == \"help\"      ~ glue::glue(\"[{names}](help({names}))\"),     style == \"reference\" ~ glue::glue(\"[{names}](../reference/{names}.html)\"),     style == \"rdrr.io\"   ~ glue::glue(\"[{names}](https://rdrr.io/cran/vcdExtra/man/{names}.html)\")   )     glue::glue_collapse(names, sep = sep) }"},{"path":"https://friendly.github.io/vcdExtra/articles/datasets.html","id":"table","dir":"Articles","previous_headings":"","what":"Make the table","title":"Datasets for categorical data analysis","text":"Use purrr::map() apply add_links() datasets tag. (mutate(datasets = add_links(datasets)) doesn’t work.) Voila!","code":"tag_dset |>   dplyr::select(-tag) |>   dplyr::mutate(datasets = purrr::map(datasets, add_links)) |>   knitr::kable()"},{"path":"https://friendly.github.io/vcdExtra/articles/tidyCats.html","id":"constructing-categorical-data-sets","dir":"Articles","previous_headings":"","what":"Constructing categorical data sets","title":"tidyCat: Tidy Methods For Categorical Data Analysis","text":"Current non-tidy data forms operations, following (Friendly & Meyer, 2016) described vignette Creating manipulating frequency tables seems clear flexible general form, one closely matches tidy data frame case form, allows numeric variables well. Thus: Among , tidy categorical data best represented tibble case form. tibble convenient ’ printing.","code":""},{"path":"https://friendly.github.io/vcdExtra/articles/tidyCats.html","id":"manipulating-categorical-data-sets","dir":"Articles","previous_headings":"Constructing categorical data sets","what":"Manipulating categorical data sets","title":"tidyCat: Tidy Methods For Categorical Data Analysis","text":"methods xtabs(), table() expand.dft() described vignette allow conversion one form another. Tidy equivalents might : as_table(), as_matrix(), as_array() convert form table/array form Similarly, perhaps as_caseform(), as_freqform() convert . already .data.frame(table) convert frequency form, expand.dft() converts case form vcd::structable() (stats::ftable()) produce ‘flat’ representation high-dimensional contingency table constructed recursive splits (similar construction mosaic displays). One can constructed table data frame formula method, suite methods indexing selecting parts \\(n\\)-way table. methods plyr package (now retired) provided coherent set tools split-apply-combine strategy works nicely multidimensional arrays. Perhaps useful ideas frequency tables resurrected . also role purrr methods thinking : \\(n\\)-way tables nested lists/arrays? ideas mapping ?","code":"data(\"HairEyeColor\") hec.df <- as.data.frame(HairEyeColor) head(hec.df) ##    Hair   Eye  Sex Freq ## 1 Black Brown Male   32 ## 2 Brown Brown Male   53 ## 3   Red Brown Male   10 ## 4 Blond Brown Male    3 ## 5 Black  Blue Male   11 ## 6 Brown  Blue Male   50 # expand to case form expand.dft(hec.df) |> head() ##    Hair   Eye  Sex ## 1 Black Brown Male ## 2 Black Brown Male ## 3 Black Brown Male ## 4 Black Brown Male ## 5 Black Brown Male ## 6 Black Brown Male structable(Titanic) ##             Sex      Male     Female     ##             Survived   No Yes     No Yes ## Class Age                                ## 1st   Child             0   5      0   1 ##       Adult           118  57      4 140 ## 2nd   Child             0  11      0  13 ##       Adult           154  14     13  80 ## 3rd   Child            35  13     17  14 ##       Adult           387  75     89  76 ## Crew  Child             0   0      0   0 ##       Adult           670 192      3  20 structable(Sex + Class ~ Survived + Age, data = Titanic) ##                Sex   Male              Female              ##                Class  1st 2nd 3rd Crew    1st 2nd 3rd Crew ## Survived Age                                               ## No       Child          0   0  35    0      0   0  17    0 ##          Adult        118 154 387  670      4  13  89    3 ## Yes      Child          5  11  13    0      1  13  14    0 ##          Adult         57  14  75  192    140  80  76   20"},{"path":"https://friendly.github.io/vcdExtra/articles/tidyCats.html","id":"manipulating-factor-levels","dir":"Articles","previous_headings":"","what":"Manipulating factor levels","title":"tidyCat: Tidy Methods For Categorical Data Analysis","text":"Also needed: methods recoding collapsing levels factor: forcats::fct_recode(), forcats::fct_collapse(), forcats::fct_lump_min() useful . methods reordering levels factor, either manually analysis purpose. example, Data Glass (1954) gave 5 x 5 table occupations 3500 British fathers sons, occupational categories listed alphabetic order. can reordered manually indexing, arrange categories status, giving order Professional Unskilled: general method permute row column categories order implied correspondence analysis dimensions. implemented seriation package using CA method seriation::seriate() applying permute() result. tidy ways things?","code":"data(Glass, package=\"vcdExtra\") str(Glass) ## 'data.frame':    25 obs. of  3 variables: ##  $ father: Factor w/ 5 levels \"Managerial\",\"Professional\",..: 2 2 2 2 2 1 1 1 1 1 ... ##  $ son   : Factor w/ 5 levels \"Managerial\",\"Professional\",..: 2 1 4 3 5 2 1 4 3 5 ... ##  $ Freq  : int  50 45 8 18 8 28 174 84 154 55 ... (glass.tab <- xtabs(Freq ~ father + son, data=Glass)) ##               son ## father         Managerial Professional Skilled Supervisory Unskilled ##   Managerial          174           28     154          84        55 ##   Professional         45           50      18           8         8 ##   Skilled             150           14     714         185       447 ##   Supervisory          78           11     223         110        96 ##   Unskilled            42            3     320          72       411 # reorder by status ord <- c(2, 1, 4, 3, 5)  glass.tab[ord, ord] ##               son ## father         Professional Managerial Supervisory Skilled Unskilled ##   Professional           50         45           8      18         8 ##   Managerial             28        174          84     154        55 ##   Supervisory            11         78         110     223        96 ##   Skilled                14        150         185     714       447 ##   Unskilled               3         42          72     320       411 library(seriation) order <- seriate(glass.tab, method = \"CA\") # the permuted row and column labels rownames(glass.tab)[order[[1]]] ## [1] \"Professional\" \"Managerial\"   \"Supervisory\"  \"Skilled\"      \"Unskilled\"  # reorder rows and columns permute(glass.tab, order) ##               son ## father         Professional Managerial Supervisory Skilled Unskilled ##   Professional           50         45           8      18         8 ##   Managerial             28        174          84     154        55 ##   Supervisory            11         78         110     223        96 ##   Skilled                14        150         185     714       447 ##   Unskilled               3         42          72     320       411"},{"path":"https://friendly.github.io/vcdExtra/articles/tidyCats.html","id":"models","dir":"Articles","previous_headings":"","what":"Models","title":"tidyCat: Tidy Methods For Categorical Data Analysis","text":"standard analysis frequency data form loglinear models fit MASS::loglm() flexible versions fit glm() gnm::gnm(). essentially linear models log frequency. vcdExtra, several methods list models, class \"glmlist\" \"loglmlist\", accommodated tidy methods. needed broom methods loglm models. information required accessible standard functions, tidy form. glance.loglm() – model level statistics. given output print() method, available print() method. complication LR Pearson \\(\\chi^2\\) reported, need made appear separate columns. also related LRstats() functions vcdExtra, report AIC BIC. tidy.loglm() — coefficient level statistics. available coef.loglm(). need assembled long format. Standard errors & p-values might problem. augment.loglm() — give case level statistics: fitted values, residuals, … hatvalues? implemented, shouldn’t hard.","code":"hec.indep <- loglm(~Hair+Eye+Sex, data=HairEyeColor) hec.indep ## Call: ## loglm(formula = ~Hair + Eye + Sex, data = HairEyeColor) ##  ## Statistics: ##                       X^2 df P(> X^2) ## Likelihood Ratio 166.3001 24        0 ## Pearson          164.9247 24        0 # extract test statistics summary(hec.indep)$tests ##                       X^2 df P(> X^2) ## Likelihood Ratio 166.3001 24        0 ## Pearson          164.9247 24        0 LRstats(hec.indep) ## Likelihood summary table: ##              AIC   BIC LR Chisq Df Pr(>Chisq)     ## hec.indep 321.18 332.9    166.3 24  < 2.2e-16 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 coef(hec.indep) ## $`(Intercept)` ## [1] 2.646879 ##  ## $Hair ##       Black       Brown         Red       Blond  ## -0.17911627  0.79474431 -0.59856762 -0.01706041  ##  ## $Eye ##      Brown       Blue      Hazel      Green  ##  0.5296905  0.5067010 -0.3313375 -0.7050540  ##  ## $Sex ##       Male     Female  ## -0.0574957  0.0574957 fitted(hec.indep) ## Re-fitting to get fitted values ## , , Sex = Male ##  ##        Eye ## Hair       Brown     Blue     Hazel     Green ##   Black 18.91504 18.48515  7.995903  5.502557 ##   Brown 50.08982 48.95142 21.174335 14.571585 ##   Red   12.43489 12.15228  5.256566  3.617421 ##   Blond 22.24268 21.73717  9.402589  6.470599 ##  ## , , Sex = Female ##  ##        Eye ## Hair       Brown     Blue     Hazel     Green ##   Black 21.22010 20.73782  8.970314  6.173119 ##   Brown 56.19396 54.91682 23.754719 16.347334 ##   Red   13.95025 13.63320  5.897151  4.058254 ##   Blond 24.95326 24.38614 10.548424  7.259131 residuals(hec.indep) ## Re-fitting to get frequencies and fitted values ## , , Sex = Male ##  ##        Eye ## Hair         Brown       Blue      Hazel      Green ##   Black  2.7349421 -1.8843321  0.6818522 -1.1685504 ##   Brown  0.4073036  0.1493413  0.8080654  0.1116873 ##   Red   -0.7150915 -0.6371217  0.7233138  1.5738248 ##   Blond -5.1444108  1.6747424 -1.5778804  0.5796238 ##  ## , , Sex = Female ##  ##        Eye ## Hair         Brown       Blue      Hazel      Green ##   Black  2.9150045 -2.9069608 -1.4476878 -1.9590840 ##   Brown  1.2726041 -3.0381608  1.0398490 -0.5953638 ##   Red    0.5361173 -1.9834384  0.4409912  1.3223880 ##   Blond -5.2211917  6.6539759 -1.9056398  0.2704898 hatvalues(hec.indep) ## Error in `UseMethod()`: ## ! no applicable method for 'hatvalues' applied to an object of class \"loglm\""},{"path":"https://friendly.github.io/vcdExtra/articles/tidyCats.html","id":"graphical-methods","dir":"Articles","previous_headings":"","what":"Graphical methods","title":"tidyCat: Tidy Methods For Categorical Data Analysis","text":"common graphical methods implemented vcd: mosaic() association plots (assoc()), …, rely vcd::strucplot() described (Meyer, Zeileis, & Hornik, 2006). tidy analog might work ggplot2? ggmosaic package implements basic marimeko-style mosaic plots. general, residual-based shading show patterns association. However, based productplots package Hadley, seems provide basic structure constructing displays nested rectangles.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Friendly. Author, maintainer. David Meyer. Contributor. Achim Zeileis. Contributor. Duncan Murdoch. Contributor. Heather Turner. Contributor. David Firth. Contributor. Daniel Sabanes Bove. Contributor. Matt Kumar. Contributor. Shuguang Sun. Contributor.","code":""},{"path":"https://friendly.github.io/vcdExtra/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Friendly M (2026). vcdExtra: 'vcd' Extensions Additions. R package version 0.9.1, https://friendly.github.io/vcdExtra/.","code":"@Manual{,   title = {vcdExtra: 'vcd' Extensions and Additions},   author = {Michael Friendly},   year = {2026},   note = {R package version 0.9.1},   url = {https://friendly.github.io/vcdExtra/}, }"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"extensions-and-additions-to-vcd-visualizing-categorical-data","dir":"","previous_headings":"","what":"Extensions and additions to vcd: Visualizing Categorical Data","title":"vcd Extensions and Additions","text":"Version 0.9.1; documentation built pkgdown 2026-01-24 package provides additional data sets, documentation, many functions designed extend vcd package Visualizing Categorical Data gnm package Generalized Nonlinear Models. particular, vcdExtra extends mosaic, assoc sieve plots vcd handle glm() gnm() models adds 3D version mosaic3d(). also adds extensions modeling functions models fit using glm() MASS::loglm(), using contruct glmlist() construct list related models can summarized (via LRstats()) graphed (via mosaic.glmlist()) vcdExtra support package book Discrete Data Analysis R (DDAR) Michael Friendly David Meyer. also web site DDAR figures code samples book. also used graduate course, Psy 6136: Categorical Data Analysis.","code":""},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"vcd Extensions and Additions","text":"Get released version (0.9.0) CRAN: current development version (0.9.1) can installed R-universe directly GitHub repo via:","code":"install.packages(\"vcdExtra\") if (!require(remotes)) install.packages(\"remotes\")    install.packages(\"vcdExtra\", repos = c('https://friendly.r-universe.dev')  # or  remotes::install_github(\"friendly/vcdExtra\", build_vignettes = TRUE)"},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"overview","dir":"","previous_headings":"Installation","what":"Overview","title":"vcd Extensions and Additions","text":"original purpose package serve sandbox introducing extensions mosaic plots related graphical methods apply loglinear models fitted using MASS::loglm(), generalized linear models using stats::glm() related, generalized nonlinear models fitted gnm() gnm package. related purpose fill holes analysis categorical data R, provided base R, vcd, commonly used packages.","code":""},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"see-also","dir":"","previous_headings":"Installation > Overview","what":"See also:","title":"vcd Extensions and Additions","text":"            book, Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data graduate course, Psy 6136: Categorical Data Analysis companion package, nestedLogit, fitting nested dichotomy logistic regression models polytomous response.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"mosaic-plot-extensions","dir":"","previous_headings":"Installation > Overview > vcdExtra Highlights","what":"mosaic plot extensions","title":"vcd Extensions and Additions","text":"method mosaic.glm() extends mosaic.loglm() method vcd package wider class models, e.g., models ordinal factors, can’t handled MASS::loglm(). method also works generalized nonlinear models fit gnm package, including models square tables models multiplicative associations (RC models). mosaic3d() introduces 3D generalization mosaic displays using rgl package.","code":""},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"model-extensions","dir":"","previous_headings":"Installation > Overview > vcdExtra Highlights","what":"model extensions","title":"vcd Extensions and Additions","text":"new class, glmlist, introduced working collections glm objects, e.g., Kway() fitting K-way models basic marginal model, LRstats() brief statistical summaries goodness--fit collection models. Similarly, loglinear models fit using MASS::loglm(), function seq_loglm() fits series sequential models 1-, 2-, … n-way marginal tables, corresponding variety types models joint, conditional, mutual, … independence. returns object class loglmlist, class loglm object. function seq_mosaic() generates mosaic plots plots vcd::strucplot() framework. square tables ordered factors, Crossings() supplements specification terms model formulas using gnm::Symm(), gnm::Diag(), gnm::Topo(), etc. gnm package.","code":""},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"other-additions","dir":"","previous_headings":"Installation > Overview","what":"Other additions","title":"vcd Extensions and Additions","text":"many new data sets; use datasets(\"vcdExtra\") see list titles descriptions. vignette, vignette(\"datasets\", package=\"vcdExtra\") provides classification according methods analysis. collection tutorial vignettes. installed package, can viewed using browseVignettes(package = \"vcdExtra\"); also set simple demonstration files illustrating analysis datasets detail provided individual help files. Use demo(package = \"vcdExtra\") see list `demo(“occStatus”) run analysis example. useful utility functions manipulating categorical data sets working models categorical data: joint(), conditional(), mutual(), saturated(). re-implementation vcd::woolf_test() extends analysis homogeneity odds ratios 2 x 2 x R x C tables provide tests differences among R strata rows C strata columns.","code":"vcdExtra::datasets(\"vcdExtra\")[,1] ##  [1] \"Abortion\"       \"Accident\"       \"AirCrash\"       \"Alligator\"      ##  [5] \"Asbestos\"       \"Bartlett\"       \"Burt\"           \"Caesar\"         ##  [9] \"Cancer\"         \"Cormorants\"     \"CrabSatellites\" \"CyclingDeaths\"  ## [13] \"DaytonSurvey\"   \"Depends\"        \"Detergent\"      \"Donner\"         ## [17] \"Draft1970\"      \"Draft1970table\" \"Dyke\"           \"Fungicide\"      ## [21] \"GSS\"            \"Geissler\"       \"Gilby\"          \"Glass\"          ## [25] \"HairEyePlace\"   \"Hauser79\"       \"Heart\"          \"Heckman\"        ## [29] \"HospVisits\"     \"HouseTasks\"     \"Hoyt\"           \"ICU\"            ## [33] \"JobSat\"         \"Mammograms\"     \"Mental\"         \"Mice\"           ## [37] \"Mobility\"       \"PhdPubs\"        \"ShakeWords\"     \"TV\"             ## [41] \"Titanicp\"       \"Toxaemia\"       \"Vietnam\"        \"Vote1980\"       ## [45] \"WorkerSat\"      \"Yamaguchi87\" vigns <- as.data.frame(tools::getVignetteInfo(\"vcdExtra\")[,c(\"File\", \"Title\")]) vigns$Title <- paste0(\"[\", vigns$Title, \"](https://friendly.github.io/vcdExtra/articles/\",                       tools::file_path_sans_ext(vigns$File), \".html)\") vigns |> knitr::kable()"},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"vcd Extensions and Additions","text":"README examples provide simple illustrations using package functions context loglinear models frequency tables fit using glm(), including models structured associations taking ordinality account.","code":""},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"mental-dataset","dir":"","previous_headings":"Examples","what":"Mental dataset","title":"vcd Extensions and Additions","text":"dataset vcdExtra::Mental data frame frequency table representing cross-classification mental health status (mental) 1660 young New York residents parents’ socioeconomic status (ses). ordered factors. questions : mental health associated parents ses? , pattern/nature association? can take ordinal nature factors account?","code":"data(Mental) str(Mental) ## 'data.frame':    24 obs. of  3 variables: ##  $ ses   : Ord.factor w/ 6 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 1 1 1 1 2 2 2 2 3 3 ... ##  $ mental: Ord.factor w/ 4 levels \"Well\"<\"Mild\"<..: 1 2 3 4 1 2 3 4 1 2 ... ##  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ...  # show as frequency table (Mental.tab <- xtabs(Freq ~ ses+mental, data=Mental)) ##    mental ## ses Well Mild Moderate Impaired ##   1   64   94       58       46 ##   2   57   94       54       40 ##   3   57  105       65       60 ##   4   72  141       77       94 ##   5   36   97       54       78 ##   6   21   71       54       71"},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"independence-model","dir":"","previous_headings":"Examples > Mental dataset","what":"Independence model","title":"vcd Extensions and Additions","text":"Fit independence model, Freq ~ mental + ses, using glm(..., family = poisson) model equivalent chisq.test(Mental) general association; take ordinality account. LRstats() provides compact summary fit statistics one models. mosaic.glm() mosaic method glm objects. default mosaic display data:  usually better use standardized residuals (residuals_type=\"rstandard\") mosaic displays, rather default Pearson residuals. also add longer labels table factors (set_varnames) display values residuals (labeling=labeling_residuals) cells. strucplot formula argument, ~ ses + mental gives order factors mosaic display, statistical model independence. , unit square first split ses, mental within level ses.  opposite-corner pattern residuals clearly shows association Parent SES mental health depends ordered levels factors: higher Parent SES associated better mental health status. principal virtue mosaic plots show pattern association remains model fit, thus help suggest better model.","code":"indep <- glm(Freq ~ mental + ses,              family = poisson, data = Mental) LRstats(indep) ## Likelihood summary table: ##          AIC    BIC LR Chisq Df Pr(>Chisq)     ## indep 209.59 220.19   47.418 15  3.155e-05 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(indep) # labels for table factors long.labels <- list(set_varnames = c(mental=\"Mental Health Status\",                                       ses=\"Parent SES\"))  mosaic(indep, formula = ~ ses + mental,        residuals_type=\"rstandard\",        labeling_args = long.labels,         labeling=labeling_residuals)"},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"ordinal-models","dir":"","previous_headings":"Examples > Mental dataset","what":"Ordinal models","title":"vcd Extensions and Additions","text":"Ordinal models use numeric scores row /column variables. models typically use equally spaced integer scores. test association analogous test correlation frequency-weighted scores, carried using CMHtest(). data, ses mental declared ordered factors, using .numeric(Mental$ses) sufficient create new Cscore variable. Similarly numeric version mental, giving Rscore. Using , term Rscore:Cscore represents association constrained linear x linear; , slopes profiles mental health status assumed vary linearly Parent SES. (model asserts one parameter (local odds ratio) sufficient account association, also called model “uniform association”.)  Note test linear x linear association consumes 1 degree freedom, compared (r-1)*(c-1) = 15 degrees freedom general association. models possible independence model, Freq ~ mental + ses, saturated model Freq ~ mental + ses + mental:ses. update.glm() method make easy specify, addition terms independence model. Compare models: glm objects, print summary methods give much information one wants see brief summary model goodness fit, easy way display compact comparison model goodness fit collection models fit data. LRstats() provides brief summary one models fit dataset. likelihood ratio \\(\\chi^2\\) values (LR Chisq)test lack fit. tests, none ordinal models show significant lack fit. AIC BIC statistics, linlin model best, combining parsimony goodness fit. anova.glm() function gives tests nested models.","code":"CMHtest(Mental.tab) ## Cochran-Mantel-Haenszel Statistics for ses by mental  ##  ##                  AltHypothesis  Chisq Df       Prob ## cor        Nonzero correlation 37.156  1 1.0907e-09 ## rmeans  Row mean scores differ 40.297  5 1.3012e-07 ## cmeans  Col mean scores differ 40.666  3 7.6971e-09 ## general    General association 45.958 15 5.4003e-05 Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental) # fit linear x linear (uniform) association.  Use integer scores for rows/cols  Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,               family = poisson, data = Mental) mosaic(linlin, ~ ses + mental,        residuals_type=\"rstandard\",         labeling_args = long.labels,         labeling=labeling_residuals,         suppress=1,         gp=shading_Friendly,        main=\"Lin x Lin model\") anova(linlin, test=\"Chisq\") ## Analysis of Deviance Table ##  ## Model: poisson, link: log ##  ## Response: Freq ##  ## Terms added sequentially (first to last) ##  ##  ##               Df Deviance Resid. Df Resid. Dev  Pr(>Chi)     ## NULL                             23    217.400               ## mental         3  113.525        20    103.875 < 2.2e-16 *** ## ses            5   56.457        15     47.418 6.543e-11 *** ## Rscore:Cscore  1   37.523        14      9.895 9.035e-10 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 # use update.glm method to fit other models  linlin <- update(indep, . ~ . + Rscore:Cscore) roweff <- update(indep, . ~ . + mental:Cscore) coleff <- update(indep, . ~ . + Rscore:ses) rowcol <- update(indep, . ~ . + Rscore:ses + mental:Cscore) LRstats(indep, linlin, roweff, coleff, rowcol) ## Likelihood summary table: ##           AIC    BIC LR Chisq Df Pr(>Chisq)     ## indep  209.59 220.19   47.418 15  3.155e-05 *** ## linlin 174.07 185.85    9.895 14     0.7698     ## roweff 174.45 188.59    6.281 12     0.9013     ## coleff 179.00 195.50    6.829 10     0.7415     ## rowcol 179.22 198.07    3.045  8     0.9315     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(indep, linlin, roweff, test = \"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Rscore:Cscore ## Model 3: Freq ~ mental + ses + mental:Cscore ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        15     47.418                           ## 2        14      9.895  1   37.523 9.035e-10 *** ## 3        12      6.281  2    3.614    0.1641     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://friendly.github.io/vcdExtra/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"vcd Extensions and Additions","text":"Friendly, M. & Meyer, D. (2016). Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data. Boca Raton, FL: Chapman & Hall/CRC.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Abortion.html","id":null,"dir":"Reference","previous_headings":"","what":"Abortion Opinion Data — Abortion","title":"Abortion Opinion Data — Abortion","text":"Opinions abortion classified gender SES","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Abortion.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Abortion Opinion Data — Abortion","text":"3-dimensional array resulting cross-tabulating 3 variables 1100 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Abortion.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Abortion Opinion Data — Abortion","text":"Christensen, R. (1990).  Log-Linear Models, New York, NY: Springer-Verlag, p. 92, Example 3.5.2. Christensen, R. (1997).  Log-Linear Models Logistic Regression, New York, NY: Springer, p. 100, Example 3.5.2.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Abortion.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Abortion Opinion Data — Abortion","text":"Support_Abortion natural response variable. combinations Sex Status represent four independent samples, fixed Sex-Status marginal totals.  500 females 600 males. Within female group, 250 low status 250 high status sampled. Similarly males, 300 low hgh status sub-groups. example product-multinomial sampling scheme. Sex:Status association must included loglinear model goal determine attitude toward abortion depends others. Alternatively, logit model abortion support may provide simpler analysis.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Abortion.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Abortion Opinion Data — Abortion","text":"","code":"data(Abortion)   ftable(Abortion) #>               Support_Abortion Yes  No #> Sex    Status                          #> Female Lo                      171  79 #>        Hi                      138 112 #> Male   Lo                      152 148 #>        Hi                      167 133 mosaic(Abortion, shade=TRUE)   # stratified by Sex fourfold(aperm(Abortion, 3:1))  # stratified by Status fourfold(aperm(Abortion, c(3,1,2)))"},{"path":"https://friendly.github.io/vcdExtra/reference/Accident.html","id":null,"dir":"Reference","previous_headings":"","what":"Traffic Accident Victims in France in 1958 — Accident","title":"Traffic Accident Victims in France in 1958 — Accident","text":"Bertin (1983) used data illustrate cross-classification data numerous variables, various types assigned various visual attributes.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Accident.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Traffic Accident Victims in France in 1958 — Accident","text":"data frame frequency form (comprising 5 x 2 x 4 x 2 table) 80 observations following 5 variables. age ordered factor levels 0-9 < 10-19 <20-29 < 30-49 < 50+ result factor levels Died Injured mode mode transportation, factor levels 4-Wheeled Bicycle Motorcycle Pedestrian gender factor levels Female Male Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Accident.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Traffic Accident Victims in France in 1958 — Accident","text":"Bertin (1983), p. 30; original data Ministere des Travaux Publics","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Accident.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Traffic Accident Victims in France in 1958 — Accident","text":"modeling visualization purposes, data can treated 4-way table using loglinear models mosaic displays, frequency-weighted data frame using binomial response result (\"Died\" vs. \"Injured\") plots predicted probabilities. age ordered factor, arguably, mode treated ordered, levels Pedestrian < Bicycle < Motorcycle < 4-Wheeled Bertin .  affects parameterization models, directly data frame.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Accident.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Traffic Accident Victims in France in 1958 — Accident","text":"Bertin, J. (1983), Semiology Graphics, University Wisconsin Press.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Accident.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Traffic Accident Victims in France in 1958 — Accident","text":"","code":"# examples data(Accident) head(Accident) #>   age result       mode gender Freq #> 1 50+   Died Pedestrian   Male  704 #> 2 50+   Died Pedestrian Female  378 #> 3 50+   Died    Bicycle   Male  396 #> 4 50+   Died    Bicycle Female   56 #> 5 50+   Died Motorcycle   Male  742 #> 6 50+   Died Motorcycle Female   78  # for graphs, reorder mode Accident$mode <- ordered(Accident$mode,    levels=levels(Accident$mode)[c(4,2,3,1)])  # Bertin's table accident_tab <- xtabs(Freq ~ gender + mode + age + result, data=Accident) structable(mode + gender ~ age + result, data=accident_tab) #>               mode   Pedestrian       Bicycle       Motorcycle       4-Wheeled       #>               gender     Female  Male  Female  Male     Female  Male    Female  Male #> age   result                                                                         #> 0-9   Died                   89   150       5    26          6     6        65    70 #>       Injured              1967  3341     126   378        131   181      1362  1593 #> 10-19 Died                   28    70      31    76         54   362        61   150 #>       Injured              1495  1827    7218  3407       3587 12311      2593  3543 #> 20-29 Died                   24    78      10    55         82   660       107   353 #>       Injured               864  1521     609  1565       4010 18558      4361  9084 #> 30-49 Died                   49   223      24   146         98   889       199   720 #>       Injured              1814  3178    1118  3024       3664 18909      7712 15086 #> 50+   Died                  378   704      56   396         78   742       253   513 #>       Injured              5449  5206    1030  3863       1387  8597      5552  7423  ## Loglinear models ## ----------------  # mutual independence acc.mod0 <- glm(Freq ~ age + result + mode + gender,                 data=Accident,                 family=poisson) LRstats(acc.mod0) #> Likelihood summary table: #>            AIC   BIC LR Chisq Df Pr(>Chisq)     #> acc.mod0 60983 61007    60320 70  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  mosaic(acc.mod0, ~mode + age + gender + result)   # result as a response acc.mod1 <- glm(Freq ~ age*mode*gender + result,                 data=Accident,                 family=poisson) LRstats(acc.mod1) #> Likelihood summary table: #>             AIC    BIC LR Chisq Df Pr(>Chisq)     #> acc.mod1 2942.4 3040.1   2217.7 39  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  mosaic(acc.mod1, ~mode + age + gender + result,     labeling_args = list(abbreviate = c(gender=1, result=4)))   # allow two-way association of result with each explanatory variable acc.mod2 <- glm(Freq ~ age*mode*gender + result*(age+mode+gender),                 data=Accident,                 family=poisson) LRstats(acc.mod2) #> Likelihood summary table: #>             AIC    BIC LR Chisq Df Pr(>Chisq)     #> acc.mod2 968.13 1084.8   227.47 31  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 mosaic(acc.mod2, ~mode + age + gender + result,     labeling_args = list(abbreviate = c(gender=1, result=4)))   acc.mods <- glmlist(acc.mod0, acc.mod1, acc.mod2) LRstats(acc.mods) #> Likelihood summary table: #>            AIC   BIC LR Chisq Df Pr(>Chisq)     #> acc.mod0 60983 61007    60320 70  < 2.2e-16 *** #> acc.mod1  2942  3040     2218 39  < 2.2e-16 *** #> acc.mod2   968  1085      227 31  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  ## Binomial (logistic regression) models for result ## ------------------------------------------------ library(car)  # for Anova() #> Loading required package: carData #>  #> Attaching package: ‘carData’ #> The following object is masked from ‘package:vcdExtra’: #>  #>     Burt acc.bin1 <- glm(result=='Died' ~ age + mode + gender,     weights=Freq, data=Accident, family=binomial) Anova(acc.bin1) #> Analysis of Deviance Table (Type II tests) #>  #> Response: result == \"Died\" #>        LR Chisq Df Pr(>Chisq)     #> age     1179.03  4  < 2.2e-16 *** #> mode     136.82  3  < 2.2e-16 *** #> gender   467.70  1  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  acc.bin2 <- glm(result=='Died' ~ (age + mode + gender)^2,     weights=Freq, data=Accident, family=binomial) Anova(acc.bin2) #> Analysis of Deviance Table (Type II tests) #>  #> Response: result == \"Died\" #>             LR Chisq Df Pr(>Chisq)     #> age          1100.82  4  < 2.2e-16 *** #> mode          136.07  3  < 2.2e-16 *** #> gender        418.88  1  < 2.2e-16 *** #> age:mode      122.24 12  < 2.2e-16 *** #> age:gender     46.86  4  1.631e-09 *** #> mode:gender    21.94  3  6.702e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  acc.bin3 <- glm(result=='Died' ~ (age + mode + gender)^3,     weights=Freq, data=Accident, family=binomial) Anova(acc.bin3) #> Analysis of Deviance Table (Type II tests) #>  #> Response: result == \"Died\" #>                 LR Chisq Df Pr(>Chisq)     #> age              1100.82  4  < 2.2e-16 *** #> mode              136.07  3  < 2.2e-16 *** #> gender            418.88  1  < 2.2e-16 *** #> age:mode          122.24 12  < 2.2e-16 *** #> age:gender         46.86  4  1.631e-09 *** #> mode:gender        21.94  3  6.702e-05 *** #> age:mode:gender    13.02 12     0.3675     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # compare models anova(acc.bin1, acc.bin2, acc.bin3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: result == \"Died\" ~ age + mode + gender #> Model 2: result == \"Died\" ~ (age + mode + gender)^2 #> Model 3: result == \"Died\" ~ (age + mode + gender)^3 #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi)     #> 1        71      64599                          #> 2        52      64384 19  214.445   <2e-16 *** #> 3        40      64371 12   13.022   0.3675     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # visualize probability of death with effect plots if (FALSE) { # \\dontrun{ library(effects) plot(allEffects(acc.bin1), ylab='Pr (Died)')  plot(allEffects(acc.bin2), ylab='Pr (Died)') } # }   #"},{"path":"https://friendly.github.io/vcdExtra/reference/AirCrash.html","id":null,"dir":"Reference","previous_headings":"","what":"Air Crash Data — AirCrash","title":"Air Crash Data — AirCrash","text":"Data fatal commercial airplane crashes 1993–2015. Excludes small planes (less 6 passengers) non-commercial (cargo, military, private) aircraft.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Air Crash Data — AirCrash","text":"data frame 439 observations following 5 variables. Phase phase flight, factor levels en route landing standing take-unknown Cause factor levels criminal human error mechanical unknown weather date date crash, Date Fatalities number fatalities, numeric vector Year year, numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Air Crash Data — AirCrash","text":"Originally David McCandless, https://informationisbeautiful.net/visualizations/plane-truth-every-single-commercial-plane-crash-visualized/, data https://docs.google.com/spreadsheets/d/1OvDq4_BtbR6nSnnHnjD5hVC3HQ-ulZPGbo0RDGbzM3Q/edit?usp=drive_web, downloaded April 14, 2015.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Air Crash Data — AirCrash","text":"Phase flight cleaned combining related variants, spelling, etc.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Air Crash Data — AirCrash","text":"Rick Wicklin, http://blogs.sas.com/content/iml/2015/03/30/visualizing-airline-crashes.html","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Air Crash Data — AirCrash","text":"","code":"data(AirCrash) aircrash.tab <- xtabs(~Phase + Cause, data=AirCrash) mosaic(aircrash.tab, shade=TRUE)   # fix label overlap mosaic(aircrash.tab, shade=TRUE,        labeling_args=list(rot_labels=c(30, 30, 30, 30)))   # reorder by Phase phase.ord <- rev(c(3,4,1,2,5)) mosaic(aircrash.tab[phase.ord,], shade=TRUE,        labeling_args=list(rot_labels=c(30, 30, 30, 30)),        offset_varnames=0.5)   # reorder by frequency phase.ord <- order(rowSums(aircrash.tab), decreasing=TRUE) cause.ord <- order(colSums(aircrash.tab), decreasing=TRUE) mosaic(aircrash.tab[phase.ord,cause.ord], shade=TRUE,        labeling_args=list(rot_labels=c(30, 30, 30, 30)))    library(ca) aircrash.ca <- ca(aircrash.tab) plot(aircrash.ca)"},{"path":"https://friendly.github.io/vcdExtra/reference/Alligator.html","id":null,"dir":"Reference","previous_headings":"","what":"Alligator Food Choice — Alligator","title":"Alligator Food Choice — Alligator","text":"Alligator data, Agresti (2002), comes study primary food choices alligators four Florida lakes. Researchers classified stomach contents 219 captured alligators five categories: Fish (common primary food choice), Invertebrate (snails, insects, crayfish, etc.), Reptile (turtles, alligators), Bird, (amphibians, plants, household pets, stones, debris).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Alligator.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Alligator Food Choice — Alligator","text":"frequency data frame 80 observations following 5 variables. lake factor levels George Hancock Oklawaha Trafford sex factor levels female male size alligator size, factor levels large (>2.3m) small (<=2.3m) food primary food choice, factor levels bird fish invert reptile count cell frequency, numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Alligator.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Alligator Food Choice — Alligator","text":"Agresti, . (2002). Categorical Data Analysis, New York: Wiley, 2nd Ed., Table 7.1","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Alligator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Alligator Food Choice — Alligator","text":"table contains fair number 0 counts. food response variable.  fish frequent choice, often taken baseline category multinomial response models.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Alligator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Alligator Food Choice — Alligator","text":"","code":"data(Alligator)  # change from frequency data.frame to table allitable <- xtabs(count ~ lake + sex + size + food, data=Alligator) # Agresti's Table 7.1 structable(food ~ lake + sex + size, allitable) #>                       food bird fish invert other reptile #> lake     sex    size                                      #> George   female large         0    8      1     1       0 #>                 small         0    3      9     1       1 #>          male   large         1    9      0     2       0 #>                 small         2   13     10     2       0 #> Hancock  female large         2    3      0     3       1 #>                 small         2   16      3     3       2 #>          male   large         1    4      0     2       0 #>                 small         0    7      1     5       0 #> Oklawaha female large         1    0      1     0       0 #>                 small         0    3      9     2       1 #>          male   large         0   13      7     0       6 #>                 small         0    2      2     1       0 #> Trafford female large         0    0      1     0       0 #>                 small         1    2      4     4       1 #>          male   large         3    8      6     5       6 #>                 small         0    3      7     1       1   plot(allitable, shade=TRUE)   # mutual independence model mosaic(~ food + lake + size, allitable, shade=TRUE)   # food jointly independent of lake and size mosaic(~ food + lake + size, allitable, shade=TRUE,        expected = ~lake:size + food)   if (require(nnet)) {   # multinomial logit model   mod1 <- multinom(food ~ lake + size + sex, data=Alligator, weights=count) } #> Loading required package: nnet #> # weights:  35 (24 variable) #> initial  value 352.466903  #> iter  10 value 270.397070 #> iter  20 value 268.958046 #> final  value 268.932740  #> converged"},{"path":"https://friendly.github.io/vcdExtra/reference/Asbestos.html","id":null,"dir":"Reference","previous_headings":"","what":"Effect of Exposure to Asbestos — Asbestos","title":"Effect of Exposure to Asbestos — Asbestos","text":"two-way contingency table formed cross-classification number years occupational exposure asbestos diagnosed severity asbestosis 1117 New York workers. Asbestosis chronic lung disease results lung tissue scared due contact fibers can lead severe breathing difficulties.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Asbestos.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Effect of Exposure to Asbestos — Asbestos","text":"format :","code":"num [1:5, 1:4] 310 212 21 25 7 36 158 35 102 35 ...  - attr(*, \"dimnames\")=List of 2   ..$ exposure: chr [1:5] \"0-9\" \"10-19\" \"20-29\" \"30-39\" ...   ..$ grade   : chr [1:4] \"None\" \"Grade 1\" \"Grade 2\" \"Grade 3\"#'"},{"path":"https://friendly.github.io/vcdExtra/reference/Asbestos.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Effect of Exposure to Asbestos — Asbestos","text":"Beh, E. J. & Lombardo, R. (2022). Features Polynomial Biplot Ordered Contingency Tables, Journal Computational Graphical Statistics, 31:2, 403-412, DOI: 10.1080/10618600.2021.1990773, Table 1.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Asbestos.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Effect of Exposure to Asbestos — Asbestos","text":"exposure grade regarded ordered factors. Beh Lombardo (2022) use data illustrate polynomial biplot ordered categories. data summarized studied Beh Smith (2011) comes original data collected published Selikoff (1981) examined link asbestos exposure asbestosis severity 1963.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Asbestos.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Effect of Exposure to Asbestos — Asbestos","text":"Beh, E. J., D. R. Smith (2011b), Real World Occupational Epidemiology, Part 2: Visual Interpretation Statistical Significance, Archives Environmental & Occupational Health, 66, 245-248. Selikoff, . J. (1981), Household Risks Inorganic Fibers, Bulletin New York Academy Medicine, 57, 947-961.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Asbestos.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Effect of Exposure to Asbestos — Asbestos","text":"","code":"data(Asbestos) # mosaic plot vcd::mosaic(Asbestos, shade=TRUE, legend=FALSE)   # do the correspondence analysis library(ca) Asbestos.ca <- ca(Asbestos)  plot(Asbestos.ca, lines=TRUE)"},{"path":"https://friendly.github.io/vcdExtra/reference/Bartlett.html","id":null,"dir":"Reference","previous_headings":"","what":"Bartlett Data on Plum Root Cuttings — Bartlett","title":"Bartlett Data on Plum Root Cuttings — Bartlett","text":"experiment investigate effect cutting length (two levels) planting time (two levels) survival plum root cuttings, 240 cuttings planted 2 x 2 combinations factors, survival later recorded.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Bartlett Data on Plum Root Cuttings — Bartlett","text":"3-dimensional array resulting cross-tabulating 3 variables 960 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Bartlett Data on Plum Root Cuttings — Bartlett","text":"Hand, D. Daly, F. Lunn, . D.McConway, K. J. Ostrowski, E. (1994). Handbook Small Data Sets. London: Chapman & Hall, p. 15, # 19.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bartlett Data on Plum Root Cuttings — Bartlett","text":"Bartlett (1935) used data illustrate method testing three-way interaction contingency table.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bartlett Data on Plum Root Cuttings — Bartlett","text":"Bartlett, M. S. (1935).  Contingency Table Interactions Journal Royal Statistical Society, Supplement, 1935, 2, 248-252.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bartlett Data on Plum Root Cuttings — Bartlett","text":"","code":"data(Bartlett)  # measures of association assocstats(Bartlett) #> $`Length:Long` #>                     X^2 df   P(> X^2) #> Likelihood Ratio 43.873  1 3.5048e-11 #> Pearson          43.200  1 4.9421e-11 #>  #> Phi-Coefficient   : 0.3  #> Contingency Coeff.: 0.287  #> Cramer's V        : 0.3  #>  #> $`Length:Short` #>                     X^2 df   P(> X^2) #> Likelihood Ratio 61.310  1 4.8850e-15 #> Pearson          58.744  1 1.7986e-14 #>  #> Phi-Coefficient   : 0.35  #> Contingency Coeff.: 0.33  #> Cramer's V        : 0.35  #>  oddsratio(Bartlett) #> log odds ratios for Alive and Time by Length  #>  #>     Long    Short  #> 1.238078 1.690827   # Test models  ## Independence MASS::loglm(formula = ~Alive + Time + Length, data = Bartlett) #> Call: #> MASS::loglm(formula = ~Alive + Time + Length, data = Bartlett) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 151.0193  4        0 #> Pearson          141.0527  4        0  ## No three-way association MASS::loglm(formula = ~(Alive + Time + Length)^2, data = Bartlett) #> Call: #> MASS::loglm(formula = ~(Alive + Time + Length)^2, data = Bartlett) #>  #> Statistics: #>                       X^2 df  P(> X^2) #> Likelihood Ratio 2.293841  1 0.1298882 #> Pearson          2.270373  1 0.1318681  # Use woolf_test() for a formal test of homogeneity of odds ratios vcd::woolf_test(Bartlett) #>  #> \tWoolf-test on Homogeneity of Odds Ratios (no 3-Way assoc.) #>  #> data:  Bartlett #> X-squared = 2.264, df = 1, p-value = 0.1324 #>    # Plots fourfold(Bartlett, mfrow=c(1,2))   mosaic(Bartlett, shade=TRUE)  pairs(Bartlett, gp=shading_Friendly)"},{"path":"https://friendly.github.io/vcdExtra/reference/Burt.html","id":null,"dir":"Reference","previous_headings":"","what":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"Cyril Burt (1950) gave data, sample 100 people Liverpool, illustrate application method factor analysis (later called multiple correspondence analysis) applied categorical data.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Burt.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"frequency data frame (representing 3 x 3 x 2 x 2 frequency table) 36 cells following 5 variables. Hair hair color, factor levels Fair Red Dark Eyes eye color, factor levels Light Mixed Dark Head head shape, factor levels Narrow Wide Stature height, factor levels Tall Short Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Burt.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"Burt, C. (1950). factorial analysis qualitative data, British Journal Statistical Psychology, 3(3), 166-185. Table IX.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Burt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"presented data initially form come called \"Burt table\", giving univariate bivariate frequencies n-way frequency table. Burt says: \", 217 individuals examined, two-thirds males. , partly simplify calculations partly later observations rather trustworthy, shall restrict analysis data obtained last hundred males series.\" Head Stature reflect binary coding people classified according whether average population.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Burt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"","code":"data(Burt) mosaic(Freq ~ Hair + Eyes + Head + Stature, data=Burt, shade=TRUE) #> Error in eval(predvars, data, env): object 'Hair' not found  #or burt.tab <- xtabs(Freq ~ Hair + Eyes + Head + Stature, data=Burt) #> Error in eval(predvars, data, env): object 'Freq' not found mosaic(burt.tab, shade=TRUE) #> Error: object 'burt.tab' not found"},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"Provides generalized Cochran-Mantel-Haenszel tests association two possibly ordered factors, optionally stratified factor(s).  strata, CMHtest calculates tests level stratifying variables also provides overall tests controlling strata.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"","code":"CMHtest(x, ...)  # S3 method for class 'formula' CMHtest(formula, data = NULL, subset = NULL, na.action = NULL, ...)  # Default S3 method CMHtest(   x,   strata = NULL,   rscores = 1:R,   cscores = 1:C,   types = c(\"cor\", \"rmeans\", \"cmeans\", \"general\"),   overall = FALSE,   details = overall,   ... )  # S3 method for class 'CMHtest' print(x, digits = max(getOption(\"digits\") - 2, 3), ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"x 2+ way contingency table array form, class \"table\" object optional category labels specified dimnames(x) attribute. ... arguments passed default method. formula formula specifying variables used create contingency table data.  one-sided formula data array form, two-sided formula response Freq data data frame cell frequency variable. convenience, conditioning formulas can specified indicating strata. data either data frame, object class \"table\" \"ftable\". subset optional vector specifying subset observations used. na.action function indicates happen data contain NAs. Ignored data contingency table. strata 3- higher-way table, names numbers factors treated strata.  default, first 2 factors treated main table variables, others considered stratifying factors. rscores Row scores.  Either set numbers (typically integers, 1:R) string \"midrank\" standardized midrank scores, NULL exclude tests depend row scores. cscores Column scores. row scores. types Types CMH tests compute: one c(\"cor\", \"cmeans\", \"rmeans\", \"general\"), \"\" . overall logical. Whether calculate overall tests, controlling stratifying factors. details logical.  Whether include computational details result digits Digits print.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"object class \"CMHtest\" , list following 4 components: table matrix containing test statistics, columns Chisq, Df Prob names names table row column variables rscore Row scores cscore Column scores details==TRUE, additional components included. strata, result list \"CMHtest\" objects. overall=TRUE another component, labeled appended list.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"ordinal factors, powerful tests test general association (independence) obtained assigning scores row column categories. standard \\(\\chi^2\\) tests association two-way table treat table factors nominal (unordered) categories. one factors two-way table quantitative ordinal, powerful tests association may obtained taking ordinality account using row column scores test linear trends differences row column means. CMH analysis two-way table produces generalized Cochran-Mantel-Haenszel statistics (Landis etal., 1978). include CMH correlation statistic (\"cor\"), treating factors ordered. given statum, equally spaced row column scores, CMH statistic reduces \\((n-1) r^2\\), \\(r\\) Pearson correlation X Y. \"midrank\" scores, CMH statistic analogous \\((n-1) r_S^2\\), using Spearman rank correlation. ANOVA (row mean scores column mean scores) statistics, treat columns rows respectively ordinal, sensitive mean shifts columns rows. transforms \\(F\\) statistics one-way ANOVAs equally spaced scores Kruskal-Wallis tests \"midrank\" scores. CMH general association statistic treat factors unordered, give test closely related Pearson \\(\\chi^2\\) test. one stratum, overall general CMH statistic gives stratum-adjusted Pearson \\(\\chi^2\\), equivalent calculated mantelhaen.test. 3+ way table, one table CMH tests produced combination factors identified strata. overall=TRUE, additional table calculated two primary variables, controlling (pooling ) strata variables. overall tests implicitly assume interactions primary variables strata low power presence interactions. Note strata combinations insufficient data (less 2 observations) automatically omitted analysis.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"Stokes, M. E. & Davis, C. S.  & Koch, G., (2000). Categorical Data Analysis using SAS System, 2nd Ed., Cary, NC: SAS Institute, pp 74-75, 92-101, 124-129.  Details computation given : http://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_freq_a0000000648.htm Cochran, W. G. (1954), Methods Strengthening Common \\(\\chi^2\\) Tests, Biometrics, 10, 417-451. Landis, R. J., Heyman, E. R., Koch, G. G. (1978).  Average Partial Association Three-way Contingency Tables: Review Discussion Alternative Tests, International Statistical Review, 46, 237-254. Mantel, N. (1963), Chi-square Tests One Degree Freedom: Extensions Mantel-Haenszel Procedure,\" Journal American Statistical Association, 58, 690-700.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"","code":"data(JobSat, package=\"vcdExtra\") CMHtest(JobSat) #> Cochran-Mantel-Haenszel Statistics for income by satisfaction  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 2.9830  1 0.084144 #> rmeans  Row mean scores differ 4.4774  3 0.214318 #> cmeans  Col mean scores differ 3.1036  3 0.375931 #> general    General association 5.9034  9 0.749549 #>  CMHtest(JobSat, rscores=\"midrank\", cscores=\"midrank\") #> Cochran-Mantel-Haenszel Statistics for income by satisfaction  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 2.9726  1 0.084685 #> rmeans  Row mean scores differ 4.1200  3 0.248799 #> cmeans  Col mean scores differ 3.3108  3 0.346144 #> general    General association 5.9034  9 0.749549 #>   # formula interface CMHtest(~ ., data=JobSat) #> Cochran-Mantel-Haenszel Statistics for income by satisfaction  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 2.9830  1 0.084144 #> rmeans  Row mean scores differ 4.4774  3 0.214318 #> cmeans  Col mean scores differ 3.1036  3 0.375931 #> general    General association 5.9034  9 0.749549 #>   # A 3-way table (both factors ordinal) data(MSPatients, package=\"vcd\") CMHtest(MSPatients) #> $`Patients:Winnipeg` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:Winnipeg  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 51.424  1 7.4426e-13 #> rmeans  Row mean scores differ 55.393  3 5.6601e-12 #> cmeans  Col mean scores differ 53.631  3 1.3450e-11 #> general    General association 64.318  9 1.9580e-10 #>  #>  #> $`Patients:New Orleans` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:New Orleans  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 28.863  1 7.7667e-08 #> rmeans  Row mean scores differ 30.594  3 1.0347e-06 #> cmeans  Col mean scores differ 29.054  3 2.1818e-06 #> general    General association 43.428  9 1.7990e-06 #>  #>    # also calculate overall tests, controlling for Patient CMHtest(MSPatients, overall = TRUE) #> $`Patients:Winnipeg` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:Winnipeg  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 51.424  1 7.4426e-13 #> rmeans  Row mean scores differ 55.393  3 5.6601e-12 #> cmeans  Col mean scores differ 53.631  3 1.3450e-11 #> general    General association 64.318  9 1.9580e-10 #>  #>  #> $`Patients:New Orleans` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:New Orleans  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 28.863  1 7.7667e-08 #> rmeans  Row mean scores differ 30.594  3 1.0347e-06 #> cmeans  Col mean scores differ 29.054  3 2.1818e-06 #> general    General association 43.428  9 1.7990e-06 #>  #>  #> $ALL #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tOverall tests, controlling for all strata  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 80.086  1 3.5848e-19 #> rmeans  Row mean scores differ 83.923  3 4.4189e-18 #> cmeans  Col mean scores differ 81.116  3 1.7685e-17 #> general    General association 101.21  9 8.9683e-18 #>  #>  # compare with mantelhaen.test mantelhaen.test(MSPatients) #>  #> \tCochran-Mantel-Haenszel test #>  #> data:  MSPatients #> Cochran-Mantel-Haenszel M^2 = 101.21, df = 9, p-value < 2.2e-16 #>   # formula interface CMHtest(~ ., data = MSPatients, overall = TRUE) #> $`Patients:Winnipeg` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:Winnipeg  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 51.424  1 7.4426e-13 #> rmeans  Row mean scores differ 55.393  3 5.6601e-12 #> cmeans  Col mean scores differ 53.631  3 1.3450e-11 #> general    General association 64.318  9 1.9580e-10 #>  #>  #> $`Patients:New Orleans` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:New Orleans  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 28.863  1 7.7667e-08 #> rmeans  Row mean scores differ 30.594  3 1.0347e-06 #> cmeans  Col mean scores differ 29.054  3 2.1818e-06 #> general    General association 43.428  9 1.7990e-06 #>  #>  #> $ALL #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tOverall tests, controlling for all strata  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 80.086  1 3.5848e-19 #> rmeans  Row mean scores differ 83.923  3 4.4189e-18 #> cmeans  Col mean scores differ 81.116  3 1.7685e-17 #> general    General association 101.21  9 8.9683e-18 #>  #>   # using a frequency data.frame CMHtest(xtabs(Freq~ses + mental, data = Mental)) #> Cochran-Mantel-Haenszel Statistics for ses by mental  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 37.156  1 1.0907e-09 #> rmeans  Row mean scores differ 40.297  5 1.3012e-07 #> cmeans  Col mean scores differ 40.666  3 7.6971e-09 #> general    General association 45.958 15 5.4003e-05 #>  # or, more simply CMHtest(Freq~ses + mental, data = Mental) #> Cochran-Mantel-Haenszel Statistics for ses by mental  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 37.156  1 1.0907e-09 #> rmeans  Row mean scores differ 40.297  5 1.3012e-07 #> cmeans  Col mean scores differ 40.666  3 7.6971e-09 #> general    General association 45.958 15 5.4003e-05 #>   # conditioning formulae CMHtest(Freq~right + left | gender, data = VisualAcuity) #> $`gender:male` #> Cochran-Mantel-Haenszel Statistics for right by left  #> \tin stratum gender:male  #>  #>                  AltHypothesis  Chisq Df Prob #> cor        Nonzero correlation 1554.6  1    0 #> rmeans  Row mean scores differ 1556.3  3    0 #> cmeans  Col mean scores differ 1556.6  3    0 #> general    General association 3303.3  9    0 #>  #>  #> $`gender:female` #> Cochran-Mantel-Haenszel Statistics for right by left  #> \tin stratum gender:female  #>  #>                  AltHypothesis  Chisq Df Prob #> cor        Nonzero correlation 3691.3  1    0 #> rmeans  Row mean scores differ 3709.4  3    0 #> cmeans  Col mean scores differ 3724.0  3    0 #> general    General association 8095.8  9    0 #>  #>   CMHtest(Freq ~ attitude + memory | education + age, data = Punishment) #> $`education:elementary|age:15-24` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:elementary|age:15-24  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 3.5652  1 0.059002 #> rmeans  Row mean scores differ 3.5652  1 0.059002 #> cmeans  Col mean scores differ 3.5652  1 0.059002 #> general    General association 3.5652  1 0.059002 #>  #>  #> $`education:secondary|age:15-24` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:secondary|age:15-24  #>  #>                  AltHypothesis    Chisq Df   Prob #> cor        Nonzero correlation 0.077731  1 0.7804 #> rmeans  Row mean scores differ 0.077731  1 0.7804 #> cmeans  Col mean scores differ 0.077731  1 0.7804 #> general    General association 0.077731  1 0.7804 #>  #>  #> $`education:high|age:15-24` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:high|age:15-24  #>  #>                  AltHypothesis    Chisq Df    Prob #> cor        Nonzero correlation 0.089524  1 0.76478 #> rmeans  Row mean scores differ 0.089524  1 0.76478 #> cmeans  Col mean scores differ 0.089524  1 0.76478 #> general    General association 0.089524  1 0.76478 #>  #>  #> $`education:elementary|age:25-39` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:elementary|age:25-39  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 8.5433  1 0.003468 #> rmeans  Row mean scores differ 8.5433  1 0.003468 #> cmeans  Col mean scores differ 8.5433  1 0.003468 #> general    General association 8.5433  1 0.003468 #>  #>  #> $`education:secondary|age:25-39` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:secondary|age:25-39  #>  #>                  AltHypothesis   Chisq Df    Prob #> cor        Nonzero correlation 0.92897  1 0.33513 #> rmeans  Row mean scores differ 0.92897  1 0.33513 #> cmeans  Col mean scores differ 0.92897  1 0.33513 #> general    General association 0.92897  1 0.33513 #>  #>  #> $`education:high|age:25-39` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:high|age:25-39  #>  #>                  AltHypothesis Chisq Df    Prob #> cor        Nonzero correlation 0.472  1 0.49207 #> rmeans  Row mean scores differ 0.472  1 0.49207 #> cmeans  Col mean scores differ 0.472  1 0.49207 #> general    General association 0.472  1 0.49207 #>  #>  #> $`education:elementary|age:40-` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:elementary|age:40-  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 11.606  1 0.00065737 #> rmeans  Row mean scores differ 11.606  1 0.00065737 #> cmeans  Col mean scores differ 11.606  1 0.00065737 #> general    General association 11.606  1 0.00065737 #>  #>  #> $`education:secondary|age:40-` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:secondary|age:40-  #>  #>                  AltHypothesis  Chisq Df    Prob #> cor        Nonzero correlation 6.0457  1 0.01394 #> rmeans  Row mean scores differ 6.0457  1 0.01394 #> cmeans  Col mean scores differ 6.0457  1 0.01394 #> general    General association 6.0457  1 0.01394 #>  #>  #> $`education:high|age:40-` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:high|age:40-  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 3.0436  1 0.081055 #> rmeans  Row mean scores differ 3.0436  1 0.081055 #> cmeans  Col mean scores differ 3.0436  1 0.081055 #> general    General association 3.0436  1 0.081055 #>  #>    # Stokes etal, Table 5.1, p 92: two unordered factors parties <- matrix(   c(221, 160, 360, 140,     200, 291, 160, 311,     208, 106, 316, 97),   nrow=3, ncol=4,   byrow=TRUE) dimnames(parties) <- list(party=c(\"Dem\", \"Indep\", \"Rep\"),              neighborhood=c(\"Bayside\", \"Highland\", \"Longview\", \"Sheffield\")) CMHtest(parties, rscores=NULL, cscores=NULL) #> Cochran-Mantel-Haenszel Statistics for party by neighborhood  #>  #>               AltHypothesis  Chisq Df       Prob #> general General association 273.81  6 3.3158e-56 #>   # compare with Pearson chisquare chisq.test(parties) #>  #> \tPearson's Chi-squared test #>  #> data:  parties #> X-squared = 273.92, df = 6, p-value < 2.2e-16 #>"},{"path":"https://friendly.github.io/vcdExtra/reference/Caesar.html","id":null,"dir":"Reference","previous_headings":"","what":"Risk Factors for Infection in Caesarian Births — Caesar","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"Data infection birth Caesarian section, classified Risk (two levels), whether Antibiotics used (two levels) whether Caesarian section Planned .  outcome Infection (three levels).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Caesar.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"4-dimensional array resulting cross-tabulating 4 variables 251 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Caesar.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"% Fahrmeir:94 Fahrmeir, L. & Tutz, G. (1994). Multivariate Statistical Modelling Based Generalized Linear Models New York: Springer Verlag, Table 1.1.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Caesar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"Infection regarded response variable .  quite 0 cells , particularly Risk absent Caesarian section unplanned. treated structural sampling zeros?","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Caesar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"","code":"data(Caesar) #display table;  note that there are quite a few 0 cells structable(Caesar) #>                       Risk    Yes     No    #>                       Planned Yes No Yes No #> Infection Antibiotics                       #> Type 1    Yes                   0  4   0  0 #>           No                   11 10   4  0 #> Type 2    Yes                   1  7   1  0 #>           No                   17 13   4  0 #> None      Yes                  17 87   1  0 #>           No                   30  3  32  9 require(MASS) #> Loading required package: MASS  # baseline model, Infection as response Caesar.mod0 <- loglm(~Infection + (Risk*Antibiotics*Planned),                      data=Caesar)  # NB: Pearson chisq cannot be computed due to the 0 cells Caesar.mod0 #> Call: #> loglm(formula = ~Infection + (Risk * Antibiotics * Planned),  #>     data = Caesar) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 85.10955 14 3.156586e-12 #> Pearson               NaN 14          NaN  mosaic(Caesar.mod0, main=\"Baseline model\")   # Illustrate handling structural zeros zeros <- 0+ (Caesar >0) zeros[1,,1,1] <- 1 structable(zeros) #>                       Risk    Yes     No    #>                       Planned Yes No Yes No #> Infection Antibiotics                       #> Type 1    Yes                   1  1   1  0 #>           No                    1  1   1  0 #> Type 2    Yes                   1  1   1  0 #>           No                    1  1   1  0 #> None      Yes                   1  1   1  0 #>           No                    1  1   1  1  # fit model excluding possible structural zeros Caesar.mod0s <- loglm(~Infection + (Risk*Antibiotics*Planned),                       data=Caesar,                       start=zeros) Caesar.mod0s #> Call: #> loglm(formula = ~Infection + (Risk * Antibiotics * Planned),  #>     data = Caesar, start = zeros) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 78.89068  9 2.683409e-13 #> Pearson          77.55728  9 4.931611e-13  anova(Caesar.mod0, Caesar.mod0s, test=\"Chisq\") #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Infection + (Risk * Antibiotics * Planned)  #> Model 2: #>  ~Infection + (Risk * Antibiotics * Planned)  #>  #>           Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   85.10955 14                                     #> Model 2   78.89068  9   6.218866         5         0.2855 #> Saturated  0.00000  0  78.890682         9         0.0000  mosaic (Caesar.mod0s) #> Error in eval(expr, p): object 'zeros' not found  # what terms to add? add1(Caesar.mod0, ~.^2, test=\"Chisq\") #> Single term additions #>  #> Model: #> ~Infection + (Risk * Antibiotics * Planned) #>                       Df     AIC    LRT  Pr(>Chi)     #> <none>                   105.110                      #> Infection:Risk         2 104.932  4.178    0.1238     #> Infection:Antibiotics  2  72.187 36.922 9.603e-09 *** #> Infection:Planned      2 107.742  1.368    0.5047     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # add Association of Infection:Antibiotics Caesar.mod1 <- update(Caesar.mod0, ~ . + Infection:Antibiotics) anova(Caesar.mod0, Caesar.mod1, test=\"Chisq\") #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Infection + (Risk * Antibiotics * Planned)  #> Model 2: #>  ~Infection + Risk + Antibiotics + Planned + Risk:Antibiotics + Risk:Planned + Antibiotics:Planned + Infection:Antibiotics + Risk:Antibiotics:Planned  #>  #>           Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   85.10955 14                                     #> Model 2   48.18709 12   36.92246         2              0 #> Saturated  0.00000  0   48.18709        12              0  mosaic(Caesar.mod1,        gp=shading_Friendly,        main=\"Adding Infection:Antibiotics\")"},{"path":"https://friendly.github.io/vcdExtra/reference/Cancer.html","id":null,"dir":"Reference","previous_headings":"","what":"Survival of Breast Cancer Patients — Cancer","title":"Survival of Breast Cancer Patients — Cancer","text":"Three year survival 474 breast cancer patients according nuclear grade diagnostic center.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Cancer.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Survival of Breast Cancer Patients — Cancer","text":"3-dimensional array resulting cross-tabulating 3 variables 474 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Cancer.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Survival of Breast Cancer Patients — Cancer","text":"Lindsey, J. K. (1995). Analysis Frequency Count Data Oxford, UK: Oxford University Press. p. 38, Table 2.5. Whittaker, J. (1990) Graphical Models Applied Multivariate Statistics New York: John Wiley Sons, p. 220.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Cancer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Survival of Breast Cancer Patients — Cancer","text":"","code":"data(Cancer)  MASS::loglm(~Survival + Grade + Center, data = Cancer) #> Call: #> MASS::loglm(formula = ~Survival + Grade + Center, data = Cancer) #>  #> Statistics: #>                       X^2 df    P(> X^2) #> Likelihood Ratio 17.54776  4 0.001512235 #> Pearson          17.14492  4 0.001811552  vcd::mosaic(Cancer, shade=TRUE)"},{"path":"https://friendly.github.io/vcdExtra/reference/Cormorants.html","id":null,"dir":"Reference","previous_headings":"","what":"Advertising Behavior by Males Cormorants — Cormorants","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"Male double-crested cormorants use advertising behavior attract females breeding. study Meagan McRae (2015), cormorants observed two three times week six stations tree-nesting colony entire season, April 10, 2014-July 10, 2014. number advertising birds counted observations classified characteristics trees nests.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"data frame 343 observations following 8 variables. category Time season, divided 3 categories based breeding chronology, ordered factor levels Pre < Incubation < Chicks Present week Week season station Station observations two different peninsulas park, factor levels B1 B2 C1 C2 C3 C4 nest Type nest, ordered factor levels < partial < full height Relative height bird tree, ordered factor levels low < mid < high density Number nests tree, ordered factor levels zero < < moderate < high tree_health Health tree bird advertising , factor levels dead healthy count Number birds advertising, numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"McRae, M. (2015). Spatial, Habitat Frequency Changes Double-crested Cormorant Advertising Display Tree-nesting Colony. Unpublished MA project, Environmental Studies, York University.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"goal determine behavior varies temporally season spatially, well characteristics nesting sites. Observations made 2 days weeks 3 4, 3 days weeks. One use log(days) offset, response measures rate. Cormorants$days <- ifelse(Cormorants$week \\%\\% 3:4, 2, 3)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"","code":"data(Cormorants) str(Cormorants) #> 'data.frame':\t343 obs. of  8 variables: #>  $ category   : Ord.factor w/ 3 levels \"Pre\"<\"Incubation\"<..: 1 1 1 1 1 1 1 1 1 1 ... #>  $ week       : int  1 1 1 1 1 1 1 1 1 1 ... #>  $ station    : Factor w/ 6 levels \"B1\",\"B2\",\"C1\",..: 3 3 3 3 3 3 3 4 4 4 ... #>  $ nest       : Ord.factor w/ 3 levels \"no\"<\"partial\"<..: 1 1 2 2 2 3 3 1 1 1 ... #>  $ height     : Ord.factor w/ 3 levels \"low\"<\"mid\"<\"high\": 2 3 2 3 3 2 3 2 2 3 ... #>  $ density    : Ord.factor w/ 4 levels \"zero\"<\"few\"<\"moderate\"<..: 2 2 2 2 2 2 2 2 2 2 ... #>  $ tree_health: Factor w/ 2 levels \"dead\",\"healthy\": 2 2 2 2 1 2 2 2 1 2 ... #>  $ count      : int  3 2 2 2 1 3 3 1 8 3 ...  if (require(\"ggplot2\")) {   print(ggplot(Cormorants, aes(count)) +     geom_histogram(binwidth=0.5) +     labs(x=\"Number of birds advertising\"))  # Quick look at the data, on the log scale, for plots of `count ~ week`, #   stratified by something else.    print(ggplot(Cormorants, aes(week, count, color=height)) +     geom_jitter() +     stat_smooth(method=\"loess\", size=2) +     scale_y_log10(breaks=c(1,2,5,10)) +     geom_vline(xintercept=c(4.5, 9.5))) } #> Loading required package: ggplot2  #> Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #> ℹ Please use `linewidth` instead. #> `geom_smooth()` using formula = 'y ~ x'   # ### models using week fit1 <-glm(count ~ week + station + nest + height + density + tree_health,            data=Cormorants,            family =  poisson)  if (requireNamespace(\"car\"))   car::Anova(fit1) #> Analysis of Deviance Table (Type II tests) #>  #> Response: count #>             LR Chisq Df Pr(>Chisq)     #> week          62.791  1  2.298e-15 *** #> station       14.068  5    0.01518 *   #> nest         137.812  2  < 2.2e-16 *** #> height        47.988  2  3.797e-11 *** #> density       47.266  2  5.450e-11 *** #> tree_health    0.070  1    0.79199     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # plot fitted effects if (requireNamespace(\"effects\"))   plot(effects::allEffects(fit1))"},{"path":"https://friendly.github.io/vcdExtra/reference/CrabSatellites.html","id":null,"dir":"Reference","previous_headings":"","what":"Horseshoe Crab Mating — CrabSatellites","title":"Horseshoe Crab Mating — CrabSatellites","text":"Determinants mating male satellites nesting horseshoe crabs. number satellites natural outcome variable. dataset useful exploring various count data models.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CrabSatellites.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Horseshoe Crab Mating — CrabSatellites","text":"data frame containing 173 observations 5 variables. color Ordered factor indicating color (light medium, medium, dark medium, dark). spine Ordered factor indicating spine condition (good, one worn broken, worn broken). width Carapace width (cm). weight Weight (kg). satellites Number satellites.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CrabSatellites.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Horseshoe Crab Mating — CrabSatellites","text":"Table 4.3 Agresti (2002). dataset taken countreg package, CRAN","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CrabSatellites.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Horseshoe Crab Mating — CrabSatellites","text":"Brockmann (1996) investigates horseshoe crab mating. crabs arrive beach pairs spawn. Furthermore, unattached males also come beach, crowd around nesting couples compete attached males fertilizations. -called satellite males form large groups around couples ignoring others. Brockmann (1996) shows groupings driven environmental factors properties nesting female crabs. Larger females better condition attract satellites. Agresti (2002, 2013) reanalyzes number satellites using count models. Explanatory variables female crab's color, spine condition, weight, carapace width. Color spine condition ordered factors treated numeric analyses.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CrabSatellites.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Horseshoe Crab Mating — CrabSatellites","text":"Agresti (2002). Categorical Data Analysis, 2nd ed., John Wiley & Sons, Hoboken. Agresti (2013). Categorical Data Analysis, 3rd ed., John Wiley & Sons, Hoboken. Brockmann HJ (1996). “Satellite Male Groups Horseshoe Crabs, Limulus polyphemus”, Ethology, 102(1), 1–21.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CrabSatellites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Horseshoe Crab Mating — CrabSatellites","text":"","code":"## load data, use ordered factors as numeric, and grouped factor version of width data(\"CrabSatellites\", package = \"vcdExtra\") CrabSatellites <- transform(CrabSatellites,   color = as.numeric(color),   spine = as.numeric(spine),   cwidth = cut(width, c(-Inf, seq(23.25, 29.25), Inf)) )  ## Agresti, Table 4.4 aggregate(CrabSatellites$satellites,           list(CrabSatellites$cwidth), function(x)   round(c(Number = length(x), Sum = sum(x), Mean = mean(x), Var = var(x)), digits = 2)) #>       Group.1 x.Number  x.Sum x.Mean  x.Var #> 1 (-Inf,23.2]    14.00  14.00   1.00   2.77 #> 2 (23.2,24.2]    14.00  20.00   1.43   8.88 #> 3 (24.2,25.2]    28.00  67.00   2.39   6.54 #> 4 (25.2,26.2]    39.00 105.00   2.69  11.38 #> 5 (26.2,27.2]    22.00  63.00   2.86   6.89 #> 6 (27.2,28.2]    24.00  93.00   3.88   8.81 #> 7 (28.2,29.2]    18.00  71.00   3.94  16.88 #> 8 (29.2, Inf]    14.00  72.00   5.14   8.29  ## Agresti, Figure 4.4 plot(tapply(satellites, cwidth, mean) ~ tapply(width, cwidth, mean),   data = CrabSatellites,   ylim = c(0, 6), pch = 19, cex = 1.5,   xlab = \"Mean carapace width (cm)\",   ylab = \"Mean number of satellites\")   ## More examples: ?countreg::CrabSatellites` has examples of other plots and count data models"},{"path":"https://friendly.github.io/vcdExtra/reference/Crossings.html","id":null,"dir":"Reference","previous_headings":"","what":"Crossings Interaction of Factors — Crossings","title":"Crossings Interaction of Factors — Crossings","text":"Given two ordered factors square, n x n frequency table, Crossings creates n-1 column matrix corresponding different degrees difficulty crossing one level next, described Goodman (1972).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Crossings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Crossings Interaction of Factors — Crossings","text":"","code":"Crossings(...)"},{"path":"https://friendly.github.io/vcdExtra/reference/Crossings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Crossings Interaction of Factors — Crossings","text":"... Two factors","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Crossings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Crossings Interaction of Factors — Crossings","text":"two factors n levels, returns binary indicator matrix n*n rows n-1 columns.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Crossings.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Crossings Interaction of Factors — Crossings","text":"Goodman, L. (1972).  multiplicative models analysis cross-classified data. : Proceedings Sixth Berkeley Symposium Mathematical Statistics Probability, Berkeley, CA: University California Press, pp. 649-696.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Crossings.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Crossings Interaction of Factors — Crossings","text":"Michael Friendly Heather Turner","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Crossings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Crossings Interaction of Factors — Crossings","text":"","code":"data(Hauser79) # display table structable(~Father + Son, data=Hauser79) #>        Son UpNM LoNM  UpM  LoM Farm #> Father                              #> UpNM       1414  521  302  643   40 #> LoNM        724  524  254  703   48 #> UpM         798  648  856 1676  108 #> LoM         756  914  771 3325  237 #> Farm        409  357  441 1611 1832  hauser.indep <- gnm(Freq ~ Father + Son,                     data=Hauser79,                     family=poisson)  hauser.CR <- update(hauser.indep,                     ~ . + Crossings(Father,Son)) LRstats(hauser.CR) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CR 318.63 334.47   89.914 12  5.131e-14 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  hauser.CRdiag <- update(hauser.indep,                         ~ . + Crossings(Father,Son) + Diag(Father,Son)) LRstats(hauser.CRdiag) #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CRdiag 298.95 318.45   64.237  9   2.03e-10 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"},{"path":"https://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":null,"dir":"Reference","previous_headings":"","what":"London Cycling Deaths — CyclingDeaths","title":"London Cycling Deaths — CyclingDeaths","text":"data frame containing number deaths cyclists London 2005 2012 fortnightly period.  Aberdein & Spiegelhalter (2013) discuss data relation observation six cyclists died London Nov. 5 Nov. 13, 2013.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"London Cycling Deaths — CyclingDeaths","text":"data frame 208 observations following 2 variables. date Date deaths number deaths, numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"London Cycling Deaths — CyclingDeaths","text":"https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-accidents-safety-data, STATS 19 data, 2005-2012, using files Casualty0512.csv Accidents0512.csv","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"London Cycling Deaths — CyclingDeaths","text":"Aberdein, Jody Spiegelhalter, David (2013). London's roads become dangerous cyclists? Significance, 10(6), 46–48.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"London Cycling Deaths — CyclingDeaths","text":"","code":"data(CyclingDeaths)  plot(deaths ~ date, data=CyclingDeaths,   type=\"h\",   lwd=3,   ylab=\"Number of deaths\",   axes=FALSE) axis(1, at=seq(as.Date('2005-01-01'),                by='years',                length.out=9),      labels=2005:2013) axis(2, at=0:3)   # make a one-way frequency table CyclingDeaths.tab <- table(CyclingDeaths$deaths)  gf <- goodfit(CyclingDeaths.tab) gf #>  #> Observed and fitted values for poisson distribution #> with parameters estimated by `ML'  #>  #>  count observed     fitted pearson residual #>      0      114 117.946412       -0.3633792 #>      1       75  66.911907        0.9887681 #>      2       14  18.979820       -1.1430562 #>      3        5   3.589133        0.4108395 summary(gf) #>  #> \t Goodness-of-fit test for poisson distribution #>  #>                       X^2 df  P(> X^2) #> Likelihood Ratio 4.151738  2 0.1254474  rootogram(gf, xlab=\"Number of Deaths\")  distplot(CyclingDeaths.tab)   # prob of 6 or more deaths in one fortnight lambda <- gf$par$lambda ppois(5, lambda, lower.tail=FALSE) #> [1] 2.854305e-05"},{"path":"https://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":null,"dir":"Reference","previous_headings":"","what":"Dayton Student Survey on Substance Use — DaytonSurvey","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"data, Agresti (2002), Table 9.1, gives result 1992 survey Dayton Ohio 2276 high school seniors whether ever used alcohol, cigarettes marijuana.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"frequency data frame 32 observations following 6 variables. cigarette factor levels Yes alcohol factor levels Yes marijuana factor levels Yes sex factor levels female male race factor levels white Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"Agresti, . (2002). Categorical Data Analysis, 2nd Ed., New York: Wiley-Interscience, Table 9.1, p. 362.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"Agresti uses letters G (sex), R (race), (alcohol), C (cigarette), M (marijuana) refer table variables, usage followed examples . Background variables include sex race respondent (GR), typically treated explanatory, model full table include term sex:race. Models reduced table, collapsed sex race entirely unreasonable, permit estimation effects variables responses. full 5-way table contains number cells counts 0 1, well many cells large counts, even ACM table collapsed GR small cell counts.  Consequently, residuals models mosaic displays best represented standardized (adjusted) residuals.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"Thompson, L. (2009). R (S-PLUS) Manual Accompany Agresti's Categorical Data, http://www.stat.ufl.edu/~aa/cda/Thompson_manual.pdf","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"","code":"data(DaytonSurvey)  # mutual independence mod.0  <- glm(Freq ~ ., data=DaytonSurvey, family=poisson)  # mutual independence + GR mod.GR <- glm(Freq ~ . + sex*race, data=DaytonSurvey, family=poisson) anova(mod.GR, test = \"Chisq\") #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>           Df Deviance Resid. Df Resid. Dev  Pr(>Chi)     #> NULL                         31     4818.1               #> cigarette  1   227.81        30     4590.2 < 2.2e-16 *** #> alcohol    1  1281.71        29     3308.5 < 2.2e-16 *** #> marijuana  1    55.91        28     3252.6 7.575e-14 *** #> sex        1     0.57        27     3252.0    0.4505     #> race       1  1926.11        26     1325.9 < 2.2e-16 *** #> sex:race   1     0.79        25     1325.1    0.3746     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # all two-way terms mod.all2way <- glm(Freq ~ .^2, data=DaytonSurvey, family=poisson) anova(mod.all2way, test = \"Chisq\") #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>                     Df Deviance Resid. Df Resid. Dev  Pr(>Chi)     #> NULL                                   31     4818.1               #> cigarette            1   227.81        30     4590.2 < 2.2e-16 *** #> alcohol              1  1281.71        29     3308.5 < 2.2e-16 *** #> marijuana            1    55.91        28     3252.6 7.575e-14 *** #> sex                  1     0.57        27     3252.0  0.450480     #> race                 1  1926.11        26     1325.9 < 2.2e-16 *** #> cigarette:alcohol    1   442.19        25      883.7 < 2.2e-16 *** #> cigarette:marijuana  1   751.81        24      131.9 < 2.2e-16 *** #> cigarette:sex        1     0.04        23      131.9  0.837426     #> cigarette:race       1     2.34        22      129.5  0.126405     #> alcohol:marijuana    1    91.64        21       37.9 < 2.2e-16 *** #> alcohol:sex          1     2.22        20       35.7  0.136357     #> alcohol:race         1     6.50        19       29.2  0.010769 *   #> marijuana:sex        1     9.62        18       19.6  0.001926 **  #> marijuana:race       1     3.39        17       16.2  0.065758 .   #> sex:race             1     0.84        16       15.3  0.359722     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # compare models LRstats(mod.0, mod.GR, mod.all2way) #> Likelihood summary table: #>                 AIC     BIC LR Chisq Df Pr(>Chisq)     #> mod.0       1474.17 1482.96  1325.93 26     <2e-16 *** #> mod.GR      1475.38 1485.64  1325.14 25     <2e-16 *** #> mod.all2way  183.58  207.03    15.34 16     0.4999     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # collapse over sex and race Dayton.ACM <- aggregate(Freq ~ cigarette+alcohol+marijuana,                         data=DaytonSurvey,                         FUN=sum) Dayton.ACM #>   cigarette alcohol marijuana Freq #> 1       Yes     Yes       Yes  911 #> 2        No     Yes       Yes   44 #> 3       Yes      No       Yes    3 #> 4        No      No       Yes    2 #> 5       Yes     Yes        No  538 #> 6        No     Yes        No  456 #> 7       Yes      No        No   43 #> 8        No      No        No  279"},{"path":"https://friendly.github.io/vcdExtra/reference/Depends.html","id":null,"dir":"Reference","previous_headings":"","what":"Dependencies of R Packages — Depends","title":"Dependencies of R Packages — Depends","text":"one-way table gives type-token distribution number dependencies declared 4983 packages listed CRAN January 17, 2014.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Depends.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dependencies of R Packages — Depends","text":"format one-way frequency table counts packages 0, 1, 2, ... dependencies.","code":"table' int [1:15(1d)] 986 1347 993 685 375 298 155 65 32 19 ...  - attr(*, \"dimnames\")=List of 1  ..$ Depends: chr [1:15] \"0\" \"1\" \"2\" \"3\" ..."},{"path":"https://friendly.github.io/vcdExtra/reference/Depends.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dependencies of R Packages — Depends","text":"Using code https://www.r-bloggers.com/2013/12/-look---distribution--r-package-dependencies/","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Depends.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dependencies of R Packages — Depends","text":"","code":"data(Depends) plot(Depends,      xlab=\"Number of Dependencies\",      ylab=\"Number of R Packages\",      lwd=8)   # what type of distribution? # Ord_plot can't classify this! Ord_plot(Depends)   if (FALSE) { # \\dontrun{ # The code below, from Joseph Rickert, downloads and tabulates the data p <- as.data.frame(available.packages(),stringsAsFactors=FALSE) names(p)  pkgs <- data.frame(p[,c(1,4)])                  # Pick out Package names and Depends row.names(pkgs) <- NULL                         # Get rid of row names pkgs <- pkgs[complete.cases(pkgs[,2]),]         # Remove NAs  pkgs$Depends2 <-strsplit(pkgs$Depends,\",\")      # split list of Depends pkgs$numDepends <- as.numeric(lapply(pkgs$Depends2,length)) # Count number of dependencies in list zeros <- c(rep(0,dim(p)[1] - dim(pkgs)[1]))     # Account for packages with no dependencies Deps <- as.vector(c(zeros,pkgs$numDepends))     # Set up to tablate Depends <- table(Deps)  } # }"},{"path":"https://friendly.github.io/vcdExtra/reference/Detergent.html","id":null,"dir":"Reference","previous_headings":"","what":"Detergent Preference Data — Detergent","title":"Detergent Preference Data — Detergent","text":"Cross-classification sample 1008 consumers according () softness laundry water used, (b) previous use detergent Brand M, (c) temperature laundry water used (d) expressed preference Brand X Brand M blind trial.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Detergent.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Detergent Preference Data — Detergent","text":"4-dimensional array resulting cross-tabulating 4 variables 1008 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Detergent.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Detergent Preference Data — Detergent","text":"Fienberg, S. E. (1980). Analysis Cross-Classified Categorical Data Cambridge, MA: MIT Press, p. 71.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Detergent.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Detergent Preference Data — Detergent","text":"Ries, P. N. & Smith, H. (1963). use chi-square preference testing multidimensional problems. Chemical Engineering Progress, 59, 39-43.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Detergent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Detergent Preference Data — Detergent","text":"","code":"data(Detergent)  # basic mosaic plot mosaic(Detergent, shade=TRUE)   require(MASS) (det.mod0 <- loglm(~ Preference + Temperature + M_User + Water_softness,                    data=Detergent)) #> Call: #> loglm(formula = ~Preference + Temperature + M_User + Water_softness,  #>     data = Detergent) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 42.92866 18 0.0008190181 #> Pearson          43.90225 18 0.0005957483 # examine addition of two-way terms add1(det.mod0, ~ .^2, test=\"Chisq\") #> Single term additions #>  #> Model: #> ~Preference + Temperature + M_User + Water_softness #>                            Df    AIC     LRT  Pr(>Chi)     #> <none>                        54.929                       #> Preference:Temperature      1 52.567  4.3616   0.03676 *   #> Preference:M_User           1 36.347 20.5815 5.715e-06 *** #> Preference:Water_softness   2 58.533  0.3953   0.82066     #> Temperature:M_User          1 55.676  1.2531   0.26296     #> Temperature:Water_softness  2 52.830  6.0991   0.04738 *   #> M_User:Water_softness       2 57.854  1.0751   0.58418     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # model for Preference as a response (det.mod1 <- loglm(~ Preference + (Temperature * M_User * Water_softness),                    data=Detergent)) #> Call: #> loglm(formula = ~Preference + (Temperature * M_User * Water_softness),  #>     data = Detergent) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 32.82562 11 0.0005615017 #> Pearson          32.46939 11 0.0006410272 mosaic(det.mod0)"},{"path":"https://friendly.github.io/vcdExtra/reference/Donner.html","id":null,"dir":"Reference","previous_headings":"","what":"Survival in the Donner Party — Donner","title":"Survival in the Donner Party — Donner","text":"data frame contains information members Donner Party, group people attempted migrate California 1846. trapped early blizzard eastern side Sierra Nevada mountains, rescued, nearly half party died.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Donner.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Survival in the Donner Party — Donner","text":"data frame 90 observations following 5 variables. family family name, factor 10 levels age age person, numeric vector sex factor levels Female Male survived numeric vector, 0 1 death date death died rescue, POSIXct","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Donner.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Survival in the Donner Party — Donner","text":"D. K. Grayson, 1990, \"Donner party deaths: demographic assessment\", J. Anthropological Research, 46, 223-242. Johnson, K. (1996). Unfortunate Emigrants: Narratives Donner Party.  Logan, UT: Utah State University Press.  Additions, dates death http://user.xmission.com/~octa/DonnerParty/Roster.htm.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Donner.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Survival in the Donner Party — Donner","text":"factors affected lived died? data frame uses person's name row labels. family reflects recoding last names individuals reduce number factor levels. main families Donner party : Donner, Graves, Breen Reed. families Murphy, Foster Pike grouped 'MurFosPik', Fosdick Wolfinger coded 'FosdWolf', others ''. survived response variable. kind models used ?","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Donner.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Survival in the Donner Party — Donner","text":"Ramsey, F.L. Schafer, D.W. (2002).  Statistical Sleuth: Course Methods Data Analysis, (2nd ed), Duxbury. Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Donner.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Survival in the Donner Party — Donner","text":"","code":"# conditional density plots op <- par(mfrow=c(1,2), cex.lab=1.5) cdplot(factor(survived) ~ age,        subset=sex=='Male',        data=Donner,        main=\"Donner party: Males\",        ylevels=2:1,        ylab=\"Survived\",        yaxlabels=c(\"yes\", \"no\")) with(Donner, rug(jitter(age[sex==\"Male\"]),                  col=\"white\", quiet=TRUE))  cdplot(factor(survived) ~ age,        subset=sex=='Female',        data=Donner,        main=\"Donner party: Females\",        ylevels=2:1,        ylab=\"Survived\",        yaxlabels=c(\"yes\", \"no\")) with(Donner, rug(jitter(age[sex==\"Female\"]),                  col=\"white\", quiet=TRUE))  par(op)   # fit some models (mod1 <- glm(survived ~ age + sex, data=Donner, family=binomial)) #>  #> Call:  glm(formula = survived ~ age + sex, family = binomial, data = Donner) #>  #> Coefficients: #> (Intercept)          age      sexMale   #>      1.5992      -0.0338      -1.2068   #>  #> Degrees of Freedom: 89 Total (i.e. Null);  87 Residual #> Null Deviance:\t    124.4  #> Residual Deviance: 111.1 \tAIC: 117.1 (mod2 <- glm(survived ~ age * sex, data=Donner, family=binomial)) #>  #> Call:  glm(formula = survived ~ age * sex, family = binomial, data = Donner) #>  #> Coefficients: #> (Intercept)          age      sexMale  age:sexMale   #>     1.85515     -0.04565     -1.62177      0.01957   #>  #> Degrees of Freedom: 89 Total (i.e. Null);  86 Residual #> Null Deviance:\t    124.4  #> Residual Deviance: 110.7 \tAIC: 118.7 anova(mod2, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model: binomial, link: logit #>  #> Response: survived #>  #> Terms added sequentially (first to last) #>  #>  #>         Df Deviance Resid. Df Resid. Dev Pr(>Chi)    #> NULL                       89     124.37             #> age      1   6.5113        88     117.86 0.010719 *  #> sex      1   6.7274        87     111.13 0.009494 ** #> age:sex  1   0.4003        86     110.73 0.526922    #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  (mod3 <- glm(survived ~ poly(age,2) * sex, data=Donner, family=binomial)) #>  #> Call:  glm(formula = survived ~ poly(age, 2) * sex, family = binomial,  #>     data = Donner) #>  #> Coefficients: #>           (Intercept)          poly(age, 2)1          poly(age, 2)2   #>                0.7622               -26.9689               -30.5626   #>               sexMale  poly(age, 2)1:sexMale  poly(age, 2)2:sexMale   #>               -1.0996                22.7211                28.8976   #>  #> Degrees of Freedom: 89 Total (i.e. Null);  84 Residual #> Null Deviance:\t    124.4  #> Residual Deviance: 97.8 \tAIC: 109.8 anova(mod3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model: binomial, link: logit #>  #> Response: survived #>  #> Terms added sequentially (first to last) #>  #>  #>                  Df Deviance Resid. Df Resid. Dev Pr(>Chi)    #> NULL                                89    124.366             #> poly(age, 2)      2   9.5441        87    114.822 0.008463 ** #> sex               1   8.0908        86    106.731 0.004449 ** #> poly(age, 2):sex  2   8.9321        84     97.799 0.011492 *  #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 LRstats(glmlist(mod1, mod2, mod3)) #> Likelihood summary table: #>         AIC    BIC LR Chisq Df Pr(>Chisq)   #> mod1 117.13 124.63  111.128 87    0.04159 * #> mod2 118.73 128.73  110.727 86    0.03755 * #> mod3 109.80 124.80   97.799 84    0.14408   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # plot fitted probabilities from mod2 and mod3 # idea from: http://www.ling.upenn.edu/~joseff/rstudy/summer2010_ggplot2_intro.html library(ggplot2)  # separate linear fits on age for M/F ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\",               method.args = list(family = binomial),               formula = y ~ x,               alpha = 0.2,               size=2,               aes(fill = sex))   # separate quadratics ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\",               method.args = list(family = binomial),               formula = y ~ poly(x,2),               alpha = 0.2,               size=2,               aes(fill = sex))"},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970.html","id":null,"dir":"Reference","previous_headings":"","what":"USA 1970 Draft Lottery Data — Draft1970","title":"USA 1970 Draft Lottery Data — Draft1970","text":"data set gives results 1970 US draft lottery, form data frame.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"USA 1970 Draft Lottery Data — Draft1970","text":"data frame 366 observations following 3 variables. Day day year, 1:366 Rank draft priority rank people born day Month ordered factor levels Jan < Feb ... < Dec","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"USA 1970 Draft Lottery Data — Draft1970","text":"Starr, N. (1997). Nonrandom Risk: 1970 Draft Lottery, Journal Statistics Education, v.5, n.2 https://jse.amstat.org/v5n2/datasets.starr.html","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"USA 1970 Draft Lottery Data — Draft1970","text":"draft lottery used determine order eligible men called Selective Service draft. days year (including February 29) represented numbers 1 366 written slips paper. slips placed separate plastic capsules mixed shoebox dumped deep glass jar. Capsules drawn jar one time. first number drawn 258 (September 14), registrants birthday assigned lottery number Rank 1. second number drawn corresponded April 24, forth.  men draft age (born 1944 1950) shared birthdate called serve . first 195 birthdates drawn later called serve order drawn; last September 24.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"USA 1970 Draft Lottery Data — Draft1970","text":"Fienberg, S. E. (1971), \"Randomization Social Affairs: 1970 Draft Lottery,\" Science, 171, 255-261. https://en.wikipedia.org/wiki/Draft_lottery_(1969)","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"USA 1970 Draft Lottery Data — Draft1970","text":"","code":"data(Draft1970)  # scatterplot plot(Rank ~ Day, data=Draft1970) with(Draft1970, lines(lowess(Day, Rank), col=\"red\", lwd=2)) abline(lm(Rank ~ Day, data=Draft1970), col=\"blue\")   # boxplots plot(Rank ~ Month, data=Draft1970, col=\"bisque\")   lm(Rank ~ Month, data=Draft1970) #>  #> Call: #> lm(formula = Rank ~ Month, data = Draft1970) #>  #> Coefficients: #> (Intercept)      Month.L      Month.Q      Month.C      Month^4      Month^5   #>     183.528      -84.330      -31.503        5.020      -20.904      -14.052   #>     Month^6      Month^7      Month^8      Month^9     Month^10     Month^11   #>       2.122        3.488       21.150        1.747       15.582        1.126   #>  anova(lm(Rank ~ Month, data=Draft1970)) #> Analysis of Variance Table #>  #> Response: Rank #>            Df  Sum Sq Mean Sq F value  Pr(>F)    #> Month      11  290507   26410  2.4634 0.00558 ** #> Residuals 354 3795120   10721                    #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # make the table version Draft1970$Risk <- cut(Draft1970$Rank, breaks=3, labels=c(\"High\", \"Med\", \"Low\")) with(Draft1970, table(Month, Risk)) #>      Risk #> Month High Med Low #>   Jan    9  12  10 #>   Feb    7  12  10 #>   Mar    5  10  16 #>   Apr    8   8  14 #>   May    9   7  15 #>   Jun   11   7  12 #>   Jul   12   7  12 #>   Aug   13   7  11 #>   Sep   10  15   5 #>   Oct    9  15   7 #>   Nov   12  12   6 #>   Dec   17  10   4"},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":null,"dir":"Reference","previous_headings":"","what":"USA 1970 Draft Lottery Table — Draft1970table","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"data set gives results 1970 US draft lottery, form frequency table. rows months year, Jan–Dec columns give number days month fall three draft risk categories High, Medium, Low, corresponding chances called serve US army.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"format :","code":"'table' int [1:12, 1:3] 9 7 5 8 9 11 12 13 10 9 ... - attr(*, \"dimnames\")=List of 2 ..$ Month: chr [1:12] \"Jan\" \"Feb\" \"Mar\" \"Apr\" ... ..$ Risk : chr [1:3] \"High\" \"Med\" \"Low\""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"data available several forms, table version obtained https://sas.uwaterloo.ca/~rwoldfor/software/eikosograms/data/draft-70","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"lottery numbers divided three categories risk called draft – High, Medium, Low – representing roughly one third days year.  birthdays highest risk lottery numbers 1-122, medium risk numbers 123-244, lowest risk category contains lottery numbers 245-366.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"Fienberg, S. E. (1971), \"Randomization Social Affairs: 1970 Draft Lottery,\" Science, 171, 255-261. Starr, N. (1997). Nonrandom Risk: 1970 Draft Lottery, Journal Statistics Education, v.5, n.2 https://jse.amstat.org/v5n2/datasets.starr.html","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"","code":"data(Draft1970table) chisq.test(Draft1970table) #>  #> \tPearson's Chi-squared test #>  #> data:  Draft1970table #> X-squared = 37.156, df = 22, p-value = 0.02274 #>   # plot.table -> graphics:::mosaicplot plot(Draft1970table, shade=TRUE)  mosaic(Draft1970table, gp=shading_Friendly)   # correspondence analysis if(require(ca)) {   ca(Draft1970table)   plot(ca(Draft1970table)) }   # convert to a frequency data frame with ordered factors Draft1970df <- as.data.frame(Draft1970table)  Draft1970df <- within(Draft1970df, {   Month <- ordered(Month)   Risk <- ordered(Risk, levels=rev(levels(Risk)))   }) str(Draft1970df) #> 'data.frame':\t36 obs. of  3 variables: #>  $ Month: Ord.factor w/ 12 levels \"Jan\"<\"Feb\"<\"Mar\"<..: 1 2 3 4 5 6 7 8 9 10 ... #>  $ Risk : Ord.factor w/ 3 levels \"Low\"<\"Med\"<\"High\": 3 3 3 3 3 3 3 3 3 3 ... #>  $ Freq : int  9 7 5 8 9 11 12 13 10 9 ...  # similar model, as a Poisson GLM indep <- glm(Freq ~ Month + Risk, family = poisson, data = Draft1970df)  mosaic(indep, residuals_type=\"rstandard\", gp=shading_Friendly) #> Warning: no formula provided, assuming ~Month + Risk   # numeric scores for tests of ordinal factors Cscore <- as.numeric(Draft1970df$Risk) Rscore <- as.numeric(Draft1970df$Month)  # linear x linear association between Month and Risk linlin <- glm(Freq ~ Month + Risk + Rscore:Cscore, family = poisson, data = Draft1970df)  # compare models anova(indep, linlin, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Month + Risk #> Model 2: Freq ~ Month + Risk + Rscore:Cscore #>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     #> 1        22     38.261                           #> 2        21     23.885  1   14.376 0.0001497 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 mosaic(linlin, residuals_type=\"rstandard\", gp=shading_Friendly) #> Warning: no formula provided, assuming ~Month + Risk"},{"path":"https://friendly.github.io/vcdExtra/reference/Dyke.html","id":null,"dir":"Reference","previous_headings":"","what":"Sources of Knowledge of Cancer — Dyke","title":"Sources of Knowledge of Cancer — Dyke","text":"Observational data sample 1729 individuals, cross-classified 2^5 table according sources information (read newspapers, listen radio, 'solid' reading, attend lectures) whether good poor knowledge regarding cancer.  Knowledge cancer often treated response.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Dyke.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sources of Knowledge of Cancer — Dyke","text":"5-dimensional array resulting cross-tabulating 5 variables 1729 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Dyke.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sources of Knowledge of Cancer — Dyke","text":"Fienberg, S. E. (1980). Analysis Cross-Classified Categorical Data Cambridge, MA: MIT Press, p. 85, Table 5-6.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Dyke.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sources of Knowledge of Cancer — Dyke","text":"Dyke, G. V. Patterson, H. D. (1952). Analysis factorial arrangements data proportions. Biometrics, 8, 1-12. Lindsey, J. K. (1993).  Models Repeated Measurements Oxford, UK: Oxford University Press, p. 57.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Dyke.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sources of Knowledge of Cancer — Dyke","text":"","code":"data(Dyke)  # independence model mosaic(Dyke, shade=TRUE)   # null model, Knowledge as response, independent of others require(MASS) dyke.mod0 <- loglm(~ Knowledge + (Reading * Radio * Lectures * Newspaper), data=Dyke) dyke.mod0 #> Call: #> loglm(formula = ~Knowledge + (Reading * Radio * Lectures * Newspaper),  #>     data = Dyke) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 216.2594 15        0 #> Pearson          207.5194 15        0 mosaic(dyke.mod0)   # view as doubledecker plot Dyke <- Dyke[2:1,,,,]    # make Good the highlighted value of Knowledge doubledecker(Knowledge ~ ., data=Dyke)   # better version, with some options doubledecker(Knowledge ~ Lectures + Reading + Newspaper + Radio,   data=Dyke,   margins = c(1,6, length(dim(Dyke)) + 1, 1),   fill_boxes=list(rep(c(\"white\", gray(.90)),4))   )   # separate (conditional) plots for those who attend lectures and those who do not doubledecker(Knowledge ~ Reading + Newspaper + Radio,   data=Dyke[,,,1,],   main=\"Do not attend lectures\",   margins = c(1,6, length(dim(Dyke)) + 1, 1),   fill_boxes=list(rep(c(\"white\", gray(.90)),3))   )  doubledecker(Knowledge ~ Reading + Newspaper + Radio,   data=Dyke[,,,2,],   main=\"Attend lectures\",   margins = c(1,6, length(dim(Dyke)) + 1, 1),   fill_boxes=list(rep(c(\"white\", gray(.90)),3))   )    drop1(dyke.mod0, test=\"Chisq\") #> Single term deletions #>  #> Model: #> ~Knowledge + (Reading * Radio * Lectures * Newspaper) #>                                  Df    AIC    LRT Pr(>Chi)     #> <none>                              250.26                     #> Knowledge                         1 338.37 90.114   <2e-16 *** #> Reading:Radio:Lectures:Newspaper  1 248.63  0.374   0.5406     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"},{"path":"https://friendly.github.io/vcdExtra/reference/Fungicide.html","id":null,"dir":"Reference","previous_headings":"","what":"Carcinogenic Effects of a Fungicide — Fungicide","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"Data Gart (1971) carcinogenic effects certain fungicide two strains mice. interest association group (Control, Treated) outcome (Tumor, Tumor) varies sex strain mice.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"data comprise set four 2 x 2 tables classifying 403 mice, either Control Treated whether tumor later observed. four groups represent combinations sex strain mice. format :","code":"num [1:2, 1:2, 1:2, 1:2] 5 4 74 12 3 2 84 14 10 4 ... - attr(*, \"dimnames\")=List of 4 ..$ group  : chr [1:2] \"Control\" \"Treated\" ..$ outcome: chr [1:2] \"Tumor\" \"NoTumor\" ..$ sex    : chr [1:2] \"M\" \"F\" ..$ strain : chr [1:2] \"1\" \"2\""},{"path":"https://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"Gart, J. J. (1971). comparison proportions: review significance tests, confidence intervals adjustments stratification. International Statistical Review, 39, 148-169.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"Breslow (1976) used data illustrate application linear models log odds ratios. tables small cells, continuity correction recommended.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"Breslow, N. (1976), Regression analysis log odds ratio: method retrospective studies, Biometrics, 32(3), 409-416.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"","code":"data(Fungicide) # loddsratio was moved to vcd; requires vcd_1.3-3+ if (FALSE) { # \\dontrun{ fung.lor <- loddsratio(Fungicide, correct=TRUE) fung.lor confint(fung.lor) } # }  # visualize odds ratios in fourfold plots cotabplot(Fungicide, panel=cotab_fourfold)  #  -- fourfold() requires vcd >= 1.2-10 fourfold(Fungicide, p_adjust_method=\"none\")"},{"path":"https://friendly.github.io/vcdExtra/reference/GKgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Goodman-Kruskal \\(\\gamma\\) statistic measure association ordinal factors two-way table proposed Goodman Kruskal (1954).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"","code":"GKgamma(x, level = 0.95)  # S3 method for class 'GKgamma' print(x, digits = 3, ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"x two-way frequency table, matrix table form.  rows columns considered ordinal factors level Confidence level significance test \\(\\gamma \\ne =\\) digits number digits use print method ... arguments (unused), conformity print generic","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Returns object class \"GKgamma\" 6 components, follows gamma gamma statistic C Total number concordant pairs table D Total number discordant pairs table sigma Standard error gamma CIlevel Confidence level CI Confidence interval","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Agresti, . Categorical Data Analysis. John Wiley & Sons, 2002, pp. 57–59. Goodman, L. ., & Kruskal, W. H. (1954). Measures association cross classifications. Journal American Statistical Association, 49, 732-764. Goodman, L. ., & Kruskal, W. H. (1963). Measures association cross classifications III: Approximate sampling theory. Journal American Statistical Association, 58, 310-364.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Michael Friendly; original version Laura Thompson","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"","code":"data(JobSat) GKgamma(JobSat) #> gamma        : 0.221  #> std. error   : 0.117  #> CI           : -0.009 0.451"},{"path":"https://friendly.github.io/vcdExtra/reference/GSS.html","id":null,"dir":"Reference","previous_headings":"","what":"General Social Survey– Sex and Party affiliation — GSS","title":"General Social Survey– Sex and Party affiliation — GSS","text":"Data General Social Survey, 1991, relation sex party affiliation.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/GSS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"General Social Survey– Sex and Party affiliation — GSS","text":"data frame frequency form 6 observations following 3 variables. sex factor levels female male party factor levels dem indep rep count numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/GSS.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"General Social Survey– Sex and Party affiliation — GSS","text":"Agresti, . Categorical Data Analysis, 2nd E., John Wiley & Sons, 2002, Table 3.11, p. 106.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/GSS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"General Social Survey– Sex and Party affiliation — GSS","text":"","code":"data(GSS) str(GSS) #> 'data.frame':\t6 obs. of  3 variables: #>  $ sex  : Factor w/ 2 levels \"female\",\"male\": 1 2 1 2 1 2 #>  $ party: Factor w/ 3 levels \"dem\",\"indep\",..: 1 1 2 2 3 3 #>  $ count: num  279 165 73 47 225 191  # use xtabs to show the table in a compact form (GSStab <- xtabs(count ~ sex + party, data=GSS)) #>         party #> sex      dem indep rep #>   female 279    73 225 #>   male   165    47 191  # fit the independence model (mod.glm <- glm(count ~ sex + party, family = poisson, data = GSS)) #>  #> Call:  glm(formula = count ~ sex + party, family = poisson, data = GSS) #>  #> Coefficients: #> (Intercept)      sexmale   partyindep     partyrep   #>     5.56611     -0.35891     -1.30833     -0.06514   #>  #> Degrees of Freedom: 5 Total (i.e. Null);  2 Residual #> Null Deviance:\t    271.4  #> Residual Deviance: 7.003 \tAIC: 55.59  # display all the residuals in a mosaic plot mosaic(mod.glm,   formula = ~ sex + party,   labeling = labeling_residuals,   suppress=0)"},{"path":"https://friendly.github.io/vcdExtra/reference/Geissler.html","id":null,"dir":"Reference","previous_headings":"","what":"Geissler's Data on the Human Sex Ratio — Geissler","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"Geissler (1889) published data distributions boys girls families Saxony, collected period 1876-1885. Geissler data tabulates family composition 991,958 families number boys girls listed table supplied Edwards (1958, Table 1).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Geissler.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"data frame 90 observations following 4 variables.  rows represent non-NA entries Edwards' table. boys number boys family, 0:12 girls number girls family, 0:12 size family size: boys+girls Freq number families sex composition","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Geissler.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"Edwards, . W. F. (1958). Analysis Geissler's Data Human Sex Ratio. Annals Human Genetics, 23, 6-15.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Geissler.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"data family composition available , birth child, parents state sex children birth certificate. family records necessarily independent, given family may several children 10 year period, included multiple records.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Geissler.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Geissler, . (1889). Beitrage zur Frage des Geschlechts verhaltnisses der Geborenen Z. K. Sachsischen Statistischen Bureaus, 35, n.p. Lindsey, J. K. & Altham, P. M. E. (1998).  Analysis human sex ratio using overdispersion models. Journal Royal Statistical Society: Series C (Applied Statistics), 47, 149-157.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Geissler.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"","code":"data(Geissler) str(Geissler) #> 'data.frame':\t90 obs. of  4 variables: #>  $ boys : int  0 0 0 0 0 0 0 0 0 0 ... #>  $ girls: num  1 2 3 4 5 6 7 8 9 10 ... #>  $ size : num  1 2 3 4 5 6 7 8 9 10 ... #>  $ Freq : int  108719 42860 17395 7004 2839 1096 436 161 66 30 ...  # reproduce Saxony data, families of size 12 Saxony12 <- subset(Geissler, size==12, select=c(boys, Freq)) rownames(Saxony12)<-NULL  # make a 1-way table xtabs(Freq~boys, Saxony12) #> boys #>    0    1    2    3    4    5    6    7    8    9   10   11   12  #>    3   24  104  286  670 1033 1343 1112  829  478  181   45    7   # extract data for other family sizes Saxony11 <- subset(Geissler, size==11, select=c(boys, Freq)) rownames(Saxony11)<-NULL  Saxony10 <- subset(Geissler, size==10, select=c(boys, Freq)) rownames(Saxony10)<-NULL"},{"path":"https://friendly.github.io/vcdExtra/reference/Gilby.html","id":null,"dir":"Reference","previous_headings":"","what":"Clothing and Intelligence Rating of Children — Gilby","title":"Clothing and Intelligence Rating of Children — Gilby","text":"Schoolboys classified according clothing teachers rating \"dullness\" (lack intelligence), 5 x 7 table originally Gilby (1911). Anscombe (1981) presents slightly collapsed 4 x 6 table, used , last two categories clothing pooled first two categories dullness due small counts.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Gilby.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Clothing and Intelligence Rating of Children — Gilby","text":"2-dimensional array resulting cross-tabulating 2 variables 1725 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Gilby.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Clothing and Intelligence Rating of Children — Gilby","text":"Anscombe, F. J. (1981). Computing Statistical Science APL. New York: Springer-Verlag, p. 302","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Gilby.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Clothing and Intelligence Rating of Children — Gilby","text":"Dullness Clothing ordered categories, models methods examine association terms ordinal categories profitable.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Gilby.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Clothing and Intelligence Rating of Children — Gilby","text":"Gilby, W. H. (1911). significance teacher's appreciation general intelligence.  Biometrika, 8, 93-108 (esp. p. 94).  (Quoted Kendall (1943,..., 1953) Table 13.1, p 320.)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Gilby.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clothing and Intelligence Rating of Children — Gilby","text":"","code":"data(Gilby)  # CMH tests treating row/column variables as ordinal CMHtest(Gilby) #> Cochran-Mantel-Haenszel Statistics for Dullness by Clothing  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 133.21  1 8.1410e-31 #> rmeans  Row mean scores differ 134.79  5 2.2915e-27 #> cmeans  Col mean scores differ 135.22  3 4.0462e-29 #> general    General association 174.72 15 2.7516e-29 #>   mosaic(Gilby, shade=TRUE)   # correspondence analysis to see relations among categories if(require(ca)){   ca(Gilby)   plot(ca(Gilby), lines=TRUE)  }"},{"path":"https://friendly.github.io/vcdExtra/reference/Glass.html","id":null,"dir":"Reference","previous_headings":"","what":"British Social Mobility from Glass(1954) — Glass","title":"British Social Mobility from Glass(1954) — Glass","text":"Glass(1954) gave 5 x 5 table occupations 3500 British fathers sons.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Glass.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"British Social Mobility from Glass(1954) — Glass","text":"frequency data frame 25 observations following 3 variables representing 5 x 5 table 3500 cases. father factor levels Managerial Professional Skilled Supervisory Unskilled son factor levels Managerial Professional Skilled Supervisory Unskilled Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Glass.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"British Social Mobility from Glass(1954) — Glass","text":"Glass, D. V. (1954), Social Mobility Britain. Free Press.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Glass.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"British Social Mobility from Glass(1954) — Glass","text":"occupational categories order status : (1) Professional & High Administrative (2) Managerial, Executive & High Supervisory (3) Low Inspectional & Supervisory (4) Routine Nonmanual & Skilled Manual (5) Semi- & Unskilled Manual However, make point factors ordered alphabetically default, Friendly & Meyer (2016) introduce data set form given .","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Glass.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"British Social Mobility from Glass(1954) — Glass","text":"Bishop, Y. M. M. Fienberg, S. E. Holland, P. W. (1975). Discrete Multivariate Analysis: Theory Practice, MIT Press. Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Glass.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"British Social Mobility from Glass(1954) — Glass","text":"","code":"data(Glass) glass.tab <- xtabs(Freq ~ father + son, data=Glass)  largs <- list(set_varnames=list(father=\"Father's Occupation\",                                 son=\"Son's Occupation\"),               abbreviate=10) gargs <- list(interpolate=c(1,2,4,8))  mosaic(glass.tab,   shade=TRUE,   labeling_args=largs,   gp_args=gargs,   main=\"Alphabetic order\",   legend=FALSE,   rot_labels=c(20,90,0,70))   # reorder by status ord <- c(2, 1, 4, 3, 5) mosaic(glass.tab[ord, ord],   shade=TRUE,   labeling_args=largs,   gp_args=gargs,   main=\"Effect order\",   legend=FALSE,   rot_labels=c(20,90,0,70))"},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"HLtest function computes classical Hosmer-Lemeshow (1980) goodness fit test binomial glm object logistic regression","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"","code":"HLtest(model, g = 10)  # S3 method for class 'HLtest' print(x, ...)  # S3 method for class 'HLtest' summary(object, ...)  # S3 method for class 'HLtest' rootogram(x, ...)  # S3 method for class 'HLtest' plot(x, ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"model glm model object binomial family g Number groups used partition fitted values GOF test. x, object HLtest object ... arguments passed methods","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"class HLtest object following components: table data.frame describing results partitioning data g groups following columns: cut, total, obs, exp, chi chisq chisquare statistics df Degrees freedom p.value p value groups Number groups call model call %% ...","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"general idea assesses whether observed event rates match expected event rates subgroups model population. Hosmer-Lemeshow test specifically identifies subgroups deciles fitted event values, quantiles determined g argument. Given subgroups, simple chisquare test g-2 df used. addition print summary methods, plot method supplied visualize discrepancies observed fitted frequencies.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"Hosmer, David W., Lemeshow, Stanley (1980).  goodness--fit test multiple logistic regression model. Communications Statistics, Series , 9, 1043-1069. Hosmer, David W., Lemeshow, Stanley (2000).  Applied Logistic Regression, New York: Wiley, ISBN 0-471-61553-6 Lemeshow, S. Hosmer, D.W.  (1982).  review goodness fit statistics use development logistic regression models. American Journal Epidemiology, 115(1), 92-106.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HLtest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"","code":"data(birthwt, package=\"MASS\") # how to do this without attach? attach(birthwt) #> The following object is masked from package:ca: #>  #>     smoke   race = factor(race, labels = c(\"white\", \"black\", \"other\"))   ptd = factor(ptl > 0)   ftv = factor(ftv)   levels(ftv)[-(1:2)] = \"2+\"   bwt <- data.frame(low = factor(low), age, lwt, race,       smoke = (smoke > 0), ptd, ht = (ht > 0), ui = (ui > 0), ftv) detach(birthwt)  options(contrasts = c(\"contr.treatment\", \"contr.poly\")) BWmod <- glm(low ~ ., family=binomial, data=bwt)  (hlt <- HLtest(BWmod)) #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ ., family = binomial, data = bwt) #>  ChiSquare df   P_value #>   5.981786  8 0.6492722 str(hlt) #> List of 6 #>  $ table  :'data.frame':\t10 obs. of  5 variables: #>   ..$ cut  : chr [1:10] \"[0.0161,0.0788]\" \"(0.0788,0.119]\" \"(0.119,0.189]\" \"(0.189,0.229]\" ... #>   ..$ total: num [1:10] 19 19 19 19 19 18 19 19 19 19 #>   ..$ obs  : num [1:10] 19 17 15 13 16 15 11 10 9 5 #>   ..$ exp  : num [1:10] 18 17.2 16.2 15.1 14.3 ... #>   ..$ chi  : num [1:10] 0.242 -0.0374 -0.3036 -0.5317 0.4611 ... #>  $ chisq  : num 5.98 #>  $ df     : num 8 #>  $ p.value: num 0.649 #>  $ groups : num 10 #>  $ call   : language glm(formula = low ~ ., family = binomial, data = bwt) #>  - attr(*, \"class\")= chr \"HLtest\" summary(hlt) #> Partition for Hosmer and Lemeshow Goodness-of-Fit Test  #>  #>                cut total obs       exp         chi #> 1  [0.0161,0.0788]    19  19 17.974124  0.24197519 #> 2   (0.0788,0.119]    19  17 17.154854 -0.03738777 #> 3    (0.119,0.189]    19  15 16.222714 -0.30357311 #> 4    (0.189,0.229]    19  13 15.063836 -0.53174994 #> 5    (0.229,0.268]    19  16 14.259007  0.46105470 #> 6    (0.268,0.312]    18  15 12.757257  0.62791490 #> 7    (0.312,0.402]    19  11 12.545096 -0.43623285 #> 8    (0.402,0.493]    19  10 10.593612 -0.18238140 #> 9    (0.493,0.618]    19   9  8.552849  0.15289685 #> 10   (0.618,0.904]    19   5  4.876650  0.05585725 #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ ., family = binomial, data = bwt) #>  ChiSquare df   P_value #>   5.981786  8 0.6492722 plot(hlt)   # basic model BWmod0 <- glm(low ~ age, family=binomial, data=bwt) (hlt0 <- HLtest(BWmod0)) #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ age, family = binomial, data = bwt) #>  ChiSquare df   P_value #>   9.307311  8 0.3170385 str(hlt0) #> List of 6 #>  $ table  :'data.frame':\t10 obs. of  5 variables: #>   ..$ cut  : chr [1:10] \"[0.128,0.231]\" \"(0.231,0.26]\" \"(0.26,0.29]\" \"(0.29,0.301]\" ... #>   ..$ total: num [1:10] 20 23 26 13 13 25 18 16 22 13 #>   ..$ obs  : num [1:10] 17 19 14 8 8 18 10 13 15 8 #>   ..$ exp  : num [1:10] 15.76 17.23 18.6 9.09 8.95 ... #>   ..$ chi  : num [1:10] 0.311 0.426 -1.066 -0.361 -0.317 ... #>  $ chisq  : num 9.31 #>  $ df     : num 8 #>  $ p.value: num 0.317 #>  $ groups : num 10 #>  $ call   : language glm(formula = low ~ age, family = binomial, data = bwt) #>  - attr(*, \"class\")= chr \"HLtest\" summary(hlt0) #> Partition for Hosmer and Lemeshow Goodness-of-Fit Test  #>  #>              cut total obs       exp         chi #> 1  [0.128,0.231]    20  17 15.764147  0.31126591 #> 2   (0.231,0.26]    23  19 17.229899  0.42643885 #> 3    (0.26,0.29]    26  14 18.599113 -1.06641920 #> 4   (0.29,0.301]    13   8  9.088499 -0.36106223 #> 5  (0.301,0.312]    13   8  8.947209 -0.31666633 #> 6  (0.312,0.334]    25  18 16.793786  0.29434049 #> 7  (0.334,0.346]    18  10 11.779364 -0.51844629 #> 8  (0.346,0.357]    16  13 10.284015  0.84692725 #> 9  (0.357,0.381]    22  15 13.736398  0.34093679 #> 10 (0.381,0.418]    13   8  7.777571  0.07975704 #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ age, family = binomial, data = bwt) #>  ChiSquare df   P_value #>   9.307311  8 0.3170385 plot(hlt0)"},{"path":"https://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":null,"dir":"Reference","previous_headings":"","what":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"three-way frequency table crossing eye color hair color two places, Caithness Aberdeen, Scotland. data interest Fisher (1940) others mixtures people Nordic, Celtic Anglo-Saxon origin.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"format :","code":"num [1:4, 1:5, 1:2] 326 688 343 98 38 116 84 48 241 584 ... - attr(*, \"dimnames\")=List of 3 ..$ Eye  : chr [1:4] \"Blue\" \"Light\" \"Medium\" \"Dark\" ..$ Hair : chr [1:5] \"Fair\" \"Red\" \"Medium\" \"Dark\" ... ..$ Place: chr [1:2] \"Caithness\" \"Aberdeen\""},{"path":"https://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"data taken colors data logmult.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"One tables widely analyzed conjunction RC canonical correlation models categorical data, e.g., Becker Clogg (1989). hair eye colors ordered original source, suggesting form ordered categories.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"Becker, M. P., Clogg, C. C. (1989).  Analysis Sets Two-Way Contingency Tables Using Association Models.  Journal American Statistical Association, 84(405), 142-151. Fisher, R.. (1940) precision discriminant functions.  Annals Eugenics, 10, 422-429.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"","code":"data(HairEyePlace)  # separate mosaics mosaic(HairEyePlace[,,1], shade=TRUE, main=\"Caithness\")  mosaic(HairEyePlace[,,2], shade=TRUE, main=\"Aberdeen\")   # condition on Place mosaic(~Hair + Eye |Place, data=HairEyePlace, shade=TRUE, legend=FALSE)   cotabplot(~Hair+Eye|Place, data=HairEyePlace, shade=TRUE, legend=FALSE)"},{"path":"https://friendly.github.io/vcdExtra/reference/Hauser79.html","id":null,"dir":"Reference","previous_headings":"","what":"Hauser (1979) Data on Social Mobility — Hauser79","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"Hauser (1979) presented two-way frequency table, cross-classifying occupational categories sons fathers United States.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"frequency data frame 25 observations following 3 variables, representing cross-classification 19912 individuals father's occupation son's first occupation. Son factor levels UpNM LoNM UpM LoM Farm Father factor levels UpNM LoNM UpM LoM Farm Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"R.M. Hauser (1979), exploratory methods modeling mobility tables cross-classified data.  : K.F. Schuessler (Ed.), Sociological Methodology, 1980, Jossey-Bass, San Francisco, pp. 413-458. Table 1.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"good example exploring variety models square tables: quasi-independence, quasi-symmetry, row/column effects, uniform association, etc., using facilities gnm. Hauser's data first presented 1979, published 1980. name dataset reflects earliest use. reflects \"frequencies classification son's first full-time civilian occupation father's (family head's) occupation son's sixteenth birthday among American men aged 20 64 1973 currently enrolled school\". noted Hauser's Table 1, \"Counts based observations weighted estimate population counts compensate departures sampling design simple random sampling. Broad occupation groups upper nonmanual: professional kindred workers, managers officials, non-retail sales workers; lower nonmanual: proprietors, clerical kindred workers, retail sales workers; upper manual: craftsmen, foremen, kindred workers; lower manual: service workers, operatives kindred workers, laborers (except farm); farm: farmers farm managers, farm laborers, foremen. density mobility immobility cells refer.\" table levels Son Father arranged order decreasing status common mobility tables.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"Powers, D.. Xie, Y. (2008). Statistical Methods Categorical Data Analysis, Bingley, UK: Emerald.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"","code":"data(Hauser79) str(Hauser79) #> 'data.frame':\t25 obs. of  3 variables: #>  $ Son   : Factor w/ 5 levels \"UpNM\",\"LoNM\",..: 1 2 3 4 5 1 2 3 4 5 ... #>  $ Father: Factor w/ 5 levels \"UpNM\",\"LoNM\",..: 1 1 1 1 1 2 2 2 2 2 ... #>  $ Freq  : num  1414 521 302 643 40 ...  # display table structable(~Father+Son, data=Hauser79) #>        Son UpNM LoNM  UpM  LoM Farm #> Father                              #> UpNM       1414  521  302  643   40 #> LoNM        724  524  254  703   48 #> UpM         798  648  856 1676  108 #> LoM         756  914  771 3325  237 #> Farm        409  357  441 1611 1832  #Examples from Powers & Xie, Table 4.15 # independence model mosaic(Freq ~ Father + Son, data=Hauser79, shade=TRUE)   hauser.indep <- gnm(Freq ~ Father + Son,   data=Hauser79,   family=poisson)  mosaic(hauser.indep, ~Father+Son,        main=\"Independence model\",        gp=shading_Friendly)   # Quasi-independence hauser.quasi <-  update(hauser.indep,                         ~ . + Diag(Father,Son)) mosaic(hauser.quasi, ~Father+Son,        main=\"Quasi-independence model\",        gp=shading_Friendly)   # Quasi-symmetry hauser.qsymm <-  update(hauser.indep,                         ~ . + Diag(Father,Son) + Symm(Father,Son))  mosaic(hauser.qsymm, ~Father+Son,        main=\"Quasi-symmetry model\",        gp=shading_Friendly)    # numeric scores for row/column effects Sscore <- as.numeric(Hauser79$Son) Fscore <- as.numeric(Hauser79$Father)  # row effects model hauser.roweff <- update(hauser.indep, ~ . + Father*Sscore) LRstats(hauser.roweff) #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.roweff 2308.9 2324.7   2080.2 12  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # uniform association hauser.UA <- update(hauser.indep, ~ . + Fscore*Sscore) LRstats(hauser.UA) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.UA 2503.4 2515.6   2280.7 15  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # uniform association, omitting diagonals hauser.UAdiag <- update(hauser.indep, ~ . + Fscore*Sscore + Diag(Father,Son)) LRstats(hauser.UAdiag) #> Likelihood summary table: #>                  AIC BIC LR Chisq Df Pr(>Chisq)     #> hauser.UAdiag 305.72 324   73.007 10  1.161e-11 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # Levels for Hauser 5-level model levels <- matrix(c(   2,  4,  5,  5,  5,   3,  4,  5,  5,  5,   5,  5,  5,  5,  5,   5,  5,  5,  4,  4,   5,  5,  5,  4,  1   ), 5, 5, byrow=TRUE)  hauser.topo <- update(hauser.indep,                       ~ . + Topo(Father, Son, spec=levels))  mosaic(hauser.topo, ~Father+Son,        main=\"Topological model\", gp=shading_Friendly)   # RC model hauser.RC <- update(hauser.indep, ~ . + Mult(Father, Son), verbose=FALSE) mosaic(hauser.RC, ~Father+Son, main=\"RC model\", gp=shading_Friendly)  LRstats(hauser.RC) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.RC 920.16 939.66   685.45  9  < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # crossings models hauser.CR <- update(hauser.indep, ~ . + Crossings(Father,Son)) mosaic(hauser.topo, ~Father+Son, main=\"Crossings model\", gp=shading_Friendly)  LRstats(hauser.CR) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CR 318.63 334.47   89.914 12  5.131e-14 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  hauser.CRdiag <- update(hauser.indep, ~ . + Crossings(Father,Son) + Diag(Father,Son)) LRstats(hauser.CRdiag) #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CRdiag 298.95 318.45   64.237  9   2.03e-10 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1   # compare model fit statistics modlist <- glmlist(hauser.indep, hauser.roweff, hauser.UA, hauser.UAdiag,                    hauser.quasi, hauser.qsymm,  hauser.topo,                    hauser.RC, hauser.CR, hauser.CRdiag) sumry <- LRstats(modlist) sumry[order(sumry$AIC, decreasing=TRUE),] #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.indep  6390.8 6401.8   6170.1 16  < 2.2e-16 *** #> hauser.UA     2503.4 2515.6   2280.7 15  < 2.2e-16 *** #> hauser.roweff 2308.9 2324.7   2080.2 12  < 2.2e-16 *** #> hauser.RC      920.2  939.7    685.4  9  < 2.2e-16 *** #> hauser.quasi   914.1  931.1    683.3 11  < 2.2e-16 *** #> hauser.CR      318.6  334.5     89.9 12  5.131e-14 *** #> hauser.UAdiag  305.7  324.0     73.0 10  1.161e-11 *** #> hauser.CRdiag  298.9  318.5     64.2  9  2.030e-10 *** #> hauser.topo    295.3  311.1     66.6 12  1.397e-09 *** #> hauser.qsymm   268.2  291.3     27.4  6  0.0001193 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 # or, more simply LRstats(modlist, sortby=\"AIC\") #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.indep  6390.8 6401.8   6170.1 16  < 2.2e-16 *** #> hauser.UA     2503.4 2515.6   2280.7 15  < 2.2e-16 *** #> hauser.roweff 2308.9 2324.7   2080.2 12  < 2.2e-16 *** #> hauser.RC      920.2  939.7    685.4  9  < 2.2e-16 *** #> hauser.quasi   914.1  931.1    683.3 11  < 2.2e-16 *** #> hauser.CR      318.6  334.5     89.9 12  5.131e-14 *** #> hauser.UAdiag  305.7  324.0     73.0 10  1.161e-11 *** #> hauser.CRdiag  298.9  318.5     64.2  9  2.030e-10 *** #> hauser.topo    295.3  311.1     66.6 12  1.397e-09 *** #> hauser.qsymm   268.2  291.3     27.4  6  0.0001193 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  mods <- substring(rownames(sumry),8) with(sumry,   {plot(Df, AIC, cex=1.3, pch=19, xlab='Degrees of freedom', ylab='AIC')   text(Df, AIC, mods, adj=c(0.5,-.5), col='red', xpd=TRUE)   })"},{"path":"https://friendly.github.io/vcdExtra/reference/Heart.html","id":null,"dir":"Reference","previous_headings":"","what":"Sex, Occupation and Heart Disease — Heart","title":"Sex, Occupation and Heart Disease — Heart","text":"Classification individuals gender, occupational category occurrence heart disease","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heart.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sex, Occupation and Heart Disease — Heart","text":"3-dimensional array resulting cross-tabulating 3 variables 21522 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heart.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sex, Occupation and Heart Disease — Heart","text":"% Karger, 1980 Karger, (1980).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heart.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sex, Occupation and Heart Disease — Heart","text":"","code":"data(Heart) str(Heart) #>  'table' num [1:2, 1:2, 1:3] 254 759 431 10283 158 ... #>  - attr(*, \"dimnames\")=List of 3 #>   ..$ Disease: chr [1:2] \"Disease\" \"None\" #>   ..$ Gender : chr [1:2] \"Male\" \"Female\" #>   ..$ Occup  : chr [1:3] \"Unempl\" \"WhiteCol\" \"BlueCol\"  # Display the frequencies for occupational categories. # Each row is a 2 x 2 table vcd::structable(Disease + Gender ~ Occup, data=Heart) #>          Disease Disease         None        #>          Gender     Male Female  Male Female #> Occup                                        #> Unempl               254    431   759  10283 #> WhiteCol             158     52  3155   3082 #> BlueCol               87     16  2829    416  # display as fourfold plots vcd::cotabplot(~ Disease + Gender | Occup, data=Heart, panel = cotab_fourfold)"},{"path":"https://friendly.github.io/vcdExtra/reference/Heckman.html","id":null,"dir":"Reference","previous_headings":"","what":"Labour Force Participation of Married Women 1967-1971 — Heckman","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"1583 married women surveyed years 1967-1971, recording whether employed labor force.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heckman.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"5-dimensional \\(2^5\\) array resulting cross-tabulating 5 binary variables 1583 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heckman.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"Lindsey, J. K. (1993).  Models Repeated Measurements Oxford, UK: Oxford University Press, p. 185.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heckman.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"data, originally Heckman & Willis (1977) provide example modeling longitudinal categorical data, e.g., markov chain models dependence time. Lindsey (1993) fits initial set logistic regression models examining dependence employment 1971 (e1971) successive subsets previous years, e1970, e1969, ... e1967. Alternatively, one can examine markov chain models first-order (dependence previous year), second-order (dependence previous two years), etc.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heckman.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"% HeckmanWillis:77 Heckman, J.J. & Willis, R.J. (1977). \"beta-logistic model analysis sequential labor force participation married women.\"  Journal Political Economy, 85: 27-58","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Heckman.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"","code":"data(Heckman)  # independence model mosaic(Heckman, shade=TRUE)  # same, as a loglm() require(MASS) (heckman.mod0 <- loglm(~ e1971+e1970+e1969+e1968+e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 + e1970 + e1969 + e1968 + e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 3824.863 26        0 #> Pearson          8747.019 26        0 mosaic(heckman.mod0, main=\"Independence model\")   # first-order markov chain: bad fit (heckman.mod1 <- loglm(~ e1971*e1970 + e1970*e1969 +e1969*e1968 + e1968*e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 * e1970 + e1970 * e1969 + e1969 * e1968 +  #>     e1968 * e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 210.2251 22        0 #> Pearson          254.8971 22        0 mosaic(heckman.mod1, main=\"1st order markov chain model\")   # second-order markov chain: bad fit (heckman.mod2 <- loglm(~ e1971*e1970*e1969 + e1970*e1969*e1968 +e1969*e1968*e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 * e1970 * e1969 + e1970 * e1969 * e1968 +  #>     e1969 * e1968 * e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 62.67163 16 1.845162e-07 #> Pearson          75.99393 16 8.698373e-10 mosaic(heckman.mod2, main=\"2nd order markov chain model\")   # third-order markov chain: fits OK (heckman.mod3 <- loglm(~ e1971*e1970*e1969*e1968 + e1970*e1969*e1968*e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 * e1970 * e1969 * e1968 + e1970 * e1969 *  #>     e1968 * e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df  P(> X^2) #> Likelihood Ratio 9.023246  8 0.3403388 #> Pearson          8.155529  8 0.4184270 mosaic(heckman.mod2, main=\"3rd order markov chain model\")"},{"path":"https://friendly.github.io/vcdExtra/reference/HospVisits.html","id":null,"dir":"Reference","previous_headings":"","what":"Hospital Visits Data — HospVisits","title":"Hospital Visits Data — HospVisits","text":"Length stay hospital 132 schizophrenic patients, classified visiting patterns, originally Wing (1962).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hospital Visits Data — HospVisits","text":"3 3 frequency table, format:","code":"table [1:3, 1:3] 43 6 9 16 11 18 3 10 16 - attr(*, \"dimnames\")=List of 2 ..$ visit: chr [1:3] \"Regular\" \"Infrequent\" \"Never\" ..$ stay : chr [1:3] \"2-9\" \"10-19\" \"20+\""},{"path":"https://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hospital Visits Data — HospVisits","text":"Goodman, L. . (1983) analysis dependence cross-classifications ordered categories, using log-linear models frequencies log-linear models odds.  Biometrics, 39, 149-160.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hospital Visits Data — HospVisits","text":"table variables can considered ordinal. variable visit refers visiting patterns recorded hospital.  category labels abbreviations given Goodman (1983); e.g., \"Regular\" short “received visitors regularly patient went home”. variable stay refers length stay hospital, year groups.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hospital Visits Data — HospVisits","text":"Wing, J. K. (1962). Institutionalism Mental Hospitals, British Journal Social Clinical Psychology, 1 (1), 38-51.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hospital Visits Data — HospVisits","text":"","code":"data(HospVisits) mosaic(HospVisits, gp=shading_Friendly)   if(require(ca)){   ca(HospVisits)   # surprisingly 1D !   plot(ca(HospVisits))   }"},{"path":"https://friendly.github.io/vcdExtra/reference/HouseTasks.html","id":null,"dir":"Reference","previous_headings":"","what":"Household Tasks Performed by Husbands and Wives — HouseTasks","title":"Household Tasks Performed by Husbands and Wives — HouseTasks","text":"13 x 4 table frequencies household tasks performed couples, either Husband, Wife, Alternating Jointly.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HouseTasks.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Household Tasks Performed by Husbands and Wives — HouseTasks","text":"format :","code":"'table' int [1:13, 1:4] 36 11 24 51 13 1 1 14 20 46 ... - attr(*, \"dimnames\")=List of 2 ..$ Task: chr [1:13] \"Breakfast\" \"Dinner\" \"Dishes\" \"Driving\" ... ..$ Who : chr [1:4] \"Alternating\" \"Husband\" \"Jointly\" \"Wife\""},{"path":"https://friendly.github.io/vcdExtra/reference/HouseTasks.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Household Tasks Performed by Husbands and Wives — HouseTasks","text":"data set taken housetasks, 13 x 4 data.frame. table version, rows columns sorted alphabetically (typo corrected).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/HouseTasks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Household Tasks Performed by Husbands and Wives — HouseTasks","text":"","code":"data(HouseTasks) str(HouseTasks) #>  'table' int [1:13, 1:4] 36 11 24 51 13 1 1 14 20 46 ... #>  - attr(*, \"dimnames\")=List of 2 #>   ..$ Task: chr [1:13] \"Breakfast\" \"Dinner\" \"Dishes\" \"Driving\" ... #>   ..$ Who : chr [1:4] \"Alternating\" \"Husband\" \"Jointly\" \"Wife\"  chisq.test(HouseTasks) #>  #> \tPearson's Chi-squared test #>  #> data:  HouseTasks #> X-squared = 1944.5, df = 36, p-value < 2.2e-16 #>   # mosaic plot, illustrating some tweaks to handle overlapping labels require(vcd) mosaic(HouseTasks, shade = TRUE,        labeling = labeling_border(rot_labels = c(45,0, 0, 0),                                   offset_label =c(.5,5,0, 0),                                   varnames = c(FALSE, TRUE),                                   just_labels=c(\"center\",\"right\"),                                   tl_varnames = FALSE),        legend = FALSE)   # use seriation package to permute rows & cols using correspondence analysis if(require(seriation)) { order <- seriate(HouseTasks, method = \"CA\") # the permuted row and column labels rownames(HouseTasks)[order[[1]]] colnames(HouseTasks)[order[[2]]]  # do the permutation HT_perm <- permute(HouseTasks, order, margin=1)  mosaic(HT_perm, shade = TRUE,        labeling = labeling_border(rot_labels = c(45,0, 0, 0),                                   offset_label =c(.5,5,0, 0),                                   varnames = c(FALSE, TRUE),                                   just_labels=c(\"center\",\"right\"),                                   tl_varnames = FALSE),        legend = FALSE) } #> Loading required package: seriation"},{"path":"https://friendly.github.io/vcdExtra/reference/Hoyt.html","id":null,"dir":"Reference","previous_headings":"","what":"Minnesota High School Graduates — Hoyt","title":"Minnesota High School Graduates — Hoyt","text":"Minnesota high school graduates June 1930 classified respect () Rank thirds graduating class, (b) post-high school Status April 1939 (4 levels), (c) Sex, (d) father's Occupational status (7 levels, 1=High 7=Low).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Minnesota High School Graduates — Hoyt","text":"4-dimensional array resulting cross-tabulating 4 variables 13968 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Minnesota High School Graduates — Hoyt","text":"Fienberg, S. E. (1980). Analysis Cross-Classified Categorical Data. Cambridge, MA: MIT Press, p. 91-92. R. L. Plackett, (1974). Analysis Categorical Data. London: Griffin.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Minnesota High School Graduates — Hoyt","text":"data first presented Hoyt et al. (1959) analyzed Fienberg(1980), Plackett(1974) others. Post high-school Status natural consider response. Rank father's Occupation ordinal variables.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Minnesota High School Graduates — Hoyt","text":"Hoyt, C. J., Krishnaiah, P. R. Torrance, E. P. (1959) Analysis complex contingency tables, Journal Experimental Education 27, 187-194.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Minnesota High School Graduates — Hoyt","text":"","code":"data(Hoyt)  # display the table structable(Status + Sex ~ Rank + Occupation, data=Hoyt) #>                   Status College        School         Job        Other        #>                   Sex       Male Female   Male Female Male Female  Male Female #> Rank   Occupation                                                              #> Low    1                      87     53      3      7   17     13   105     76 #>        2                      72     36      6     16   18     11   209    111 #>        3                      52     52     17     28   14     49   541    521 #>        4                      88     48      9     18   14     29   328    191 #>        5                      32     12      1      5   12     10   124    101 #>        6                      14      9      2      1    5     15   148    130 #>        7                      20      3      3      1    4      6   109     88 #> Middle 1                     216    163      4     30   14     28   118    118 #>        2                     159    116     14     41   28     53   227    214 #>        3                     119    162     13     64   44    129   578    708 #>        4                     158    130     15     47   36     62   304    305 #>        5                      43     35      5     11    7     37   119    152 #>        6                      24     19      6     13   15     22   131    174 #>        7                      41     25      5      9   13     15    88    158 #> High   1                     256    309      2     17   10     38    53     89 #>        2                     176    225      8     49   22     68    95    210 #>        3                     119    243     10     79   33    184   257    448 #>        4                     144    237     12     57   20     63   115    219 #>        5                      42     72      2     20    7     21    56     95 #>        6                      24     42      2     10    4     19    61    105 #>        7                      32     36      2     14    4     19    41     93  # mosaic for independence model plot(Hoyt, shade=TRUE)   # examine all pairwise mosaics pairs(Hoyt, shade=TRUE)   # collapse Status to College vs. Non-College Hoyt1 <- collapse.table(Hoyt, Status=c(\"College\", rep(\"Non-College\",3))) plot(Hoyt1, shade=TRUE)   ################################################# # fitting models with loglm, plotting with mosaic #################################################  # fit baseline log-linear model for Status as response require(MASS) hoyt.mod0 <- loglm(~ Status + (Sex*Rank*Occupation),   data=Hoyt1) hoyt.mod0 #> Call: #> loglm(formula = ~Status + (Sex * Rank * Occupation), data = Hoyt1) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 2080.359 41        0 #> Pearson          2090.750 41        0  mosaic(hoyt.mod0,   gp=shading_Friendly,   main=\"Baseline model: Status + (Sex*Rank*Occ)\") #> Error in eval(expr, p): object 'Hoyt1' not found  # add one-way association of Status with factors hoyt.mod1 <- loglm(~ Status * (Sex + Rank + Occupation) + (Sex*Rank*Occupation),   data=Hoyt1) hoyt.mod1 #> Call: #> loglm(formula = ~Status * (Sex + Rank + Occupation) + (Sex *  #>     Rank * Occupation), data = Hoyt1) #>  #> Statistics: #>                       X^2 df   P(> X^2) #> Likelihood Ratio 50.10913 32 0.02175915 #> Pearson          49.33936 32 0.02578430  mosaic(hoyt.mod1,   gp=shading_Friendly,   main=\"Status * (Sex + Rank + Occ)\") #> Error in eval(expr, p): object 'Hoyt1' not found  # can we drop any terms? drop1(hoyt.mod1, test=\"Chisq\") #> Error in eval(expr, p): object 'Hoyt1' not found  # assess model fit anova(hoyt.mod0, hoyt.mod1) #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Status + (Sex * Rank * Occupation)  #> Model 2: #>  ~Status * (Sex + Rank + Occupation) + (Sex * Rank * Occupation)  #>  #>             Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   2080.35910 41                                     #> Model 2     50.10913 32 2030.24997         9        0.00000 #> Saturated    0.00000  0   50.10913        32        0.02176  # what terms to add? add1(hoyt.mod1, ~.^2, test=\"Chisq\") #> Error in eval(expr, p): object 'Hoyt1' not found  # add interaction of Sex:Occupation on Status hoyt.mod2 <- update(hoyt.mod1, ~ . + Status:Sex:Occupation)  mosaic(hoyt.mod2,   gp=shading_Friendly,   main=\"Adding Status:Sex:Occupation\") #> Error in eval(expr, p): object 'Hoyt1' not found  # compare model fits anova(hoyt.mod0, hoyt.mod1, hoyt.mod2) #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Status + (Sex * Rank * Occupation)  #> Model 2: #>  ~Status * (Sex + Rank + Occupation) + (Sex * Rank * Occupation)  #> Model 3: #>  ~Status + Sex + Rank + Occupation + Status:Sex + Status:Rank + Status:Occupation + Sex:Rank + Sex:Occupation + Rank:Occupation + Sex:Rank:Occupation + Status:Sex:Occupation  #>  #>             Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   2080.35910 41                                     #> Model 2     50.10913 32 2030.24997         9        0.00000 #> Model 3     21.01300 26   29.09613         6        0.00006 #> Saturated    0.00000  0   21.01300        26        0.74129  # Alternatively, try stepwise analysis, heading toward the saturated model steps <- step(hoyt.mod0,   direction=\"forward\",   scope=~Status*Sex*Rank*Occupation) #> Start:  AIC=2166.36 #> ~Status + (Sex * Rank * Occupation) #>  #> Error in eval(expr, p): object 'Hoyt1' not found  # display anova steps$anova #> Error: object 'steps' not found"},{"path":"https://friendly.github.io/vcdExtra/reference/ICU.html","id":null,"dir":"Reference","previous_headings":"","what":"ICU data set — ICU","title":"ICU data set — ICU","text":"ICU data set consists sample 200 subjects part much larger study survival patients following admission adult intensive care unit (ICU), derived Hosmer, Lemeshow Sturdivant (2013) Friendly (2000).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ICU.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"ICU data set — ICU","text":"data frame 200 observations following 22 variables. died Died discharge?, factor levels Yes age Patient age, numeric vector sex Patient sex, factor levels Female Male race Patient race, factor levels Black White.  Also represented white. service Service ICU Admission, factor levels Medical Surgical cancer Cancer part present problem?, factor levels Yes renal History chronic renal failure?, factor levels Yes infect Infection probable ICU admission?, factor levels Yes cpr Patient received CPR prior ICU admission?, factor levels Yes systolic Systolic blood pressure admission (mm Hg), numeric vector hrtrate Heart rate ICU Admission (beats/min), numeric vector previcu Previous admission ICU within 6 Months?, factor levels Yes admit Type admission, factor levels Elective Emergency fracture Admission long bone, multiple, neck, single area, hip fracture? factor levels Yes po2 PO2 initial blood gases, factor levels >60 <=60 ph pH initial blood gases, factor levels >=7.25 <7.25 pco PCO2 initial blood gases, factor levels <=45 >45 bic Bicarbonate (HCO3) level initial blood gases, factor levels >=18 <18 creatin Creatinine, initial blood gases, factor levels <=2 >2 coma Level unconsciousness admission ICU,\tfactor levels None Stupor Coma white recoding race,  factor levels White Non-white uncons recoding coma factor levels Yes","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ICU.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"ICU data set — ICU","text":"M. Friendly (2000), Visualizing Categorical Data, Appendix B.4. SAS Institute, Cary, NC. Hosmer, D. W. Jr., Lemeshow, S. Sturdivant, R. X. (2013) Applied Logistic Regression, NY: Wiley, Third Edition.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ICU.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ICU data set — ICU","text":"major goal study develop logistic regression model predict probability survival hospital discharge patients study risk factors associated ICU mortality. clinical details study described Lemeshow, Teres, Avrunin, Pastides (1988). data set often used illustrate model selection methods logistic regression. Patient ID numbers rownames data frame. Note last two variables white uncons recoding respectively race coma binary variables.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ICU.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ICU data set — ICU","text":"Lemeshow, S., Teres, D., Avrunin, J. S., Pastides, H. (1988). Predicting Outcome Intensive Care Unit Patients. Journal American Statistical Association, 83, 348-356.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ICU.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ICU data set — ICU","text":"","code":"data(ICU) # remove redundant variables (race, coma) ICU1 <- ICU[,-c(4,20)]  # fit full model icu.full <- glm(died ~ ., data=ICU1, family=binomial) summary(icu.full) #>  #> Call: #> glm(formula = died ~ ., family = binomial, data = ICU1) #>  #> Coefficients: #>                  Estimate Std. Error z value Pr(>|z|)     #> (Intercept)     -6.726704   2.385512  -2.820  0.00481 **  #> age              0.056393   0.018624   3.028  0.00246 **  #> sexMale          0.639725   0.531393   1.204  0.22864     #> serviceSurgical -0.673522   0.601902  -1.119  0.26315     #> cancerYes        3.107051   1.045846   2.971  0.00297 **  #> renalYes        -0.035708   0.801647  -0.045  0.96447     #> infectYes       -0.204933   0.553191  -0.370  0.71104     #> cprYes           1.053483   1.006614   1.047  0.29530     #> systolic        -0.015472   0.008497  -1.821  0.06864 .   #> hrtrate         -0.002769   0.009607  -0.288  0.77317     #> previcuYes       1.131942   0.671450   1.686  0.09183 .   #> admitEmergency   3.079583   1.081584   2.847  0.00441 **  #> fractureYes      1.411402   1.029705   1.371  0.17047     #> po2<=60          0.073822   0.857044   0.086  0.93136     #> ph<7.25          2.354078   1.208804   1.947  0.05148 .   #> pco>45          -3.018442   1.253448  -2.408  0.01604 *   #> bic<18          -0.709284   0.909777  -0.780  0.43561     #> creatin>2        0.295143   1.116925   0.264  0.79159     #> whiteNon-white   0.565729   0.926828   0.610  0.54160     #> unconsYes        5.232292   1.226303   4.267 1.98e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for binomial family taken to be 1) #>  #>     Null deviance: 200.16  on 199  degrees of freedom #> Residual deviance: 120.78  on 180  degrees of freedom #> AIC: 160.78 #>  #> Number of Fisher Scoring iterations: 6 #>   # simpler model (found from a \"best\" subsets procedure) icu.mod1 <- glm(died ~ age + sex + cancer + systolic + admit + uncons,   data=ICU1,   family=binomial) summary(icu.mod1) #>  #> Call: #> glm(formula = died ~ age + sex + cancer + systolic + admit +  #>     uncons, family = binomial, data = ICU1) #>  #> Coefficients: #>                 Estimate Std. Error z value Pr(>|z|)     #> (Intercept)    -5.884702   1.758997  -3.345 0.000821 *** #> age             0.038875   0.013130   2.961 0.003069 **  #> sexMale         0.524194   0.479374   1.093 0.274176     #> cancerYes       2.386534   0.896958   2.661 0.007798 **  #> systolic       -0.011683   0.006833  -1.710 0.087309 .   #> admitEmergency  3.171332   0.962323   3.295 0.000982 *** #> unconsYes       3.934575   0.961746   4.091 4.29e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for binomial family taken to be 1) #>  #>     Null deviance: 200.16  on 199  degrees of freedom #> Residual deviance: 134.38  on 193  degrees of freedom #> AIC: 148.38 #>  #> Number of Fisher Scoring iterations: 6 #>   # even simpler model icu.mod2 <- glm(died ~ age + cancer  + admit + uncons,   data=ICU1,   family=binomial) summary(icu.mod2) #>  #> Call: #> glm(formula = died ~ age + cancer + admit + uncons, family = binomial,  #>     data = ICU1) #>  #> Coefficients: #>                Estimate Std. Error z value Pr(>|z|)     #> (Intercept)    -6.86978    1.31882  -5.209 1.90e-07 *** #> age             0.03718    0.01277   2.911 0.003600 **  #> cancerYes       2.09711    0.83847   2.501 0.012381 *   #> admitEmergency  3.10218    0.91860   3.377 0.000733 *** #> unconsYes       3.70546    0.87647   4.228 2.36e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for binomial family taken to be 1) #>  #>     Null deviance: 200.16  on 199  degrees of freedom #> Residual deviance: 139.13  on 195  degrees of freedom #> AIC: 149.13 #>  #> Number of Fisher Scoring iterations: 6 #>   anova(icu.mod2, icu.mod1, icu.full, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: died ~ age + cancer + admit + uncons #> Model 2: died ~ age + sex + cancer + systolic + admit + uncons #> Model 3: died ~ age + sex + service + cancer + renal + infect + cpr +  #>     systolic + hrtrate + previcu + admit + fracture + po2 + ph +  #>     pco + bic + creatin + white + uncons #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi)   #> 1       195     139.13                        #> 2       193     134.38  2   4.7582  0.09263 . #> 3       180     120.78 13  13.5981  0.40274   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  ## Reproduce Fig 6.12 from VCD  icu.fit <- data.frame(ICU, prob=predict(icu.mod2, type=\"response\"))  # combine categorical risk factors to a single string risks <- ICU[, c(\"cancer\", \"admit\", \"uncons\")] risks[,1] <- ifelse(risks[,1]==\"Yes\", \"Cancer\", \"\") risks[,2] <- ifelse(risks[,2]==\"Emergency\", \"Emerg\", \"\") risks[,3] <- ifelse(risks[,3]==\"Yes\", \"Uncons\", \"\") risks <- apply(risks, 1, paste, collapse=\"\") risks[risks==\"\"] <- \"(none)\" icu.fit$risks <- risks  library(ggplot2) ggplot(icu.fit, aes(x=age, y=prob, color=risks)) +   geom_point(size=2) +   geom_line(size=1.25, alpha=0.5) +   theme_bw() + ylab(\"Probability of death\")"},{"path":"https://friendly.github.io/vcdExtra/reference/JobSat.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-classification of job satisfaction by income — JobSat","title":"Cross-classification of job satisfaction by income — JobSat","text":"data set contingency table job satisfaction income small sample black males 1996 General Social Survey, used Agresti (2002) example.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/JobSat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cross-classification of job satisfaction by income — JobSat","text":"4 x 4 contingency table income satisfaction, following structure:","code":"table [1:4, 1:4] 1 2 1 0 3 3 6 1 10 10 ...   - attr(*, \"dimnames\")=List of 2   ..$ income      : chr [1:4] \"< 15k\" \"15-25k\" \"25-40k\" \"> 40k\"   ..$ satisfaction: chr [1:4] \"VeryD\" \"LittleD\" \"ModerateS\" \"VeryS\""},{"path":"https://friendly.github.io/vcdExtra/reference/JobSat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Cross-classification of job satisfaction by income — JobSat","text":"Agresti, . Categorical Data Analysis John Wiley & Sons, 2002, Table 2.8, p. 57.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/JobSat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-classification of job satisfaction by income — JobSat","text":"income satisfaction ordinal variables, ordered table.  Measures association, visualizations, models take ordinality account.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/JobSat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-classification of job satisfaction by income — JobSat","text":"","code":"data(JobSat) assocstats(JobSat) #>                     X^2 df P(> X^2) #> Likelihood Ratio 6.7641  9  0.66167 #> Pearson          5.9655  9  0.74336 #>  #> Phi-Coefficient   : NA  #> Contingency Coeff.: 0.242  #> Cramer's V        : 0.144  GKgamma(JobSat) #> gamma        : 0.221  #> std. error   : 0.117  #> CI           : -0.009 0.451"},{"path":"https://friendly.github.io/vcdExtra/reference/Kway.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit All K-way Models in a GLM — Kway","title":"Fit All K-way Models in a GLM — Kway","text":"Generate fit 0-way, 1-way, 2-way, ... k-way terms glm.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Kway.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit All K-way Models in a GLM — Kway","text":"","code":"Kway(formula, family = poisson, data, ..., order = nt, prefix = \"kway\")"},{"path":"https://friendly.github.io/vcdExtra/reference/Kway.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit All K-way Models in a GLM — Kway","text":"formula two-sided formula 1-way effects model. LHS response, RHS first-order terms connected + signs. family description error distribution link function used model.  can character string naming family function, family function result call family function. (See family details family functions.) data optional data frame, list environment (object coercible .data.frame data frame) containing variables model. found data, variables taken environment(formula), typically environment glm called. ... arguments passed glm order Highest order interaction models generated. Defaults number terms model formula. prefix Prefix used label models fit glmlist object.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Kway.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit All K-way Models in a GLM — Kway","text":"object class glmlist, length order+1 containing 0-way, 1-way, ...  models degree order.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Kway.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit All K-way Models in a GLM — Kway","text":"function designed mainly hierarchical loglinear models (glms poisson family), desired find highest-order terms necessary achieve satisfactory fit. Using anova resulting glmlist object give sequential tests pooled contributions terms degree \\(k+1\\) degree \\(k\\). function also intended example generating function glmlist objects, facilitate model comparison, extraction, summary plotting model components, etc., perhaps using lapply similar. y response formula, 0-way (null) model y ~ 1.  1-way (\"main effects\") model specified formula argument.  k-way model generated using formula . ~ .^k. default order = nt, final model saturated model. presently written, function requires two-sided formula explicit response LHS. frequency data table form (e.g., produced xtabs) data argument coerced data.frame, supply formula form Freq ~  ....","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Kway.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fit All K-way Models in a GLM — Kway","text":"Michael Friendly Heather Turner","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Kway.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit All K-way Models in a GLM — Kway","text":"","code":"## artificial data factors <- expand.grid(A=factor(1:3),                        B=factor(1:2),                        C=factor(1:3),                        D=factor(1:2)) Freq <- rpois(nrow(factors), lambda=40) df <- cbind(factors, Freq)  mods3 <- Kway(Freq ~ A + B + C, data=df, family=poisson) LRstats(mods3) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq)   #> kway.0 249.69 251.28   49.216 35    0.05601 . #> kway.1 256.21 265.71   45.735 30    0.03293 * #> kway.2 256.64 278.81   30.168 22    0.11444   #> kway.3 258.52 287.02   24.042 18    0.15366   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 mods4 <- Kway(Freq ~ A + B + C + D, data=df, family=poisson) LRstats(mods4) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq)   #> kway.0 249.69 251.28   49.216 35    0.05601 . #> kway.1 258.17 269.25   45.690 29    0.02518 * #> kway.2 255.38 287.05   16.902 16    0.39196   #> kway.3 265.50 316.18    3.028  4    0.55313   #> kway.4 270.48 327.48    0.000  0    1.00000   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # JobSatisfaction data data(JobSatisfaction, package=\"vcd\") modSat <- Kway(Freq ~ management+supervisor+own,                data=JobSatisfaction,                family=poisson, prefix=\"JobSat\") LRstats(modSat) #> Likelihood summary table: #>              AIC     BIC LR Chisq Df Pr(>Chisq)     #> JobSat.0 260.251 260.330  208.775  7     <2e-16 *** #> JobSat.1 175.472 175.790  117.997  4     <2e-16 *** #> JobSat.2  63.541  64.097    0.065  1     0.7989     #> JobSat.3  65.476  66.111    0.000  0     1.0000     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 anova(modSat, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ 1 #> Model 2: Freq ~ management + supervisor + own #> Model 3: Freq ~ management + supervisor + own + management:supervisor +  #>     management:own + supervisor:own #> Model 4: Freq ~ management + supervisor + own + management:supervisor +  #>     management:own + supervisor:own + management:supervisor:own #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi)     #> 1         7    208.775                          #> 2         4    117.997  3   90.778   <2e-16 *** #> 3         1      0.065  3  117.932   <2e-16 *** #> 4         0      0.000  1    0.065   0.7989     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  # Rochdale data: very sparse, in table form data(Rochdale, package=\"vcd\") if (FALSE) { # \\dontrun{ modRoch <- Kway(Freq~EconActive + Age + HusbandEmployed + Child +                      Education + HusbandEducation + Asian + HouseholdWorking,                 data=Rochdale, family=poisson) LRstats(modRoch) } # }"},{"path":"https://friendly.github.io/vcdExtra/reference/LRstats.html","id":null,"dir":"Reference","previous_headings":"","what":"Brief Summary of Model Fit for glm and loglm Models — LRstats","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"glm objects, print summary methods give much information one wants see brief summary model goodness fit, easy way display compact comparison model goodness fit collection models fit data. loglm models equivalent glm forms, print summary methods give quite different results.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/LRstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"","code":"LRstats(object, ...)  # S3 method for class 'glmlist' LRstats(object, ..., saturated = NULL, sortby = NULL)  # S3 method for class 'loglmlist' LRstats(object, ..., saturated = NULL, sortby = NULL)  # Default S3 method LRstats(object, ..., saturated = NULL, sortby = NULL)"},{"path":"https://friendly.github.io/vcdExtra/reference/LRstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"object fitted model object exists logLik method extract corresponding log-likelihood ... optionally fitted model objects saturated saturated model log likelihood reference value (use 0 deviance available) sortby either numeric character string specifying column result rows sorted (decreasing order)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/LRstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"data frame (also class anova) columns c(\"AIC\", \"BIC\", \"LR Chisq\", \"Df\", \"Pr(>Chisq)\"). Row names taken names model object(s).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/LRstats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"LRstats provides brief summary one models fit dataset logLik nobs methods exist (e.g., glm loglm models). %implementation experimental, subject change. function relies residual degrees freedom LR chisq test available model object.  true objects inheriting lm, glm, loglm, polr negbin.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/LRstats.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"Achim Zeileis","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/LRstats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"","code":"data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) LRstats(indep) #> Likelihood summary table: #>          AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep 209.59 220.19   47.418 15  3.155e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)  # compare models LRstats(indep, coleff, roweff, linlin) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep  209.59 220.19   47.418 15  3.155e-05 *** #> coleff 179.00 195.50    6.829 10     0.7415     #> roweff 174.45 188.59    6.281 12     0.9013     #> linlin 174.07 185.85    9.895 14     0.7698     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"},{"path":"https://friendly.github.io/vcdExtra/reference/Mammograms.html","id":null,"dir":"Reference","previous_headings":"","what":"Mammogram Ratings — Mammograms","title":"Mammogram Ratings — Mammograms","text":"Kundel & Polansky (2003) give (possibly contrived) data set 110 mammograms rated two readers.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mammograms.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mammogram Ratings — Mammograms","text":"frequency table matrix form.  format :","code":"num [1:4, 1:4] 34 6 2 0 10 8 5 1 2 8 ... - attr(*, \"dimnames\")=List of 2 ..$ Reader2: chr [1:4] \"Absent\" \"Minimal\" \"Moderate\" \"Severe\" ..$ Reader1: chr [1:4] \"Absent\" \"Minimal\" \"Moderate\" \"Severe\""},{"path":"https://friendly.github.io/vcdExtra/reference/Mammograms.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mammogram Ratings — Mammograms","text":"Kundel, H. L. & Polansky, M. (2003), \"Measurement Observer Agreement\", Radiology, 228, 303-308, Table A1","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mammograms.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mammogram Ratings — Mammograms","text":"","code":"data(Mammograms) B <- agreementplot(Mammograms, main=\"Mammogram ratings\")  # agreement measures B #> $Bangdiwala #>           [,1] #> [1,] 0.4272076 #>  #> $Bangdiwala_Weighted #>           [,1] #> [1,] 0.8366481 #>  #> $weights #> [1] 1.0000000 0.8888889 #>  Kappa(Mammograms) #>             value     ASE      z #> Unweighted 0.3713 0.06033  6.154 #> Weighted   0.5964 0.04923 12.114  ## other displays mosaic(Mammograms, shade=TRUE)   sieve(Mammograms, pop = FALSE, shade = TRUE) labeling_cells(text = Mammograms,   gp_text = gpar(fontface = 2, cex=1.75))(as.table(Mammograms))"},{"path":"https://friendly.github.io/vcdExtra/reference/Mental.html","id":null,"dir":"Reference","previous_headings":"","what":"Mental Impairment and Parents SES — Mental","title":"Mental Impairment and Parents SES — Mental","text":"6 x 4 contingency table representing cross-classification mental health status (mental) 1660 young New York residents parents' socioeconomic status (ses).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mental.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mental Impairment and Parents SES — Mental","text":"data frame frequency table 24 observations following 3 variables. ses ordered factor levels 1 < 2 < 3 < 4 < 5 < 6 mental ordered factor levels Well < Mild < Moderate < Impaired Freq cell frequency: numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mental.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mental Impairment and Parents SES — Mental","text":"Haberman, S. J.  Analysis Qualitative Data: New Developments, Academic Press, 1979, Vol. II, p. 375. Srole, L.; Langner, T. S.; Michael, S. T.; Kirkpatrick, P.; Opler, M. K. & Rennie, T. . C.  Mental Health Metropolis: Midtown Manhattan Study, NYU Press, 1978, p. 289","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mental.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mental Impairment and Parents SES — Mental","text":"ses mental can treated ordered factors integer scores.  ses, 1=\"High\" 6=\"Low\".","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mental.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mental Impairment and Parents SES — Mental","text":"Friendly, M. Visualizing Categorical Data, Cary, NC: SAS Institute, 2000, Appendix B.7.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mental.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mental Impairment and Parents SES — Mental","text":"","code":"data(Mental) str(Mental) #> 'data.frame':\t24 obs. of  3 variables: #>  $ ses   : Ord.factor w/ 6 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 1 1 1 1 2 2 2 2 3 3 ... #>  $ mental: Ord.factor w/ 4 levels \"Well\"<\"Mild\"<..: 1 2 3 4 1 2 3 4 1 2 ... #>  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ... (Mental.tab <- xtabs(Freq ~ ses + mental, data=Mental)) #>    mental #> ses Well Mild Moderate Impaired #>   1   64   94       58       46 #>   2   57   94       54       40 #>   3   57  105       65       60 #>   4   72  141       77       94 #>   5   36   97       54       78 #>   6   21   71       54       71  # mosaic and sieve plots mosaic(Mental.tab, gp=shading_Friendly)  sieve(Mental.tab, gp=shading_Friendly)   if(require(ca)){   plot(ca(Mental.tab), main=\"Mental impairment & SES\", lines=TRUE) }"},{"path":"https://friendly.github.io/vcdExtra/reference/Mice.html","id":null,"dir":"Reference","previous_headings":"","what":"Mice Depletion Data — Mice","title":"Mice Depletion Data — Mice","text":"Data Kastenbaum Lamphiear (1959). table gives number depletions (deaths) 657 litters mice, classified litter size treatment.  data set become classic analysis contingency tables, yet unfortunately little information details experiment published.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mice.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mice Depletion Data — Mice","text":"frequency data frame 30 observations following 4 variables, representing 5 x 2 x 3 contingency table. litter litter size, numeric vector treatment treatment, factor levels B deaths number depletions, factor levels 0 1 2+ Freq cell frequency, numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mice.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mice Depletion Data — Mice","text":"Goodman, L. . (1983) analysis dependence cross-classifications ordered categories, using log-linear models frequencies log-linear models odds. Biometrics, 39, 149-160.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mice.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mice Depletion Data — Mice","text":"Kastenbaum, M. . & Lamphiear, D. E. (1959) Calculation chi-square calculate three-factor interaction hypothesis. Biometrics, 15, 107-115.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mice.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mice Depletion Data — Mice","text":"","code":"data(Mice) # make a table ftable(mice.tab <- xtabs(Freq ~ litter + treatment + deaths, data=Mice)) #>                  deaths  0  1 2+ #> litter treatment                 #> 7      A                58 11  5 #>        B                75 19  7 #> 8      A                49 14 10 #>        B                58 17  8 #> 9      A                33 18 15 #>        B                45 22 10 #> 10     A                15 13 15 #>        B                39 22 18 #> 11     A                 4 12 17 #>        B                 5 15  8  #library(vcd) vcd::mosaic(mice.tab, shade=TRUE)"},{"path":"https://friendly.github.io/vcdExtra/reference/Mobility.html","id":null,"dir":"Reference","previous_headings":"","what":"Social Mobility data — Mobility","title":"Social Mobility data — Mobility","text":"Data social mobility, recording occupational category fathers sons.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mobility.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Social Mobility data — Mobility","text":"2-dimensional array resulting cross-tabulating 2 variables 19912 observations. variable names levels :","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Mobility.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Social Mobility data — Mobility","text":"Falguerolles, . de Mathieu, J. R. (1988).  Proceedings COMPSTAT 88, Copenhagen, Denmark, Springer-Verlag. % FeathermanHauser:78 Featherman, D. L. Hauser, R. M. Occupations social mobility United States.  Sociological Microjournal, 12, Fiche 62. Copenhagen: Sociological Institute.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Mobility.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Social Mobility data — Mobility","text":"","code":"data(Mobility) Mobility #>               Father_Occupation #> Son_Occupation UpNonMan LoNonMan UpManual LoManual Farm #>       UpNonMan     1414      724      798      756  409 #>       LoNonMan      521      524      648      914  357 #>       UpManual      302      254      856      771  441 #>       LoManual      643      703     1676     3325 1611 #>       Farm           40       48      108      237 1832  # independence model MASS::loglm(~Father_Occupation + Son_Occupation, data = Mobility) #> Call: #> MASS::loglm(formula = ~Father_Occupation + Son_Occupation, data = Mobility) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 6170.130 16        0 #> Pearson          7166.771 16        0  vcd::mosaic(Mobility, shade=TRUE, legend = FALSE)"},{"path":"https://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":null,"dir":"Reference","previous_headings":"","what":"Publications of PhD Candidates — PhdPubs","title":"Publications of PhD Candidates — PhdPubs","text":"data set giving number publications doctoral candidates biochemistry relation various predictors, originally Long (1997).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Publications of PhD Candidates — PhdPubs","text":"data frame 915 observations following 6 variables. articles number articles published final three years PhD studies female dummy variable gender, coded 1 female married dummy variable marital status, coded 1 married kid5 number young children, age 5 phdprestige prestige PhD department.  higher number prestigious program. mentor number publications mentor preceeding three years","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Publications of PhD Candidates — PhdPubs","text":"Long, J. S. (1997). Regression Models Categorical Limited Dependent Variables, Sage. Long, J. S. & Freese, J. (2006). Regression Models Categorical Dependent Variables Using Stata, 2nd Ed., Stata Press.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Publications of PhD Candidates — PhdPubs","text":"large number zero counts. evidence separate group non-publishers? version data set, phdprestige rounded nearest integer. Stata version continuous values subsequently found https://www.stata-press.com/data/lf2/couart2.dta","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Publications of PhD Candidates — PhdPubs","text":"","code":"data(PhdPubs) # very uninformative hist(PhdPubs$articles,      breaks=0:19, col=\"pink\", xlim=c(0,20),      xlab=\"Number of Articles\")   library(vcd) rootogram(goodfit(PhdPubs$articles), xlab=\"Number of Articles\")   # compare with negative binomial rootogram(goodfit(PhdPubs$articles, type=\"nbinomial\"),   xlab=\"Number of Articles\", main=\"Negative binomial\")"},{"path":"https://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":null,"dir":"Reference","previous_headings":"","what":"Shakespeare's Word Type Frequencies — ShakeWords","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"data set, Efron Thisted (1976), gives number distinct words types (Freq) words appeared exactly , twice, etc. 100 times (count) complete works Shakespeare.  works, Shakespeare used 31,534 distinct words (types), comprising 884,647 words total.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"data frame 100 observations following 2 variables. count number times word type appeared Shakespeare's written works Freq number different words (types) appearing count.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"Bradley Efron Ronald Thisted (1976). Estimating Number Unseen Species: Many Words Shakespeare Know? Biometrika, Vol. 63, . 3, pp. 435-447, %http://www.jstor.org/stable/2335721","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"Efron & Thisted used data ask question, \"many words Shakespeare know?\"  Put another way, suppose another new corpus works Shakespeare discovered, also 884,647 words. many new word types appear? answer main question involves contemplating infinite number new corpora. addition words appear 1:100 times, 846 words appear 100 times, listed data set.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"","code":"data(ShakeWords) str(ShakeWords) #> 'data.frame':\t100 obs. of  2 variables: #>  $ count: int  1 2 3 4 5 6 7 8 9 10 ... #>  $ Freq : num  14376 4343 2292 1463 1043 ...  plot(sqrt(Freq) ~ count, data=ShakeWords)"},{"path":"https://friendly.github.io/vcdExtra/reference/Summarise.html","id":null,"dir":"Reference","previous_headings":"","what":"Brief Summary of Model Fit for glm and loglm Models — Summarise","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"glm objects, print summary methods give much information one wants see brief summary model goodness fit, easy way display compact comparison model goodness fit collection models fit data. loglm models equivalent glm forms, print summary methods give quite different results.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Summarise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"","code":"Summarise(object, ...)  # S3 method for class 'glmlist' Summarise(object, ..., saturated = NULL, sortby = NULL)  # S3 method for class 'loglmlist' Summarise(object, ..., saturated = NULL, sortby = NULL)  # Default S3 method Summarise(object, ..., saturated = NULL, sortby = NULL)"},{"path":"https://friendly.github.io/vcdExtra/reference/Summarise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"object fitted model object exists logLik method extract corresponding log-likelihood ... optionally fitted model objects saturated saturated model log likelihood reference value (use 0 deviance available) sortby either numeric character string specifying column result rows sorted (decreasing order)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Summarise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"data frame (also class anova) columns c(\"AIC\", \"BIC\", \"LR Chisq\", \"Df\", \"Pr(>Chisq)\"). Row names taken names model object(s).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Summarise.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"Summarise provides brief summary one models fit dataset logLik nobs methods exist (e.g., glm loglm models). function relies residual degrees freedom LR chisq test available model object.  true objects inheriting lm, glm, loglm, polr negbin.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/Summarise.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"Achim Zeileis","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Summarise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"","code":"data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) Summarise(indep) #> Likelihood summary table: #>          AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep 209.59 220.19   47.418 15  3.155e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)  # compare models Summarise(indep, coleff, roweff, linlin) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep  209.59 220.19   47.418 15  3.155e-05 *** #> coleff 179.00 195.50    6.829 10     0.7415     #> roweff 174.45 188.59    6.281 12     0.9013     #> linlin 174.07 185.85    9.895 14     0.7698     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"},{"path":"https://friendly.github.io/vcdExtra/reference/TV.html","id":null,"dir":"Reference","previous_headings":"","what":"TV Viewing Data — TV","title":"TV Viewing Data — TV","text":"data set TV comprises 5 x 11 x 3 contingency table based audience viewing data Neilsen Media Research week starting November 6, 1995.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/TV.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"TV Viewing Data — TV","text":"5 x 11 x 3 array cell frequencies following structure:","code":"int [1:5, 1:11, 1:3] 146 244 233 174 294 151 181 161 183 281 ...   - attr(*, \"dimnames\")=List of 3   ..$ Day    : chr [1:5] \"Monday\" \"Tuesday\" \"Wednesday\" \"Thursday\" ...   ..$ Time   : chr [1:11] \"8:00\" \"8:15\" \"8:30\" \"8:45\" ...   ..$ Network: chr [1:3] \"ABC\" \"CBS\" \"NBC\""},{"path":"https://friendly.github.io/vcdExtra/reference/TV.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"TV Viewing Data — TV","text":"original data, tv.dat, came initial implementation mosaic displays R Jay Emerson (1998). Similar data used Hartigan Kleiner (1984) illustration.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/TV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"TV Viewing Data — TV","text":"original data, tv.dat, contains two additional networks: \"Fox\" \"\", small frequencies. levels removed current version. also fourth factor, transition State transition (turn television , Switch channels, Persist viewing current channel). TV data includes Persist observations.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/TV.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"TV Viewing Data — TV","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Emerson, John W. Mosaic Displays S-PLUS: General Implementation Case Study. Statistical Graphics Computing Newsletter, 1998, 9(1), 17–23, http://www.stat.yale.edu/~jay/R/mosaic/v91.pdf Hartigan, J. . & Kleiner, B. Mosaic Television Ratings. American Statistician, 1984, 38, 32-35.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/TV.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"TV Viewing Data — TV","text":"","code":"data(TV) structable(TV) #>                   Time 8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30 #> Day       Network                                                                #> Monday    ABC           146  151  156   83  325  350  386  340   352   280   278 #>           CBS           337  293  304  233  311  251  241  164   252   265   272 #>           NBC           263  219  236  140  226  235  239  246   279   263   283 #> Tuesday   ABC           244  181  231  205  385  283  345  192   329   351   364 #>           CBS           173  180  184  109  218  235  256  250   274   263   261 #>           NBC           315  254  280  241  370  214  195  111   188   190   210 #> Wednesday ABC           233  161  194  156  339  264  279  140   237   228   203 #>           CBS           158  126  207   59   98  103  122   86   109   105   110 #>           NBC           134  146  166   66  194  230  264  143   274   289   306 #> Thursday  ABC           174  183  197  181  187  198  211   86   110   122   117 #>           CBS           196  185  195  104  106  116  116   47   102    84    84 #>           NBC           515  463  472  477  590  473  446  349   649   705   747 #> Friday    ABC           294  281  305  239  278  246  245  138   246   232   233 #>           CBS           130  144  154   81  129  153  136  126   138   136   152 #>           NBC           195  220  248  160  172  164  169   85   183   198   204 doubledecker(TV)   # reduce number of levels of Time TV.df <- as.data.frame.table(TV) levels(TV.df$Time) <- rep(c(\"8:00-8:59\", \"9:00-9:59\", \"10:00-10:44\"),                           c(4, 4, 3))  TV2 <- xtabs(Freq ~ Day + Time + Network, TV.df)  # re-label for mosaic display levels(TV.df$Time) <- c(\"8\", \"9\", \"10\") # fit mode of joint independence, showing association of Network with Day*Time mosaic(~ Day + Network + Time,   data = TV.df,   expected = ~ Day:Time + Network,   legend = FALSE)    # with doubledecker arrangement mosaic(~ Day + Network + Time,   data = TV.df,   expected = ~ Day:Time + Network,   split = c(TRUE, TRUE, FALSE),   spacing = spacing_highlighting,   legend = FALSE)"},{"path":"https://friendly.github.io/vcdExtra/reference/Titanicp.html","id":null,"dir":"Reference","previous_headings":"","what":"Passengers on the Titanic — Titanicp","title":"Passengers on the Titanic — Titanicp","text":"Data passengers RMS Titanic, excluding Crew individual identifier variables.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Passengers on the Titanic — Titanicp","text":"data frame 1309 observations following 6 variables. pclass factor levels 1st 2nd 3rd survived factor levels died survived sex factor levels female male age passenger age years (fractions year, children), numeric vector; age missing 263 passengers sibsp number siblings spouses aboard, integer: 0:8 parch number parents children aboard, integer: 0:6","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Passengers on the Titanic — Titanicp","text":"original R source dataset compiled Frank Harrell Robert Dawson: https://hbiostat.org/data/repo/titanic.txt, described detail https://hbiostat.org/data/repo/titanic version Titanic data, passenger details deleted, survived cast factor, name changed Titanicp minimize confusion versions.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Passengers on the Titanic — Titanicp","text":"number related versions Titanic data, various formats. version derived ptitanic rpart.plot package, modifying remove Class 'labelled' attributes variables (inherited Frank Harrell's titanic3 version) caused problems applications, notably ggplot2. versions: Titanic 4-way frequency table 2201 people aboard Titanic, including passengers crew.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Passengers on the Titanic — Titanicp","text":"","code":"data(Titanicp) ## maybe str(Titanicp) ; plot(Titanicp) ..."},{"path":"https://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":null,"dir":"Reference","previous_headings":"","what":"Toxaemia Symptoms in Pregnancy — Toxaemia","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"Brown et al (1983) gave data two signs toxaemia, abnormal condition pregnancy characterized high blood pressure (hypertension) high levels protein urine.  untreated, mother baby risk complications death.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"data frame frequency form representing 5 x 3 x 2 x 2 contingency table, 60 observations following 5 variables. class Social class mother, factor levels 1 2 3 4 5 smoke Cigarettes smoked per day pregnancy, factor levels 0 1-19 20+ hyper Hypertension level, factor levels Low High urea Protein urea level, factor levels Low High Freq frequency cell, numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"Brown, P. J., Stone, J. Ord-Smith, C. (1983), Toxaemic signs pregnancy. JRSS, Series C, Applied Statistics, 32, 69-72","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"data frame Toxaemia represents 13384 expectant mothers Bradford, England first pregnancy, also classified according social class number cigarettes smoked per day.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"Friendly, M.  (2000), Visualizing Categorical Data, SAS Institute, Cary, NC, Example 7.15. Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Example 10.10.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"","code":"data(Toxaemia)  tox.tab <- xtabs(Freq ~ class + smoke + hyper + urea, Toxaemia) ftable(tox.tab, row.vars=1) #>       smoke    0                1-19                 20+                #>       hyper  Low      High       Low      High       Low      High      #>       urea   Low High  Low High  Low High  Low High  Low High  Low High #> class                                                                   #> 1            286   21   82   28   71    5   24    5   13    0    3    1 #> 2            785   34  266   50  284   17   92   13   34    3   15    0 #> 3           3160  164 1101  278 2300  142  492  120  383   32   92   16 #> 4            656   52  213   63  649   46  129   35  163   12   40    7 #> 5            245   23   78   20  321   34   74   22   65    4   14    7   # symptoms by smoking mosaic(~smoke + hyper + urea, data=tox.tab, shade=TRUE)   # symptoms by social class mosaic(~class + hyper + urea, data=tox.tab, shade=TRUE)   # predictors mosaic(~smoke + class, data=tox.tab, shade=TRUE)   # responses mosaic(~hyper + urea, data=tox.tab, shade=TRUE)   # log odds ratios for urea and hypertension, by class and smoke if (FALSE) { # \\dontrun{ LOR <-loddsratio(aperm(tox.tab)) LOR } # }"},{"path":"https://friendly.github.io/vcdExtra/reference/Vietnam.html","id":null,"dir":"Reference","previous_headings":"","what":"Student Opinion about the Vietnam War — Vietnam","title":"Student Opinion about the Vietnam War — Vietnam","text":"survey student opinion Vietnam War taken University North Carolina Chapel Hill May 1967 published student newspaper. Students asked fill ballot papers stating policy ,B,C D supported. Responses cross-classified gender/year.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Student Opinion about the Vietnam War — Vietnam","text":"frequency data frame 40 observations representing 2 x 5 x 4 contingency table following 4 variables. sex factor levels Female Male year year study, ordered factor levels Freshmen, Sophomore, Junior, Senior, Grad student response factor levels B C D Freq cell frequency, numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Student Opinion about the Vietnam War — Vietnam","text":"Aitken, M. etal, 1989, Statistical Modelling GLIM","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Student Opinion about the Vietnam War — Vietnam","text":"response categories : Defeat North Vietnam widespread bombing land invasion B Maintain present policy C De-escalate military activity, stop bombing begin negotiations D Withdraw military forces Immediately analyses, useful treat year numeric, possibly assign grad students value year=7.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Student Opinion about the Vietnam War — Vietnam","text":"Friendly, M.  (2000), Visualizing Categorical Data, SAS Institute, Cary, NC, Example 7.9.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Student Opinion about the Vietnam War — Vietnam","text":"","code":"data(Vietnam) ## maybe str(Vietnam) ; plot(Vietnam) ..."},{"path":"https://friendly.github.io/vcdExtra/reference/Vote1980.html","id":null,"dir":"Reference","previous_headings":"","what":"Race and Politics in the 1980 Presidential Vote — Vote1980","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"Data 1982 General Social Survey votes 1980 U.S. presidential election relation race political conservatism.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"frequency data frame representing 2 x 7 x 2 table, 28 observations following 4 variables. race factor levels NonWhite White conservatism factor levels 1 2 3 4 5 6 7, 1=liberal, 7=conservative votefor factor levels Carter Reagan; Carterrepresents Jimmy Carter . Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"Clogg, C. & Shockey, J. W. (1988). Nesselroade, J. R. & Cattell, R. B. (ed.)  Multivariate Analysis Discrete Data, Handbook Multivariate Experimental Psychology, New York: Plenum Press.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"data contains number sampling zeros frequencies NonWhites voting Ronald Reagan.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"Agresti, . (1990) Categorical Data Analysis, Table 4.12 New York: Wiley-Interscience. Friendly, M. (2000) Visualizing Categorical Data, Example 7.5 Cary, NC: SAS Institute.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"","code":"data(Vote1980) fourfold(xtabs(Freq ~ race + votefor + conservatism,   data=Vote1980),   mfrow=c(2,4))"},{"path":"https://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":null,"dir":"Reference","previous_headings":"","what":"Worker Satisfaction Data — WorkerSat","title":"Worker Satisfaction Data — WorkerSat","text":"Blue collar workers job satisfaction large scale investigation Denmark 1968 (Andersen, 1991).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Worker Satisfaction Data — WorkerSat","text":"frequency data frame 8 observations following 4 variables, representing 2 x 2 x 2 classification 715 cases. Manage Quality management, ordered factor levels bad < good Super Supervisor satisfaction, ordered factor levels low < high Worker Worker job satisfaction, ordered factor levels low < high Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Worker Satisfaction Data — WorkerSat","text":"Originally https://online.stat.psu.edu/stat504/Lesson10","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Worker Satisfaction Data — WorkerSat","text":"Andersen, E. B. (1991) Statistical Analysis Categorical Data, 2nd Ed., Springer-Verlag.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Worker Satisfaction Data — WorkerSat","text":"","code":"data(WorkerSat)  worker.tab <- xtabs(Freq ~ Worker + Super + Manage, data=WorkerSat) fourfold(worker.tab)  mosaic(worker.tab, shade=TRUE)"},{"path":"https://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":null,"dir":"Reference","previous_headings":"","what":"Occupational Mobility in Three Countries — Yamaguchi87","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"Yamaguchi (1987) presented three-way frequency table, cross-classifying occupational categories sons fathers United States, United Kingdom Japan.  data set become classic models comparing two-way mobility tables across layers corresponding countries, groups time (e.g., Goodman Hout, 1998; Xie, 1992).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"frequency data frame 75 observations following 4 variables. total sample size 28887. Son factor levels UpNM LoNM UpM LoM Farm Father factor levels UpNM LoNM UpM LoM Farm Country factor levels US UK Japan Freq numeric vector","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"Yamaguchi, K. (1987).  Models comparing mobility tables: toward parsimony substance, American Sociological Review, vol. 52 (Aug.), 482-494, Table 1","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"US data derived 1973 OCG-II survey; UK 1972 Oxford Social Mobility Survey; Japan came 1975 Social Stratification Mobility survey. pertain men aged 20-64. Five status categories – upper lower nonmanuals (UpNM, LoNM), upper lower manuals (UpM, LoM), Farm) used fathers' occupations sons' occupations. Upper nonmanuals professionals, managers, officials; lower nonmanuals proprietors, sales workers, clerical workers; upper manuals skilled workers; lower manuals semi-skilled unskilled nonfarm workers; farm workers farmers farm laborers. models Xie (1992), Table 1, fit demo(yamaguchi-xie).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"Goodman, L. . Hout, M. (1998). Statistical Methods Graphical Displays Analyzing Association Two Qualitative Variables Differs Among Countries, Among Groups, Time: Modified Regression-Type Approach. Sociological Methodology, 28 (1), 175-230. Xie, Yu (1992). log-multiplicative layer effect model comparing mobility tables. American Sociological Review, 57 (June), 380-395.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"","code":"data(Yamaguchi87) # reproduce Table 1 structable(~ Father + Son + Country, Yamaguchi87) #>                Son UpNM LoNM  UpM  LoM Farm #> Father Country                              #> UpNM   US          1275  364  274  272   17 #>        UK           474  129   87  124   11 #>        Japan        127  101   24   30   12 #> LoNM   US          1055  597  394  443   31 #>        UK           300  218  171  220    8 #>        Japan         86  207   64   61   13 #> UpM    US          1043  587 1045  951   47 #>        UK           438  254  669  703   16 #>        Japan         43   73  122   60   13 #> LoM    US          1159  791 1323 2046   52 #>        UK           601  388  932 1789   37 #>        Japan         35   51   62   66   11 #> Farm   US           666  496 1031 1632  646 #>        UK            76   56  125  295  191 #>        Japan        109  206  184  253  325 # create table form Yama.tab <- xtabs(Freq ~ Son + Father + Country, data=Yamaguchi87)  # define mosaic labeling_args for convenient reuse in 3-way displays largs <- list(rot_labels=c(right=0), offset_varnames = c(right = 0.6),               offset_labels = c(right = 0.2),               set_varnames = c(Son=\"Son's status\", Father=\"Father's status\")              )  ################################### # Fit some models & display mosaics  # Mutual independence yama.indep <- glm(Freq ~ Son + Father + Country,   data=Yamaguchi87,   family=poisson) anova(yama.indep) #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>         Df Deviance Resid. Df Resid. Dev  Pr(>Chi)     #> NULL                       74      34313               #> Son      4   7034.4        70      27279 < 2.2e-16 *** #> Father   4   3859.2        66      23419 < 2.2e-16 *** #> Country  2  14231.1        64       9188 < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  mosaic(yama.indep, ~Son+Father, main=\"[S][F] ignoring country\")   mosaic(yama.indep, ~Country + Son + Father, condvars=\"Country\",        labeling_args=largs,        main='[S][F][C] Mutual independence')   # no association between S and F given country ('perfect mobility') # asserts same associations for all countries yama.noRC <- glm(Freq ~ (Son + Father) * Country,   data=Yamaguchi87,   family=poisson) anova(yama.noRC) #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>                Df Deviance Resid. Df Resid. Dev  Pr(>Chi)     #> NULL                              74      34313               #> Son             4   7034.4        70      27279 < 2.2e-16 *** #> Father          4   3859.2        66      23419 < 2.2e-16 *** #> Country         2  14231.1        64       9188 < 2.2e-16 *** #> Son:Country     8   1062.9        56       8125 < 2.2e-16 *** #> Father:Country  8   2533.8        48       5592 < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  mosaic(yama.noRC, ~~Country + Son + Father, condvars=\"Country\",        labeling_args=largs,        main=\"[SC][FC] No [SF] (perfect mobility)\")   # ignore diagonal cells yama.quasi <- update(yama.noRC, ~ . + Diag(Son,Father):Country) anova(yama.quasi) #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>                           Df Deviance Resid. Df Resid. Dev  Pr(>Chi)     #> NULL                                         74      34313               #> Son                        4   7034.4        70      27279 < 2.2e-16 *** #> Father                     4   3859.2        66      23419 < 2.2e-16 *** #> Country                    2  14231.1        64       9188 < 2.2e-16 *** #> Son:Country                8   1062.9        56       8125 < 2.2e-16 *** #> Father:Country             8   2533.8        48       5592 < 2.2e-16 *** #> Country:Diag(Son, Father) 15   4255.3        33       1336 < 2.2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  mosaic(yama.quasi, ~Son + Father, main=\"Quasi [S][F]\")   ## see also: # demo(yamaguchi-xie) ##"},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":null,"dir":"Reference","previous_headings":"","what":"Bivariate Logits and Log Odds Ratio — blogits","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"function calculates log odds log odds ratio two binary responses classified one stratifying variables.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"","code":"blogits(Y, add, colnames, row.vars, rev = FALSE)"},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"Y four-column matrix data frame whose columns correspond 2 x 2 combinations two binary responses. add Constant added cells allow zero frequencies.  default 0.5 (Y)==0 0 otherwise. colnames Names columns results. default c(\"logit1\", \"logit2\", \"logOR\").  less three names supplied, remaining ones filled default. row.vars data frame matrix giving factor levels one factors corresponding rows Y rev logical, indicating whether order columns Y reversed.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"data frame nrow(Y) rows 3 + ncol(row.vars) columns","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"useful plotting results bivariate logistic regression models, fit using vglm VGAM. two binary variables levels 0,1 logits calculated assuming columns Y given order 11, 10, 01, 00, logits give log odds 1 response compared 0.  case, either use rev=TRUE supply Y[,4:1] first argument.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/blogits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"","code":"data(Toxaemia) tox.tab <- xtabs(Freq~class + smoke + hyper + urea, Toxaemia)  # reshape to 4-column matrix toxaemia <- t(matrix(aperm(tox.tab), 4, 15)) colnames(toxaemia) <- c(\"hu\", \"hU\", \"Hu\", \"HU\") rowlabs <- expand.grid(smoke=c(\"0\", \"1-19\", \"20+\"), class=factor(1:5)) toxaemia <- cbind(toxaemia, rowlabs)  # logits for H and U logitsTox <- blogits(toxaemia[,4:1],                       add=0.5,                       colnames=c(\"logitH\", \"logitW\"),                       row.vars=rowlabs) logitsTox #>        logitH    logitW      logOR smoke class #> 1  -1.0205696 -1.998774  1.5267914     0     1 #> 2  -0.9426080 -2.166453  1.0710243  1-19     1 #> 3  -1.0296194 -2.140066  2.4485390   20+     1 #> 4  -0.9504026 -2.515797  1.4619602     0     2 #> 5  -1.0469879 -2.498258  0.8640134  1-19     2 #> 6  -0.8649974 -2.525729 -1.1457908   20+     2 #> 7  -0.8793862 -2.263924  1.5805648     0     3 #> 8  -1.3826171 -2.362718  1.3736951  1-19     3 #> 9  -1.3393374 -2.273598  0.7442513   20+     3 #> 10 -0.9398380 -2.014903  1.3135126     0     4 #> 11 -1.4394042 -2.251292  1.3426023  1-19     4 #> 12 -1.2992830 -2.322388  0.8846854   20+     4 #> 13 -0.9995915 -1.996554  1.0036228     0     5 #> 14 -1.3002198 -1.938363  1.0347544  1-19     5 #> 15 -1.1574528 -1.897120  2.0187271   20+     5"},{"path":"https://friendly.github.io/vcdExtra/reference/collapse.table.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse Levels of a Table — collapse.table","title":"Collapse Levels of a Table — collapse.table","text":"Collapse (re-label) variables contingency table, array ftable object re-assigning levels table variables.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse Levels of a Table — collapse.table","text":"","code":"collapse.table(table, ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse Levels of a Table — collapse.table","text":"table table, array ftable object ... collection one assignments factors table list levels","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse Levels of a Table — collapse.table","text":"xtabs table object, representing original table one factors collapsed rearranged levels.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Collapse Levels of a Table — collapse.table","text":"...{} arguments must form variable = levels, variable name one table dimensions, levels character numeric vector length equal corresponding dimension table.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Collapse Levels of a Table — collapse.table","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse Levels of a Table — collapse.table","text":"","code":"# create some sample data in table form sex <- c(\"Male\", \"Female\") age <- letters[1:6] education <- c(\"low\", 'med', 'high') data <- expand.grid(sex=sex, age=age, education=education) counts <- rpois(36, 100)  data <- cbind(data, counts) t1 <- xtabs(counts ~ sex + age + education, data=data) structable(t1) #>                  age   a   b   c   d   e   f #> sex    education                             #> Male   low           114 121  93 106  80 114 #>        med           107 100  97  86 104 103 #>        high           89 105 114  96  91 108 #> Female low           100  85 103 110 102  98 #>        med           100  92  96 106 100 112 #>        high           98 117 115  94  93 118  ##                  age   a   b   c   d   e   f ## sex    education                             ## Male   low           119 101 109  85  99  93 ##        med            94  98 103 108  84  84 ##        high           81  88  96 110 100  92 ## Female low           107 104  95  86 103  96 ##        med           104  98  94  95 110 106 ##        high           93  85  90 109  99  86   # collapse age to 3 levels t2 <- collapse.table(t1, age=c(\"A\", \"A\", \"B\", \"B\", \"C\", \"C\")) structable(t2) #>                  age   A   B   C #> sex    education                 #> Male   low           235 199 194 #>        med           207 183 207 #>        high          194 210 199 #> Female low           185 213 200 #>        med           192 202 212 #>        high          215 209 211  ##                  age   A   B   C ## sex    education                 ## Male   low           220 194 192 ##        med           192 211 168 ##        high          169 206 192 ## Female low           211 181 199 ##        med           202 189 216 ##        high          178 199 185   # collapse age to 3 levels and pool education: \"low\" and \"med\" to \"low\" t3 <- collapse.table(t1, age=c(\"A\", \"A\", \"B\", \"B\", \"C\", \"C\"),      education=c(\"low\", \"low\", \"high\")) structable(t3) #>                  age   A   B   C #> sex    education                 #> Male   low           442 382 401 #>        high          194 210 199 #> Female low           377 415 412 #>        high          215 209 211  ##                  age   A   B   C ## sex    education                 ## Male   low           412 405 360 ##        high          169 206 192 ## Female low           413 370 415 ##        high          178 199 185    # change labels for levels of education to 1:3 t4 <- collapse.table(t1,  education=1:3) structable(t4) #>                  age   a   b   c   d   e   f #> sex    education                             #> Male   1             114 121  93 106  80 114 #>        2             107 100  97  86 104 103 #>        3              89 105 114  96  91 108 #> Female 1             100  85 103 110 102  98 #>        2             100  92  96 106 100 112 #>        3              98 117 115  94  93 118  structable(t4) #>                  age   a   b   c   d   e   f #> sex    education                             #> Male   1             114 121  93 106  80 114 #>        2             107 100  97  86 104 103 #>        3              89 105 114  96  91 108 #> Female 1             100  85 103 110 102  98 #>        2             100  92  96 106 100 112 #>        3              98 117 115  94  93 118 ##                  age   a   b   c   d   e   f ## sex    education                             ## Male   1             119 101 109  85  99  93 ##        2              94  98 103 108  84  84 ##        3              81  88  96 110 100  92 ## Female 1             107 104  95  86 103  96 ##        2             104  98  94  95 110 106 ##        3              93  85  90 109  99  86"},{"path":"https://friendly.github.io/vcdExtra/reference/color_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Display Frequency Table with Colored Cell Backgrounds — color_table","title":"Display Frequency Table with Colored Cell Backgrounds — color_table","text":"Creates formatted table display frequency data cell backgrounds colored according observed frequencies residuals loglinear model.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/color_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display Frequency Table with Colored Cell Backgrounds — color_table","text":"","code":"color_table(   x,   formula = NULL,   shade = c(\"residuals\", \"freq\", \"pearson\", \"deviance\"),   model = NULL,   expected = NULL,   palette = NULL,   legend = TRUE,   margins = TRUE,   digits = 0,   title = NULL,   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/color_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Display Frequency Table with Colored Cell Backgrounds — color_table","text":"x table, xtabs, matrix, ftable, structable object formula Formula specifying row ~ col layout (passed structable needed) shade values determine cell shading: \"residuals\" (default), \"freq\", \"pearson\", \"deviance\" model fitted model (loglm glm) compute residuals . NULL shade involves residuals, uses independence model. expected Expected frequencies (alternative model) palette Color palette function vector. Default depends shade type. legend Logical, show color legend/scale? margins Logical, include row/column totals? digits Number decimal places displayed values title Optional table title ... Additional arguments (currently unused)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/color_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Display Frequency Table with Colored Cell Backgrounds — color_table","text":"gt table object can customized","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/color_table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Display Frequency Table with Colored Cell Backgrounds — color_table","text":"function provides heatmap-style representation frequency table, background coloring used visualize patterns anomalies data. shading residuals (default), cells large positive residuals (observations expected) shaded red, cells large negative residuals (fewer expected) shaded blue. makes easy identify cells deviate substantially expected given model (default, independence model). cells dark background colors, black text can difficult read. function automatically selects white black text cell based provides better contrast background color. colorspace package available, contrast_ratio used determine optimal text color according WCAG 2.1 guidelines. Otherwise, fallback based relative luminance (ITU-R BT.709) used.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/color_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Display Frequency Table with Colored Cell Backgrounds — color_table","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage - shade by residuals from independence data(HairEyeColor) HEC <- margin.table(HairEyeColor, 2:1) color_table(HEC)  # Shade by frequencies instead color_table(HEC, shade = \"freq\")  # 3-way table color_table(HairEyeColor, formula = Eye ~ Hair + Sex) } # }"},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":null,"dir":"Reference","previous_headings":"","what":"Cut a Numeric Variable to a Factor — cutfac","title":"Cut a Numeric Variable to a Factor — cutfac","text":"cutfac acts like cut, dividing range x intervals coding values x according interval fall. However, gives nicer labels factor levels default chooses convenient breaks among values based deciles. particularly useful plots one wants make numeric variable discrete purpose getting boxplots, spinograms mosaic plots.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cut a Numeric Variable to a Factor — cutfac","text":"","code":"cutfac(x, breaks = NULL, q = 10)"},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cut a Numeric Variable to a Factor — cutfac","text":"x numeric vector converted factor cutting breaks either numeric vector two unique cut points single number (greater equal 2) giving number intervals x cut. q number quantile groups used define breaks, specified.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cut a Numeric Variable to a Factor — cutfac","text":"factor corresponding x returned","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cut a Numeric Variable to a Factor — cutfac","text":"default, cut chooses breaks equal lengths range x, whereas cutfac uses quantile choose breaks roughly equal count.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cut a Numeric Variable to a Factor — cutfac","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Cut a Numeric Variable to a Factor — cutfac","text":"Achim Zeileis","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/cutfac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cut a Numeric Variable to a Factor — cutfac","text":"","code":"if (require(AER)) { data(\"NMES1988\", package=\"AER\") nmes <- NMES1988[, c(1, 6:8, 13, 15, 18)]  plot(log(visits+1) ~ cutfac(chronic),   data = nmes,   ylab = \"Physician office visits (log scale)\",   xlab = \"Number of chronic conditions\", main = \"chronic\")  plot(log(visits+1) ~ cutfac(hospital, c(0:2, 8)),   data = nmes,   ylab = \"Physician office visits (log scale)\",   xlab = \"Number of hospital stays\", main = \"hospital\") } #> Loading required package: AER #> Loading required package: lmtest #> Loading required package: zoo #>  #> Attaching package: ‘zoo’ #> The following objects are masked from ‘package:base’: #>  #>     as.Date, as.Date.numeric #> Loading required package: sandwich #> Loading required package: survival    data(\"CrabSatellites\", package = \"vcdExtra\")  # jittered scatterplot plot(jitter(satellites) ~ width, data=CrabSatellites,   ylab=\"Number of satellites (jittered)\",   xlab=\"Carapace width\",   cex.lab=1.25) with(CrabSatellites,      lines(lowess(width, satellites), col=\"red\", lwd=2))   # boxplot, using deciles plot(satellites ~ cutfac(width), data=CrabSatellites,      ylab=\"Number of satellites\",      xlab=\"Carapace width (deciles)\")"},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":null,"dir":"Reference","previous_headings":"","what":"Information on Data Sets in Packages — datasets","title":"Information on Data Sets in Packages — datasets","text":"data function used load data sets packages, give display names titles data sets one packages, however return result can easily used get additional information nature data sets packages.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information on Data Sets in Packages — datasets","text":"","code":"datasets(   package = \"vcdExtra\",   allClass = FALSE,   incPackage = length(package) > 1,   maxTitle = NULL,   ndim = FALSE )"},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Information on Data Sets in Packages — datasets","text":"package character vector giving package(s) look allClass logical variable. Include classes item (TRUE) just last class (FALSE)? incPackage include package name result? maxTitle maximum length data set Title ndim logical; include number dimensions result?","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Information on Data Sets in Packages — datasets","text":"data.frame whose rows correspond data sets found package. columns (single package) : Item data set name, character variable class class, object class data set, typically one \"data.frame\", \"table\", \"array\" ... dim abbreviation dimensions data set, form like \"36x3\" data.frame matrix 36 rows 3 columns. Title data set title","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Information on Data Sets in Packages — datasets","text":"datasets() function designed produce useful summary display data sets one packages.  extracts class dimension information (dim codelength) item, formats provide additional descriptors. requested packages must installed, silently loaded order extract class size information.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Information on Data Sets in Packages — datasets","text":"Rmd documents, datasets(\"package\") |> knitr::kable() can used create pleasing display.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Information on Data Sets in Packages — datasets","text":"Michael Friendly, R-help Curt Seeliger","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/datasets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Information on Data Sets in Packages — datasets","text":"","code":"datasets(\"vcdExtra\") #>              Item      class       dim #> 1        Abortion      table     2x2x2 #> 2        Accident data.frame      80x5 #> 3        AirCrash data.frame     439x5 #> 4       Alligator data.frame      80x5 #> 5        Asbestos      array       5x4 #> 6        Bartlett      table     2x2x2 #> 7            Burt data.frame      27x3 #> 8          Caesar      table   3x2x2x2 #> 9          Cancer      table     2x2x2 #> 10     Cormorants data.frame     343x8 #> 11 CrabSatellites data.frame     173x5 #> 12  CyclingDeaths data.frame     208x2 #> 13   DaytonSurvey data.frame      32x6 #> 14        Depends      table        15 #> 15      Detergent      table   2x2x2x3 #> 16         Donner data.frame      90x5 #> 17      Draft1970 data.frame     366x3 #> 18 Draft1970table      table      12x3 #> 19           Dyke      table 2x2x2x2x2 #> 20      Fungicide      array   2x2x2x2 #> 21            GSS data.frame       6x3 #> 22       Geissler data.frame      90x4 #> 23          Gilby      table       6x4 #> 24          Glass data.frame      25x3 #> 25   HairEyePlace      array     4x5x2 #> 26       Hauser79 data.frame      25x3 #> 27          Heart      table     2x2x3 #> 28        Heckman      table 2x2x2x2x2 #> 29     HospVisits      table       3x3 #> 30     HouseTasks      table      13x4 #> 31           Hoyt      table   4x3x7x2 #> 32            ICU data.frame    200x22 #> 33         JobSat      table       4x4 #> 34     Mammograms      array       4x4 #> 35         Mental data.frame      24x3 #> 36           Mice data.frame      30x4 #> 37       Mobility      table       5x5 #> 38        PhdPubs data.frame     915x6 #> 39     ShakeWords data.frame     100x2 #> 40             TV      array    5x11x3 #> 41       Titanicp data.frame    1309x6 #> 42       Toxaemia data.frame      60x5 #> 43        Vietnam data.frame      40x4 #> 44       Vote1980 data.frame      28x4 #> 45      WorkerSat data.frame       8x4 #> 46    Yamaguchi87 data.frame      75x4 #>                                                    Title #> 1                                  Abortion Opinion Data #> 2             Traffic Accident Victims in France in 1958 #> 3                                         Air Crash Data #> 4                                  Alligator Food Choice #> 5                         Effect of Exposure to Asbestos #> 6                    Bartlett Data on Plum Root Cuttings #> 7       Burt (1950) Data on Hair, Eyes, Head and Stature #> 8         Risk Factors for Infection in Caesarian Births #> 9                     Survival of Breast Cancer Patients #> 10              Advertising Behavior by Males Cormorants #> 11                                 Horseshoe Crab Mating #> 12                                 London Cycling Deaths #> 13                Dayton Student Survey on Substance Use #> 14                            Dependencies of R Packages #> 15                             Detergent Preference Data #> 16                          Survival in the Donner Party #> 17                           USA 1970 Draft Lottery Data #> 18                          USA 1970 Draft Lottery Table #> 19                        Sources of Knowledge of Cancer #> 20                   Carcinogenic Effects of a Fungicide #> 21      General Social Survey- Sex and Party affiliation #> 22                Geissler's Data on the Human Sex Ratio #> 23          Clothing and Intelligence Rating of Children #> 24              British Social Mobility from Glass(1954) #> 25    Hair Color and Eye Color in Caithness and Aberdeen #> 26                 Hauser (1979) Data on Social Mobility #> 27                     Sex, Occupation and Heart Disease #> 28 Labour Force Participation of Married Women 1967-1971 #> 29                                  Hospital Visits Data #> 30       Household Tasks Performed by Husbands and Wives #> 31                       Minnesota High School Graduates #> 32                                          ICU data set #> 33    Cross-classification of job satisfaction by income #> 34                                     Mammogram Ratings #> 35                     Mental Impairment and Parents SES #> 36                                   Mice Depletion Data #> 37                                  Social Mobility data #> 38                        Publications of PhD Candidates #> 39                   Shakespeare's Word Type Frequencies #> 40                                       TV Viewing Data #> 41                             Passengers on the Titanic #> 42                        Toxaemia Symptoms in Pregnancy #> 43                 Student Opinion about the Vietnam War #> 44       Race and Politics in the 1980 Presidential Vote #> 45                              Worker Satisfaction Data #> 46              Occupational Mobility in Three Countries # datasets(c(\"vcd\", \"vcdExtra\")) datasets(\"datasets\", maxTitle=50) #>                              Item      class     dim #> 1                   AirPassengers         ts     144 #> 2                         BJsales         ts     150 #> 3          BJsales.lead (BJsales)         ts     150 #> 4                             BOD data.frame     6x2 #> 5                             CO2 data.frame    84x5 #> 6                     ChickWeight data.frame   578x4 #> 7                           DNase data.frame   176x3 #> 8                  EuStockMarkets      array  1860x4 #> 9                    Formaldehyde data.frame     6x2 #> 10                   HairEyeColor      table   4x4x2 #> 11                   Harman23.cor       list       3 #> 12                   Harman74.cor       list       3 #> 13                       Indometh data.frame    66x3 #> 14                   InsectSprays data.frame    72x2 #> 15                 JohnsonJohnson         ts      84 #> 16                      LakeHuron         ts      98 #> 17               LifeCycleSavings data.frame    50x5 #> 18                       Loblolly data.frame    84x3 #> 19                           Nile         ts     100 #> 20                         Orange data.frame    35x3 #> 21                  OrchardSprays data.frame    64x4 #> 22                    PlantGrowth data.frame    30x2 #> 23                      Puromycin data.frame    23x3 #> 24                      Seatbelts      array   192x8 #> 25                         Theoph data.frame   132x5 #> 26                        Titanic      table 4x2x2x2 #> 27                    ToothGrowth data.frame    60x3 #> 28                  UCBAdmissions      table   2x2x6 #> 29                 UKDriverDeaths         ts     192 #> 30                          UKgas         ts     108 #> 31                    USAccDeaths         ts      72 #> 32                      USArrests data.frame    50x4 #> 33                 USJudgeRatings data.frame   43x12 #> 34          USPersonalExpenditure      array     5x5 #> 35                      UScitiesD       dist      45 #> 36                       VADeaths      array     5x4 #> 37                       WWWusage         ts     100 #> 38                    WorldPhones      array     7x7 #> 39                    ability.cov       list       3 #> 40                       airmiles         ts      24 #> 41                     airquality data.frame   153x6 #> 42                       anscombe data.frame    11x8 #> 43                         attenu data.frame   182x5 #> 44                       attitude data.frame    30x7 #> 45                        austres         ts      89 #> 46              beaver1 (beavers) data.frame   114x4 #> 47              beaver2 (beavers) data.frame   100x4 #> 48                           cars data.frame    50x2 #> 49                       chickwts data.frame    71x2 #> 50                            co2         ts     468 #> 51                        crimtab      table   42x22 #> 52                    discoveries         ts     100 #> 53                          esoph data.frame    88x5 #> 54                           euro    numeric      11 #> 55              euro.cross (euro)      array   11x11 #> 56                       eurodist       dist     210 #> 57                       faithful data.frame   272x2 #> 58         fdeaths (UKLungDeaths)         ts      72 #> 59                         freeny data.frame    39x5 #> 60              freeny.x (freeny)      array    39x4 #> 61              freeny.y (freeny)         ts      39 #> 62                           gait      array 20x39x2 #> 63                         infert data.frame   248x8 #> 64                           iris data.frame   150x5 #> 65                          iris3      array  50x4x3 #> 66                        islands    numeric      48 #> 67         ldeaths (UKLungDeaths)         ts      72 #> 68                             lh         ts      48 #> 69                        longley data.frame    16x7 #> 70                           lynx         ts     114 #> 71         mdeaths (UKLungDeaths)         ts      72 #> 72                         morley data.frame   100x3 #> 73                         mtcars data.frame   32x11 #> 74                         nhtemp         ts      60 #> 75                         nottem         ts     240 #> 76                            npk data.frame    24x5 #> 77             occupationalStatus      table     8x8 #> 78                       penguins data.frame   344x8 #> 79        penguins_raw (penguins) data.frame  344x17 #> 80                         precip    numeric      70 #> 81                     presidents         ts     120 #> 82                       pressure data.frame    19x2 #> 83                         quakes data.frame  1000x5 #> 84                          randu data.frame   400x3 #> 85                         rivers    numeric     141 #> 86                           rock data.frame    48x4 #> 87                          sleep data.frame    20x3 #> 88         stack.loss (stackloss)    numeric      21 #> 89            stack.x (stackloss)      array    21x3 #> 90                      stackloss data.frame    21x4 #> 91              state.abb (state)  character      50 #> 92             state.area (state)    numeric      50 #> 93           state.center (state)       list       2 #> 94         state.division (state)     factor      50 #> 95             state.name (state)  character      50 #> 96           state.region (state)     factor      50 #> 97              state.x77 (state)      array    50x8 #> 98  sunspot.m2014 (sunspot.month)         ts    3177 #> 99                  sunspot.month         ts    3310 #> 100                  sunspot.year         ts     289 #> 101                      sunspots         ts    2820 #> 102                         swiss data.frame    47x6 #> 103                      treering         ts    7980 #> 104                         trees data.frame    31x3 #> 105                         uspop         ts      19 #> 106                       volcano      array   87x61 #> 107                    warpbreaks data.frame    54x3 #> 108                         women data.frame    15x2 #>                                                  Title #> 1          Monthly Airline Passenger Numbers 1949-1960 #> 2                    Sales Data with Leading Indicator #> 3                    Sales Data with Leading Indicator #> 4                            Biochemical Oxygen Demand #> 5                Carbon Dioxide Uptake in Grass Plants #> 6       Weight versus age of chicks on different diets #> 7                                 Elisa assay of DNase #> 8   Daily Closing Prices of Major European Stock Indic #> 9                        Determination of Formaldehyde #> 10           Hair and Eye Color of Statistics Students #> 11                                  Harman Example 2.3 #> 12                                  Harman Example 7.4 #> 13                    Pharmacokinetics of Indomethacin #> 14                      Effectiveness of Insect Sprays #> 15      Quarterly Earnings per Johnson & Johnson Share #> 16                       Level of Lake Huron 1875-1972 #> 17                Intercountry Life-Cycle Savings Data #> 18                       Growth of Loblolly Pine Trees #> 19                              Flow of the River Nile #> 20                              Growth of Orange Trees #> 21                           Potency of Orchard Sprays #> 22          Results from an Experiment on Plant Growth #> 23          Reaction Velocity of an Enzymatic Reaction #> 24            Road Casualties in Great Britain 1969-84 #> 25                    Pharmacokinetics of Theophylline #> 26               Survival of passengers on the Titanic #> 27  The Effect of Vitamin C on Tooth Growth in Guinea  #> 28                   Student Admissions at UC Berkeley #> 29            Road Casualties in Great Britain 1969-84 #> 30                        UK Quarterly Gas Consumption #> 31               Accidental Deaths in the US 1973-1978 #> 32                     Violent Crime Rates by US State #> 33  Lawyers' Ratings of State Judges in the US Superio #> 34                           Personal Expenditure Data #> 35  Distances Between European Cities and Between US C #> 36                      Death Rates in Virginia (1940) #> 37                           Internet Usage per Minute #> 38                              The World's Telephones #> 39                      Ability and Intelligence Tests #> 40  Passenger Miles on Commercial US Airlines, 1937-19 #> 41                   New York Air Quality Measurements #> 42  Anscombe's Quartet of 'Identical' Simple Linear Re #> 43                   The Joyner-Boore Attenuation Data #> 44                  The Chatterjee-Price Attitude Data #> 45  Quarterly Time Series of the Number of Australian  #> 46              Body Temperature Series of Two Beavers #> 47              Body Temperature Series of Two Beavers #> 48                Speed and Stopping Distances of Cars #> 49                        Chicken Weights by Feed Type #> 50             Mauna Loa Atmospheric CO2 Concentration #> 51                       Student's 3000 Criminals Data #> 52             Yearly Numbers of Important Discoveries #> 53           Smoking, Alcohol and (O)esophageal Cancer #> 54                 Conversion Rates of Euro Currencies #> 55                 Conversion Rates of Euro Currencies #> 56  Distances Between European Cities and Between US C #> 57                            Old Faithful Geyser Data #> 58         Monthly Deaths from Lung Diseases in the UK #> 59                               Freeny's Revenue Data #> 60                               Freeny's Revenue Data #> 61                               Freeny's Revenue Data #> 62                    Hip and Knee Angle while Walking #> 63  Infertility after Spontaneous and Induced Abortion #> 64                          Edgar Anderson's Iris Data #> 65                          Edgar Anderson's Iris Data #> 66               Areas of the World's Major Landmasses #> 67         Monthly Deaths from Lung Diseases in the UK #> 68                Luteinizing Hormone in Blood Samples #> 69                  Longley's Economic Regression Data #> 70            Annual Canadian Lynx trappings 1821-1934 #> 71         Monthly Deaths from Lung Diseases in the UK #> 72                       Michelson Speed of Light Data #> 73                          Motor Trend Car Road Tests #> 74            Average Yearly Temperatures in New Haven #> 75  Average Monthly Temperatures at Nottingham, 1920-1 #> 76              Classical N, P, K Factorial Experiment #> 77       Occupational Status of Fathers and their Sons #> 78  Measurements of Penguins near Palmer Station, Anta #> 79  Measurements of Penguins near Palmer Station, Anta #> 80          Annual Precipitation in Selected US Cities #> 81         Quarterly Approval Ratings of US Presidents #> 82  Vapor Pressure of Mercury as a Function of Tempera #> 83                   Locations of Earthquakes off Fiji #> 84    Random Numbers from Congruential Generator RANDU #> 85              Lengths of Major North American Rivers #> 86              Measurements on Petroleum Rock Samples #> 87                                Student's Sleep Data #> 88                    Brownlee's Stack Loss Plant Data #> 89                    Brownlee's Stack Loss Plant Data #> 90                    Brownlee's Stack Loss Plant Data #> 91                          US State Facts and Figures #> 92                          US State Facts and Figures #> 93                          US State Facts and Figures #> 94                          US State Facts and Figures #> 95                          US State Facts and Figures #> 96                          US State Facts and Figures #> 97                          US State Facts and Figures #> 98        Monthly Sunspot Data, from 1749 to \"Present\" #> 99        Monthly Sunspot Data, from 1749 to \"Present\" #> 100                     Yearly Sunspot Data, 1700-1988 #> 101                 Monthly Sunspot Numbers, 1749-1983 #> 102 Swiss Fertility and Socioeconomic Indicators (1888 #> 103                  Yearly Tree-Ring Data, -6000-1979 #> 104 Diameter, Height and Volume for Black Cherry Trees #> 105              Populations Recorded by the US Census #> 106 Topographic Information on Auckland's Maunga Whau  #> 107        The Number of Breaks in Yarn during Weaving #> 108     Average Heights and Weights for American Women  # just list dataset names in a package datasets(\"vcdExtra\")[,\"Item\"] #>  [1] \"Abortion\"       \"Accident\"       \"AirCrash\"       \"Alligator\"      #>  [5] \"Asbestos\"       \"Bartlett\"       \"Burt\"           \"Caesar\"         #>  [9] \"Cancer\"         \"Cormorants\"     \"CrabSatellites\" \"CyclingDeaths\"  #> [13] \"DaytonSurvey\"   \"Depends\"        \"Detergent\"      \"Donner\"         #> [17] \"Draft1970\"      \"Draft1970table\" \"Dyke\"           \"Fungicide\"      #> [21] \"GSS\"            \"Geissler\"       \"Gilby\"          \"Glass\"          #> [25] \"HairEyePlace\"   \"Hauser79\"       \"Heart\"          \"Heckman\"        #> [29] \"HospVisits\"     \"HouseTasks\"     \"Hoyt\"           \"ICU\"            #> [33] \"JobSat\"         \"Mammograms\"     \"Mental\"         \"Mice\"           #> [37] \"Mobility\"       \"PhdPubs\"        \"ShakeWords\"     \"TV\"             #> [41] \"Titanicp\"       \"Toxaemia\"       \"Vietnam\"        \"Vote1980\"       #> [45] \"WorkerSat\"      \"Yamaguchi87\"    datasets(\"vcd\")[,\"Item\"] #>  [1] \"Arthritis\"       \"Baseball\"        \"BrokenMarriage\"  \"Bundesliga\"      #>  [5] \"Bundestag2005\"   \"Butterfly\"       \"CoalMiners\"      \"DanishWelfare\"   #>  [9] \"Employment\"      \"Federalist\"      \"Hitters\"         \"HorseKicks\"      #> [13] \"Hospital\"        \"JobSatisfaction\" \"JointSports\"     \"Lifeboats\"       #> [17] \"MSPatients\"      \"NonResponse\"     \"OvaryCancer\"     \"PreSex\"          #> [21] \"Punishment\"      \"RepVict\"         \"Rochdale\"        \"Saxony\"          #> [25] \"SexualFun\"       \"SpaceShuttle\"    \"Suicide\"         \"Trucks\"          #> [29] \"UKSoccer\"        \"VisualAcuity\"    \"VonBort\"         \"WeldonDice\"      #> [33] \"WomenQueue\"       # Find one-way tables in vcd (dim doesn't contain \"x\") datasets(\"vcd\") |>   dplyr::filter(class==\"table\",                 !stringr::str_detect(dim, \"x\")) #>         Item class dim                       Title #> 1  Butterfly table  24 Butterfly Species in Malaya #> 2 Federalist table   7  'May' in Federalist Papers #> 3 HorseKicks table   5        Death by Horse Kicks #> 4     Saxony table  13          Families in Saxony #> 5 WeldonDice table  11          Weldon's Dice Data #> 6 WomenQueue table  11             Women in Queues"},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand a frequency table to case form — expand.dft","title":"Expand a frequency table to case form — expand.dft","text":"Converts frequency table, given either table object data frame frequency form data frame representing individual observations table.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand a frequency table to case form — expand.dft","text":"","code":"expand.dft(x, var.names = NULL, freq = \"Freq\", ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand a frequency table to case form — expand.dft","text":"x table object, data frame frequency form containing factors one numeric variable representing cell frequency combination factors. var.names list variable names factors, wish override already table freq name frequency variable table ... arguments passed type.convert.  particular, pay attention na.strings (default: na.strings=NA missing cells) .(default: .=FALSE, converting character vectors factors).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand a frequency table to case form — expand.dft","text":"data frame containing factors table many observations represented total freq variable.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Expand a frequency table to case form — expand.dft","text":"expand.table synonym expand.dft.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Expand a frequency table to case form — expand.dft","text":"Originally posted R-Help, Jan 20, 2009, http://tolstoy.newcastle.edu.au/R/e6/help/09/01/1873.html Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Expand a frequency table to case form — expand.dft","text":"Mark Schwarz","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Expand a frequency table to case form — expand.dft","text":"","code":"library(vcd) art <- xtabs(~Treatment + Improved, data = Arthritis) art #>          Improved #> Treatment None Some Marked #>   Placebo   29    7      7 #>   Treated   13    7     21 artdf <- expand.dft(art) str(artdf) #> 'data.frame':\t84 obs. of  2 variables: #>  $ Treatment: chr  \"Placebo\" \"Placebo\" \"Placebo\" \"Placebo\" ... #>  $ Improved : chr  \"None\" \"None\" \"None\" \"None\" ...  # 1D case (tab <- table(sample(head(letters), 20, replace=TRUE))) #>  #> a b c d e f  #> 2 5 5 2 1 5  expand.table(tab, var.names=\"letter\") #>    letter #> 1       a #> 2       a #> 3       b #> 4       b #> 5       b #> 6       b #> 7       b #> 8       c #> 9       c #> 10      c #> 11      c #> 12      c #> 13      d #> 14      d #> 15      e #> 16      f #> 17      f #> 18      f #> 19      f #> 20      f"},{"path":"https://friendly.github.io/vcdExtra/reference/glmlist.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Model List Object — glmlist","title":"Create a Model List Object — glmlist","text":"glmlist creates glmlist object containing list fitted glm objects names. loglmlist loglm objects.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/glmlist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Model List Object — glmlist","text":"","code":"glmlist(...)  loglmlist(...)  # S3 method for class 'glmlist' coef(object, result = c(\"list\", \"matrix\", \"data.frame\"), ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/glmlist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Model List Object — glmlist","text":"... One model objects, appropriate function, optionally assigned names list. object \"glmlist\" object result type result returned","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/glmlist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Model List Object — glmlist","text":"object class glmlist loglmlist, just like list, except model given name attribute.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/glmlist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a Model List Object — glmlist","text":"intention provide object classes facilitate model comparison, extraction, summary plotting model components, etc., perhaps using lapply similar. exists anova.glm method glmlist objects.  , coef method also defined, collecting coefficients models single object type determined result. arguments glmlist loglmlist form value name=value. objects inherit appropriate class glm loglm excluded, warning. coef method, coefficients different models matched name list unique names across models.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/glmlist.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create a Model List Object — glmlist","text":"Michael Friendly; coef method John Fox","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/glmlist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Model List Object — glmlist","text":"","code":"data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)  # use object names mods <- glmlist(indep, coleff, roweff, linlin) names(mods) #> [1] \"indep\"  \"coleff\" \"roweff\" \"linlin\"  # assign new names mods <- glmlist(Indep=indep, Col=coleff, Row=roweff, LinxLin=linlin) names(mods) #> [1] \"Indep\"   \"Col\"     \"Row\"     \"LinxLin\"  LRstats(mods) #> Likelihood summary table: #>            AIC    BIC LR Chisq Df Pr(>Chisq)     #> Indep   209.59 220.19   47.418 15  3.155e-05 *** #> Col     179.00 195.50    6.829 10     0.7415     #> Row     174.45 188.59    6.281 12     0.9013     #> LinxLin 174.07 185.85    9.895 14     0.7698     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  coef(mods, result='data.frame') #>                             Indep        Col        Row     LinxLin #> (Intercept)            4.18756842  4.8631072  4.7061332  3.37942319 #> mental.L               0.04507501  0.6795332 -0.6818052 -0.66051890 #> mental.Q              -0.30073728 -0.3233129 -0.3277282 -0.32176183 #> mental.C               0.39412292  0.3936983  0.1992104  0.39415885 #> ses.L                 -0.04968094 -1.0342736  0.5629992 -0.99933120 #> ses.Q                 -0.30335318 -0.5581022 -0.3328887 -0.33029582 #> ses.C                 -0.19797985 -0.1707521 -0.1979530 -0.19811915 #> ses^4                  0.17490822  0.1230409  0.1749295  0.17494245 #> ses^5                  0.14682648  0.2429662  0.1468266  0.14682693 #> ses1:Rscore                    NA -0.4459213         NA          NA #> ses2:Rscore                    NA -0.4594090         NA          NA #> ses3:Rscore                    NA -0.3342208         NA          NA #> ses4:Rscore                    NA -0.2814884         NA          NA #> ses5:Rscore                    NA -0.1393421         NA          NA #> ses6:Rscore                    NA         NA         NA          NA #> mentalWell:Cscore              NA         NA -0.3068185          NA #> mentalMild:Cscore              NA         NA -0.1617300          NA #> mentalModerate:Cscore          NA         NA -0.1433864          NA #> mentalImpaired:Cscore          NA         NA         NA          NA #> Rscore:Cscore                  NA         NA         NA  0.09068661  #extract model components unlist(lapply(mods, deviance)) #>     Indep       Col       Row   LinxLin  #> 47.417847  6.829334  6.280761  9.895124   res <- lapply(mods, residuals) boxplot(as.data.frame(res), main=\"Residuals from various models\")"},{"path":"https://friendly.github.io/vcdExtra/reference/labeling_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Labeling Function for Mosaic Displays Using Points — labeling_points","title":"Labeling Function for Mosaic Displays Using Points — labeling_points","text":"labeling function use strucplot displays, mosaic, draws random points within cell mosaic plot, number points represents observed expected frequencies. creates \"dot-density\" visualization provides direct visual representation cell frequencies.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/labeling_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Labeling Function for Mosaic Displays Using Points — labeling_points","text":"","code":"labeling_points(   labels = TRUE,   varnames = labels,   value_type = c(\"observed\", \"expected\"),   scale = 1,   pch = 19,   size = unit(0.5, \"char\"),   gp_points = gpar(col = \"black\", alpha = 0.7),   margin = unit(0.05, \"npc\"),   seed = NULL,   jitter = 1,   clip = FALSE,   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/labeling_points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Labeling Function for Mosaic Displays Using Points — labeling_points","text":"labels Logical vector scalar indicating whether labels drawn table dimensions via labeling_border. Defaults TRUE. varnames Logical vector scalar indicating whether variable names drawn. Defaults labels. value_type Character string specifying whether display \"observed\" \"expected\" frequencies points. scale Numeric scaling factor. number points drawn equals round(frequency / scale). Use larger values tables large counts. pch Point character (plotting symbol). Default 19 (filled circle). size Point size unit object. Default unit(0.5, \"char\"). gp_points gpar object controlling point appearance (color, alpha, etc.), example: gp_points = gpar(col = \"red\"). margin Margin inside cells unit object. Points drawn within inset area. Default unit(0.05, \"npc\"). seed Optional integer seed reproducible point placement across several similar plots. NULL (default), seed set. jitter Numeric jitter amount (0-1) point placement. Default 1 (full random). Values < 1 create regular patterns. clip Logical indicating whether clip points cell boundaries. Default FALSE. ... Additional arguments passed labeling_border axis labels.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/labeling_points.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Labeling Function for Mosaic Displays Using Points — labeling_points","text":"function class \"grapcon_generator\" suitable use labeling argument strucplot related functions like mosaic.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/labeling_points.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Labeling Function for Mosaic Displays Using Points — labeling_points","text":"function follows \"grapcon_generator\" pattern used vcd labeling functions. returns function can passed labeling argument strucplot, mosaic, related functions argument labeling = labeling_poionts(...). visualization inspired conceptual model described Friendly (1995), cell frequencies represented physical counts objects. independence, point density uniform across cells (adjusted marginals), departures independence become visible density variations. approach related sieve diagrams (sieve), also use density represent association.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/labeling_points.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Labeling Function for Mosaic Displays Using Points — labeling_points","text":"Friendly, M. (1995). Conceptual Visual Models Categorical Data. American Statistician, 49, 153-160. doi:10.1080/00031305.1995.10476131 Friendly, M. (1997). Conceptual Models Visualizing Contingency Table Data. M. Greenacre & J. Blasius (Eds.), Visualization Categorical Data (pp. 17–35). Academic Press. https://www.datavis.ca/papers/koln/kolnpapr.pdf Meyer, D., Zeileis, ., Hornik, K. (2006). Strucplot Framework: Visualizing Multi-way Contingency Tables vcd. Journal Statistical Software, 17(3), 1-48. doi:10.18637/jss.v017.i03","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/labeling_points.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Labeling Function for Mosaic Displays Using Points — labeling_points","text":"","code":"library(vcd)  # 2-way table of Hair and Eye color HairEye <- margin.table(HairEyeColor, 2:1)  # Basic usage - observed frequencies as points mosaic(HairEye,        labeling = labeling_points(scale = 1))   # Show expected frequencies instead of observed mosaic(HairEye,        labeling = labeling_points(                      value_type = \"expected\",                      scale = 2,                      seed = 42)       )   # Combine with residual shading mosaic(HairEye,        shade = TRUE, legend = FALSE,        labeling = labeling_points(scale = 2, seed = 42))   # Make tiles show expected frequencies, show points for observed frequencies # Reproduces: Fig 6 in Friendly (1995) mosaic(HairEye,        type = \"expected\",        shade = TRUE, legend = FALSE,        labeling = labeling_points(scale = 2, seed = 42))"},{"path":"https://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":null,"dir":"Reference","previous_headings":"","what":"Log-Likelihood of a loglm Object — logLik.loglm","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"Calculates log-likelihood value loglm model represented object evaluated estimated coefficients.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"","code":"# S3 method for class 'loglm' logLik(object, ..., zero = 1e-10)"},{"path":"https://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"object loglm object ... compatibility S3 generic; used zero value used replace zero frequencies calculating log-likelihood","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"Returns object class logLik.  number one attribute, \"df\" (degrees freedom), giving number (estimated) parameters model.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"allows use AIC BIC, require logLik method exists extract corresponding log-likelihood model. cell frequencies stored loglm object (via argument keep.frequencies = TRUE), obtained using update. function calculates log-likelihood way allows non-integer frequencies, case 0.5 added cell frequencies allow sampling zeros.  frequencies still contain zero values, replaced value start. integer frequencies, gives result corresponding model fit using glm, whereas glm returns -Inf non-integer frequencies.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"Achim Zeileis","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"","code":"data(Titanic, package=\"datasets\")  require(MASS) titanic.mod1 <- loglm(~ (Class * Age * Sex) + Survived, data=Titanic) titanic.mod2 <- loglm(~ (Class * Age * Sex) + Survived*(Class + Age + Sex), data=Titanic) titanic.mod3 <- loglm(~ (Class * Age * Sex) + Survived*(Class + Age * Sex), data=Titanic)  logLik(titanic.mod1) #> 'log Lik.' -399.6822 (df=17) AIC(titanic.mod1, titanic.mod2, titanic.mod3) #>              df      AIC #> titanic.mod1 17 833.3644 #> titanic.mod2 22 283.9687 #> titanic.mod3 23 267.9503 BIC(titanic.mod1, titanic.mod2, titanic.mod3) #>              df      BIC #> titanic.mod1 17 858.2819 #> titanic.mod2 22 316.2149 #> titanic.mod3 23 301.6622  # compare with models fit using glm() titanic <- as.data.frame(Titanic) titanic.glm1 <- glm(Freq ~ (Class * Age * Sex) + Survived,                     data=titanic, family=poisson) titanic.glm2 <- glm(Freq ~ (Class * Age * Sex) + Survived*(Class + Age + Sex),                     data=titanic, family=poisson) titanic.glm3 <- glm(Freq ~ (Class * Age * Sex) + Survived*(Class + Age * Sex),                     data=titanic, family=poisson)  logLik(titanic.glm1) #> 'log Lik.' -399.6822 (df=17) AIC(titanic.glm1, titanic.glm2, titanic.glm3) #>              df      AIC #> titanic.glm1 17 833.3644 #> titanic.glm2 22 283.9687 #> titanic.glm3 23 267.9503 BIC(titanic.glm1, titanic.glm2, titanic.glm3) #>              df      BIC #> titanic.glm1 17 858.2819 #> titanic.glm2 22 316.2149 #> titanic.glm3 23 301.6622"},{"path":"https://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglinear Model Utilities — joint","title":"Loglinear Model Utilities — joint","text":"functions generate lists terms specify loglinear model form compatible loglin also provide conversion equivalent loglm specification shorthand character string representation. allow conceptual way specify models function type, opposed just uninterpreted list model terms also allow easy specification marginal models given contingency table. intended used tools higher-level modeling graphics functions, can also used directly.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglinear Model Utilities — joint","text":"","code":"joint(nf, table = NULL, factors = 1:nf, with = nf)  conditional(nf, table = NULL, factors = 1:nf, with = nf)  mutual(nf, table = NULL, factors = 1:nf)  saturated(nf, table = NULL, factors = 1:nf)  markov(nf, factors = 1:nf, order = 1)  loglin2formula(x, env = parent.frame())  loglin2string(x, brackets = c(\"[\", \"]\"), sep = \",\", collapse = \" \", abbrev)"},{"path":"https://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Loglinear Model Utilities — joint","text":"Code Henrique Dallazuanna, wwwhsd@gmail.com, R-help 7-4-2013","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglinear Model Utilities — joint","text":"nf number factors generate model table contingency table used factor names, typically output table factors names factors used model table specified indices factors others considered conditionally independent order order markov chain x list terms loglinear model, returned joint, conditional, ... env environment evaluate formula brackets characters use surround model terms.  Either single character string containing two characters character vector length two. sep characters used separate factor names within term collapse characters used separate terms abbrev Unused yet","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Loglinear Model Utilities — joint","text":"main model specification functions, conditional, joint, markov, ..., saturated, return list vectors indicating marginal totals fit, via margin argument loglin. element list corresponds high-order term hierarchical loglinear model, , e.g., term like c(\"\", \"B\") equivalent loglm term \":B\" hence automatically includes low-order terms. Note can used supply expected argument default mosaic function, data supplied contingency table. table shows typical results terms standard shorthand notation loglinear models, factors , B, C, ..., brackets used delimit high-order terms loglinear model. loglin2formula converts output one model formula suitable formula loglm. loglin2string converts output one string describing loglinear model shorthand bracket notation, e.g., \"[,B] [,C]\".","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":null,"dir":"Reference","previous_headings":"","what":"The Logarithmic Series Distribution — dlogseries","title":"The Logarithmic Series Distribution — dlogseries","text":"logarithmic series distribution long-tailed distribution introduced Fisher etal. (1943) connection data abundance individuals classified species.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Logarithmic Series Distribution — dlogseries","text":"","code":"dlogseries(x, prob = 0.5, log = FALSE)  plogseries(q, prob = 0.5, lower.tail = TRUE, log.p = FALSE)  qlogseries(p, prob = 0.5, lower.tail = TRUE, log.p = FALSE, max.value = 10000)  rlogseries(n, prob = 0.5)"},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Logarithmic Series Distribution — dlogseries","text":"x, q vector quantiles representing number events. prob parameter distribution, 0 < prob < 1 log, log.p logical; TRUE, probabilities p given log(p) lower.tail logical; TRUE (default), probabilities \\(P[X \\le x]\\), otherwise, \\(P[X > x]\\). p vector probabilities max.value maximum value returned qlogseries n number observations rlogseries","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Logarithmic Series Distribution — dlogseries","text":"dlogseries gives density, plogseries gives cumulative distribution function, qlogseries gives quantile function, rlogseries generates random deviates.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Logarithmic Series Distribution — dlogseries","text":"functions provide density, distribution function, quantile function random generation logarithmic series distribution parameter prob. logarithmic series distribution prob = \\(p\\) density $$ p ( x ) = \\alpha p^x / x $$ \\(x = 1, 2, \\dots\\), \\(\\alpha= -1 / \\log(1 - p)\\) \\(0 < p < 1\\). % Note counts x==2 occur.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Logarithmic Series Distribution — dlogseries","text":"https://en.wikipedia.org/wiki/Logarithmic_distribution Fisher, R. . Corbet, . S. Williams, C. B. (1943). relation number species number individuals Journal Animal Ecology, 12, 42-58.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The Logarithmic Series Distribution — dlogseries","text":"Michael Friendly, using original code modified gmlss.dist package Mikis Stasinopoulos.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/logseries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Logarithmic Series Distribution — dlogseries","text":"","code":"XL <-expand.grid(x=1:5, p=c(0.33, 0.66, 0.99)) lgs.df <- data.frame(XL, prob=dlogseries(XL[,\"x\"], XL[,\"p\"])) lgs.df$p = factor(lgs.df$p) str(lgs.df) #> 'data.frame':\t15 obs. of  3 variables: #>  $ x   : int  1 2 3 4 5 1 2 3 4 5 ... #>  $ p   : Factor w/ 3 levels \"0.33\",\"0.66\",..: 1 1 1 1 1 2 2 2 2 2 ... #>  $ prob: num  0.82402 0.13596 0.02991 0.0074 0.00195 ...  require(lattice) #> Loading required package: lattice #>  #> Attaching package: ‘lattice’ #> The following object is masked from ‘package:seriation’: #>  #>     panel.lines #> The following object is masked from ‘package:gnm’: #>  #>     barley mycol <- palette()[2:4] xyplot( prob ~ x, data=lgs.df, groups=p,   xlab=list('Number of events (k)', cex=1.25),   ylab=list('Probability',  cex=1.25),   type='b', pch=15:17, lwd=2, cex=1.25, col=mycol,   key = list(           title = 'p',           points = list(pch=15:17, col=mycol, cex=1.25),           lines = list(lwd=2, col=mycol),           text = list(levels(lgs.df$p)),           x=0.9, y=0.98, corner=c(x=1, y=1)           )   )    # random numbers hist(rlogseries(200, prob=.4), xlab='x')  hist(rlogseries(200, prob=.8), xlab='x')"},{"path":"https://friendly.github.io/vcdExtra/reference/mcaplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple and enhanced plot of MCA solutions — mcaplot","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"function intended alternative plot.mjca plotting multiple correspondence analysis solutions. provides flexibility labeling factor levels connecting lines. support features plot.mjca (centroids, supplementary points, arrows, etc.)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"","code":"mcaplot(   obj,   map = \"symmetric\",   dim = 1:2,   col = c(\"blue\", \"red\", \"brown\", \"black\", \"green3\", \"purple\"),   pch = 15:20,   cex = 1.2,   pos = 3,   lines = TRUE,   lwd = 2,   legend = FALSE,   legend.pos = \"topright\",   xlab = \"_auto_\",   ylab = \"_auto_\",   rev.axes = c(FALSE, FALSE),   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"obj \"mjca\" object map Character string specifying map type, .e., scaling applied coordinates different types MCA representations. Allowed options include: \"symmetric\" (default), \"rowprincipal\", \"colprincipal\", \"symbiplot\", \"rowgab\", \"colgab\", \"rowgreen\", \"colgreen\". See mjca details. dim Dimensions plot, integer vector length 2 col Vector colors, one factor MCA pch Vector point symbols category levels, one factor cex Character size points level labels pos Position level labels relative category points; either single number vector length equal number category points. lines logical integer vector indicating factors joined lines using multilines lwd Line width(s) lines legend Logical; draw legend factor names? legend.pos Position legend plot, legend xlab, ylab Labels horizontal vertical axes.  default, \"_auto_\" means function auto-generates label form \"Dimension X (xx.x \\%)\" rev.axes logical vector length 2, TRUE reverses direction corresponding axis ... Arguments passed plot","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"Returns coordinates category points invisibly","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"","code":"require(ca) data(Titanic) titanic.mca <- mjca(Titanic) #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE mcaplot(titanic.mca, legend=TRUE, legend.pos=\"topleft\")   data(HairEyeColor) haireye.mca <- mjca(HairEyeColor) #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE mcaplot(haireye.mca, legend=TRUE, cex.lab=1.3)"},{"path":"https://friendly.github.io/vcdExtra/reference/modFit.html","id":null,"dir":"Reference","previous_headings":"","what":"Brief Summary of Model Fit for a glm or loglm Object — modFit","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"Formats brief summary model fit glm loglm object, showing likelihood ratio Chisq (df) value AIC.  Useful inclusion plot title annotation.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/modFit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"","code":"modFit(x, ...)  # S3 method for class 'glm' modFit(x, stats = \"chisq\", digits = 2, ...)  # S3 method for class 'loglm' modFit(x, stats = \"chisq\", digits = 2, ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/modFit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"x glm loglm object ... Arguments passed stats statistics print: one \"chisq\", \"aic\" digits number digits use print method","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/modFit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"character string containing formatted values chosen statistics.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/modFit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/modFit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"","code":"data(Mental) require(MASS) (Mental.tab <- xtabs(Freq ~ ses + mental, data=Mental)) #>    mental #> ses Well Mild Moderate Impaired #>   1   64   94       58       46 #>   2   57   94       54       40 #>   3   57  105       65       60 #>   4   72  141       77       94 #>   5   36   97       54       78 #>   6   21   71       54       71 (Mental.mod <- loglm(~ses + mental, Mental.tab)) #> Call: #> loglm(formula = ~ses + mental, data = Mental.tab) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 47.41785 15 3.155408e-05 #> Pearson          45.98526 15 5.345771e-05 Mental.mod #> Call: #> loglm(formula = ~ses + mental, data = Mental.tab) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 47.41785 15 3.155408e-05 #> Pearson          45.98526 15 5.345771e-05 modFit(Mental.mod) #> [1] \"G^2(15)=47.42\"  # use to label mosaic() mosaic(Mental.mod, main=paste(\"Independence model,\", modFit(Mental.mod))) #> Error in eval(expr, p): object 'Mental.tab' not found"},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"Produces mosaic plots (plots strucplot framework) log-linear model fitted glm generalized nonlinear model fitted gnm.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"","code":"# S3 method for class 'glm' mosaic(   x,   formula = NULL,   panel = mosaic,   type = c(\"observed\", \"expected\"),   residuals = NULL,   residuals_type = c(\"pearson\", \"deviance\", \"rstandard\"),   gp = shading_hcl,   gp_args = list(),   ... )  # S3 method for class 'glm' sieve(x, ...)  # S3 method for class 'glm' assoc(x, ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"x glm gnm object. response variable, typically cell frequency, non-negative. formula one-sided formula indexing factors plot separated '+', determining order variables used mosaic.  formula must provided unless x$data inherits class \"table\" – case indexing factors table used, factors x$data (model.frame(x) x$data environment) exactly cross-classify data – case set cross-classifying factors used. panel Panel function used draw plot visualizing observed values, residuals expected values. Currently, one \"mosaic\", \"assoc\", \"sieve\" vcd. type character string indicating whether \"observed\" \"expected\" values table visualized area tiles bars. residuals optional array vector residuals corresponding cells data, example, calculated residuals.glm(x), residuals.gnm(x). residuals_type residuals argument NULL, residuals calculated internally used display.  case, residual_type can \"pearson\", \"deviance\" \"rstandard\".  Otherwise (residuals supplied), residuals_type used label legend plot. gp Object class \"gpar\", shading function corresponding generating function (see strucplot Details shadings).  Ignored shade = FALSE. gp_args list arguments shading-generating function, specified. ... arguments passed panel function e.g., mosaic","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"structable visualized strucplot returned invisibly.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"methods extend range strucplot visualizations well beyond models can fit loglm. intended models counts using Poisson family (quasi-poisson), sensible long () response variable non-negative (b) predictors visualized strucplot discrete factors. poisson family generalized linear models loglinear models, standardized residuals provided rstandard (sometimes called adjusted residuals) often preferred constant unit asymptotic variance. sieve assoc methods simple convenience interfaces plot method, setting panel argument accordingly.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"Heather Turner, Michael Friendly, help Achim Zeileis","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"","code":"library(vcdExtra)  GSStab <- xtabs(count ~ sex + party, data=GSS) # using the data in table form mod.glm1 <- glm(Freq ~ sex + party, family = poisson, data = GSStab) res <- residuals(mod.glm1) std <- rstandard(mod.glm1)  # For mosaic.default(), need to re-shape residuals to conform to data stdtab <- array(std,                 dim=dim(GSStab),                 dimnames=dimnames(GSStab))  mosaic(GSStab,        gp=shading_Friendly,        residuals=stdtab,        residuals_type=\"Std\\nresiduals\",        labeling = labeling_residuals)    # Using externally calculated residuals with the glm() object mosaic(mod.glm1,        residuals=std,        labeling = labeling_residuals,        shade=TRUE)   # Using residuals_type mosaic(mod.glm1,        residuals_type=\"rstandard\",        labeling = labeling_residuals, shade=TRUE)   ## Ordinal factors and structured associations data(Mental) xtabs(Freq ~ mental+ses, data=Mental) #>           ses #> mental       1   2   3   4   5   6 #>   Well      64  57  57  72  36  21 #>   Mild      94  94 105 141  97  71 #>   Moderate  58  54  65  77  54  54 #>   Impaired  46  40  60  94  78  71 long.labels <- list(set_varnames = c(mental=\"Mental Health Status\",                                      ses=\"Parent SES\"))  # fit independence model # Residual deviance: 47.418 on 15 degrees of freedom indep <- glm(Freq ~ mental+ses,              family = poisson, data = Mental)  long.labels <- list(set_varnames = c(mental=\"Mental Health Status\",                                      ses=\"Parent SES\")) mosaic(indep,        residuals_type=\"rstandard\",        labeling_args = long.labels,        labeling=labeling_residuals) #> Warning: no formula provided, assuming ~ses + mental   # or, show as a sieve diagram mosaic(indep,        labeling_args = long.labels,        panel=sieve,        gp=shading_Friendly) #> Warning: no formula provided, assuming ~ses + mental   # fit linear x linear (uniform) association.  Use integer scores for rows/cols Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)  mosaic(linlin,        residuals_type=\"rstandard\",        labeling_args = long.labels,        labeling=labeling_residuals,        suppress=1,        gp=shading_Friendly,        main=\"Lin x Lin model\") #> Warning: no formula provided, assuming ~ses + mental   ##  Goodman Row-Column association model fits even better (deviance 3.57, df 8) if (require(gnm)) { Mental$mental <- C(Mental$mental, treatment) Mental$ses <- C(Mental$ses, treatment) RC1model <- gnm(Freq ~ ses + mental + Mult(ses, mental),                 family = poisson, data = Mental)  mosaic(RC1model,        residuals_type=\"rstandard\",        labeling_args = long.labels,        labeling=labeling_residuals,        suppress=1,        gp=shading_Friendly,        main=\"RC1 model\")  } #> Initialising #> Running start-up iterations.. #> Running main iterations........ #> Done #> Warning: no formula provided, assuming ~ses + mental    ############# UCB Admissions data, fit using glm()  structable(Dept ~ Admit+Gender,UCBAdmissions) #>                 Dept   A   B   C   D   E   F #> Admit    Gender                              #> Admitted Male        512 353 120 138  53  22 #>          Female       89  17 202 131  94  24 #> Rejected Male        313 207 205 279 138 351 #>          Female       19   8 391 244 299 317  berkeley <- as.data.frame(UCBAdmissions) berk.glm1 <- glm(Freq ~ Dept * (Gender+Admit), data=berkeley, family=\"poisson\") summary(berk.glm1) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit), family = \"poisson\",  #>     data = berkeley) #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.27557    0.04248 147.744  < 2e-16 *** #> DeptB               -0.40575    0.06770  -5.993 2.06e-09 *** #> DeptC               -1.53939    0.08305 -18.536  < 2e-16 *** #> DeptD               -1.32234    0.08159 -16.207  < 2e-16 *** #> DeptE               -2.40277    0.11014 -21.816  < 2e-16 *** #> DeptF               -3.09624    0.15756 -19.652  < 2e-16 *** #> GenderFemale        -2.03325    0.10233 -19.870  < 2e-16 *** #> AdmitRejected       -0.59346    0.06838  -8.679  < 2e-16 *** #> DeptB:GenderFemale  -1.07581    0.22860  -4.706 2.52e-06 *** #> DeptC:GenderFemale   2.63462    0.12343  21.345  < 2e-16 *** #> DeptD:GenderFemale   1.92709    0.12464  15.461  < 2e-16 *** #> DeptE:GenderFemale   2.75479    0.13510  20.391  < 2e-16 *** #> DeptF:GenderFemale   1.94356    0.12683  15.325  < 2e-16 *** #> DeptB:AdmitRejected  0.05059    0.10968   0.461    0.645     #> DeptC:AdmitRejected  1.20915    0.09726  12.432  < 2e-16 *** #> DeptD:AdmitRejected  1.25833    0.10152  12.395  < 2e-16 *** #> DeptE:AdmitRejected  1.68296    0.11733  14.343  < 2e-16 *** #> DeptF:AdmitRejected  3.26911    0.16707  19.567  < 2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   21.736  on  6  degrees of freedom #> AIC: 216.8 #>  #> Number of Fisher Scoring iterations: 4 #>   mosaic(berk.glm1,        gp=shading_Friendly,        labeling=labeling_residuals,        formula=~Admit+Dept+Gender)   # the same, displaying studentized residuals; # note use of formula to reorder factors in the mosaic mosaic(berk.glm1,        residuals_type=\"rstandard\",        labeling=labeling_residuals,        shade=TRUE,        formula=~Admit+Dept+Gender,        main=\"Model: [DeptGender][DeptAdmit]\")   ## all two-way model berk.glm2 <- glm(Freq ~ (Dept + Gender + Admit)^2, data=berkeley, family=\"poisson\") summary(berk.glm2) #>  #> Call: #> glm(formula = Freq ~ (Dept + Gender + Admit)^2, family = \"poisson\",  #>     data = berkeley) #>  #> Coefficients: #>                            Estimate Std. Error z value Pr(>|z|)     #> (Intercept)                 6.27150    0.04271 146.855  < 2e-16 *** #> DeptB                      -0.40322    0.06784  -5.944 2.78e-09 *** #> DeptC                      -1.57790    0.08949 -17.632  < 2e-16 *** #> DeptD                      -1.35000    0.08526 -15.834  < 2e-16 *** #> DeptE                      -2.44982    0.11755 -20.840  < 2e-16 *** #> DeptF                      -3.13787    0.16174 -19.401  < 2e-16 *** #> GenderFemale               -1.99859    0.10593 -18.866  < 2e-16 *** #> AdmitRejected              -0.58205    0.06899  -8.436  < 2e-16 *** #> DeptB:GenderFemale         -1.07482    0.22861  -4.701 2.58e-06 *** #> DeptC:GenderFemale          2.66513    0.12609  21.137  < 2e-16 *** #> DeptD:GenderFemale          1.95832    0.12734  15.379  < 2e-16 *** #> DeptE:GenderFemale          2.79519    0.13925  20.073  < 2e-16 *** #> DeptF:GenderFemale          2.00232    0.13571  14.754  < 2e-16 *** #> DeptB:AdmitRejected         0.04340    0.10984   0.395    0.693     #> DeptC:AdmitRejected         1.26260    0.10663  11.841  < 2e-16 *** #> DeptD:AdmitRejected         1.29461    0.10582  12.234  < 2e-16 *** #> DeptE:AdmitRejected         1.73931    0.12611  13.792  < 2e-16 *** #> DeptF:AdmitRejected         3.30648    0.16998  19.452  < 2e-16 *** #> GenderFemale:AdmitRejected -0.09987    0.08085  -1.235    0.217     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   20.204  on  5  degrees of freedom #> AIC: 217.26 #>  #> Number of Fisher Scoring iterations: 4 #>   mosaic(berk.glm2,        residuals_type=\"rstandard\",        labeling = labeling_residuals,        shade=TRUE,        formula=~Admit+Dept+Gender,        main=\"Model: [DeptGender][DeptAdmit][AdmitGender]\")   anova(berk.glm1, berk.glm2, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ (Dept + Gender + Admit)^2 #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi) #> 1         6     21.735                      #> 2         5     20.204  1   1.5312   0.2159  # Add 1 df term for association of [GenderAdmit] only in Dept A berkeley <- within(berkeley,                    dept1AG <- (Dept=='A')*(Gender=='Female')*(Admit=='Admitted')) berkeley[1:6,] #>      Admit Gender Dept Freq dept1AG #> 1 Admitted   Male    A  512       0 #> 2 Rejected   Male    A  313       0 #> 3 Admitted Female    A   89       1 #> 4 Rejected Female    A   19       0 #> 5 Admitted   Male    B  353       0 #> 6 Rejected   Male    B  207       0  berk.glm3 <- glm(Freq ~ Dept * (Gender+Admit) + dept1AG, data=berkeley, family=\"poisson\") summary(berk.glm3) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit) + dept1AG, family = \"poisson\",  #>     data = berkeley) #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.23832    0.04419 141.157  < 2e-16 *** #> DeptB               -0.36850    0.06879  -5.357 8.47e-08 *** #> DeptC               -1.50215    0.08394 -17.895  < 2e-16 *** #> DeptD               -1.28509    0.08250 -15.577  < 2e-16 *** #> DeptE               -2.36552    0.11081 -21.347  < 2e-16 *** #> DeptF               -3.05899    0.15803 -19.357  < 2e-16 *** #> GenderFemale        -2.80176    0.23628 -11.858  < 2e-16 *** #> AdmitRejected       -0.49212    0.07175  -6.859 6.94e-12 *** #> dept1AG              1.05208    0.26271   4.005 6.21e-05 *** #> DeptB:GenderFemale  -0.30730    0.31243  -0.984    0.325     #> DeptC:GenderFemale   3.40313    0.24615  13.825  < 2e-16 *** #> DeptD:GenderFemale   2.69560    0.24676  10.924  < 2e-16 *** #> DeptE:GenderFemale   3.52330    0.25220  13.970  < 2e-16 *** #> DeptF:GenderFemale   2.71207    0.24787  10.941  < 2e-16 *** #> DeptB:AdmitRejected -0.05074    0.11181  -0.454    0.650     #> DeptC:AdmitRejected  1.10781    0.09966  11.116  < 2e-16 *** #> DeptD:AdmitRejected  1.15699    0.10381  11.145  < 2e-16 *** #> DeptE:AdmitRejected  1.58162    0.11933  13.254  < 2e-16 *** #> DeptF:AdmitRejected  3.16777    0.16848  18.803  < 2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.0952  on 23  degrees of freedom #> Residual deviance:    2.6815  on  5  degrees of freedom #> AIC: 199.74 #>  #> Number of Fisher Scoring iterations: 3 #>   mosaic(berk.glm3,        residuals_type = \"rstandard\",        labeling = labeling_residuals,        shade=TRUE,         formula = ~Admit+Dept+Gender,         main = \"Model: [DeptGender][DeptAdmit] + DeptA*[GA]\")   # compare models anova(berk.glm1, berk.glm3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ Dept * (Gender + Admit) + dept1AG #>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     #> 1         6    21.7355                           #> 2         5     2.6815  1   19.054 1.271e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":null,"dir":"Reference","previous_headings":"","what":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"function provides convenient interface viewing mosaic displays associated collection glm models frequency tables stored glmlist loglmlist object.  can plot either selected models individually, mosaics models array viewports.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"","code":"# S3 method for class 'glmlist' mosaic(   x,   selection,   panel = mosaic,   type = c(\"observed\", \"expected\"),   legend = ask | !missing(selection),   main = NULL,   ask = TRUE,   graphics = TRUE,   rows,   cols,   newpage = TRUE,   ... )  # S3 method for class 'loglmlist' mosaic(   x,   selection,   panel = mosaic,   type = c(\"observed\", \"expected\"),   legend = ask | !missing(selection),   main = NULL,   ask = TRUE,   graphics = TRUE,   rows,   cols,   newpage = TRUE,   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"x glmlist loglmlist object selection index name one glm loglm object x.  selection specified, menu models presented models plotted. panel strucplot panel function, typically mosaic sieve type character string indicating whether \"observed\" \"expected\" values table visualized legend logical: show legend residuals mosaic display(s)? default behavior include legend single plot shown, .e., ask TRUE selection specified. main either logical, vector character strings used plotting main title.  main logical TRUE, name selected glm object used. ask logical: function display menu models, one specified selection? selection supplied ask TRUE (default), menu model names presented; ask FALSE, mosaics models plotted array. graphics logical: use graphic dialog box ask=TRUE? rows, cols ask=FALSE, number rows columns plot mosaics. newpage start new page? (applies ask=FALSE) ... arguments passed mosaic.glm ultimately mosaic.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"Returns result mosaic.glm.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"details plots produced can controlled via ... arguments shown examples .  particular, panel=sieve need also pass gp=shading_Friendly get color version.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"David Meyer, Achim Zeileis, Kurt Hornik (2006). Strucplot Framework: Visualizing Multi-Way Contingency Tables vcd. Journal Statistical Software, 17(3), 1-48. https://www.jstatsoft.org/v17/i03/, available vignette(\"strucplot\", package=\"vcd\").","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mosaic Displays for glmlist and loglmlist Objects — mosaic.glmlist","text":"","code":"data(JobSatisfaction, package=\"vcd\")  # view all pairwise mosaics pairs(xtabs(Freq~management+supervisor+own, data=JobSatisfaction),     shade=TRUE, diag_panel=pairs_diagonal_mosaic)   modSat <- Kway(Freq ~ management+supervisor+own, data=JobSatisfaction,                family=poisson, prefix=\"JobSat\") names(modSat) #> [1] \"JobSat.0\" \"JobSat.1\" \"JobSat.2\" \"JobSat.3\"  if (FALSE) { # \\dontrun{ mosaic(modSat)              # uses menu, if interactive() } # } mosaic(modSat, \"JobSat.1\")  # model label #> Warning: no formula provided, assuming ~management + supervisor + own  mosaic(modSat, 2)           # model index #> Warning: no formula provided, assuming ~management + supervisor + own   # supply a formula to determine the order of variables in the mosaic mosaic(modSat, 2, formula=~own+supervisor+management)   mosaic(modSat, ask=FALSE)   # uses viewports #> Warning: no formula provided, assuming ~management + supervisor + own #> Warning: no formula provided, assuming ~management + supervisor + own #> Warning: no formula provided, assuming ~management + supervisor + own #> Warning: no formula provided, assuming ~management + supervisor + own   # use a different panel function, label the observed valued in the cells mosaic(modSat, 1, main=TRUE, panel=sieve, gp=shading_Friendly, labeling=labeling_values) #> Warning: no formula provided, assuming ~management + supervisor + own   data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)  # assign names for the plot labels modMental <- glmlist(Indep=indep, ColEff=coleff, RowEff=roweff, `Lin x Lin`=linlin) mosaic(modMental, ask=FALSE, margins=c(3,1,1,2), labeling_args=list(abbreviate_labs=5)) #> Warning: no formula provided, assuming ~ses + mental #> Warning: no formula provided, assuming ~ses + mental #> Warning: no formula provided, assuming ~ses + mental #> Warning: no formula provided, assuming ~ses + mental"},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":null,"dir":"Reference","previous_headings":"","what":"3D Mosaic Plots — mosaic3d","title":"3D Mosaic Plots — mosaic3d","text":"Produces 3D mosaic plot contingency table (link[MASS]{loglm} model) using rgl-package.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"3D Mosaic Plots — mosaic3d","text":"","code":"mosaic3d(x, ...)  # S3 method for class 'loglm' mosaic3d(   x,   type = c(\"observed\", \"expected\"),   residuals_type = c(\"pearson\", \"deviance\"),   ... )  # Default S3 method mosaic3d(   x,   expected = NULL,   residuals = NULL,   type = c(\"observed\", \"expected\"),   residuals_type = NULL,   shape = rgl::cube3d(alpha = alpha),   alpha = 0.5,   spacing = 0.1,   split_dir = 1:3,   shading = shading_basic,   interpolate = c(2, 4),   zero_size = 0.05,   label_edge,   labeling_args = list(),   newpage = TRUE,   box = FALSE,   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"3D Mosaic Plots — mosaic3d","text":"x link[MASS]{loglm} model object. Alternatively, multidimensional array table orstructable frequencies contingency table.  present implementation, dimensions taken sequential order. Use link[base]{aperm} structable change . ... arguments passed mosaic.default 3D functions. type character string indicating whether \"observed\" \"expected\" frequencies table visualized volume 3D tiles. residuals_type character string indicating type residuals computed none supplied.  residuals NULL, residuals_type must one \"pearson\" (default; giving components Pearson's chi-squared), \"deviance\" (giving components likelihood ratio chi-squared), \"FT\" Freeman-Tukey residuals.  value argument can abbreviated. expected optionally, contingency tables, array expected frequencies dimension x, alternatively corresponding loglinear model specification used bylink[stats]{loglin} link[MASS]{loglm} (see structable details). residuals optionally, array residuals dimension x (see details). shape initial 3D shape mosaic based.  Typically call rgl function, must produce shape3d object. default \"unit cube\" (-1, +1), transparency specified alpha. alpha Specifies transparency 3D tiles used compose 3D mosaic. spacing number vector giving total amount space used separate 3D tiles along dimensions table. values specified re-cycled number table dimensions. split_dir numeric vector composed integers 1:3 character vector composed c(\"x\", \"y\", \"z\"), split_dir[] specifies axis along tiles split dimension table. values specified re-cycled number table dimensions. shading function, taking array vector residuals given model, returning vector colors.  present, default shading=shading_basic provided. roughly equivalent use shade argument mosaicplot use gp=shading_Friendly mosaic. interpolate vector interpolation values shading function. zero_size radius small sphere used mark zero cells display. label_edge character vector composed c(\"-\", \"+\") indicating whether labels given table dimension written minima (\"-\") maxima (\"+\") dimensions plot. default rep( c('-', '+'), =3, length=ndim), meaning first three table variables labeled minima, successive ones maxima. labeling_args argument intended used specify details rendering labels table dimensions, present effect. newpage logical indicating whether new page created plot . box logical indicating whether bounding box drawn around plot.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"3D Mosaic Plots — mosaic3d","text":"Invisibly, list shape3d objects used draw 3D mosaic, names corresponding concatenation level labels, separated \":\".","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"3D Mosaic Plots — mosaic3d","text":"Generalizing 2D mosaic plot, begins given 3D shape (unit cube), successively sub-divides along X, Y, Z dimensions according table margins, generating nested set 3D tiles. volume resulting tiles therefore proportional frequency represented table cells. Residuals given loglinear model used color shade tiles. developing implementation.  arguments details subject change. Friendly (1995), Friendly (2000, Sect. 4.5) Theus Lauer (1999) used idea 3D mosaic displays explain various aspects loglinear models (iterative proportional fitting algorithm, structure various models 3-way n-way tables, etc.), implementation 3D mosaics previously available. default method, residuals, used color shade 3D tiles, can passed explicitly, , typically, computed needed observed expected frequencies. case, expected frequencies optionally computed specified loglinear model given expected argument. loglm method, residuals observed frequencies calculated model object.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"3D Mosaic Plots — mosaic3d","text":"Friendly, M. (1995). Conceptual Visual Models Categorical Data, American Statistician, 49, 153-160. Friendly, M. Visualizing Categorical Data, Cary NC: SAS Institute, 2000. Web materials: http://www.datavis.ca/books/vcd/. Theus, M. & Lauer, S. R. W. (1999) Visualizing Loglinear Models. Journal Computational Graphical Statistics, 8, 396-412.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"3D Mosaic Plots — mosaic3d","text":"Michael Friendly, help Duncan Murdoch Achim Zeileis","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"3D Mosaic Plots — mosaic3d","text":"","code":"# 2 x 2 x 2 if (!rgl::rgl.useNULL() && interactive()){ mosaic3d(Bartlett, box=TRUE) # compare with expected frequencies under model of mutual independence mosaic3d(Bartlett, type=\"expected\", box=TRUE)  # 2 x 2 x 3 mosaic3d(Heart, box=TRUE) }  # Make a dynamic display if (FALSE) { # \\dontrun{   mosaic3d(Heart, box=TRUE, alpha = 0.3, interpolate = c(1, 2, 4))   play3d(spin3d(axis = c(0, 1, 0), rpm = 10), duration = 5) } # }  if (FALSE) { # \\dontrun{ # 2 x 2 x 2 x 3 # illustrates a 4D table mosaic3d(Detergent)  # compare 2D and 3D mosaics #demo(\"mosaic-hec\") } # }"},{"path":"https://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Kappa — print.Kappa","title":"Print Kappa — print.Kappa","text":"replacement print.Kappa method vcd, adding display z values vcd version optional confidence intervals.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Kappa — print.Kappa","text":"","code":"# S3 method for class 'Kappa' print(   x,   digits = max(getOption(\"digits\") - 3, 3),   CI = FALSE,   level = 0.95,   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Kappa — print.Kappa","text":"x Kappa object digits number digits print CI Include confidence intervals display? level confidence level ... arguments","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Kappa — print.Kappa","text":"Returns Kappa object, invisibly.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print Kappa — print.Kappa","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print Kappa — print.Kappa","text":"","code":"data(\"SexualFun\") Kappa(SexualFun) #>             value     ASE     z #> Unweighted 0.1293 0.06860 1.885 #> Weighted   0.2374 0.07832 3.031 print(Kappa(SexualFun), CI=TRUE) #>             value     ASE     z    lower  upper #> Unweighted 0.1293 0.06860 1.885 -0.00512 0.2638 #> Weighted   0.2374 0.07832 3.031  0.08388 0.3909  # stratified 3-way table apply(MSPatients, 3, Kappa) #> $Winnipeg #>             value     ASE     z #> Unweighted 0.2079 0.05046 4.121 #> Weighted   0.3797 0.05167 7.350 #>  #> $`New Orleans` #>             value     ASE     z #> Unweighted 0.2965 0.07850 3.777 #> Weighted   0.4773 0.07303 6.535 #>"},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":null,"dir":"Reference","previous_headings":"","what":"Sequential Loglinear Models for an N-way Table — seq_loglm","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"function takes n-way contingency table fits series sequential models 1-, 2-, ... n-way marginal tables, corresponding variety types loglinear models.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"","code":"seq_loglm(   x,   type = c(\"joint\", \"conditional\", \"mutual\", \"markov\", \"saturated\"),   marginals = 1:nf,   vorder = 1:nf,   k = NULL,   prefix = \"model\",   fitted = TRUE,   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"x contingency table array form, optional category labels specified dimnames(x) attribute, else data.frame frequency form, frequency variable named \"Freq\". type type sequential model fit, character string. One \"joint\", \"conditional\", \"mutual\", \"markov\", \"saturated\". marginals marginal sub-tables fit? vector (sub)set integers, 1:nf nf number factors full n-way table. vorder order variables, permutation integers 1:nf, used reorder variables original table purpose fitting sequential marginal models. k conditioning variable(s) type = \"joint\", \"conditional\" Markov chain order type = \"markov\" prefix prefix used give names sequential models fitted argument passed loglm store fitted values model objects ... arguments, passed ","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"object class \"loglmlist\", class \"loglm\" object","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"Sequential marginal models n-way tables begin model equal-probability one-way margin (equivalent chisq.test) add successive variables one time order specified vorder. model types give result two-way margin, namely test independence first two factors. Sequential models joint independence (type=\"joint\") particularly simple interpretation, decompose likelihood ratio test model mutual independence full n-way table, hence account \"total\" association terms portions attributable conditional probabilities new variable, given prior variables.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"One-way marginal tables bit problem , fit directly using loglm. present version uses loglin, repairs result look like loglm object (sort ).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"functions inspired original SAS implementation mosaic displays, described User's Guide, http://www.datavis.ca/mosaics/mosaics.pdf","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"","code":"data(Titanic, package=\"datasets\") # variables are in the order Class, Sex, Age, Survived tt <- seq_loglm(Titanic)"},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":null,"dir":"Reference","previous_headings":"","what":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"function takes n-way contingency table plots mosaics series sequential models 1-, 2-, ... n-way marginal tables, corresponding variety types loglinear models.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"","code":"seq_mosaic(   x,   panel = mosaic,   type = c(\"joint\", \"conditional\", \"mutual\", \"markov\", \"saturated\"),   plots = 1:nf,   vorder = 1:nf,   k = NULL,   ... )"},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"x contingency table array form, optional category labels specified dimnames(x) attribute, else data.frame frequency form, frequency variable named \"Freq\". panel strucplot panel function, typically mosaic sieve. yet implemented. type type sequential model fit, character string. One \"joint\", \"conditional\", \"mutual\", \"markov\", \"saturated\". plots marginal sub-tables plot? vector (sub)set integers, 1:nf nf number factors full n-way table. vorder order variables, permutation integers 1:nf, used reorder variables original table purpose fitting sequential marginal models. k conditioning variable(s) type = \"joint\", \"conditional\" Markov chain order type = \"markov\" ... arguments passed mosaic.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"None. Used side-effect producing plots","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"function produces similar plots use mosaic.loglmlist, called result seq_loglm.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"functions inspired original SAS implementation mosaic displays, described User's Guide Mosaics, http://www.datavis.ca/mosaics/mosaics.pdf","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"","code":"data(Titanic, package=\"datasets\")  seq_mosaic(Titanic)  # models of joint independence, Survived last     seq_mosaic(Titanic, type=\"condit\")     seq_mosaic(Titanic, type=\"mutual\")      # other panel functions and options: presently BUGGED if (FALSE) { # \\dontrun{ seq_mosaic(Titanic, type=\"mutual\", panel=sieve,    gp=shading_Friendly, labeling=labeling_values) } # }"},{"path":"https://friendly.github.io/vcdExtra/reference/split3d.html","id":null,"dir":"Reference","previous_headings":"","what":"Subdivide a 3D Object — split3d","title":"Subdivide a 3D Object — split3d","text":"Subdivides shape3d object list shape3d objects objects shape along given dimension according proportions frequencies specified vector(s).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/split3d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subdivide a 3D Object — split3d","text":"","code":"split3d(obj, ...)  # S3 method for class 'shape3d' split3d(obj, p, dim, space = 0.1, ...)  # S3 method for class 'list' split3d(obj, p, dim, space = 0.1, ...)  range3d(obj)  center3d(obj)"},{"path":"https://friendly.github.io/vcdExtra/reference/split3d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subdivide a 3D Object — split3d","text":"obj shape3d object, list composed ... arguments split3d methods p single shade3d object, vector proportions (vector non-negative numbers normed proportions) indicating number subdivisions scaling along dimension dim. list shade3d objects, matrix whose columns indicate subdivisions object. dim dimension along object subdivided. Either integer: 1, 2, 3, character: \"x\", \"y\", \"z\". space total space used separate copies object along dimension dim. unit inter-object space therefore space/(length(p)-1).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/split3d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subdivide a 3D Object — split3d","text":"split3d returns list shape3d objects. range3d returns 2 x 3 matrix, whose first row contains minima dimensions x, y, z, whose second row contains maxima. center3d returns numeric vector containing means minima maxima dimensions x, y, z.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/split3d.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Subdivide a 3D Object — split3d","text":"split3d basic workhorse used mosaic3d, may useful contexts. range3d center3d utility functions, also useful contexts. resulting list shape3d objects actually composed copies input object(s), scaled according proportions p translated make range along splitting dimension equal input object(s).","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/split3d.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Subdivide a 3D Object — split3d","text":"Duncan Murdoch, refinements Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/split3d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subdivide a 3D Object — split3d","text":"","code":"if (!rgl::rgl.useNULL() && interactive()){   open3d()   cube <- cube3d(alpha=0.4)   sl1 <- split3d(cube, c(.2, .3, .5), 1)   col <- c(\"#FF000080\", \"#E5E5E580\", \"#0000FF80\")   shapelist3d(sl1, col=col)    open3d()   p <- matrix(c(.6, .4, .5, .5, .2, .8), nrow=2)   sl2 <- split3d(sl1, p, 2)   shapelist3d(sl2, col=col)   }"},{"path":"https://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":null,"dir":"Reference","previous_headings":"","what":"Update method for a xtabs object — update.xtabs","title":"Update method for a xtabs object — update.xtabs","text":"Provides update method \"xtabs\" objects, typically removing terms formula collapse .","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update method for a xtabs object — update.xtabs","text":"","code":"# S3 method for class 'xtabs' update(object, formula., ..., evaluate = TRUE)"},{"path":"https://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update method for a xtabs object — update.xtabs","text":"object existing \"xtabs\" object formula. Changes formula ? see update.formula details ... Additional arguments call, arguments changed values. evaluate TRUE, evaluate new call else return call","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update method for a xtabs object — update.xtabs","text":"evaluate == TRUE, new \"xtabs\" object, otherwise updated call","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Update method for a xtabs object — update.xtabs","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update method for a xtabs object — update.xtabs","text":"","code":"vietnam.tab <- xtabs(Freq ~ sex + year + response, data=Vietnam)  update(vietnam.tab, formula = ~ . -year) #>         response #> sex        A   B   C   D #>   Female  71 105 369  37 #>   Male   730 633 950 252"},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"package provides additional data sets, documentation, functions designed extend vcd package Visualizing Categorical Data gnm package Generalized Nonlinear Models. particular, vcdExtra extends mosaic, assoc sieve plots vcd handle glm() gnm() models adds 3D version mosaic3d. package also support package book, Discrete Data Analysis R Michael Friendly David Meyer, Chapman & Hall/CRC, 2016, https://www.routledge.com/Discrete-Data-Analysis--R-Visualization--Modeling-Techniques--Categorical--Count-Data/Friendly-Meyer/p/book/9781498725835 number additional data sets, functions. web site book http://ddar.datavis.ca. addition, teach course, Psy 6136: Categorical Data Analysis, https://friendly.github.io/psy6136/ using package. main purpose package serve sandbox introducing extensions mosaic plots related graphical methods apply loglinear models fitted using glm() related, generalized nonlinear models fitted gnm() gnm-package package. related purpose fill holes analysis categorical data R, provided base R, vcd, commonly used packages. method mosaic.glm extends mosaic.loglm method vcd package wider class models.  method also works generalized nonlinear models fit gnm-package package, including models square tables models multiplicative associations. mosaic3d introduces 3D generalization mosaic displays using rgl package. addition, several new data sets, tutorial vignette, vcd-tutorial Working categorical data R vcd package, vignette(\"vcd-tutorial\", package = \"vcdExtra\") functions manipulating categorical data sets working models categorical data. new class, glmlist, introduced working collections glm objects, e.g., Kway fitting K-way models basic marginal model, LRstats brief statistical summaries goodness--fit collection models. square tables ordered factors, Crossings supplements specification terms model formulas using Symm, Diag, Topo, etc. gnm-package. extensions may migrated vcd gnm. collection demos included illustrate fitting visualizing wide variety models: mental-glm Mental health data: mosaics glm() gnm() models occStatus Occupational status data: Compare mosaic using expected= mosaic.glm ucb-glm UCBAdmissions data: Conditional independence via loglm() glm() vision-quasi VisualAcuity data: Quasi- Symmetry models yaish-unidiff Yaish data: Unidiff model 3-way table Wong2-3 Political views support women work (U, R, C, R+C RC(1) models) Wong3-1 Political views, support women work national welfare spending (3-way, marginal, conditional independence models) housing Visualize glm(), multinom() polr() models example(housing, package=\"MASS\") Use  demo(package=\"vcdExtra\") complete current list. vcdExtra package now contains large number data sets illustrating various forms categorical data analysis related visualizations, simple advanced. Use data(package=\"vcdExtra\") complete list, datasets(package=\"vcdExtra\") annotated one showing class dim data set.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"Friendly, M. Visualizing Categorical Data, Cary NC: SAS Institute, 2000. Web materials: http://www.datavis.ca/books/vcd/. Friendly, M. Meyer, D. (2016). Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data. Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Meyer, D.; Zeileis, . & Hornik, K. Strucplot Framework: Visualizing Multi-way Contingency Tables vcd Journal Statistical Software, 2006, 17, 1-48. Available R via vignette(\"strucplot\", package = \"vcd\") Turner, H. Firth, D. Generalized nonlinear models R: overview gnm package, 2007, http://eprints.ncrm.ac.uk/472/. Available R via vignette(\"gnmOverview\", package = \"gnm\").","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"Michael Friendly Maintainer: Michael Friendly (ORCID)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"","code":"example(mosaic.glm) #>  #> msc.gl> library(vcdExtra) #>  #> msc.gl> GSStab <- xtabs(count ~ sex + party, data=GSS) #>  #> msc.gl> # using the data in table form #> msc.gl> mod.glm1 <- glm(Freq ~ sex + party, family = poisson, data = GSStab) #>  #> msc.gl> res <- residuals(mod.glm1) #>  #> msc.gl> std <- rstandard(mod.glm1) #>  #> msc.gl> # For mosaic.default(), need to re-shape residuals to conform to data #> msc.gl> stdtab <- array(std, #> msc.gl+                 dim=dim(GSStab), #> msc.gl+                 dimnames=dimnames(GSStab)) #>  #> msc.gl> mosaic(GSStab, #> msc.gl+        gp=shading_Friendly, #> msc.gl+        residuals=stdtab, #> msc.gl+        residuals_type=\"Std\\nresiduals\", #> msc.gl+        labeling = labeling_residuals)  #>  #> msc.gl> # Using externally calculated residuals with the glm() object #> msc.gl> mosaic(mod.glm1, #> msc.gl+        residuals=std, #> msc.gl+        labeling = labeling_residuals, #> msc.gl+        shade=TRUE)  #>  #> msc.gl> # Using residuals_type #> msc.gl> mosaic(mod.glm1, #> msc.gl+        residuals_type=\"rstandard\", #> msc.gl+        labeling = labeling_residuals, shade=TRUE)  #>  #> msc.gl> ## Ordinal factors and structured associations #> msc.gl> data(Mental) #>  #> msc.gl> xtabs(Freq ~ mental+ses, data=Mental) #>           ses #> mental       1   2   3   4   5   6 #>   Well      64  57  57  72  36  21 #>   Mild      94  94 105 141  97  71 #>   Moderate  58  54  65  77  54  54 #>   Impaired  46  40  60  94  78  71 #>  #> msc.gl> long.labels <- list(set_varnames = c(mental=\"Mental Health Status\", #> msc.gl+                                      ses=\"Parent SES\")) #>  #> msc.gl> # fit independence model #> msc.gl> # Residual deviance: 47.418 on 15 degrees of freedom #> msc.gl> indep <- glm(Freq ~ mental+ses, #> msc.gl+              family = poisson, data = Mental) #>  #> msc.gl> long.labels <- list(set_varnames = c(mental=\"Mental Health Status\", #> msc.gl+                                      ses=\"Parent SES\")) #>  #> msc.gl> mosaic(indep, #> msc.gl+        residuals_type=\"rstandard\", #> msc.gl+        labeling_args = long.labels, #> msc.gl+        labeling=labeling_residuals) #> Warning: no formula provided, assuming ~ses + mental  #>  #> msc.gl> # or, show as a sieve diagram #> msc.gl> mosaic(indep, #> msc.gl+        labeling_args = long.labels, #> msc.gl+        panel=sieve, #> msc.gl+        gp=shading_Friendly) #> Warning: no formula provided, assuming ~ses + mental  #>  #> msc.gl> # fit linear x linear (uniform) association.  Use integer scores for rows/cols #> msc.gl> Cscore <- as.numeric(Mental$ses) #>  #> msc.gl> Rscore <- as.numeric(Mental$mental) #>  #> msc.gl> linlin <- glm(Freq ~ mental + ses + Rscore:Cscore, #> msc.gl+                 family = poisson, data = Mental) #>  #> msc.gl> mosaic(linlin, #> msc.gl+        residuals_type=\"rstandard\", #> msc.gl+        labeling_args = long.labels, #> msc.gl+        labeling=labeling_residuals, #> msc.gl+        suppress=1, #> msc.gl+        gp=shading_Friendly, #> msc.gl+        main=\"Lin x Lin model\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> msc.gl> ##  Goodman Row-Column association model fits even better (deviance 3.57, df 8) #> msc.gl> if (require(gnm)) { #> msc.gl+ Mental$mental <- C(Mental$mental, treatment) #> msc.gl+ Mental$ses <- C(Mental$ses, treatment) #> msc.gl+ RC1model <- gnm(Freq ~ ses + mental + Mult(ses, mental), #> msc.gl+                 family = poisson, data = Mental) #> msc.gl+  #> msc.gl+ mosaic(RC1model, #> msc.gl+        residuals_type=\"rstandard\", #> msc.gl+        labeling_args = long.labels, #> msc.gl+        labeling=labeling_residuals, #> msc.gl+        suppress=1, #> msc.gl+        gp=shading_Friendly, #> msc.gl+        main=\"RC1 model\") #> msc.gl+  } #> Initialising #> Running start-up iterations.. #> Running main iterations....... #> Done #> Warning: no formula provided, assuming ~ses + mental  #>  #> msc.gl>  ############# UCB Admissions data, fit using glm() #> msc.gl>  #> msc.gl> structable(Dept ~ Admit+Gender,UCBAdmissions) #>                 Dept   A   B   C   D   E   F #> Admit    Gender                              #> Admitted Male        512 353 120 138  53  22 #>          Female       89  17 202 131  94  24 #> Rejected Male        313 207 205 279 138 351 #>          Female       19   8 391 244 299 317 #>  #> msc.gl> berkeley <- as.data.frame(UCBAdmissions) #>  #> msc.gl> berk.glm1 <- glm(Freq ~ Dept * (Gender+Admit), data=berkeley, family=\"poisson\") #>  #> msc.gl> summary(berk.glm1) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit), family = \"poisson\",  #>     data = berkeley) #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.27557    0.04248 147.744  < 2e-16 *** #> DeptB               -0.40575    0.06770  -5.993 2.06e-09 *** #> DeptC               -1.53939    0.08305 -18.536  < 2e-16 *** #> DeptD               -1.32234    0.08159 -16.207  < 2e-16 *** #> DeptE               -2.40277    0.11014 -21.816  < 2e-16 *** #> DeptF               -3.09624    0.15756 -19.652  < 2e-16 *** #> GenderFemale        -2.03325    0.10233 -19.870  < 2e-16 *** #> AdmitRejected       -0.59346    0.06838  -8.679  < 2e-16 *** #> DeptB:GenderFemale  -1.07581    0.22860  -4.706 2.52e-06 *** #> DeptC:GenderFemale   2.63462    0.12343  21.345  < 2e-16 *** #> DeptD:GenderFemale   1.92709    0.12464  15.461  < 2e-16 *** #> DeptE:GenderFemale   2.75479    0.13510  20.391  < 2e-16 *** #> DeptF:GenderFemale   1.94356    0.12683  15.325  < 2e-16 *** #> DeptB:AdmitRejected  0.05059    0.10968   0.461    0.645     #> DeptC:AdmitRejected  1.20915    0.09726  12.432  < 2e-16 *** #> DeptD:AdmitRejected  1.25833    0.10152  12.395  < 2e-16 *** #> DeptE:AdmitRejected  1.68296    0.11733  14.343  < 2e-16 *** #> DeptF:AdmitRejected  3.26911    0.16707  19.567  < 2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   21.736  on  6  degrees of freedom #> AIC: 216.8 #>  #> Number of Fisher Scoring iterations: 4 #>  #>  #> msc.gl> mosaic(berk.glm1, #> msc.gl+        gp=shading_Friendly, #> msc.gl+        labeling=labeling_residuals, #> msc.gl+        formula=~Admit+Dept+Gender)  #>  #> msc.gl> # the same, displaying studentized residuals; #> msc.gl> # note use of formula to reorder factors in the mosaic #> msc.gl> mosaic(berk.glm1, #> msc.gl+        residuals_type=\"rstandard\", #> msc.gl+        labeling=labeling_residuals, #> msc.gl+        shade=TRUE, #> msc.gl+ \t     formula=~Admit+Dept+Gender, #> msc.gl+ \t     main=\"Model: [DeptGender][DeptAdmit]\")  #>  #> msc.gl> ## all two-way model #> msc.gl> berk.glm2 <- glm(Freq ~ (Dept + Gender + Admit)^2, data=berkeley, family=\"poisson\") #>  #> msc.gl> summary(berk.glm2) #>  #> Call: #> glm(formula = Freq ~ (Dept + Gender + Admit)^2, family = \"poisson\",  #>     data = berkeley) #>  #> Coefficients: #>                            Estimate Std. Error z value Pr(>|z|)     #> (Intercept)                 6.27150    0.04271 146.855  < 2e-16 *** #> DeptB                      -0.40322    0.06784  -5.944 2.78e-09 *** #> DeptC                      -1.57790    0.08949 -17.632  < 2e-16 *** #> DeptD                      -1.35000    0.08526 -15.834  < 2e-16 *** #> DeptE                      -2.44982    0.11755 -20.840  < 2e-16 *** #> DeptF                      -3.13787    0.16174 -19.401  < 2e-16 *** #> GenderFemale               -1.99859    0.10593 -18.866  < 2e-16 *** #> AdmitRejected              -0.58205    0.06899  -8.436  < 2e-16 *** #> DeptB:GenderFemale         -1.07482    0.22861  -4.701 2.58e-06 *** #> DeptC:GenderFemale          2.66513    0.12609  21.137  < 2e-16 *** #> DeptD:GenderFemale          1.95832    0.12734  15.379  < 2e-16 *** #> DeptE:GenderFemale          2.79519    0.13925  20.073  < 2e-16 *** #> DeptF:GenderFemale          2.00232    0.13571  14.754  < 2e-16 *** #> DeptB:AdmitRejected         0.04340    0.10984   0.395    0.693     #> DeptC:AdmitRejected         1.26260    0.10663  11.841  < 2e-16 *** #> DeptD:AdmitRejected         1.29461    0.10582  12.234  < 2e-16 *** #> DeptE:AdmitRejected         1.73931    0.12611  13.792  < 2e-16 *** #> DeptF:AdmitRejected         3.30648    0.16998  19.452  < 2e-16 *** #> GenderFemale:AdmitRejected -0.09987    0.08085  -1.235    0.217     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   20.204  on  5  degrees of freedom #> AIC: 217.26 #>  #> Number of Fisher Scoring iterations: 4 #>  #>  #> msc.gl> mosaic(berk.glm2, #> msc.gl+        residuals_type=\"rstandard\", #> msc.gl+        labeling = labeling_residuals, #> msc.gl+        shade=TRUE, #> msc.gl+ \t     formula=~Admit+Dept+Gender, #> msc.gl+ \t     main=\"Model: [DeptGender][DeptAdmit][AdmitGender]\")  #>  #> msc.gl> anova(berk.glm1, berk.glm2, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ (Dept + Gender + Admit)^2 #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi) #> 1         6     21.735                      #> 2         5     20.204  1   1.5312   0.2159 #>  #> msc.gl> # Add 1 df term for association of [GenderAdmit] only in Dept A #> msc.gl> berkeley <- within(berkeley, #> msc.gl+                    dept1AG <- (Dept=='A')*(Gender=='Female')*(Admit=='Admitted')) #>  #> msc.gl> berkeley[1:6,] #>      Admit Gender Dept Freq dept1AG #> 1 Admitted   Male    A  512       0 #> 2 Rejected   Male    A  313       0 #> 3 Admitted Female    A   89       1 #> 4 Rejected Female    A   19       0 #> 5 Admitted   Male    B  353       0 #> 6 Rejected   Male    B  207       0 #>  #> msc.gl> berk.glm3 <- glm(Freq ~ Dept * (Gender+Admit) + dept1AG, data=berkeley, family=\"poisson\") #>  #> msc.gl> summary(berk.glm3) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit) + dept1AG, family = \"poisson\",  #>     data = berkeley) #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.23832    0.04419 141.157  < 2e-16 *** #> DeptB               -0.36850    0.06879  -5.357 8.47e-08 *** #> DeptC               -1.50215    0.08394 -17.895  < 2e-16 *** #> DeptD               -1.28509    0.08250 -15.577  < 2e-16 *** #> DeptE               -2.36552    0.11081 -21.347  < 2e-16 *** #> DeptF               -3.05899    0.15803 -19.357  < 2e-16 *** #> GenderFemale        -2.80176    0.23628 -11.858  < 2e-16 *** #> AdmitRejected       -0.49212    0.07175  -6.859 6.94e-12 *** #> dept1AG              1.05208    0.26271   4.005 6.21e-05 *** #> DeptB:GenderFemale  -0.30730    0.31243  -0.984    0.325     #> DeptC:GenderFemale   3.40313    0.24615  13.825  < 2e-16 *** #> DeptD:GenderFemale   2.69560    0.24676  10.924  < 2e-16 *** #> DeptE:GenderFemale   3.52330    0.25220  13.970  < 2e-16 *** #> DeptF:GenderFemale   2.71207    0.24787  10.941  < 2e-16 *** #> DeptB:AdmitRejected -0.05074    0.11181  -0.454    0.650     #> DeptC:AdmitRejected  1.10781    0.09966  11.116  < 2e-16 *** #> DeptD:AdmitRejected  1.15699    0.10381  11.145  < 2e-16 *** #> DeptE:AdmitRejected  1.58162    0.11933  13.254  < 2e-16 *** #> DeptF:AdmitRejected  3.16777    0.16848  18.803  < 2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.0952  on 23  degrees of freedom #> Residual deviance:    2.6815  on  5  degrees of freedom #> AIC: 199.74 #>  #> Number of Fisher Scoring iterations: 3 #>  #>  #> msc.gl> mosaic(berk.glm3, #> msc.gl+        residuals_type = \"rstandard\", #> msc.gl+        labeling = labeling_residuals, #> msc.gl+        shade=TRUE, #> msc.gl+ \t      formula = ~Admit+Dept+Gender, #> msc.gl+ \t      main = \"Model: [DeptGender][DeptAdmit] + DeptA*[GA]\")  #>  #> msc.gl> # compare models #> msc.gl> anova(berk.glm1, berk.glm3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ Dept * (Gender + Admit) + dept1AG #>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     #> 1         6    21.7355                           #> 2         5     2.6815  1   19.054 1.271e-05 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  demo(\"mental-glm\") #>  #>  #> \tdemo(mental-glm) #> \t---- ~~~~~~~~~~ #>  #> > ## Mental health data: mosaics for glm() and gnm() models #> > library(gnm) #>  #> > library(vcdExtra) #>  #> > data(Mental) #>  #> > # display the frequency table #> > (Mental.tab <- xtabs(Freq ~ mental+ses, data=Mental)) #>           ses #> mental       1   2   3   4   5   6 #>   Well      64  57  57  72  36  21 #>   Mild      94  94 105 141  97  71 #>   Moderate  58  54  65  77  54  54 #>   Impaired  46  40  60  94  78  71 #>  #> > # fit independence model #> > # Residual deviance: 47.418 on 15 degrees of freedom #> > indep <- glm(Freq ~ mental+ses, #> +                 family = poisson, data = Mental) #>  #> > deviance(indep) #> [1] 47.41785 #>  #> > long.labels <- list(set_varnames = c(mental=\"Mental Health Status\", ses=\"Parent SES\")) #>  #> > mosaic(indep,residuals_type=\"rstandard\", labeling_args = long.labels, labeling=labeling_residuals, #> +        main=\"Mental health data: Independence\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > # as a sieve diagram #> > mosaic(indep, labeling_args = long.labels, panel=sieve, gp=shading_Friendly, #> +        main=\"Mental health data: Independence\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > # fit linear x linear (uniform) association.  Use integer scores for rows/cols  #> > Cscore <- as.numeric(Mental$ses) #>  #> > Rscore <- as.numeric(Mental$mental) #>  #> > # column effects model (ses) #> > coleff <- glm(Freq ~ mental + ses + Rscore:ses, #> +                 family = poisson, data = Mental) #>  #> > mosaic(coleff,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: Col effects (ses)\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > # row effects model (mental) #> > roweff <- glm(Freq ~ mental + ses + mental:Cscore, #> +                 family = poisson, data = Mental) #>  #> > mosaic(roweff,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: Row effects (mental)\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > linlin <- glm(Freq ~ mental + ses + Rscore:Cscore, #> +                 family = poisson, data = Mental) #>  #> > # compare models #> > anova(indep, roweff, coleff, linlin) #> Analysis of Deviance Table #>  #> Model 1: Freq ~ mental + ses #> Model 2: Freq ~ mental + ses + mental:Cscore #> Model 3: Freq ~ mental + ses + Rscore:ses #> Model 4: Freq ~ mental + ses + Rscore:Cscore #>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     #> 1        15     47.418                           #> 2        12      6.281  3   41.137 6.116e-09 *** #> 3        10      6.829  2   -0.549               #> 4        14      9.895 -4   -3.066    0.5469     #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> > AIC(indep, roweff, coleff, linlin) #>        df      AIC #> indep   9 209.5908 #> roweff 12 174.4537 #> coleff 14 179.0023 #> linlin 10 174.0681 #>  #> > mosaic(linlin,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: Linear x Linear\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > ##  Goodman Row-Column association model fits well (deviance 3.57, df 8) #> > Mental$mental <- C(Mental$mental, treatment) #>  #> > Mental$ses <- C(Mental$ses, treatment) #>  #> > RC1model <- gnm(Freq ~ mental + ses + Mult(mental, ses), #> +                 family = poisson, data = Mental) #> Initialising #> Running start-up iterations.. #> Running main iterations....... #> Done #>  #> > mosaic(RC1model,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: RC1 model\") #> Warning: no formula provided, assuming ~ses + mental"},{"path":"https://friendly.github.io/vcdExtra/reference/woolf_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","title":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","text":"Test homogeneity \\(2 \\times 2 \\times k\\) tables strata (.e., whether log odds ratios strata). Generalized handle tables dimensionality beyond 3. 4-dimensional tables, optionally provides two-way decomposition homogeneity test row effects, column effects, residual.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/woolf_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","text":"","code":"woolf_test(x, decompose = FALSE)  # S3 method for class 'woolf_test' print(x, ...)"},{"path":"https://friendly.github.io/vcdExtra/reference/woolf_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","text":"x object class \"woolf_test\" decompose Logical. TRUE x 4-dimensional (\\(2 \\times 2 \\times R \\times C\\) table), test decomposed row effects, column effects, residual (interaction). Defaults FALSE. Ignored non-4-dimensional tables. ... Additional arguments (currently unused)","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/woolf_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","text":"list class \"woolf_test\" (also inheriting \"htest\") containing following components: statistic chi-squared test statistic. parameter degrees freedom approximate chi-squared distribution test statistic. p.value \\(p\\)-value test. method character string indicating type test performed. data.name character string giving name data. or_vars names first two dimensions (2x2 table variables). strata_vars names stratifying variables (dimensions 3 beyond). observed observed log odds ratios. expected expected log odds ratio null hypothesis (weighted mean). decomposed logical indicating decomposition performed. decompose = TRUE (4-dimensional tables), additional components: rows list statistic, df, p.value, observed, expected row effects. cols list statistic, df, p.value, observed, expected column effects. residual list statistic, df, p.value residual (interaction).","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/woolf_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","text":"Woolf test (Woolf, 1955) tests hypothesis odds ratios \\(\\theta_i\\) equal across \\(k\\) strata. test statistic computed weighted sum squared deviations log odds ratios weighted mean: $$\\chi^2_W = \\sum_{=1}^{k} w_i [\\log(\\theta_i) - \\log(\\bar{\\theta}_w)]^2       = \\sum_{=1}^{k} w_i \\log^2(\\theta_i / \\bar{\\theta}_w)$$ \\(\\theta_i = (n_{11i} n_{22i}) / (n_{12i} n_{21i})\\) odds ratio stratum \\(\\), \\(\\bar{\\theta}_w\\) weighted average odds ratio (computed exponential weighted mean log odds ratios). weights \\(w_i\\) inverse variances log odds ratios: $$w_i = 1 / \\text{Var}(\\log \\theta_i) = 1 / (1/n_{11i} + 1/n_{12i} + 1/n_{21i} + 1/n_{22i})$$ null hypothesis homogeneous odds ratios, \\(\\chi^2_W\\) follows chi-squared distribution \\(k - 1\\) degrees freedom. Decomposition 4-way tables: \\(2 \\times 2 \\times R \\times C\\) table, strata form \\(R \\times C\\) two-way layout odds ratios \\(\\theta_{ij}\\) row \\(\\) column \\(j\\). suggests overall Woolf test homogeneity can decomposed three components, conceptually analogous two-way ANOVA one observation per cell: $$\\chi^2_{\\text{W:Total}} = \\chi^2_{\\text{W:Rows}} + \\chi^2_{\\text{W:Cols}} + \\chi^2_{\\text{W:Residual}}$$ : \\(\\chi^2_{\\text{W:Rows}} \\) tests whether odds ratios differ among row levels (pooling columns), \\(R - 1\\) df \\(\\chi^2_{\\text{W:Cols}}\\) tests whether odds ratios differ among column levels (pooling rows), \\(C - 1\\) df \\(\\chi^2_{\\text{W:Residual}}\\) tests row \\(\\times\\) column interaction (deviation additivity log odds scale), \\((R-1)(C-1)\\) df row effect test compares marginal log odds ratios \\(\\log \\bar{\\theta}_{+}\\) (pooled columns) overall weighted mean. Similarly, column effect test compares \\(\\log \\bar{\\theta}_{+j}\\) (pooled rows). residual tests whether cell log odds ratios \\(\\log \\theta_{ij}\\) additive row column effects. Note: two-way ANOVA-like decomposition 4-dimensional tables appears novel extension introduced package. existing literature Woolf test (related Breslow-Day test) treats strata unstructured, testing whether \\(k\\) odds ratios equal. decomposition exploits factorial structure \\(R \\times C\\) strata provide detailed insight sources heterogeneity.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/woolf_test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","text":"Woolf, B. (1955). estimating relation blood group disease. Annals Human Genetics, 19, 251-253.","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/woolf_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Woolf Test for Homogeneity of Odds Ratios — woolf_test","text":"","code":"# 3-way tables data(CoalMiners, package = \"vcd\") woolf_test(CoalMiners) #>  #> Woolf-test on Homogeneity of Odds Ratios (no 3-way association)  #>  #> Data:          CoalMiners  #> OR variables:  Breathlessness, Wheeze  #> Strata:        Age  #>  #> X-squared = 26.2034, df = 8, p-value = 0.0009694  data(Heart, package = \"vcdExtra\") woolf_test(Heart) #>  #> Woolf-test on Homogeneity of Odds Ratios (no 3-way association)  #>  #> Data:          Heart  #> OR variables:  Disease, Gender  #> Strata:        Occup  #>  #> X-squared = 81.0807, df = 2, p-value = 0  # 4-way table without decomposition data(Fungicide, package = \"vcdExtra\") woolf_test(Fungicide) #>  #> Woolf-test on Homogeneity of Odds Ratios (no 4-way association)  #>  #> Data:          Fungicide  #> OR variables:  group, outcome  #> Strata:        sex, strain  #>  #> X-squared = 0.8548, df = 3, p-value = 0.8363  # 4-way table with decomposition woolf_test(Fungicide, decompose = TRUE) #>  #> Woolf-test on Homogeneity of Odds Ratios (no 4-way association)  #>  #> Data:          Fungicide  #> OR variables:  group, outcome  #> Strata:        sex, strain  #>  #> Overall homogeneity test: #>   X-squared = 0.8548, df = 3, p-value = 0.8363 #>  #> Decomposition: #>   Rows (sex):    X-squared = 0.0086, df = 1, p-value = 0.9261 #>   Cols (strain): X-squared = 0.8257, df = 1, p-value = 0.3635 #>   Residual:      X-squared = 0.0205, df = 1, p-value = 0.8861 #>  #> Note: Overall = Rows + Columns + Residual  # 4-way table, but need to rearrange dimensions # How does association between `Preference` and `M_User` vary over strata? data(Detergent, package = \"vcdExtra\") dimnames(Detergent) |> names() #> [1] \"Temperature\"    \"M_User\"         \"Preference\"     \"Water_softness\" Detergent <- aperm(Detergent, c(3, 2, 1, 4)) woolf_test(Detergent) #>  #> Woolf-test on Homogeneity of Odds Ratios (no 4-way association)  #>  #> Data:          Detergent  #> OR variables:  Preference, M_User  #> Strata:        Temperature, Water_softness  #>  #> X-squared = 8.0132, df = 5, p-value = 0.1555"},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Score test for zero inflation in Poisson data — zero.test","title":"Score test for zero inflation in Poisson data — zero.test","text":"Carries simple score test (van den Broek, 1995) excess zeros otherwise Poisson distribution counts.  gives \\(\\chi^2_1\\) statistic one degree freedom.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score test for zero inflation in Poisson data — zero.test","text":"","code":"zero.test(x)"},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score test for zero inflation in Poisson data — zero.test","text":"x vector non-negative counts, one-way frequency table counts.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Score test for zero inflation in Poisson data — zero.test","text":"Returns invisibly list three elements: statistic Value test statistic df Degrees freedom pvalue Upper tail p-value","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Score test for zero inflation in Poisson data — zero.test","text":"test first calculates rate estimate mean, \\(\\hat{\\lambda} = \\bar{x}\\). number observed zeros, \\(n_0\\) compared expected number, \\(n \\hat{p_0}\\), \\(\\hat{p}_0=\\exp[-\\hat{\\lambda}]\\). test statistic calculated formula: $$\\frac{(n_0 - n\\hat{p}_0)^2}{n\\hat{p}_0(1-\\hat{p}_0) - n\\bar{x}\\hat{p}_0^2}$$ . test statistic \\(\\chi^2_1\\) distribution.","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Score test for zero inflation in Poisson data — zero.test","text":"original R code came Stackexchange question, https://stats.stackexchange.com/questions/118322/--test--zero-inflation---dataset Van den Broek, J. (1995).  Score Test Zero Inflation Poisson Distribution.  Biometrics, 51(2), 738-743. https://www.jstor.org/stable/2532959 Yang, Zhao, James W. Hardin, Cheryl L. Addy (2010).  Score Tests Zero-Inflation Overdispersed Count Data.  Communications Statistics - Theory Methods 39 (11) 2008-2030. DOI: 10.1080/03610920902948228","code":""},{"path":[]},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Score test for zero inflation in Poisson data — zero.test","text":"Michael Friendly","code":""},{"path":"https://friendly.github.io/vcdExtra/reference/zero.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Score test for zero inflation in Poisson data — zero.test","text":"","code":"# synthetic tests zero.test(rpois(100, 1)) #> Score test for zero inflation #>  #>  \tChi-square = 0.16856  #>  \tdf = 1 #>  \tpvalue: 0.68139  zero.test(rpois(100, 5)) #> Score test for zero inflation #>  #>  \tChi-square = 0.54816  #>  \tdf = 1 #>  \tpvalue: 0.45907  # add some extra zeros zero.test(c(rep(0, 20), rpois(100, 5))) #> Score test for zero inflation #>  #>  \tChi-square = 212.04692  #>  \tdf = 1 #>  \tpvalue: < 2.22e-16   # Articles by Phd candidates data(PhdPubs, package=\"vcdExtra\") zero.test(PhdPubs$articles) #> Score test for zero inflation #>  #>  \tChi-square = 133.91825  #>  \tdf = 1 #>  \tpvalue: < 2.22e-16   phd.tab <- table(PhdPubs$articles) zero.test(phd.tab) #> Score test for zero inflation #>  #>  \tChi-square = 133.91825  #>  \tdf = 1 #>  \tpvalue: < 2.22e-16"},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-091-2026-01-23","dir":"Changelog","previous_headings":"","what":"Version 0.9.1 (2026-01-23)","title":"Version 0.9.1 (2026-01-23)","text":"Added labeling_points() mosaic displays show observed expected frequencies random points tiles Changed defaults clip margin labeling_points() sensible [Thx: Achim Zeileis] Added color_table() display frequency tables color shaded backgrounds show patterns","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-090-2026-01-17","dir":"Changelog","previous_headings":"","what":"Version 0.9.0 (2026-01-17)","title":"Version 0.9.0 (2026-01-17)","text":"CRAN release: 2026-01-21 major release package, adding structure dataset examples introducing new extension Woolf’s test homogeneity odds ratios. Begin categorize datasets package @concept tags Begin flesh general conception CDA datasets(): added ndim arg; package=“vcdExtra” default Added tidyCat hex logo Generalized vcd::woolf_test() handle strata better, special handling 2 x 2 x R x C case. Completed extension vcd::woolf_test() fully handle R x C strata, tests rows/cols/residuals Added GH actions R-CMD-check & pkgdown Now depends R (>= 4.1.0) due use native pipe |> Fixed broken URLs R/data.R","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-087-2025-12-10","dir":"Changelog","previous_headings":"","what":"Version 0.8.7 (2025-12-10)","title":"Version 0.8.7 (2025-12-10)","text":"CRAN release: 2025-12-11 major release package, fixing bugs revising documentation o Added tests CMHtest() PR #13 [Thx: Daniel Sabanes Bove] o Automatically omit strata single observation CMHtest() contribute test statistics o Use generalized Moore-Penrose inverse MASS CMHtest() can work variance matrix singular. o Converted package use roxygen documentation via {rd2roxygen}. UGH! o Added CrabSatellites data {countreg} b/c ’s still available CRAN o Moved grid Depends: Imports: o Now use markdown package documentation easier maintenance, via {roxygen2md}","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-08-6-2025-07-23","dir":"Changelog","previous_headings":"","what":"Version 0.8-6 (2025-07-23)","title":"Version 0.8-6 (2025-07-23)","text":"CRAN release: 2025-07-24 minor release satisfy CRAN gods like crossref links correct. o Fixed CRAN nits re crossrefs o Update issues link o Update README o Fixed Winbuilder notes re: Rd links data sources","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-08-5-2023-08-19","dir":"Changelog","previous_headings":"","what":"Version 0.8-5 (2023-08-19)","title":"Version 0.8-5 (2023-08-19)","text":"CRAN release: 2023-08-22 Fix CRAN nit re vcdExtra-package.Rd Fix moved URL - http: -> https: Fix xrefs vignettes spellcheck Fixed one NOTE re: AirCrash.Rd URL","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-08-4-2023-04-12","dir":"Changelog","previous_headings":"","what":"Version 0.8-4 (2023-04-12)","title":"Version 0.8-4 (2023-04-12)","text":"CRAN release: 2023-04-16 Imports: tidyr must depend (>= 1.3.0) one use vignette. Enhanced vignette, “Creating manipulating frequency tables”, vignettes/creating.Rmd Created new vignette, “Mobility tables”, extensive examples models graphs square mobility tables.","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-08-3-2023-02-16","dir":"Changelog","previous_headings":"","what":"Version 0.8-3 (2023-02-16)","title":"Version 0.8-3 (2023-02-16)","text":"CRAN release: 2023-03-04 datasets now classified  tags method analysis. can found using help.search(pattern, field=\"concept\") Added vignette, datasets.Rmd showing datasets classified method tags. Links work pkgdown site. Added Asbestos data","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-08-2-2023-01-19","dir":"Changelog","previous_headings":"","what":"Version 0.8-2 (2023-01-19)","title":"Version 0.8-2 (2023-01-19)","text":"CRAN release: 2023-01-29 major enhancement release vcdExtra package, focusing documentation examples. added HouseTasks data set, illustrating permutation row / col variables package now depends R (>= 3.5.0) per CRAN nit add Suggests: seriation illustrate CA re-ordering rows/cols based correspondence analysis .Rd files reformatted many examples extended. vignette mosaic.Rmd mosaic displays extensively revised examples square tables permutation row / column variables. begin classify datasets \\concept{} tags Added new demo-housing.Rmd vignette, using content demo/housing.R.","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-08-1-2022-04-22","dir":"Changelog","previous_headings":"","what":"Version 0.8-1 (2022-04-22)","title":"Version 0.8-1 (2022-04-22)","text":"rename vignettes order","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-08-0-2022-04-20","dir":"Changelog","previous_headings":"","what":"Version 0.8-0 (2022-04-20)","title":"Version 0.8-0 (2022-04-20)","text":"CRAN release: 2022-04-21 Fixed warning expand.dft() re type.convert Old .Rnw vignettes converted .Rmd Fixed two problems detected initial submission.","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-07-6-2022-02-12","dir":"Changelog","previous_headings":"","what":"Version 0.7-6 (2022-02-12)","title":"Version 0.7-6 (2022-02-12)","text":"CRAN release: 2022-02-14 Fix issues CMHtest() types argument #PR11 [Thx: ShuguangSun, Matt Kumar] Fix Winbuilder URL nits; extensive spell checking","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-07-5-2020-12-25","dir":"Changelog","previous_headings":"","what":"Version 0.7-5 (2020-12-25)","title":"Version 0.7-5 (2020-12-25)","text":"CRAN release: 2021-01-25 Fix problem re use rgl mosaic3d() examples","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-07-4-2019-09-25","dir":"Changelog","previous_headings":"","what":"Version 0.7-4 (2019-09-25)","title":"Version 0.7-4 (2019-09-25)","text":"Fix datasets() work packages using LazyData #PR7 [Thx: Duncan Murdoch] Bump package Version","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-07-3-2018-06-04","dir":"Changelog","previous_headings":"","what":"Version 0.7-3 (2018-06-04)","title":"Version 0.7-3 (2018-06-04)","text":"fix Version number gnm DESCRIPTION fix expand.dft expand.table work tibbles [Thx: Duncan Murdoch] vcdExtra gets hex sticker","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-07-1-2017-09-28","dir":"Changelog","previous_headings":"","what":"Version 0.7-1 (2017-09-28)","title":"Version 0.7-1 (2017-09-28)","text":"CRAN release: 2017-09-29 Fixed buglet expand.dft() table 1-dim [Thx: Long Qu] Added zero.test(), simple score test zero inflation Development moved https://github.com/friendly/vcdExtra","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-07-0-2016-01-27","dir":"Changelog","previous_headings":"","what":"Version 0.7-0 (2016-01-27)","title":"Version 0.7-0 (2016-01-27)","text":"CRAN release: 2016-02-25 Added Glass data introduce links references DDAR added mcaplot() plot MCA solutions DDAR style added update.xtabs() method updated vignette refer DDAR","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-12-2015-10-06","dir":"Changelog","previous_headings":"","what":"Version 0.6-12 (2015-10-06)","title":"Version 0.6-12 (2015-10-06)","text":"CRAN release: 2015-12-23 Added Burt data Fixed examples/vignette ggplot_2.0.0","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-11-2015-09-14","dir":"Changelog","previous_headings":"","what":"Version 0.6-11 (2015-09-14)","title":"Version 0.6-11 (2015-09-14)","text":"CRAN release: 2015-09-17 bump pkg Version CRAN","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-10-2015-07-27","dir":"Changelog","previous_headings":"","what":"Version 0.6-10 (2015-07-27)","title":"Version 0.6-10 (2015-07-27)","text":"Added HospVisits data","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-9-2015-06-11","dir":"Changelog","previous_headings":"","what":"Version 0.6-9 (2015-06-11)","title":"Version 0.6-9 (2015-06-11)","text":"CRAN release: 2015-07-11 Added Mice data Removed uses summarise() Summarise() demos examples, preparation deprecating . summarise() now deprecated Now use importsFrom() functions recommended packages","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-8-2015-04-15","dir":"Changelog","previous_headings":"","what":"Version 0.6-8 (2015-04-15)","title":"Version 0.6-8 (2015-04-15)","text":"CRAN release: 2015-04-16 Fixed Title: Description: CRAN","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-7-2015-04-02","dir":"Changelog","previous_headings":"","what":"Version 0.6-7 (2015-04-02)","title":"Version 0.6-7 (2015-04-02)","text":"Removed loddsratio (now vcd) (rev 252) Removed print.Kappa (now vcd) (rev 253) Fixed bug CMHtest(): rmeans cmeans labels reversed (rev 254) Fixed error Fungicide.Rd, now require vcd_1.3-3 (rev 254) Added WorkerSat data - 2 x 2 x 2 Added AirCrash data","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-6-2015-02-04","dir":"Changelog","previous_headings":"","what":"Version 0.6-6 (2015-02-04)","title":"Version 0.6-6 (2015-02-04)","text":"Minor doc changes","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-5-2014-11-07","dir":"Changelog","previous_headings":"","what":"Version 0.6-5 (2014-11-07)","title":"Version 0.6-5 (2014-11-07)","text":"CRAN release: 2015-01-03 Added Cormorants data (fixed latest) Added LRstats(), replace Summarise. Older summarise() Summarise() eventually deprecated. Now Suggests: AER NMES1988 data collapse.table() now works array objects","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-3-2014-10-27","dir":"Changelog","previous_headings":"","what":"Version 0.6-3 (2014-10-27)","title":"Version 0.6-3 (2014-10-27)","text":"CRAN release: 2014-11-01 Fixed bug logLik.loglm data contain zero frequencies (rev 228) Made Summarise generic, adding method “glmlist” objects (rev 230) Added coef() method “glmlist” objects (thx: John Fox) Added Summarise.loglmlist method (rev 232) Replaced documentation uses summarise() Summarise() (rev 233) Added cutfac(), convenience wrapper cut() (rev 234) Now use rgl:: mosaic3d functions","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-2-2014-06-30","dir":"Changelog","previous_headings":"","what":"Version 0.6-2 (2014-06-30)","title":"Version 0.6-2 (2014-06-30)","text":"added Summarise, replace summarise Added HairEyePlace data - 4 x 5 x 2, Caithness Aberdeen hair/eye color (rev 223) Added PhdPubs data Long (1997) - publications PhD candidates Allow Summarise work models w/o deviance() function Fixed bug Summarise wrt degrees freedom","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-1-2014-04-14","dir":"Changelog","previous_headings":"","what":"Version 0.6-1 (2014-04-14)","title":"Version 0.6-1 (2014-04-14)","text":"CRAN release: 2014-06-10 Added ICU data Added Toxaemia data - multivariate response contingency table (rev 209) Added Vietnam data - 2 x 5 x 4 frequency table (rev 210) Added logLik.loglm allow use AIC() BIC() loglm models (rev 212) Fixed loddsratio.Rd work revised vcd::CoalMiners data (rev 212) Added blogits bivariate binary response data Added Vote1980 data (rev 214)","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-06-0-2014-03-07","dir":"Changelog","previous_headings":"","what":"Version 0.6-0 (2014-03-07)","title":"Version 0.6-0 (2014-03-07)","text":"CRAN release: 2014-03-08 Removed Authors: DESCRIPTION, bumped Version","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-12-2013-12-16","dir":"Changelog","previous_headings":"","what":"Version 0.5-12 (2013-12-16)","title":"Version 0.5-12 (2013-12-16)","text":"Added ShakeWords data set- word frequency counts Shakespeare (rev 188) Added Geissler data– family sizes Saxony sex composition data (rev 190) Added logseries functions logarithmic series distribution (rev 191) Added Depends data – dependencies r packages (rev 192) Fixed buglet seq_loglm() respecting arrays Added seq_mosaic() (rev 194) Added CyclingDeaths data (rev 196) mosaic3d() gets interpolate= option control shading levels (rev 197) Fixed bug seq_mosaic, thx David Meyer (rev 200) Fixed bug seq_loglm() marginals != 1:nf","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-11-2013-07-01","dir":"Changelog","previous_headings":"","what":"Version 0.5-11 (2013-07-01)","title":"Version 0.5-11 (2013-07-01)","text":"CRAN release: 2013-09-16 Added mosaic.glmlist plot mosaics (strucplots) models glmlist (rev 169) Added loglin-utilities.R, containing suite functions provide conceptual way specify loglinear models type (‘joint’, ‘conditional’, ‘mutual’, ‘markov’, ‘saturated’) (rev 171) Added mosaic.loglmlist, similar mosaic.glmlist models fit using MASS::loglm (rev 173) mosaic.glmlist mosaic.glmlist get explicit panel=argument; get sensible default default arguments (rev 175) Added seq_loglm fit sequential loglm models marginal subtables, giving loglmlist result (rev 176) Added Accident data (rev 178); fleshed Accident examples (rev 180) Fixed use ::: R 3.0.1 (rev 179) Fixed various problems related use MASS:loglm (rev 181-183) Added Titanicp datasets (rev 185)","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-8-2013-03-06","dir":"Changelog","previous_headings":"","what":"Version 0.5-8 (2013-03-06)","title":"Version 0.5-8 (2013-03-06)","text":"Revised vcd-tutorial showing examples plyr; added section RC models Added Donner data example ggplot2 plot binomial glm() Added vcd-tutorial section using ggplot2 Donner data Enhanced datasets() provide maxTitle argument (rev 153) Added doubledecker plots Dyke.Rd (rev 156) Added Draft1970table Draft1970 data sets (rev 158) Added example doubledecker plots vcd-tutorial vignette (rev 164)","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-7-2013-03-01","dir":"Changelog","previous_headings":"","what":"Version 0.5-7 (2013-03-01)","title":"Version 0.5-7 (2013-03-01)","text":"CRAN release: 2013-03-05 Completed CMHtest methods, adding overall tests across strata general way CMHtest now gets S3 generic formula interface print Kappa gets digits= CI= arguments","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-6-2012-11-30","dir":"Changelog","previous_headings":"","what":"Version 0.5-6 (2012-11-30)","title":"Version 0.5-6 (2012-11-30)","text":"CRAN release: 2013-02-28 Added Hosmer Lemeshow HLtest methods, including plotting via vcd::rootogram() Added CMHtest general Cochran-Mantel-Haenszel tests Revised vcd-tutorial vignette, adding section CMH tests; removed dependence Z.cls","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-3-2012-03-07","dir":"Changelog","previous_headings":"","what":"Version 0.5-3 (2012-03-07)","title":"Version 0.5-3 (2012-03-07)","text":"CRAN release: 2012-05-08 Added Mammograms data (4x4, ordered factors, agreement) Extended mosaic.glm examples Added Alligator data (4x2x2x5, frequency form) Added DaytonSurvey data (5-way, 2x2x2x2x2 frequency form) Extended vcd-tutorial vignette section collapsing factors Removed aperm.* now aperm.table base R","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-2-2010-11-28","dir":"Changelog","previous_headings":"","what":"Version 0.5-2 (2010-11-28)","title":"Version 0.5-2 (2010-11-28)","text":"CRAN release: 2011-03-24 Added loddsratio related methods log odds ratios, generalizing vcd::oddsratio 2 x 2 (x strata) tables R x C (x strata) tables Added .matrix.loddsratio, .array.loddsratio methods Added simple plot examples example(loddsratio), anticipating plot method Added data(Fungicide), 2 x 2 x 2 x 2 table Renamed summarize() related methods summarise() avoid conflict plyr. Addition vcd-tutorial vignette use aperm() table objects Updated demo(yamaguchi-xie) correct row/col nomenclature add plot BIC Added aperm() S3 generic handle table objects Moved tv.dat inst/doc/extdata avoid warnings R 2.12+","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-1-2010-09-17","dir":"Changelog","previous_headings":"","what":"Version 0.5-1 (2010-09-17)","title":"Version 0.5-1 (2010-09-17)","text":"CRAN release: 2010-11-29 Added Yamaguchi87 data (5x5x3 three-way mobility table frequency form) Added demo(yamaguchi-xie) illustrating fitting visualization models homogeneous log multiplicative layer effects fit Xie (1992, Table 1) Added BIC summarize() friends Added Hauser79 data (two-way mobility table), plus examples Powers Xie (2008) Added Crossings() construct interactions Goodman 1972 crossings model. Added datasets() list datasets packages Extended description examples Kway() Added meanResiduals() extended mosaic.glm() (Heather Turner) summarize() gets sortby argument glmlist loglmlist objects","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-05-0-2010-04-28","dir":"Changelog","previous_headings":"","what":"Version 0.5-0 (2010-04-28)","title":"Version 0.5-0 (2010-04-28)","text":"CRAN release: 2010-04-16 Fleshed mosaic3d, allowing display observed expected, internally calculated externally supplied residuals, specifying initial 3D shape, etc. completes ‘top-level’ work mosaic3d(), borrowing code vcd::strucplot. Added initial handling zero cells table mosaic3d(). Added center3d() finding mean coordinates shape3d objects. Added demo(mosaic-hec) comparing 2D 3D mosaics HairEyeColor data Gave mosaic3d label_edge argument, allowing labels dimensions minima maxima Made mosaic3d object oriented, giving loglm method Added Kway(), fitting 0-way, 1-way, 2-way, … k-way models glm","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-04-3-2010-03-25","dir":"Changelog","previous_headings":"","what":"Version 0.4-3 (2010-03-25)","title":"Version 0.4-3 (2010-03-25)","text":"Added demo(mosaic3d-demo), proof--concept 3D mosaic displays Added mosaic3d(), initial basic Version. Factored split3d() gave S3 methods","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-04-2-2010-03-09","dir":"Changelog","previous_headings":"","what":"Version 0.4-2 (2010-03-09)","title":"Version 0.4-2 (2010-03-09)","text":"CRAN release: 2010-03-18 Revised vignette(“vcd-tutorial”): added hints mosaic(), corrected stuff regarding prior limitations mosaic.glm() Added demo(Wong3-1): three-way table, models conditional association Added Suggest: effects effects plots glm(), multinom() polr() models Added demo(housing): visualize models fit example(housing, package=“MASS”) using mosaic() effect plots. Updated demo(Wong2-3): added model comparison plots, glmlist processing Added Suggest: VGAM Extended package description vcdExtra-package.Rd Added glmlist() facilitate processing, extraction, plotting, etc. collection glm() models Added loglmlist(), collections loglm() objects Added summarize methods glm, glmlist, loglm loglmlist objects","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-04-1-2010-02-21","dir":"Changelog","previous_headings":"","what":"Version 0.4-1 (2010-02-21)","title":"Version 0.4-1 (2010-02-21)","text":"CRAN release: 2010-03-07 Added example(Caesar), illustrating structural zeros Re-named Heckman variables e1971, …, e1968 (errors loglm); began example(Heckman) Added example(Detergent), example(Dyke) Fixed bug mosaic.glm data global environment (Heather Turner) Added sieve.glm assoc.glm methods (MF) Added modFit.glm modFit.loglm Added demo(Wong2-3)","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-04-0-2010-02-23","dir":"Changelog","previous_headings":"","what":"Version 0.4-0 (2010-02-23)","title":"Version 0.4-0 (2010-02-23)","text":"CRAN release: 2010-02-28 Added new datasets: data/{Abortion, Bartlett, Caesar, Cancer, Detergent, Dyke, Gilby, Heart, Heckman, Hoyt, Mobility} mosdata.sas via md2r.sas converter. Fixed small documentation warnings Switched inst/CHANGES NEWS","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-03-6-2009-04-21","dir":"Changelog","previous_headings":"","what":"Version 0.3-6 (2009-04-21)","title":"Version 0.3-6 (2009-04-21)","text":"Added Depends: gnm Added demo/{mental-glm, ucb-glm, vision-quasi} Added demo/{occStatus,yaish-unidiff} Initial release CRAN","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-03-5-2009-3-6","dir":"Changelog","previous_headings":"","what":"Version 0.3-5 (2009-3-6)","title":"Version 0.3-5 (2009-3-6)","text":"mosaic.glm now uses object$data available","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-03-4-2009-2-11","dir":"Changelog","previous_headings":"","what":"Version 0.3-4 (2009-2-11)","title":"Version 0.3-4 (2009-2-11)","text":"Fixed bugs mosaic.glm, mosaic.gnm models terms like Diag(dest, origin) get included x$xlevels","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-03-3-2009-2-10","dir":"Changelog","previous_headings":"","what":"Version 0.3-3 (2009-2-10)","title":"Version 0.3-3 (2009-2-10)","text":"Fixed bugs mosaic.gnm Fixed print.GKgamma Added example GKgamma vcd-tutorial","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-03-2-2009-2-8","dir":"Changelog","previous_headings":"","what":"Version 0.3-2 (2009-2-8)","title":"Version 0.3-2 (2009-2-8)","text":"Added examples mosaic.glm.Rd","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-03-0-2009-2-6","dir":"Changelog","previous_headings":"","what":"Version 0.3-0 (2009-2-6)","title":"Version 0.3-0 (2009-2-6)","text":"Fixed bugs mosaic.glm mosaic.gnm","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-02-2009-2-1","dir":"Changelog","previous_headings":"","what":"Version 0.2 (2009-2-1)","title":"Version 0.2 (2009-2-1)","text":"Added vcd-tutorial vignette","code":""},{"path":"https://friendly.github.io/vcdExtra/news/index.html","id":"version-01-2009-1-26","dir":"Changelog","previous_headings":"","what":"Version 0.1 (2009-1-26)","title":"Version 0.1 (2009-1-26)","text":"Initial Version R-Forge.","code":""}]
