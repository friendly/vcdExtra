[{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"forms-of-frequency-data","dir":"Articles","previous_headings":"","what":"Forms of frequency data","title":"Creating and manipulating frequency tables","text":"first thing need know categorical data can represented three different forms R, sometimes necessary convert one form another, carrying statistical tests, fitting models visualizing results. data object exists R, can examine complete structure str() function, view names components names() function.","code":""},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"case-form","dir":"Articles","previous_headings":"Forms of frequency data","what":"Case form","title":"Creating and manipulating frequency tables","text":"Categorical data case form simply data frames containing individual observations, one factors, used classifying variables. case form, may also numeric covariates. total number observations nrow(X), number variables ncol(X). Example: Arthritis data available case form vcd package. two explanatory factors: Treatment Sex. Age numeric covariate, Improved response— ordered factor, levels None < < Marked. Excluding Age, represents \\(2 \\times 2 \\times 3\\) contingency table Treatment, Sex Improved, case form.","code":"names(Arthritis)      # show the variables ## [1] \"ID\"        \"Treatment\" \"Sex\"       \"Age\"       \"Improved\"  str(Arthritis)        # show the structure ## 'data.frame':    84 obs. of  5 variables: ##  $ ID       : int  57 46 77 17 36 23 75 39 33 55 ... ##  $ Treatment: Factor w/ 2 levels \"Placebo\",\"Treated\": 2 2 2 2 2 2 2 2 2 2 ... ##  $ Sex      : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 2 ... ##  $ Age      : int  27 29 30 32 46 58 59 59 63 63 ... ##  $ Improved : Ord.factor w/ 3 levels \"None\"<\"Some\"<..: 2 1 1 3 3 3 1 3 1 1 ...  head(Arthritis,5)     # first 5 observations, same as Arthritis[1:5,]  ##   ID Treatment  Sex Age Improved ## 1 57   Treated Male  27     Some ## 2 46   Treated Male  29     None ## 3 77   Treated Male  30     None ## 4 17   Treated Male  32   Marked ## 5 36   Treated Male  46   Marked"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"frequency-form","dir":"Articles","previous_headings":"Forms of frequency data","what":"Frequency form","title":"Creating and manipulating frequency tables","text":"Data frequency form also data frame containing one factors, frequency variable, often called Freq count. total number observations : sum(X$Freq), sum(X[,\"Freq\"]) equivalent form. number cells table given nrow(X). Example: small frequency tables, often convenient enter frequency form using expand.grid() factors c() list counts vector. example , (Agresti, 2002) gives results 1991 General Social Survey, respondents classified sex party identification.","code":"# Agresti (2002), table 3.11, p. 106 GSS <- data.frame(   expand.grid(sex = c(\"female\", \"male\"),                party = c(\"dem\", \"indep\", \"rep\")),   count = c(279,165,73,47,225,191))  GSS ##      sex party count ## 1 female   dem   279 ## 2   male   dem   165 ## 3 female indep    73 ## 4   male indep    47 ## 5 female   rep   225 ## 6   male   rep   191 names(GSS) ## [1] \"sex\"   \"party\" \"count\" str(GSS) ## 'data.frame':    6 obs. of  3 variables: ##  $ sex  : Factor w/ 2 levels \"female\",\"male\": 1 2 1 2 1 2 ##  $ party: Factor w/ 3 levels \"dem\",\"indep\",..: 1 1 2 2 3 3 ##  $ count: num  279 165 73 47 225 191  sum(GSS$count) ## [1] 980"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"table-form","dir":"Articles","previous_headings":"Forms of frequency data","what":"Table form","title":"Creating and manipulating frequency tables","text":"Table form data represented matrix, array table object, whose elements frequencies \\(n\\)-way table. variable names (factors) levels given dimnames(X). total number observations sum(X). number dimensions table length(dimnames(X)), table sizes given sapply(dimnames(X), length). Example: HairEyeColor stored table form vcd. Example: Enter frequencies matrix, assign dimnames, giving variable names category labels. Note , default, matrix() uses elements supplied columns result, unless specify byrow=TRUE. JobSat matrix, object class(\"table\"), functions happier tables matrices. can coerce table .table(),","code":"str(HairEyeColor)                      # show the structure ##  'table' num [1:4, 1:4, 1:2] 32 53 10 3 11 50 10 30 10 25 ... ##  - attr(*, \"dimnames\")=List of 3 ##   ..$ Hair: chr [1:4] \"Black\" \"Brown\" \"Red\" \"Blond\" ##   ..$ Eye : chr [1:4] \"Brown\" \"Blue\" \"Hazel\" \"Green\" ##   ..$ Sex : chr [1:2] \"Male\" \"Female\"  sum(HairEyeColor)                      # number of cases ## [1] 592  sapply(dimnames(HairEyeColor), length) # table dimension sizes ## Hair  Eye  Sex  ##    4    4    2 # A 4 x 4 table  Agresti (2002, Table 2.8, p. 57) Job Satisfaction JobSat <- matrix(c( 1, 2, 1, 0,                      3, 3, 6, 1,                     10,10,14, 9,                      6, 7,12,11), 4, 4)  dimnames(JobSat) = list(   income = c(\"< 15k\", \"15-25k\", \"25-40k\", \"> 40k\"),   satisfaction = c(\"VeryD\", \"LittleD\", \"ModerateS\", \"VeryS\")   )  JobSat ##         satisfaction ## income   VeryD LittleD ModerateS VeryS ##   < 15k      1       3        10     6 ##   15-25k     2       3        10     7 ##   25-40k     1       6        14    12 ##   > 40k      0       1         9    11 JobSat <- as.table(JobSat) str(JobSat) ##  'table' num [1:4, 1:4] 1 2 1 0 3 3 6 1 10 10 ... ##  - attr(*, \"dimnames\")=List of 2 ##   ..$ income      : chr [1:4] \"< 15k\" \"15-25k\" \"25-40k\" \"> 40k\" ##   ..$ satisfaction: chr [1:4] \"VeryD\" \"LittleD\" \"ModerateS\" \"VeryS\""},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"sec:ordered-factors","dir":"Articles","previous_headings":"","what":"Ordered factors and reordered tables","title":"Creating and manipulating frequency tables","text":"table form, values table factors ordered position table. Thus JobSat data, income satisfaction represent ordered factors, positions values rows columns reflects ordered nature. Yet, analysis, time need numeric values levels ordered factors table, e.g., treat factor quantitative variable. cases, can simply re-assign dimnames attribute table variables. example, , assign numeric values income middle ranges, treat satisfaction equally spaced integer scores. HairEyeColor data, hair color eye color ordered arbitrarily. visualizing data using mosaic plots methods described , turns useful assure hair color eye color ordered dark light. Hair colors actually ordered way already, easiest re-order eye colors indexing. str() friend. also order hair color eye color shown result correspondence analysis () . data case form frequency form, ordered factors represented character values, must ensure treated ordered R. Imagine Arthritis data read text file. default Improved ordered alphabetically: Marked, None, — want. case, function ordered() (others) can useful. dataset Arthritis vcd package data.frame form order Improved, response data, mosaic display Treatment Improved () shows clearly interpretable pattern. original version mosaic vcd package required input contingency table array form, convert using xtabs(). Mosaic plot Arthritis data, showing marginal model independence Treatment Improved. Age, covariate, Sex ignored . Finally, situations , particularly display purposes, want re-order dimensions \\(n\\)-way table, change labels variables levels. easy data table form: aperm() permutes dimensions, assigning names dimnames changes variable names level labels respectively. use following version UCBAdmissions @(sec:mantel) .1","code":"dimnames(JobSat)$income <- c(7.5,20,32.5,60) dimnames(JobSat)$satisfaction <- 1:4 HairEyeColor <- HairEyeColor[, c(1,3,4,2), ] str(HairEyeColor) ##  'table' num [1:4, 1:4, 1:2] 32 53 10 3 10 25 7 5 3 15 ... ##  - attr(*, \"dimnames\")=List of 3 ##   ..$ Hair: chr [1:4] \"Black\" \"Brown\" \"Red\" \"Blond\" ##   ..$ Eye : chr [1:4] \"Brown\" \"Hazel\" \"Green\" \"Blue\" ##   ..$ Sex : chr [1:2] \"Male\" \"Female\" Arthritis <- read.csv(\"arthritis.txt\",header=TRUE) Arthritis$Improved <- ordered(Arthritis$Improved,                                levels=c(\"None\", \"Some\", \"Marked\")                               ) data(Arthritis, package=\"vcd\") art <- xtabs(~Treatment + Improved, data = Arthritis) mosaic(art, gp = shading_max, split_vertical = TRUE, main=\"Arthritis: [Treatment] [Improved]\") UCB <- aperm(UCBAdmissions, c(2, 1, 3)) dimnames(UCB)[[2]] <- c(\"Yes\", \"No\") names(dimnames(UCB)) <- c(\"Sex\", \"Admit?\", \"Department\")  # display as a flattened table stats::ftable(UCB) ##               Department   A   B   C   D   E   F ## Sex    Admit?                                    ## Male   Yes               512 353 120 138  53  22 ##        No                313 207 205 279 138 351 ## Female Yes                89  17 202 131  94  24 ##        No                 19   8 391 244 299 317"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"sec:structable","dir":"Articles","previous_headings":"","what":"structable()","title":"Creating and manipulating frequency tables","text":"3-way larger tables structable() function vcd provides convenient flexible tabular display. variables assigned rows columns two-way display can specified model formula. also returns object class \"structable\" may plotted mosaic() (shown ).","code":"structable(HairEyeColor)                   # show the table: default ##              Eye Brown Hazel Green Blue ## Hair  Sex                               ## Black Male          32    10     3   11 ##       Female        36     5     2    9 ## Brown Male          53    25    15   50 ##       Female        66    29    14   34 ## Red   Male          10     7     7   10 ##       Female        16     7     7    7 ## Blond Male           3     5     8   30 ##       Female         4     5     8   64  structable(Hair+Sex ~ Eye, HairEyeColor)   # specify col ~ row variables ##       Hair Black        Brown         Red        Blond        ##       Sex   Male Female  Male Female Male Female  Male Female ## Eye                                                           ## Brown         32     36    53     66   10     16     3      4 ## Hazel         10      5    25     29    7      7     5      5 ## Green          3      2    15     14    7      7     8      8 ## Blue          11      9    50     34   10      7    30     64 HSE < - structable(Hair+Sex ~ Eye, HairEyeColor)   # save structable object mosaic(HSE)                                        # plot it"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"sec:table","dir":"Articles","previous_headings":"","what":"table() and friends","title":"Creating and manipulating frequency tables","text":"can generate frequency tables factor variables using table() function, tables proportions using prop.table() function, marginal frequencies using margin.table(). examples, create categorical vectors: lines illustrate table-related functions: table() can also generate multidimensional tables based 3 categorical variables. case, can use ftable() structable() function print results attractively. table() ignores missing values default. include NA category counts, include table option exclude=NULL variable vector. variable factor create new factor using .","code":"n=500  A <- factor(sample(c(\"a1\",\"a2\"), n, rep=TRUE))  B <- factor(sample(c(\"b1\",\"b2\"), n, rep=TRUE))  C <- factor(sample(c(\"c1\",\"c2\"), n, rep=TRUE))  mydata <- data.frame(A,B,C) # 2-Way Frequency Table attach(mydata) ## The following objects are masked _by_ .GlobalEnv: ##  ##     A, B, C mytable <- table(A,B)   # A will be rows, B will be columns mytable                 # print table ##     B ## A     b1  b2 ##   a1 116 114 ##   a2 138 132  margin.table(mytable, 1) # A frequencies (summed over B) ## A ##  a1  a2  ## 230 270 margin.table(mytable, 2) # B frequencies (summed over A) ## B ##  b1  b2  ## 254 246  prop.table(mytable)    # cell percentages ##     B ## A       b1    b2 ##   a1 0.232 0.228 ##   a2 0.276 0.264 prop.table(mytable, 1) # row percentages ##     B ## A           b1        b2 ##   a1 0.5043478 0.4956522 ##   a2 0.5111111 0.4888889 prop.table(mytable, 2) # column percentages ##     B ## A           b1        b2 ##   a1 0.4566929 0.4634146 ##   a2 0.5433071 0.5365854 # 3-Way Frequency Table mytable <- table(A, B, C) ftable(mytable) ##       C c1 c2 ## A  B          ## a1 b1   45 71 ##    b2   59 55 ## a2 b1   62 76 ##    b2   76 56"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"sec:xtabs","dir":"Articles","previous_headings":"","what":"xtabs()","title":"Creating and manipulating frequency tables","text":"xtabs() function allows create cross-tabulations data using formula style input. typically works case-form data supplied data frame matrix. result contingency table array format, whose dimensions determined terms right side formula. variable included left side formula, assumed vector frequencies (useful data already tabulated frequency form).","code":"# 3-Way Frequency Table mytable <- xtabs(~A+B+C, data=mydata)  ftable(mytable)    # print table ##       C c1 c2 ## A  B          ## a1 b1   45 71 ##    b2   59 55 ## a2 b1   62 76 ##    b2   76 56  summary(mytable)   # chi-square test of indepedence ## Call: xtabs(formula = ~A + B + C, data = mydata) ## Number of cases in table: 500  ## Number of factors: 3  ## Test for independence of all factors: ##  Chisq = 9.888, df = 4, p-value = 0.04235 (GSStab <- xtabs(count ~ sex + party, data=GSS)) ##         party ## sex      dem indep rep ##   female 279    73 225 ##   male   165    47 191  summary(GSStab) ## Call: xtabs(formula = count ~ sex + party, data = GSS) ## Number of cases in table: 980  ## Number of factors: 2  ## Test for independence of all factors: ##  Chisq = 7.01, df = 2, p-value = 0.03005"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"collapsing-over-table-factors-aggregate-margin-table-and-apply","dir":"Articles","previous_headings":"","what":"Collapsing over table factors: aggregate(), margin.table() and apply()}","title":"Creating and manipulating frequency tables","text":"sometimes happens data set variables factors want analyse, else, done initial analyses, decide certain factors important, excluded graphic displays collapsing (summing) . example, mosaic plots fourfold displays often simpler construct versions data collapsed factors shown plots. appropriate tools use depend form data represented— case-form data frame, frequency-form data frame (aggregate()), table-form array table object (margin.table() apply()). data frequency form, want produce another frequency data frame, aggregate() handy tool, using argument FUN=sum sum frequency variable factors mentioned formula. Example: data frame DaytonSurvey vcdExtra package represents \\(2^5\\) table giving frequencies reported use (``ever used?’’) alcohol, cigarettes marijuana sample high school seniors, also classified sex race. focus associations among substances, want collapse sex race. right-hand side formula used call aggregate() gives factors retained new frequency data frame, Dayton.ACM.df. data table form, want produce another table, apply() FUN=sum can used similar way sum table dimensions mentioned MARGIN argument. margin.table() just wrapper apply() using sum() function. Example: illustrate, first convert DaytonSurvey 5-way table using xtabs(), giving Dayton.tab. , use apply() Dayton.tab give 3-way table Dayton.ACM.tab summed sex race. elements new table column sums Dayton.tab shown structable() just . Many operations can performed using **ply() functions plyr package. example, data frequency form data frame, use ddply() collapse unmentioned factors, plyr::summarise() function applied piece.","code":"str(DaytonSurvey) ## 'data.frame':    32 obs. of  6 variables: ##  $ cigarette: Factor w/ 2 levels \"Yes\",\"No\": 1 2 1 2 1 2 1 2 1 2 ... ##  $ alcohol  : Factor w/ 2 levels \"Yes\",\"No\": 1 1 2 2 1 1 2 2 1 1 ... ##  $ marijuana: Factor w/ 2 levels \"Yes\",\"No\": 1 1 1 1 2 2 2 2 1 1 ... ##  $ sex      : Factor w/ 2 levels \"female\",\"male\": 1 1 1 1 1 1 1 1 2 2 ... ##  $ race     : Factor w/ 2 levels \"white\",\"other\": 1 1 1 1 1 1 1 1 1 1 ... ##  $ Freq     : num  405 13 1 1 268 218 17 117 453 28 ... head(DaytonSurvey) ##   cigarette alcohol marijuana    sex  race Freq ## 1       Yes     Yes       Yes female white  405 ## 2        No     Yes       Yes female white   13 ## 3       Yes      No       Yes female white    1 ## 4        No      No       Yes female white    1 ## 5       Yes     Yes        No female white  268 ## 6        No     Yes        No female white  218 # data in frequency form # collapse over sex and race Dayton.ACM.df <- aggregate(Freq ~ cigarette+alcohol+marijuana,                             data=DaytonSurvey,                             FUN=sum) Dayton.ACM.df ##   cigarette alcohol marijuana Freq ## 1       Yes     Yes       Yes  911 ## 2        No     Yes       Yes   44 ## 3       Yes      No       Yes    3 ## 4        No      No       Yes    2 ## 5       Yes     Yes        No  538 ## 6        No     Yes        No  456 ## 7       Yes      No        No   43 ## 8        No      No        No  279 # in table form Dayton.tab <- xtabs(Freq ~ cigarette+alcohol+marijuana+sex+race,                      data=DaytonSurvey) structable(cigarette+alcohol+marijuana ~ sex+race,             data=Dayton.tab) ##              cigarette Yes              No             ##              alcohol   Yes      No     Yes      No     ##              marijuana Yes  No Yes  No Yes  No Yes  No ## sex    race                                            ## female white           405 268   1  17  13 218   1 117 ##        other            23  23   0   1   2  19   0  12 ## male   white           453 228   1  17  28 201   1 133 ##        other            30  19   1   8   1  18   0  17 # collapse over sex and race Dayton.ACM.tab <- apply(Dayton.tab, MARGIN=1:3, FUN=sum) Dayton.ACM.tab <- margin.table(Dayton.tab, 1:3)   # same result  structable(cigarette+alcohol ~ marijuana, data=Dayton.ACM.tab) ##           cigarette Yes      No     ##           alcohol   Yes  No Yes  No ## marijuana                           ## Yes                 911   3  44   2 ## No                  538  43 456 279 library(plyr) Dayton.ACM.df <- plyr::ddply(DaytonSurvey,                               .(cigarette, alcohol, marijuana),                               plyr::summarise, Freq=sum(Freq))  Dayton.ACM.df"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"collapsing-table-levels-collapse-table","dir":"Articles","previous_headings":"","what":"Collapsing table levels: collapse.table()","title":"Creating and manipulating frequency tables","text":"related problem arises table array purpose want reduce number levels factors summing subsets frequencies. example, may initially coded Age 10-year intervals, decide , either analysis display purposes, want reduce Age 20-year intervals. collapse.table() function vcdExtra designed purpose. Example: Create 3-way table, collapse Age 10-year 20-year intervals. First, generate \\(2 \\times 6 \\times 3\\) table random counts Poisson distribution mean 100. Now collapse age 20-year intervals, education 2 levels. arguments, levels age education given label summed resulting smaller table.","code":"# create some sample data in frequency form sex <- c(\"Male\", \"Female\") age <- c(\"10-19\", \"20-29\",  \"30-39\", \"40-49\", \"50-59\", \"60-69\") education <- c(\"low\", 'med', 'high') data <- expand.grid(sex=sex, age=age, education=education) counts <- rpois(36, 100)   # random Possion cell frequencies data <- cbind(data, counts)  # make it into a 3-way table t1 <- xtabs(counts ~ sex + age + education, data=data) structable(t1) ##                  age 10-19 20-29 30-39 40-49 50-59 60-69 ## sex    education                                         ## Male   low              98   105   104    90    90   101 ##        med              97   105   101    88    97   107 ##        high             99   101   109    88    99    96 ## Female low             102   117   101   105    85    88 ##        med             106    84    92   116   110    96 ##        high            106    96   121    91   107   102 # collapse age to 3 levels, education to 2 levels t2 <- collapse.table(t1,           age=c(\"10-29\", \"10-29\",  \"30-49\", \"30-49\", \"50-69\", \"50-69\"),          education=c(\"<high\", \"<high\", \"high\")) structable(t2) ##                  age 10-29 30-49 50-69 ## sex    education                       ## Male   <high           405   383   395 ##        high            200   197   195 ## Female <high           409   414   379 ##        high            202   212   209"},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"converting-among-frequency-tables-and-data-frames","dir":"Articles","previous_headings":"","what":"Converting among frequency tables and data frames","title":"Creating and manipulating frequency tables","text":"’ve seen, given contingency table can represented equivalently different forms, R functions designed one particular representation. table shows handy tools converting one form another. example, contingency table table form (object class(table)) can converted data.frame .data.frame().2 resulting data.frame contains columns representing classifying factors table entries (column named responseName argument, defaulting Freq. inverse xtabs(). Example: Convert GSStab table form data.frame frequency form. Example: Convert Arthritis data case form 3-way table Treatment \\(\\times\\) Sex \\(\\times\\) Improved. Note use () avoid use Arthritis\\$Treatment etc. within call table().%3 may also times need equivalent case form data.frame factors representing table variables rather frequency table. example, mca() function package MASS operates data format. Marc Schwartz initially provided code expand.dft() Rhelp mailing list converting table back case form data.frame. function included vcdExtra. Example: Convert Arthritis data table form (Art.tab) back data.frame case form, factors Treatment, Sex Improved.","code":"as.data.frame(GSStab) ##      sex party Freq ## 1 female   dem  279 ## 2   male   dem  165 ## 3 female indep   73 ## 4   male indep   47 ## 5 female   rep  225 ## 6   male   rep  191 Art.tab <- with(Arthritis, table(Treatment, Sex, Improved)) str(Art.tab) ##  'table' int [1:2, 1:2, 1:3] 19 6 10 7 7 5 0 2 6 16 ... ##  - attr(*, \"dimnames\")=List of 3 ##   ..$ Treatment: chr [1:2] \"Placebo\" \"Treated\" ##   ..$ Sex      : chr [1:2] \"Female\" \"Male\" ##   ..$ Improved : chr [1:3] \"None\" \"Some\" \"Marked\"  ftable(Art.tab) ##                  Improved None Some Marked ## Treatment Sex                              ## Placebo   Female            19    7      6 ##           Male              10    0      1 ## Treated   Female             6    5     16 ##           Male               7    2      5 Art.df <- expand.dft(Art.tab) str(Art.df) ## 'data.frame':    84 obs. of  3 variables: ##  $ Treatment: chr  \"Placebo\" \"Placebo\" \"Placebo\" \"Placebo\" ... ##  $ Sex      : chr  \"Female\" \"Female\" \"Female\" \"Female\" ... ##  $ Improved : chr  \"None\" \"None\" \"None\" \"None\" ..."},{"path":"http://friendly.github.io/vcdExtra/articles/A_creating.html","id":"sec:complex","dir":"Articles","previous_headings":"","what":"A complex example","title":"Creating and manipulating frequency tables","text":"’ve followed far, ’re ready complicated example. data file, tv.dat represents 4-way table size \\(5 \\times 11 \\times 5 \\times 3\\) table variables (unnamed file) read V1 – V4, cell frequency read V5. file, stored doc/extdata directory vcdExtra, can read follows: local file, just use read.table() form: data tv.dat came initial implementation mosaic displays R Jay Emerson. turn, came initial development mosaic displays (Hartigan & Kleiner, 1984) illustrated method data large sample TV viewers whose behavior recorded Neilson ratings. data set contains sample television audience data Neilsen Media Research week starting November 6, 1995. table variables : V1– values 1:5 correspond days Monday–Friday; V2– values 1:11 correspond quarter hour times 8:00PM 10:30PM; V3– values 1:5 correspond ABC, CBS, NBC, Fox, non-network choices; V4– values 1:3 correspond transition states: turn television , Switch channels, Persist viewing current channel. interested just cell frequencies, rely facts table complete— missing cells, nrow(tv.data) = 825; observations ordered V1 varies rapidly V4 slowly. , can just extract frequency column reshape array. [dangerous observations order.] generally (even missing cells), can use xtabs() (plyr::daply()) cross-tabulation, using V5 frequency variable. ’s operation xtabs(): 4-way table large awkward work . Among networks, Fox occur infrequently. can also cut 3-way table considering viewers persist current station.4 Finally, purposes, might want collapse 11 times smaller number. Half-hour time slots make sense. , use .data.frame.table() convert table back data frame, levels() re-assign values Time, finally, xtabs() give new, collapsed frequency table. ’ve come far, might well show mosaic display. analogous used Hartigan & Kleiner (1984).  mosaic displays can read several levels, corresponding successive splits tiles residual shading. Several trends clear viewers persist: Overall, number viewers weekday, slightly Thursday. Looking time slots, viewership slightly greater 9:00 - 10:00 overall also 8:00 - 9:00 Thursday Friday residual shading tiles: Monday: CBS dominates time slots. Tuesday” ABC CBS dominate 9:00 Thursday: largely NBC day Friday: ABC dominates early evening","code":"tv.data<-read.table(system.file(\"extdata\",\"tv.dat\", package=\"vcdExtra\")) head(tv.data,5) ##   V1 V2 V3 V4 V5 ## 1  1  1  1  1  6 ## 2  2  1  1  1 18 ## 3  3  1  1  1  6 ## 4  4  1  1  1  2 ## 5  5  1  1  1 11 tv.data<-read.table(\"C:/R/data/tv.dat\") TV <- array(tv.data[,5], dim=c(5,11,5,3))                                         dimnames(TV) <- list(c(\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\"),                       c(\"8:00\",\"8:15\",\"8:30\",\"8:45\",\"9:00\",\"9:15\",\"9:30\",                                 \"9:45\",\"10:00\",\"10:15\",\"10:30\"),                                                  c(\"ABC\",\"CBS\",\"NBC\",\"Fox\",\"Other\"),                       c(\"Off\",\"Switch\",\"Persist\"))  names(dimnames(TV))<-c(\"Day\", \"Time\", \"Network\", \"State\") TV <- xtabs(V5 ~ ., data=tv.data) dimnames(TV) <- list(Day = c(\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\"),                       Time = c(\"8:00\",\"8:15\",\"8:30\",\"8:45\",\"9:00\",\"9:15\",\"9:30\",                                        \"9:45\",\"10:00\",\"10:15\",\"10:30\"),                                                  Network = c(\"ABC\",\"CBS\",\"NBC\",\"Fox\",\"Other\"),                       State = c(\"Off\",\"Switch\",\"Persist\"))  # table dimensions dim(TV) TV2 <- TV[,,1:3,]      # keep only ABC, CBS, NBC TV2 <- TV2[,,,3]       # keep only Persist -- now a 3 way table structable(TV2) ##                   Time 8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30 ## Day       Network                                                                ## Monday    ABC           146  151  156   83  325  350  386  340   352   280   278 ##           CBS           337  293  304  233  311  251  241  164   252   265   272 ##           NBC           263  219  236  140  226  235  239  246   279   263   283 ## Tuesday   ABC           244  181  231  205  385  283  345  192   329   351   364 ##           CBS           173  180  184  109  218  235  256  250   274   263   261 ##           NBC           315  254  280  241  370  214  195  111   188   190   210 ## Wednesday ABC           233  161  194  156  339  264  279  140   237   228   203 ##           CBS           158  126  207   59   98  103  122   86   109   105   110 ##           NBC           134  146  166   66  194  230  264  143   274   289   306 ## Thursday  ABC           174  183  197  181  187  198  211   86   110   122   117 ##           CBS           196  185  195  104  106  116  116   47   102    84    84 ##           NBC           515  463  472  477  590  473  446  349   649   705   747 ## Friday    ABC           294  281  305  239  278  246  245  138   246   232   233 ##           CBS           130  144  154   81  129  153  136  126   138   136   152 ##           NBC           195  220  248  160  172  164  169   85   183   198   204 TV.df <- as.data.frame.table(TV2) levels(TV.df$Time) <- c(rep(\"8:00\", 2),                         rep(\"8:30\", 2),                         rep(\"9:00\", 2),                          rep(\"9:30\", 2),                          rep(\"10:00\",2),                             \"10:30\"                         )  TV3 <- xtabs(Freq ~ Day + Time + Network, TV.df)  structable(Day ~ Time+Network, TV3) ##               Day Monday Tuesday Wednesday Thursday Friday ## Time  Network                                              ## 8:00  ABC            297     425       394      357    575 ##       CBS            630     353       284      381    274 ##       NBC            482     569       280      978    415 ## 8:30  ABC            239     436       350      378    544 ##       CBS            537     293       266      299    235 ##       NBC            376     521       232      949    408 ## 9:00  ABC            675     668       603      385    524 ##       CBS            562     453       201      222    282 ##       NBC            461     584       424     1063    336 ## 9:30  ABC            726     537       419      297    383 ##       CBS            405     506       208      163    262 ##       NBC            485     306       407      795    254 ## 10:00 ABC            632     680       465      232    478 ##       CBS            517     537       214      186    274 ##       NBC            542     378       563     1354    381 ## 10:30 ABC            278     364       203      117    233 ##       CBS            272     261       110       84    152 ##       NBC            283     210       306      747    204 mosaic(TV3, shade = TRUE,        labeling = labeling_border(rot_labels = c(0, 0, 0, 90)))"},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"crosstable","dir":"Articles","previous_headings":"","what":"CrossTable","title":"Tests of Independence","text":"tabular displays, CrossTable() function gmodels package produces cross-tabulations modeled PROC FREQ SAS CROSSTABS SPSS. wealth options quantities can shown cell. Recall GSS data used earlier. Generate crosstable showing cell frequency cell contribution \\(\\chi^2\\). options report percentages (row, column, cell), specify decimal places, produce Chi-square, Fisher, McNemar tests independence, report expected residual values (pearson, standardized, adjusted standardized), include missing values valid, annotate row column titles, format SAS SPSS style output! See help(CrossTable) details.","code":"# Agresti (2002), table 3.11, p. 106 GSS <- data.frame(   expand.grid(sex = c(\"female\", \"male\"),                party = c(\"dem\", \"indep\", \"rep\")),   count = c(279,165,73,47,225,191))  (GSStab <- xtabs(count ~ sex + party, data=GSS)) ##         party ## sex      dem indep rep ##   female 279    73 225 ##   male   165    47 191 # 2-Way Cross Tabulation library(gmodels) CrossTable(GSStab, prop.t=FALSE, prop.r=FALSE, prop.c=FALSE) ##  ##   ##    Cell Contents ## |-------------------------| ## |                       N | ## | Chi-square contribution | ## |-------------------------| ##  ##   ## Total Observations in Table:  980  ##  ##   ##              | party  ##          sex |       dem |     indep |       rep | Row Total |  ## -------------|-----------|-----------|-----------|-----------| ##       female |       279 |        73 |       225 |       577 |  ##              |     1.183 |     0.078 |     1.622 |           |  ## -------------|-----------|-----------|-----------|-----------| ##         male |       165 |        47 |       191 |       403 |  ##              |     1.693 |     0.112 |     2.322 |           |  ## -------------|-----------|-----------|-----------|-----------| ## Column Total |       444 |       120 |       416 |       980 |  ## -------------|-----------|-----------|-----------|-----------| ##  ##"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"chi-square-test","dir":"Articles","previous_headings":"","what":"Chi-square test","title":"Tests of Independence","text":"2-way tables can use chisq.test() test independence row column variable. default, \\(p\\)-value calculated asymptotic chi-squared distribution test statistic. Optionally, \\(p\\)-value can derived via Monte Carlo simulation.","code":"(HairEye <- margin.table(HairEyeColor, c(1, 2))) ##        Eye ## Hair    Brown Blue Hazel Green ##   Black    68   20    15     5 ##   Brown   119   84    54    29 ##   Red      26   17    14    14 ##   Blond     7   94    10    16  chisq.test(HairEye) ##  ##  Pearson's Chi-squared test ##  ## data:  HairEye ## X-squared = 138.29, df = 9, p-value < 2.2e-16  chisq.test(HairEye, simulate.p.value = TRUE) ##  ##  Pearson's Chi-squared test with simulated p-value (based on 2000 ##  replicates) ##  ## data:  HairEye ## X-squared = 138.29, df = NA, p-value = 0.0004998"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"sec:Fisher","dir":"Articles","previous_headings":"","what":"Fisher Exact Test","title":"Tests of Independence","text":"fisher.test(X) provides exact test independence. X must two-way contingency table table form. Another form, fisher.test(X, Y) takes two categorical vectors length. tables larger \\(2 \\times 2\\) method can computationally intensive (can fail) frequencies small. Fisher’s test meant tables small total sample size. generates error HairEye data \\(n\\)=592 total frequency.","code":"fisher.test(GSStab) ##  ##  Fisher's Exact Test for Count Data ##  ## data:  GSStab ## p-value = 0.03115 ## alternative hypothesis: two.sided fisher.test(HairEye) ## Error in fisher.test(HairEye): FEXACT error 6 (f5xact).  LDKEY=618 is too small for this problem: kval=238045028. ## Try increasing the size of the workspace."},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"sec:mantel","dir":"Articles","previous_headings":"","what":"Mantel-Haenszel test and conditional association","title":"Tests of Independence","text":"Use mantelhaen.test(X) function perform Cochran-Mantel-Haenszel \\(\\chi^2\\) chi test null hypothesis two nominal variables conditionally independent, \\(\\perp B \\; | \\; C\\), stratum, assuming three-way interaction. X 3 dimensional contingency table, last dimension refers strata. UCBAdmissions serves example \\(2 \\times 2 \\times 6\\) table, Dept stratifying variable. results show evidence association admission gender adjusted department. However, can easily see assumption equal association across strata (3-way association) probably violated. \\(2 \\times 2 \\times k\\) tables, can examined odds ratios \\(2 \\times 2\\) table (oddsratio()), tested using woolf_test() vcd.","code":"# UC Berkeley Student Admissions mantelhaen.test(UCBAdmissions) ##  ##  Mantel-Haenszel chi-squared test with continuity correction ##  ## data:  UCBAdmissions ## Mantel-Haenszel X-squared = 1.4269, df = 1, p-value = 0.2323 ## alternative hypothesis: true common odds ratio is not equal to 1 ## 95 percent confidence interval: ##  0.7719074 1.0603298 ## sample estimates: ## common odds ratio  ##         0.9046968 oddsratio(UCBAdmissions, log=FALSE) ##  odds ratios for Admit and Gender by Dept  ##  ##         A         B         C         D         E         F  ## 0.3492120 0.8025007 1.1330596 0.9212838 1.2216312 0.8278727  lor <- oddsratio(UCBAdmissions)  # capture log odds ratios summary(lor) ##  ## z test of coefficients: ##  ##    Estimate Std. Error z value  Pr(>|z|)     ## A -1.052076   0.262708 -4.0047 6.209e-05 *** ## B -0.220023   0.437593 -0.5028    0.6151     ## C  0.124922   0.143942  0.8679    0.3855     ## D -0.081987   0.150208 -0.5458    0.5852     ## E  0.200187   0.200243  0.9997    0.3174     ## F -0.188896   0.305164 -0.6190    0.5359     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  woolf_test(UCBAdmissions)  ##  ##  Woolf-test on Homogeneity of Odds Ratios (no 3-Way assoc.) ##  ## data:  UCBAdmissions ## X-squared = 17.902, df = 5, p-value = 0.003072"},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"fourfold-displays","dir":"Articles","previous_headings":"Some plot methods","what":"Fourfold displays","title":"Tests of Independence","text":"can visualize odds ratios Admission department fourfold displays using fourfold(). cell frequencies \\(n_{ij}\\) \\(2 \\times 2\\) table shown quarter circle whose radius proportional \\(\\sqrt{n_{ij}}\\), area proportional cell frequency. Confidence rings odds ratio allow visual test null association; rings adjacent quadrants overlap iff observed counts consistent null hypothesis. extended version (default), brighter colors used odds ratio significantly different 1. following lines produce . Fourfold display UCBAdmissions data. odds ratio differs significantly 1.0, confidence bands overlap, circle quadrants shaded intensely. Another vcd function, cotabplot(), provides general approach visualizing conditional associations contingency tables, similar trellis-like plots produced coplot() lattice graphics. panel argument supplies function used render conditional subtable. following gives display (shown) similar .","code":"UCB <- aperm(UCBAdmissions, c(2, 1, 3)) dimnames(UCB)[[2]] <- c(\"Yes\", \"No\") names(dimnames(UCB)) <- c(\"Sex\", \"Admit?\", \"Department\") col <- c(\"#99CCFF\", \"#6699CC\", \"#F9AFAF\", \"#6666A0\", \"#FF0000\", \"#000080\") fourfold(UCB, mfrow=c(2,3), color=col) cotabplot(UCB, panel = cotab_fourfold)"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"doubledecker-plots","dir":"Articles","previous_headings":"Some plot methods","what":"Doubledecker plots","title":"Tests of Independence","text":"want view conditional probabilities response variable (e.g., Admit) relation several factors, alternative visualization doubledecker() plot. plot specialized version mosaic plot, highlights levels response variable (plotted vertically) relation factors (shown horizontally). following call produces , use indexing first factor (Admit) make Admitted highlighted level. plot, association Admit Gender shown heights highlighted conditional probabilities align. excess females admitted Dept stands . Doubledecker display UCBAdmissions data. heights highlighted bars show conditional probabilities Admit, given Dept Gender.","code":"doubledecker(Admit ~ Dept + Gender, data=UCBAdmissions[2:1,,])"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"odds-ratio-plots","dir":"Articles","previous_headings":"Some plot methods","what":"Odds ratio plots","title":"Tests of Independence","text":"Finally, plot() method oddsratio objects. default, shows 95% confidence interval log odds ratio.  produced : Log odds ratio plot UCBAdmissions data. {#fig:oddsratio}","code":"plot(lor,       xlab=\"Department\",       ylab=\"Log Odds Ratio (Admit | Gender)\")"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"sec:CMH","dir":"Articles","previous_headings":"","what":"Cochran-Mantel-Haenszel tests for ordinal factors","title":"Tests of Independence","text":"standard \\(\\chi^2\\) tests association two-way table treat table factors nominal (unordered) categories. one factors two-way table quantitative ordinal, powerful tests association may obtaianed taking ordinality account, using row column scores test linear trends differences row column means. general versions CMH tests (Landis etal., 1978) (Landis, Heyman, Koch 1978) provided assigning numeric scores row /column variables. example, two ordinal factors (assumed equally spaced), assigning integer scores, 1:R 1:C tests linear \\(\\times\\) linear component association. statistically equivalent Pearson correlation integer-scored table variables, \\(\\chi^2 = (n-1) r^2\\), 1 \\(df\\) rather \\((R-1)\\times(C-1)\\) test general association. one table variable ordinal, general CMH tests analogous ANOVA, testing whether row mean scores column mean scores equal, consuming fewer \\(df\\) test general association. CMHtest() function vcdExtra calculates various CMH tests two possibly ordered factors, optionally stratified factor(s). Example: Recall \\(4 \\times 4\\) table, JobSat introduced @(sec:creating), Treating satisfaction levels equally spaced, using midpoints income categories row scores gives following results: Note relatively small cell frequencies, test general give evidence association. However, cor test linear x linear association 1 df nearly significant. coin package contains functions cmh_test() lbl_test() CMH tests general association linear x linear association respectively.","code":"JobSat ##         satisfaction ## income   VeryD LittleD ModerateS VeryS ##   < 15k      1       3        10     6 ##   15-25k     2       3        10     7 ##   25-40k     1       6        14    12 ##   > 40k      0       1         9    11 CMHtest(JobSat, rscores=c(7.5,20,32.5,60)) ## Cochran-Mantel-Haenszel Statistics for income by satisfaction  ##  ##                  AltHypothesis  Chisq Df     Prob ## cor        Nonzero correlation 3.8075  1 0.051025 ## rmeans  Row mean scores differ 4.4774  3 0.214318 ## cmeans  Col mean scores differ 3.8404  3 0.279218 ## general    General association 5.9034  9 0.749549"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"measures-of-association","dir":"Articles","previous_headings":"","what":"Measures of Association","title":"Tests of Independence","text":"variety statistical measures strength association contingency tables— similar spirit \\(r\\) \\(r^2\\) continuous variables. large sample size, even small degree association can show significant \\(\\chi^2\\), example GSS data. assocstats() function vcd calculates \\(\\phi\\) contingency coefficient, Cramer’s V \\(r \\times c\\) table. input must table form, two-way \\(r \\times c\\) table. won’t work GSS frequency form, now know convert. tables ordinal variables, like JobSat, people prefer Goodman-Kruskal \\(\\gamma\\) statistic (Agresti 2002, 2.4.3) based comparison concordant discordant pairs observations case-form equivalent two-way table. web article Richard Darlington, [http://node101.psych.cornell.edu/Darlington/crosstab/TABLE0.HTM] gives description measures association.","code":"assocstats(GSStab) ##                     X^2 df P(> X^2) ## Likelihood Ratio 7.0026  2 0.030158 ## Pearson          7.0095  2 0.030054 ##  ## Phi-Coefficient   : NA  ## Contingency Coeff.: 0.084  ## Cramer's V        : 0.085 GKgamma(JobSat) ## gamma        : 0.221  ## std. error   : 0.117  ## CI           : -0.009 0.451"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"measures-of-agreement","dir":"Articles","previous_headings":"","what":"Measures of Agreement","title":"Tests of Independence","text":"Kappa() function vcd package calculates Cohen’s \\(\\kappa\\) weighted \\(\\kappa\\) square two-way table row column categories (Cohen 1960).  Normal-theory \\(z\\)-tests obtained dividing \\(\\kappa\\) asymptotic standard error (ASE). confint() method Kappa objects provides confidence intervals. visualization agreement (Bangdiwala 1987), unweighted weighted degree departure exact agreement provided agreementplot() function.  shows agreementplot SexualFun data, produced shown . Bangdiwala measures (returned function) represent proportion shaded areas diagonal rectangles, using weights \\(w_1\\) exact agreement, \\(w_2\\) partial agreement one step main diagonal. Agreement plot SexualFun data. examples, agreement plot can help show sources disagreement. example, shaded boxes diagonal (red) line, lack exact agreement can attributed part different frequency use categories two raters– lack marginal homogeneity.","code":"data(SexualFun, package = \"vcd\") (K <- Kappa(SexualFun)) ##             value     ASE     z Pr(>|z|) ## Unweighted 0.1293 0.06860 1.885 0.059387 ## Weighted   0.2374 0.07832 3.031 0.002437 confint(K) ##              ## Kappa                 lwr       upr ##   Unweighted -0.005120399 0.2637809 ##   Weighted    0.083883432 0.3908778 agree <- agreementplot(SexualFun, main=\"Is sex fun?\") unlist(agree) ##          Bangdiwala Bangdiwala_Weighted            weights1            weights2  ##           0.1464624           0.4981723           1.0000000           0.8888889"},{"path":"http://friendly.github.io/vcdExtra/articles/B_tests.html","id":"correspondence-analysis","dir":"Articles","previous_headings":"","what":"Correspondence analysis","title":"Tests of Independence","text":"Correspondence analysis technique visually exploring relationships rows columns contingency tables. ca package gives one implmentation. \\(r \\times c\\) table, method provides breakdown Pearson \\(\\chi^2\\) association \\(M = \\min(r-1, c-1)\\) dimensions, finds scores row (\\(x_{im}\\)) column (\\(y_{jm}\\)) categories observations maximum possible correlations.%1 , carry simple correspondence analysis HairEye data. printed results show nearly 99% association hair color eye color can accounted 2 dimensions, first dimension accounts 90%. resulting ca object can plotted just running plot() method ca object, giving result . plot.ca() allow labels dimensions; can added title(). can seen association accounted ordering hair color eye color along Dimension 1, dark light dimension. Correspondence analysis plot HairEye data","code":"library(ca) ca(HairEye) ##  ##  Principal inertias (eigenvalues): ##            1        2        3        ## Value      0.208773 0.022227 0.002598 ## Percentage 89.37%   9.52%    1.11%    ##  ##  ##  Rows: ##             Black     Brown       Red    Blond ## Mass     0.182432  0.483108  0.119932 0.214527 ## ChiDist  0.551192  0.159461  0.354770 0.838397 ## Inertia  0.055425  0.012284  0.015095 0.150793 ## Dim. 1  -1.104277 -0.324463 -0.283473 1.828229 ## Dim. 2   1.440917 -0.219111 -2.144015 0.466706 ##  ##  ##  Columns: ##             Brown     Blue     Hazel     Green ## Mass     0.371622 0.363176  0.157095  0.108108 ## ChiDist  0.500487 0.553684  0.288654  0.385727 ## Inertia  0.093086 0.111337  0.013089  0.016085 ## Dim. 1  -1.077128 1.198061 -0.465286  0.354011 ## Dim. 2   0.592420 0.556419 -1.122783 -2.274122 plot(ca(HairEye), main=\"Hair Color and Eye Color\")"},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/articles/C_loglinear.html","id":"sec:loglm","dir":"Articles","previous_headings":"","what":"Fitting with loglm()","title":"Loglinear Models","text":"example, can fit model mutual independence among hair color, eye color sex HairEyeColor Similarly, models conditional independence joint independence specified Note printing model gives brief summary goodness fit. set models can compared using anova() function.","code":"library(MASS) ## Independence model of hair and eye color and sex.   hec.1 <- loglm(~Hair+Eye+Sex, data=HairEyeColor) hec.1 ## Call: ## loglm(formula = ~Hair + Eye + Sex, data = HairEyeColor) ##  ## Statistics: ##                       X^2 df P(> X^2) ## Likelihood Ratio 166.3001 24        0 ## Pearson          164.9247 24        0 ## Conditional independence hec.2 <- loglm(~(Hair + Eye) * Sex, data=HairEyeColor) hec.2 ## Call: ## loglm(formula = ~(Hair + Eye) * Sex, data = HairEyeColor) ##  ## Statistics: ##                       X^2 df P(> X^2) ## Likelihood Ratio 156.6779 18        0 ## Pearson          147.9440 18        0 ## Joint independence model.   hec.3 <- loglm(~Hair*Eye + Sex, data=HairEyeColor) hec.3 ## Call: ## loglm(formula = ~Hair * Eye + Sex, data = HairEyeColor) ##  ## Statistics: ##                       X^2 df  P(> X^2) ## Likelihood Ratio 19.85656 15 0.1775045 ## Pearson          19.56712 15 0.1891745 anova(hec.1, hec.2, hec.3) ## LR tests for hierarchical log-linear models ##  ## Model 1: ##  ~Hair + Eye + Sex  ## Model 2: ##  ~(Hair + Eye) * Sex  ## Model 3: ##  ~Hair * Eye + Sex  ##  ##            Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) ## Model 1   166.30014 24                                     ## Model 2   156.67789 18    9.62225         6        0.14149 ## Model 3    19.85656 15  136.82133         3        0.00000 ## Saturated   0.00000  0   19.85656        15        0.17750"},{"path":"http://friendly.github.io/vcdExtra/articles/C_loglinear.html","id":"sec:glm","dir":"Articles","previous_headings":"","what":"Fitting with glm() and gnm()","title":"Loglinear Models","text":"glm() approach, extensions gnm package allows much wider class models frequency data fit can handled loglm(). particular importance models ordinal factors square tables, can test structured hypotheses patterns association provided tests general association loglm(). similar spirit non-parametric CMH tests described . Example: data Mental vcdExtra package gives two-way table frequency form classifying young people mental health status parents’ socioeconomic status (SES), variables ordered factors. Simple ways handling ordinal variables involve assigning scores table categories, simplest cases use integer scores, either row variable (column effects'' model), column variable (row effects’’ model), (``uniform association’’ model). fit parsimonious models general association, can define numeric scores row column categories , row effects model, column effects model, uniform association model can fit follows: LRstats() function vcdExtra provides nice, compact summary fit statistics set models, collected glmlist object. Smaller better AIC BIC. specific model comparisons, can also carry tests nested models anova() models listed smallest largest. , two separate paths restrictive (independence) model model uniform association, allow one row effects column effects. model linear linear association seems best accounts. comparison, one might try CMH tests data:","code":"str(Mental) ## 'data.frame':    24 obs. of  3 variables: ##  $ ses   : Ord.factor w/ 6 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 1 1 1 1 2 2 2 2 3 3 ... ##  $ mental: Ord.factor w/ 4 levels \"Well\"<\"Mild\"<..: 1 2 3 4 1 2 3 4 1 2 ... ##  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ... xtabs(Freq ~ mental+ses, data=Mental)   # display the frequency table ##           ses ## mental       1   2   3   4   5   6 ##   Well      64  57  57  72  36  21 ##   Mild      94  94 105 141  97  71 ##   Moderate  58  54  65  77  54  54 ##   Impaired  46  40  60  94  78  71 indep <- glm(Freq ~ mental + ses, family = poisson, data = Mental)  # independence model # Use integer scores for rows/cols  Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental) # column effects model (ses) coleff <- glm(Freq ~ mental + ses + Rscore:ses, family = poisson, data = Mental)  # row effects model (mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore, family = poisson, data = Mental)  # linear x linear association linlin <- glm(Freq ~ mental + ses + Rscore:Cscore, family = poisson, data = Mental) # compare models using AIC, BIC, etc vcdExtra::LRstats(glmlist(indep, roweff, coleff, linlin)) ## Likelihood summary table: ##           AIC    BIC LR Chisq Df Pr(>Chisq)     ## indep  209.59 220.19   47.418 15  3.155e-05 *** ## roweff 174.45 188.59    6.281 12     0.9013     ## coleff 179.00 195.50    6.829 10     0.7415     ## linlin 174.07 185.85    9.895 14     0.7698     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(indep, linlin, coleff, test=\"Chisq\")   ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Rscore:Cscore ## Model 3: Freq ~ mental + ses + Rscore:ses ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        15     47.418                           ## 2        14      9.895  1   37.523 9.035e-10 *** ## 3        10      6.829  4    3.066    0.5469     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(indep, linlin, roweff, test=\"Chisq\")   ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Rscore:Cscore ## Model 3: Freq ~ mental + ses + mental:Cscore ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        15     47.418                           ## 2        14      9.895  1   37.523 9.035e-10 *** ## 3        12      6.281  2    3.614    0.1641     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 CMHtest(xtabs(Freq~ses+mental, data=Mental)) ## Cochran-Mantel-Haenszel Statistics for ses by mental  ##  ##                  AltHypothesis  Chisq Df       Prob ## cor        Nonzero correlation 37.156  1 1.0907e-09 ## rmeans  Row mean scores differ 40.297  5 1.3012e-07 ## cmeans  Col mean scores differ 40.666  3 7.6971e-09 ## general    General association 45.958 15 5.4003e-05"},{"path":"http://friendly.github.io/vcdExtra/articles/C_loglinear.html","id":"non-linear-terms","dir":"Articles","previous_headings":"","what":"Non-linear terms","title":"Loglinear Models","text":"strength gnm package handles wide variety models handle non-linear terms, parameters enter model beyond simple linear function. simplest example Goodman RC(1) model (Goodman, 1979), allows multiplicative term account association table variables. notation generalized linear models log link, can expressed \\[ \\log \\mu_{ij} = \\alpha_i + \\beta_j + \\gamma_{} \\delta_{j}   ,\\] row-multiplicative effect parameters \\(\\gamma_i\\) corresponding column parameters \\(\\delta_j\\) estimated data.%2 Similarly, RC(2) model adds two multiplicative terms independence model, \\[ \\log \\mu_{ij} = \\alpha_i + \\beta_j + \\gamma_{i1} \\delta_{j1} + \\gamma_{i2} \\delta_{j2} . \\] gnm package, models may fit using Mult() specify multiplicative term, instances() specify several terms. Example: Mental data, fit RC(1) RC(2) models, compare independence model.","code":"RC1 <- gnm(Freq ~ mental + ses + Mult(mental,ses), data=Mental,               family=poisson, verbose=FALSE) RC2 <- gnm(Freq ~ mental+ses + instances(Mult(mental,ses),2), data=Mental,               family=poisson, verbose=FALSE) anova(indep, RC1, RC2, test=\"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Mult(mental, ses) ## Model 3: Freq ~ mental + ses + Mult(mental, ses, inst = 1) + Mult(mental,  ##     ses, inst = 2) ##   Resid. Df Resid. Dev Df Deviance Pr(>Chi)     ## 1        15     47.418                          ## 2         9     40.230  6    7.188   0.3038     ## 3         3      0.523  6   39.707  5.2e-07 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/articles/E_continuous.html","id":"sec:spine","dir":"Articles","previous_headings":"","what":"Spine and conditional density plots","title":"Continuous predictors","text":"don’t go fitting models , remiss illustrate visualizations vcd helpful . first spine plot spinogram (Hummel, 1996), produced spine(). special cases mosaic plots specific spacing shading show categorical response varies continuous categorical predictor. also generalization stacked bar plots heights widths bars corresponds relative frequencies x. heights bars correspond conditional relative frequencies y every x group. Example: Arthritis data, can see Improved varies Age follows. spine() takes formula form y ~ x single dependent factor single explanatory variable x (numeric variable factor). range numeric variablex divided intervals based breaks argument, stacked bars drawn show distribution y x varies. shown , discrete table visualized returned function. Spine plots Arthritis data conditional density plot (Hofmann & Theus, 2005) generalization. visualization technique similar spinograms, uses smoothing approach rather discretizing explanatory variable. well, uses original x axis distorted one. Conditional density plot Arthritis data showing variation Improved Age. plots, useful also see distribution observations across horizontal axis, e.g., rug() plot. @ref{fig:cd-plot} uses cdplot() graphics package rather cd_plot() vcd, produced  figure can easily seen proportion patients reporting Marked improvement increases Age, peculiar bumps distribution. may real artifactual, hard see visualization methods. switch non-parametric data exploration parametric statistical models, effects easily missed.","code":"(spine(Improved ~ Age, data = Arthritis, breaks = 3)) ##          Improved ## Age       None Some Marked ##   [20,40]   10    3      2 ##   (40,60]   21    3     17 ##   (60,80]   11    8      9 (spine(Improved ~ Age, data = Arthritis, breaks = \"Scott\")) ##          Improved ## Age       None Some Marked ##   [20,30]    6    1      0 ##   (30,40]    4    2      2 ##   (40,50]    9    0      3 ##   (50,60]   12    3     14 ##   (60,70]   11    8      8 ##   (70,80]    0    0      1 cdplot(Improved ~ Age, data = Arthritis) cdplot(Improved ~ Age, data = Arthritis) with(Arthritis, rug(jitter(Age), col=\"white\", quiet=TRUE))"},{"path":"http://friendly.github.io/vcdExtra/articles/E_continuous.html","id":"sec:modelplots","dir":"Articles","previous_headings":"","what":"Model-based plots: effect plots and ggplot2 plots","title":"Continuous predictors","text":"nonparametric conditional density plot uses smoothing methods convey distributions response variable, displays simpler interpret can often obtained plotting predicted response parametric model. complex glm() models interaction effects, effects package provides useful displays, plotting predicted values given term, averaging predictors included term. don’t illustrate , see Fox & Weisberg (2018),Fox (2003) help(package=\"effects\"). just briefly illustrate capabilities ggplot2 package model-smoothed plots categorical responses glm() models. Example: Donner data frame vcdExtra gives details survival 90 members Donner party, group people attempted migrate California 1846. trapped early blizzard eastern side Sierra Nevada mountains, rescued, nearly half party died. factors affected lived died? potential model interest logistic regression model \\(Pr(survived)\\), allowing separate fits males females function age. key stat_smooth() function, using method = \"glm\", method.args = list(family = binomial). formula = y ~ x specifies linear fit logit scale (@ref{fig:donner3}, left) Alternatively, can allow quadratic relation age specifying formula = y ~ poly(x,2) (, right). Logistic regression plots Donner data showing survival vs. age, sex. Left: linear logistic model; right: quadratic model {#fig:donner3} plots nicely show () fitted \\(Pr(survived)\\) males females; (b) confidence bands around smoothed model fits (c) individual observations jittered points 0 1 died survived, respectively.","code":"data(Donner, package=\"vcdExtra\") str(Donner) ## 'data.frame':    90 obs. of  5 variables: ##  $ family  : Factor w/ 10 levels \"Breen\",\"Donner\",..: 9 1 1 1 1 1 1 1 1 1 ... ##  $ age     : int  23 13 1 5 14 40 51 9 3 8 ... ##  $ sex     : Factor w/ 2 levels \"Female\",\"Male\": 2 2 1 2 2 1 2 2 2 2 ... ##  $ survived: int  0 1 1 1 1 1 1 1 1 1 ... ##  $ death   : POSIXct, format: \"1846-12-29\" NA ... # separate linear fits on age for M/F ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\",                method.args = list(family = binomial),                formula = y ~ x,               alpha = 0.2, size=2, aes(fill = sex)) # separate quadratics ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\",                method.args = list(family = binomial),                formula = y ~ poly(x,2),                alpha = 0.2, size=2, aes(fill = sex))"},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Friendly. Author, maintainer. Heather Turner. Contributor. Achim Zeileis. Contributor. Duncan Murdoch. Contributor. David Firth. Contributor. Matt Kumar. Contributor. Shuguang Sun. Contributor.","code":""},{"path":"http://friendly.github.io/vcdExtra/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Friendly M (2022). vcdExtra: 'vcd' Extensions Additions. R package version 0.8-0, https://friendly.github.io/vcdExtra/.","code":"@Manual{,   title = {vcdExtra: 'vcd' Extensions and Additions},   author = {Michael Friendly},   year = {2022},   note = {R package version 0.8-0},   url = {https://friendly.github.io/vcdExtra/}, }"},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/index.html","id":"extensions-and-additions-to-vcd-visualizing-categorical-data","dir":"","previous_headings":"","what":"Extensions and additions to vcd: Visualizing Categorical Data","title":"vcd Extensions and Additions","text":"Version 0.8-0 package provides additional data sets, documentation, functions designed extend vcd package Visualizing Categorical Data gnm package Generalized Nonlinear Models. particular, vcdExtra extends mosaic, assoc sieve plots vcd handle glm() gnm() models adds 3D version mosaic3d(). vcdExtra now support package book Discrete Data Analysis R (DDAR) Michael Friendly David Meyer. also web site DDAR figures code samples book.","code":""},{"path":"http://friendly.github.io/vcdExtra/index.html","id":"details","dir":"","previous_headings":"Extensions and additions to vcd: Visualizing Categorical Data","what":"Details","title":"vcd Extensions and Additions","text":"main purpose package serve sandbox introducing extensions mosaic plots related graphical methods apply loglinear models fitted using glm() related, generalized nonlinear models fitted gnm() gnm package. related purpose fill holes analysis categorical data R, provided base R, vcd, commonly used packages. method mosaic.glm() extends mosaic.loglm() method vcd package wider class models. method also works generalized nonlinear models fit gnm package, including models square tables models multiplicative associations. mosaic3d() introduces 3D generalization mosaic displays using rgl package. new class, glmlist, introduced working collections glm objects, e.g., Kway() fitting K-way models basic marginal model, LRstats() brief statistical summaries goodness--fit collection models. square tables ordered factors, Crossings() supplements specification terms model formulas using Symm(), Diag(), Topo(), etc. gnm package. addition, many new data sets; use datasets(\"vcdExtra\") see list; tutorial vignette. installed package, can viewed using vignette(\"vcd-tutorial\", package = \"vcdExtra\"); useful utility functions manipulating categorical data sets working models categorical data.","code":""},{"path":"http://friendly.github.io/vcdExtra/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"vcd Extensions and Additions","text":"Get released version CRAN: development version can installed R library directly GitHub repo via:","code":"install.packages(\"vcdExtra\") if (!require(remotes)) install.packages(\"remotes\")  remotes::install_github(\"friendly/vcdExtra\", build_vignettes = TRUE)"},{"path":"http://friendly.github.io/vcdExtra/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"vcd Extensions and Additions","text":"dataset Mental data frame frequency table representing cross-classification mental health status (mental) 1660 young New York residents parents’ socioeconomic status (ses). ordered factors. examples illustrate fitting loglinear models using glm() models structured associations taking ordinality account.","code":"data(Mental) str(Mental) ## 'data.frame':    24 obs. of  3 variables: ##  $ ses   : Ord.factor w/ 6 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 1 1 1 1 2 2 2 2 3 3 ... ##  $ mental: Ord.factor w/ 4 levels \"Well\"<\"Mild\"<..: 1 2 3 4 1 2 3 4 1 2 ... ##  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ...  # show as frequency table (Mental.tab <- xtabs(Freq ~ ses+mental, data=Mental)) ##    mental ## ses Well Mild Moderate Impaired ##   1   64   94       58       46 ##   2   57   94       54       40 ##   3   57  105       65       60 ##   4   72  141       77       94 ##   5   36   97       54       78 ##   6   21   71       54       71"},{"path":"http://friendly.github.io/vcdExtra/index.html","id":"independence-model","dir":"","previous_headings":"Examples","what":"Independence model","title":"vcd Extensions and Additions","text":"Fit independence model, Freq ~ mental+ses. take ordinality account. mosaic.glm() mosaic method glm objects. default mosaic display data:  usually better use standardized residuals mosaic displays. also add longer labels table factors display values residuals cells. formula, ~ ses + mental gives order factors mosaic display, statistical model independence. , unit square first split ses, mental within level ses.  opposite-corner pattern residuals clearly shows association Parent SES mental health depends ordered levels factors.","code":"indep <- glm(Freq ~ mental+ses,              family = poisson, data = Mental) LRstats(indep) ## Likelihood summary table: ##          AIC    BIC LR Chisq Df Pr(>Chisq)     ## indep 209.59 220.19   47.418 15  3.155e-05 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(indep) # labels for table factors long.labels <- list(set_varnames = c(mental=\"Mental Health Status\",                                       ses=\"Parent SES\"))  mosaic(indep, ~ ses + mental,        residuals_type=\"rstandard\",        labeling_args = long.labels,         labeling=labeling_residuals)"},{"path":"http://friendly.github.io/vcdExtra/index.html","id":"ordinal-models","dir":"","previous_headings":"Examples","what":"Ordinal models","title":"vcd Extensions and Additions","text":"Ordinal models use numeric scores row /column variables. simplest models use equally spaced integer scores. Using , term Rscore:Cscore represents association constrained linear x linear; , slopes mental health status assumed vary linearly Parent SES.  Note test linear x linear association consumes 1 degree freedom, compared (r-1)*(c-1) = 15 degrees freedom general association. models possible independence model, Freq ~ mental + ses, saturated model Freq ~ mental + ses + mental:ses. update.glm() method make easy specify, addition terms independence model. Compare models: glm objects, print summary methods give much information one wants see brief summary model goodness fit, easy way display compact comparison model goodness fit collection models fit data. LRstats() provides brief summary one models fit dataset. likelihood ratio  values (LR Chisq)test lack fit. tests, none ordinal models show significant lack fit. AIC BIC statistics, linlin model best, combining parsimony goodness fit. anova.glm() function gives tests nested models.","code":"# fit linear x linear (uniform) association.  Use integer scores for rows/cols  Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,               family = poisson, data = Mental) mosaic(linlin, ~ ses + mental,        residuals_type=\"rstandard\",         labeling_args = long.labels,         labeling=labeling_residuals,         suppress=1,         gp=shading_Friendly,        main=\"Lin x Lin model\") anova(linlin, test=\"Chisq\") ## Analysis of Deviance Table ##  ## Model: poisson, link: log ##  ## Response: Freq ##  ## Terms added sequentially (first to last) ##  ##  ##               Df Deviance Resid. Df Resid. Dev  Pr(>Chi)     ## NULL                             23    217.400               ## mental         3  113.525        20    103.875 < 2.2e-16 *** ## ses            5   56.457        15     47.418 6.543e-11 *** ## Rscore:Cscore  1   37.523        14      9.895 9.035e-10 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 # use update.glm method to fit other models  linlin <- update(indep, . ~ . + Rscore:Cscore) roweff <- update(indep, . ~ . + mental:Cscore) coleff <- update(indep, . ~ . + Rscore:ses) rowcol <- update(indep, . ~ . + Rscore:ses + mental:Cscore) LRstats(indep, linlin, roweff, coleff, rowcol) ## Likelihood summary table: ##           AIC    BIC LR Chisq Df Pr(>Chisq)     ## indep  209.59 220.19   47.418 15  3.155e-05 *** ## linlin 174.07 185.85    9.895 14     0.7698     ## roweff 174.45 188.59    6.281 12     0.9013     ## coleff 179.00 195.50    6.829 10     0.7415     ## rowcol 179.22 198.07    3.045  8     0.9315     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(indep, linlin, roweff, test = \"Chisq\") ## Analysis of Deviance Table ##  ## Model 1: Freq ~ mental + ses ## Model 2: Freq ~ mental + ses + Rscore:Cscore ## Model 3: Freq ~ mental + ses + mental:Cscore ##   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     ## 1        15     47.418                           ## 2        14      9.895  1   37.523 9.035e-10 *** ## 3        12      6.281  2    3.614    0.1641     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://friendly.github.io/vcdExtra/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"vcd Extensions and Additions","text":"Friendly, M. & Meyer, D. (2016). Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data. Boca Raton, FL: Chapman & Hall/CRC.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Abortion.html","id":null,"dir":"Reference","previous_headings":"","what":"Abortion Opinion Data — Abortion","title":"Abortion Opinion Data — Abortion","text":"Opinions abortion classified gender SES","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Abortion.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Abortion Opinion Data — Abortion","text":"","code":"data(Abortion)"},{"path":"http://friendly.github.io/vcdExtra/reference/Abortion.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Abortion Opinion Data — Abortion","text":"    3-dimensional array resulting cross-tabulating    3 variables  1100 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Abortion.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Abortion Opinion Data — Abortion","text":"combinations Sex Status represent four independent samples, fixed Sex-Status marginal totals.  Thus Sex:Status association must included loglinear model. Support_Abortion natural response variable.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Abortion.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Abortion Opinion Data — Abortion","text":"Christensen, R. (1990).  Log-Linear Models,  New York, NY: Springer-Verlag, p. 92, Example 3.5.2. Christensen, R. (1997).  Log-Linear Models Logistic Regression,    New York, NY: Springer, p. 100, Example 3.5.2.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Abortion.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Abortion Opinion Data — Abortion","text":"","code":"data(Abortion)  # example goes here ftable(Abortion) #>               Support_Abortion Yes  No #> Sex    Status                          #> Female Lo                      171  79 #>        Hi                      138 112 #> Male   Lo                      152 148 #>        Hi                      167 133 mosaic(Abortion, shade=TRUE)   # stratified by Sex fourfold(aperm(Abortion, 3:1))  # stratified by Status fourfold(aperm(Abortion, c(3,1,2)))"},{"path":"http://friendly.github.io/vcdExtra/reference/Accident.html","id":null,"dir":"Reference","previous_headings":"","what":"Traffic Accident Victims in France in 1958 — Accident","title":"Traffic Accident Victims in France in 1958 — Accident","text":"Bertin (1983) used data illustrate cross-classification  data numerous variables, various types assigned various visual attributes. modeling visualization purposes, data can treated 4-way table using loglinear models mosaic displays,  frequency-weighted data frame using binomial response result (\"Died\" vs. \"Injured\") plots predicted probabilities.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Accident.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Traffic Accident Victims in France in 1958 — Accident","text":"","code":"data(Accident)"},{"path":"http://friendly.github.io/vcdExtra/reference/Accident.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Traffic Accident Victims in France in 1958 — Accident","text":"data frame frequency form (comprising 5 x 2 x 4 x 2 table)    80 observations following 5 variables. age ordered factor levels 0-9 < 10-19 < 20-29 < 30-49 < 50+ result factor levels Died Injured mode mode transportation,       factor levels 4-Wheeled Bicycle Motorcycle Pedestrian gender factor levels Female Male Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Accident.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Traffic Accident Victims in France in 1958 — Accident","text":"age ordered factor, arguably, mode treated ordered, levels Pedestrian < Bicycle < Motorcycle < 4-Wheeled  Bertin .  affects parameterization models, directly data frame.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Accident.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Traffic Accident Victims in France in 1958 — Accident","text":"Bertin (1983), p. 30; original data Ministere des Travaux Publics","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Accident.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Traffic Accident Victims in France in 1958 — Accident","text":"Bertin, J. (1983),  Semiology Graphics, University Wisconsin Press.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Accident.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Traffic Accident Victims in France in 1958 — Accident","text":"","code":"# examples data(Accident) head(Accident) #>   age result       mode gender Freq #> 1 50+   Died Pedestrian   Male  704 #> 2 50+   Died Pedestrian Female  378 #> 3 50+   Died    Bicycle   Male  396 #> 4 50+   Died    Bicycle Female   56 #> 5 50+   Died Motorcycle   Male  742 #> 6 50+   Died Motorcycle Female   78  # for graphs, reorder mode Accident$mode <- ordered(Accident$mode,    levels=levels(Accident$mode)[c(4,2,3,1)])  # Bertin's table accident_tab <- xtabs(Freq ~ gender+mode+age+result, data=Accident) structable(mode+gender ~ age+result, data=accident_tab) #>               mode   Pedestrian       Bicycle       Motorcycle       4-Wheeled       #>               gender     Female  Male  Female  Male     Female  Male    Female  Male #> age   result                                                                         #> 0-9   Died                   89   150       5    26          6     6        65    70 #>       Injured              1967  3341     126   378        131   181      1362  1593 #> 10-19 Died                   28    70      31    76         54   362        61   150 #>       Injured              1495  1827    7218  3407       3587 12311      2593  3543 #> 20-29 Died                   24    78      10    55         82   660       107   353 #>       Injured               864  1521     609  1565       4010 18558      4361  9084 #> 30-49 Died                   49   223      24   146         98   889       199   720 #>       Injured              1814  3178    1118  3024       3664 18909      7712 15086 #> 50+   Died                  378   704      56   396         78   742       253   513 #>       Injured              5449  5206    1030  3863       1387  8597      5552  7423  ## Loglinear models ## ----------------  # mutual independence acc.mod0 <- glm(Freq ~ age+result+mode+gender, data=Accident, family=poisson) LRstats(acc.mod0) #> Likelihood summary table: #>            AIC   BIC LR Chisq Df Pr(>Chisq)     #> acc.mod0 60983 61007    60320 70  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(acc.mod0, ~mode+age+gender+result)   # result as a response acc.mod1 <- glm(Freq ~ age*mode*gender + result, data=Accident, family=poisson) LRstats(acc.mod1) #> Likelihood summary table: #>             AIC    BIC LR Chisq Df Pr(>Chisq)     #> acc.mod1 2942.4 3040.1   2217.7 39  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(acc.mod1, ~mode+age+gender+result,      labeling_args = list(abbreviate = c(gender=1, result=4)))   # allow two-way association of result with each explanatory variable acc.mod2 <- glm(Freq ~ age*mode*gender + result*(age+mode+gender), data=Accident, family=poisson) LRstats(acc.mod2) #> Likelihood summary table: #>             AIC    BIC LR Chisq Df Pr(>Chisq)     #> acc.mod2 968.13 1084.8   227.47 31  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(acc.mod2, ~mode+age+gender+result,      labeling_args = list(abbreviate = c(gender=1, result=4)))   acc.mods <- glmlist(acc.mod0, acc.mod1, acc.mod2) LRstats(acc.mods) #> Likelihood summary table: #>            AIC   BIC LR Chisq Df Pr(>Chisq)     #> acc.mod0 60983 61007    60320 70  < 2.2e-16 *** #> acc.mod1  2942  3040     2218 39  < 2.2e-16 *** #> acc.mod2   968  1085      227 31  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  ## Binomial (logistic regression) models for result ## ------------------------------------------------ library(car)  # for Anova() #> Loading required package: carData #>  #> Attaching package: 'carData' #> The following object is masked from 'package:vcdExtra': #>  #>     Burt acc.bin1 <- glm(result=='Died' ~ age+mode+gender,      weights=Freq, data=Accident, family=binomial) Anova(acc.bin1) #> Analysis of Deviance Table (Type II tests) #>  #> Response: result == \"Died\" #>        LR Chisq Df Pr(>Chisq)     #> age     1179.03  4  < 2.2e-16 *** #> mode     136.82  3  < 2.2e-16 *** #> gender   467.70  1  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 acc.bin2 <- glm(result=='Died' ~ (age+mode+gender)^2,      weights=Freq, data=Accident, family=binomial) Anova(acc.bin2) #> Analysis of Deviance Table (Type II tests) #>  #> Response: result == \"Died\" #>             LR Chisq Df Pr(>Chisq)     #> age          1100.82  4  < 2.2e-16 *** #> mode          136.07  3  < 2.2e-16 *** #> gender        418.88  1  < 2.2e-16 *** #> age:mode      122.24 12  < 2.2e-16 *** #> age:gender     46.86  4  1.631e-09 *** #> mode:gender    21.94  3  6.702e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 acc.bin3 <- glm(result=='Died' ~ (age+mode+gender)^3,      weights=Freq, data=Accident, family=binomial) Anova(acc.bin3) #> Analysis of Deviance Table (Type II tests) #>  #> Response: result == \"Died\" #>                 LR Chisq Df Pr(>Chisq)     #> age              1100.82  4  < 2.2e-16 *** #> mode              136.07  3  < 2.2e-16 *** #> gender            418.88  1  < 2.2e-16 *** #> age:mode          122.24 12  < 2.2e-16 *** #> age:gender         46.86  4  1.631e-09 *** #> mode:gender        21.94  3  6.702e-05 *** #> age:mode:gender    13.02 12     0.3675     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # compare models anova(acc.bin1, acc.bin2, acc.bin3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: result == \"Died\" ~ age + mode + gender #> Model 2: result == \"Died\" ~ (age + mode + gender)^2 #> Model 3: result == \"Died\" ~ (age + mode + gender)^3 #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi)     #> 1        71      64599                          #> 2        52      64384 19  214.445   <2e-16 *** #> 3        40      64371 12   13.022   0.3675     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # visualize probability of death with effect plots if (FALSE) { library(effects) plot(allEffects(acc.bin1), ylab='Pr (Died)')  plot(allEffects(acc.bin2), ylab='Pr (Died)') }   #"},{"path":"http://friendly.github.io/vcdExtra/reference/AirCrash.html","id":null,"dir":"Reference","previous_headings":"","what":"Air Crash Data — AirCrash","title":"Air Crash Data — AirCrash","text":"Data fatal commercial airplane crashes 1993--2015. Excludes small planes (less 6 passengers) non-commercial (cargo, military, private) aircraft.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Air Crash Data — AirCrash","text":"","code":"data(\"AirCrash\")"},{"path":"http://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Air Crash Data — AirCrash","text":"data frame 439 observations following 5 variables. Phase phase flight, factor levels en route landing standing take-unknown Cause factor levels criminal human error mechanical unknown weather date date crash, Date Fatalities number fatalities, numeric vector Year year, numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Air Crash Data — AirCrash","text":"Phase flight cleaned combining related variants, spelling, etc.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Air Crash Data — AirCrash","text":"Originally David McCandless, http://www.informationisbeautiful.net/visualizations/plane-truth-every-single-commercial-plane-crash-visualized/, data https://docs.google.com/spreadsheets/d/1OvDq4_BtbR6nSnnHnjD5hVC3HQ-ulZPGbo0RDGbzM3Q/edit?usp=drive_web, downloaded April 14, 2015.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Air Crash Data — AirCrash","text":"Rick Wicklin, http://blogs.sas.com/content/iml/2015/03/30/visualizing-airline-crashes.html","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/AirCrash.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Air Crash Data — AirCrash","text":"","code":"data(AirCrash) aircrash.tab <- xtabs(~Phase + Cause, data=AirCrash) mosaic(aircrash.tab, shade=TRUE)   # fix label overlap mosaic(aircrash.tab, shade=TRUE,         labeling_args=list(rot_labels=c(30, 30, 30, 30)))   # reorder by Phase phase.ord <- rev(c(3,4,1,2,5)) mosaic(aircrash.tab[phase.ord,], shade=TRUE,         labeling_args=list(rot_labels=c(30, 30, 30, 30)), offset_varnames=0.5)   # reorder by frequency phase.ord <- order(rowSums(aircrash.tab), decreasing=TRUE) cause.ord <- order(colSums(aircrash.tab), decreasing=TRUE) mosaic(aircrash.tab[phase.ord,cause.ord], shade=TRUE,         labeling_args=list(rot_labels=c(30, 30, 30, 30)))    library(ca) aircrash.ca <- ca(aircrash.tab) plot(aircrash.ca)"},{"path":"http://friendly.github.io/vcdExtra/reference/Alligator.html","id":null,"dir":"Reference","previous_headings":"","what":"Alligator Food Choice — Alligator","title":"Alligator Food Choice — Alligator","text":"Alligator data, Agresti (2002), comes study primary food choices alligators  four Florida lakes. Researchers classified stomach contents 219 captured alligators five categories:  Fish (common primary food choice), Invertebrate (snails, insects, crayfish, etc.),  Reptile (turtles, alligators), Bird, (amphibians, plants, household pets, stones, debris).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Alligator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alligator Food Choice — Alligator","text":"","code":"data(Alligator)"},{"path":"http://friendly.github.io/vcdExtra/reference/Alligator.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Alligator Food Choice — Alligator","text":"frequency data frame 80 observations following 5 variables. lake factor levels George Hancock Oklawaha Trafford sex factor levels female male size alligator size, factor levels large (>2.3m) small (<=2.3m) food primary food choice, factor levels bird fish invert reptile count cell frequency, numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Alligator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Alligator Food Choice — Alligator","text":"table contains fair number 0 counts. food response variable.  fish frequent choice, often taken baseline category multinomial response models.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Alligator.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Alligator Food Choice — Alligator","text":"Agresti, . (2002). Categorical Data Analysis, New York: Wiley, 2nd Ed., Table 7.1","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Alligator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Alligator Food Choice — Alligator","text":"","code":"data(Alligator)  # change from frequency data.frame to table allitable <- xtabs(count~lake+sex+size+food, data=Alligator) # Agresti's Table 7.1 structable(food~lake+sex+size, allitable) #>                       food bird fish invert other reptile #> lake     sex    size                                      #> George   female large         0    8      1     1       0 #>                 small         0    3      9     1       1 #>          male   large         1    9      0     2       0 #>                 small         2   13     10     2       0 #> Hancock  female large         2    3      0     3       1 #>                 small         2   16      3     3       2 #>          male   large         1    4      0     2       0 #>                 small         0    7      1     5       0 #> Oklawaha female large         1    0      1     0       0 #>                 small         0    3      9     2       1 #>          male   large         0   13      7     0       6 #>                 small         0    2      2     1       0 #> Trafford female large         0    0      1     0       0 #>                 small         1    2      4     4       1 #>          male   large         3    8      6     5       6 #>                 small         0    3      7     1       1   plot(allitable, shade=TRUE)  # mutual independence model mosaic(~food+lake+size, allitable, shade=TRUE)  # food jointly independent of lake and size mosaic(~food+lake+size, allitable, shade=TRUE, expected=~lake:size+food)   if (require(nnet)) {   # multinomial logit model   mod1 <- multinom(food ~ lake+size+sex, data=Alligator, weights=count) } #> Loading required package: nnet #> # weights:  35 (24 variable) #> initial  value 352.466903  #> iter  10 value 270.397070 #> iter  20 value 268.958046 #> final  value 268.932740  #> converged"},{"path":"http://friendly.github.io/vcdExtra/reference/Bartlett.html","id":null,"dir":"Reference","previous_headings":"","what":"Bartlett data on plum root cuttings — Bartlett","title":"Bartlett data on plum root cuttings — Bartlett","text":"experiment investigate effect cutting length (two levels) planting time (two levels)  survival plum root cuttings, 240 cuttings planted 2 x 2 combinations factors,  survival later recorded. Bartlett (1935) used data illustrate method testing three-way interaction contingency table.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bartlett data on plum root cuttings — Bartlett","text":"","code":"data(Bartlett)"},{"path":"http://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Bartlett data on plum root cuttings — Bartlett","text":"    3-dimensional array resulting cross-tabulating    3 variables   960 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Bartlett data on plum root cuttings — Bartlett","text":"Hand, D. Daly, F. Lunn, . D.McConway, K. J. Ostrowski, E. (1994). Handbook Small Data Sets.  London: Chapman & Hall, p. 15, # 19.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bartlett data on plum root cuttings — Bartlett","text":"Bartlett, M. S. (1935).  Contingency Table Interactions   Journal Royal Statistical Society, Supplement, 1935, 2, 248-252.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Bartlett.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bartlett data on plum root cuttings — Bartlett","text":"","code":"data(Bartlett)  fourfold(Bartlett, mfrow=c(1,2))   mosaic(Bartlett, shade=TRUE)  pairs(Bartlett, gp=shading_Friendly)"},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":null,"dir":"Reference","previous_headings":"","what":"Bivariate Logits and Log Odds Ratio — blogits","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"function calculates log odds log odds ratio two binary responses classified one stratifying variables. useful plotting results bivariate logistic regression models, fit using vglm VGAM.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"","code":"blogits(Y, add, colnames, row.vars, rev=FALSE)"},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"Y four-column matrix data frame whose columns correspond 2 x 2 combinations two binary responses. add Constant added cells allow zero frequencies.  default 0.5 (Y)==0 0 otherwise. colnames Names columns results. default  c(\"logit1\", \"logit2\", \"logOR\").  less three names supplied, remaining ones filled default. row.vars data frame matrix giving factor levels one factors corresponding rows Y rev logical, indicating whether order columns Y   reversed.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"two binary variables levels 0,1 logits calculated  assuming columns Y given order 11, 10, 01, 00, logits give log odds 1 response compared 0.   case, either use rev=TRUE supply Y[,4:1] first argument.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"data frame nrow(Y) rows 3 + ncol(row.vars) columns","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/blogits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bivariate Logits and Log Odds Ratio — blogits","text":"","code":"data(Toxaemia) tox.tab <- xtabs(Freq~class + smoke + hyper + urea, Toxaemia)  # reshape to 4-column matrix toxaemia <- t(matrix(aperm(tox.tab), 4, 15)) colnames(toxaemia) <- c(\"hu\", \"hU\", \"Hu\", \"HU\") rowlabs <- expand.grid(smoke=c(\"0\", \"1-19\", \"20+\"), class=factor(1:5)) toxaemia <- cbind(toxaemia, rowlabs)  # logits for H and U logitsTox <- blogits(toxaemia[,4:1], add=0.5, colnames=c(\"logitH\", \"logitW\"), row.vars=rowlabs) logitsTox #>        logitH    logitW      logOR smoke class #> 1  -1.0205696 -1.998774  1.5267914     0     1 #> 2  -0.9426080 -2.166453  1.0710243  1-19     1 #> 3  -1.0296194 -2.140066  2.4485390   20+     1 #> 4  -0.9504026 -2.515797  1.4619602     0     2 #> 5  -1.0469879 -2.498258  0.8640134  1-19     2 #> 6  -0.8649974 -2.525729 -1.1457908   20+     2 #> 7  -0.8793862 -2.263924  1.5805648     0     3 #> 8  -1.3826171 -2.362718  1.3736951  1-19     3 #> 9  -1.3393374 -2.273598  0.7442513   20+     3 #> 10 -0.9398380 -2.014903  1.3135126     0     4 #> 11 -1.4394042 -2.251292  1.3426023  1-19     4 #> 12 -1.2992830 -2.322388  0.8846854   20+     4 #> 13 -0.9995915 -1.996554  1.0036228     0     5 #> 14 -1.3002198 -1.938363  1.0347544  1-19     5 #> 15 -1.1574528 -1.897120  2.0187271   20+     5"},{"path":"http://friendly.github.io/vcdExtra/reference/Burt.html","id":null,"dir":"Reference","previous_headings":"","what":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"Cyril Burt (1950) gave data, sample 100 people Liverpool, illustrate application method factor analysis (later called multiple correspondence analysis) applied  categorical data. presented data initially form come called \"Burt table\", giving univariate bivariate frequencies n-way frequency table.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Burt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"","code":"data(\"Burt\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Burt.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"frequency data frame (representing 3 x 3 x 2 x 2 frequency table) 36 observations following 5 variables. Hair hair color, factor levels Fair Red Dark Eyes eye color, factor levels Light Mixed Dark Head head shape, factor levels Narrow Wide Stature height, factor levels Tall Short Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Burt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"Burt says: \", 217 individuals examined, two-thirds males. , partly simplify calculations partly later observations rather trustworthy,  shall restrict analysis data obtained last hundred males series.\" Head Stature reflect binary coding people classified according whether average population.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Burt.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"Burt, C. (1950). factorial analysis qualitative data,  British Journal Statistical Psychology, 3(3), 166-185. Table IX.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Burt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Burt (1950) Data on Hair, Eyes, Head and Stature — Burt","text":"","code":"data(Burt) mosaic(Freq ~ Hair + Eyes + Head + Stature, data=Burt, shade=TRUE) #> Error in eval(predvars, data, env): object 'Hair' not found  #or burt.tab <- xtabs(Freq ~ Hair + Eyes + Head + Stature, data=Burt) #> Error in eval(predvars, data, env): object 'Freq' not found mosaic(burt.tab, shade=TRUE) #> Error in mosaic(burt.tab, shade = TRUE): object 'burt.tab' not found"},{"path":"http://friendly.github.io/vcdExtra/reference/Caesar.html","id":null,"dir":"Reference","previous_headings":"","what":"Risk Factors for Infection in Caesarian Births — Caesar","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"Data infection birth Caesarian section, classified Risk (two levels),  whether Antibiotics used (two levels) whether Caesarian section Planned .   outcome Infection (three levels).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Caesar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"","code":"data(Caesar)"},{"path":"http://friendly.github.io/vcdExtra/reference/Caesar.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"    4-dimensional array resulting cross-tabulating    4 variables   251 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Caesar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"Infection regarded response variable .  quite 0 cells , particularly  Risk absent Caesarian section unplanned. treated structural sampling zeros?","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Caesar.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"Fahrmeir, L. & Tutz, G. (1994). Multivariate Statistical Modelling Based Generalized Linear Models  New York: Springer Verlag, Table 1.1.","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Caesar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Risk Factors for Infection in Caesarian Births — Caesar","text":"","code":"data(Caesar) #display table;  note that there are quite a few 0 cells structable(Caesar) #>                       Risk    Yes     No    #>                       Planned Yes No Yes No #> Infection Antibiotics                       #> Type 1    Yes                   0  4   0  0 #>           No                   11 10   4  0 #> Type 2    Yes                   1  7   1  0 #>           No                   17 13   4  0 #> None      Yes                  17 87   1  0 #>           No                   30  3  32  9 require(MASS) #> Loading required package: MASS #> Warning: package 'MASS' was built under R version 4.1.3  # baseline model, Infection as response Caesar.mod0 <- loglm(~Infection + (Risk*Antibiotics*Planned), data=Caesar) # NB: Pearson chisq cannot be computed due to the 0 cells Caesar.mod0 #> Call: #> loglm(formula = ~Infection + (Risk * Antibiotics * Planned),  #>     data = Caesar) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 85.10955 14 3.156586e-12 #> Pearson               NaN 14          NaN  mosaic(Caesar.mod0, main=\"Baseline model\")   # Illustrate handling structural zeros zeros <- 0+ (Caesar >0) zeros[1,,1,1] <- 1 structable(zeros) #>                       Risk    Yes     No    #>                       Planned Yes No Yes No #> Infection Antibiotics                       #> Type 1    Yes                   1  1   1  0 #>           No                    1  1   1  0 #> Type 2    Yes                   1  1   1  0 #>           No                    1  1   1  0 #> None      Yes                   1  1   1  0 #>           No                    1  1   1  1  # fit model excluding possible structural zeros Caesar.mod0s <- loglm(~Infection + (Risk*Antibiotics*Planned), data=Caesar,    start=zeros) Caesar.mod0s #> Call: #> loglm(formula = ~Infection + (Risk * Antibiotics * Planned),  #>     data = Caesar, start = zeros) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 78.89068  9 2.683409e-13 #> Pearson          77.55728  9 4.931611e-13  anova(Caesar.mod0, Caesar.mod0s, test=\"Chisq\") #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Infection + (Risk * Antibiotics * Planned)  #> Model 2: #>  ~Infection + (Risk * Antibiotics * Planned)  #>  #>           Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   85.10955 14                                     #> Model 2   78.89068  9   6.218866         5         0.2855 #> Saturated  0.00000  0  78.890682         9         0.0000  mosaic (Caesar.mod0s) #> Error in loglin(data, margins, start = start, fit = fitted, param = param,     eps = eps, iter = iter, print = print): object 'zeros' not found  # what terms to add? add1(Caesar.mod0, ~.^2, test=\"Chisq\") #> Single term additions #>  #> Model: #> ~Infection + (Risk * Antibiotics * Planned) #>                       Df     AIC    LRT  Pr(>Chi)     #> <none>                   105.110                      #> Infection:Risk         2 104.932  4.178    0.1238     #> Infection:Antibiotics  2  72.187 36.922 9.603e-09 *** #> Infection:Planned      2 107.742  1.368    0.5047     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # add Association of Infection:Antibiotics Caesar.mod1 <- update(Caesar.mod0, ~.+Infection:Antibiotics) anova(Caesar.mod0, Caesar.mod1, test=\"Chisq\") #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Infection + (Risk * Antibiotics * Planned)  #> Model 2: #>  ~Infection + Risk + Antibiotics + Planned + Risk:Antibiotics + Risk:Planned + Antibiotics:Planned + Infection:Antibiotics + Risk:Antibiotics:Planned  #>  #>           Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   85.10955 14                                     #> Model 2   48.18709 12   36.92246         2              0 #> Saturated  0.00000  0   48.18709        12              0  mosaic(Caesar.mod1, gp=shading_Friendly, main=\"Adding Infection:Antibiotics\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Cancer.html","id":null,"dir":"Reference","previous_headings":"","what":"Survival of Breast Cancer Patients — Cancer","title":"Survival of Breast Cancer Patients — Cancer","text":"Three year survival 474 breast cancer patients according nuclear grade diagnostic center.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Cancer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Survival of Breast Cancer Patients — Cancer","text":"","code":"data(Cancer)"},{"path":"http://friendly.github.io/vcdExtra/reference/Cancer.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Survival of Breast Cancer Patients — Cancer","text":"    3-dimensional array resulting cross-tabulating    3 variables   474 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Cancer.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Survival of Breast Cancer Patients — Cancer","text":"Lindsey, J. K. (1995).  Analysis Frequency Count Data  Oxford, UK: Oxford University Press. p. 38, Table 2.5. Whittaker, J. (1990) Graphical Models Applied Multivariate Statistics New York: John Wiley Sons, p. 220.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Cancer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Survival of Breast Cancer Patients — Cancer","text":"","code":"data(Cancer)  # example goes here"},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"Provides generalized Cochran-Mantel-Haenszel tests association two possibly ordered factors,  optionally stratified factor(s).  strata, CMHtest calculates tests level stratifying variables also provides overall tests controlling strata. ordinal factors, powerful tests test general association (independence) obtained assigning scores row column categories.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"","code":"CMHtest(x, ...)  # S3 method for formula CMHtest(formula, data = NULL, subset = NULL, na.action = NULL, ...)  # S3 method for default CMHtest(x, strata = NULL,     rscores = 1:R, cscores = 1:C,     types = c(\"cor\", \"rmeans\", \"cmeans\", \"general\"),     overall=FALSE, details=overall, ...)  # S3 method for CMHtest print(x, digits = max(getOption(\"digits\") - 2, 3), ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"x 2+ way contingency table array form, class \"table\" object optional category labels specified dimnames(x) attribute. formula formula specifying variables used create contingency table data.   one-sided formula data array form, two-sided formula   response Freq data data frame cell frequency variable.    convenience, conditioning formulas can specified indicating strata. data either data frame, object class \"table\" \"ftable\". subset optional vector specifying subset observations used. na.action function indicates happen data contain NAs.    Ignored data contingency table strata 3- higher-way table, names numbers factors treated strata.  default, first 2 factors treated main table variables, others considered stratifying factors. rscores Row scores.  Either set numbers (typically integers, 1:R) string \"midrank\" standardized midrank scores, NULL exclude tests depend row scores. cscores Column scores. row scores. types Types CMH tests compute: one  c(\"cor\", \"cmeans\", \"rmeans\", \"general\"), \"\" . overall logical. Whether calculate overall tests, controlling stratifying factors. details logical.  Whether include computational details result ... arguments passed default method. digits Digits print.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"standard \\(\\chi^2\\) tests association two-way table treat table factors nominal (unordered) categories. one factors two-way table quantitative ordinal, powerful tests association may obtained taking ordinality account using row column scores test linear trends differences row column means. CMH analysis two-way table produces generalized Cochran-Mantel-Haenszel statistics (Landis etal., 1978). include CMH correlation statistic (\"cor\"), treating factors ordered. given statum, equally spaced row column scores, CMH statistic reduces \\((n-1) r^2\\), \\(r\\) Pearson correlation X Y. \"midrank\" scores, CMH statistic analogous \\((n-1) r_S^2\\), using Spearman rank correlation. ANOVA (row mean scores column mean scores) statistics, treat columns rows respectively ordinal, sensitive mean shifts columns rows. transforms \\(F\\) statistics one-way ANOVAs equally spaced scores Kruskal-Wallis tests \"midrank\" scores. CMH general association statistic treat factors unordered, give test closely related Pearson \\(\\chi^2\\) test. one stratum, overall general CMH statistic gives stratum-adjusted Pearson \\(\\chi^2\\), equivalent calculated mantelhaen.test. 3+ way table, one table CMH tests produced  combination factors identified strata. overall=TRUE, additional table calculated two primary variables, controlling (pooling ) strata variables. overall tests implicitly assume interactions   primary variables strata low power presence interactions.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"object class \"CMHtest\" , list following 4 components: table matrix containing test statistics, columns   \tChisq, Df Prob names names table row column variables rscore Row scores cscore Column scores details==TRUE, additional components included. strata, result list \"CMHtest\" objects. overall=TRUE another component, labeled ALLis appended list.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"Stokes, M. E. & Davis, C. S.  & Koch, G., (2000).   Categorical Data Analysis using SAS System, 2nd Ed.,  Cary, NC: SAS Institute,  pp 74-75, 92-101, 124-129.  Details computation given :  http://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_freq_a0000000648.htm Cochran, W. G. (1954), Methods Strengthening Common \\(\\chi^2\\) Tests,  Biometrics, 10, 417-451. Landis, R. J., Heyman, E. R., Koch, G. G. (1978).   Average Partial Association Three-way Contingency Tables:   Review Discussion Alternative Tests,   International Statistical Review, 46, 237-254. Mantel, N. (1963), Chi-square Tests One Degree Freedom: Extensions Mantel-Haenszel Procedure,\" Journal American Statistical Association, 58, 690-700.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/CMHtest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generalized Cochran-Mantel-Haenszel Tests — CMHtest","text":"","code":"data(JobSat, package=\"vcdExtra\") CMHtest(JobSat) #> Cochran-Mantel-Haenszel Statistics for income by satisfaction  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 2.9830  1 0.084144 #> rmeans  Row mean scores differ 4.4774  3 0.214318 #> cmeans  Col mean scores differ 3.1036  3 0.375931 #> general    General association 5.9034  9 0.749549 #>  CMHtest(JobSat, rscores=\"midrank\", cscores=\"midrank\") #> Cochran-Mantel-Haenszel Statistics for income by satisfaction  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 2.9726  1 0.084685 #> rmeans  Row mean scores differ 4.1200  3 0.248799 #> cmeans  Col mean scores differ 3.3108  3 0.346144 #> general    General association 5.9034  9 0.749549 #>   # formula interface CMHtest(~ ., data=JobSat) #> Cochran-Mantel-Haenszel Statistics for income by satisfaction  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 2.9830  1 0.084144 #> rmeans  Row mean scores differ 4.4774  3 0.214318 #> cmeans  Col mean scores differ 3.1036  3 0.375931 #> general    General association 5.9034  9 0.749549 #>   # A 3-way table (both factors ordinal) data(MSPatients, package=\"vcd\") CMHtest(MSPatients) #> $`Patients:Winnipeg` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:Winnipeg  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 51.424  1 7.4426e-13 #> rmeans  Row mean scores differ 55.393  3 5.6601e-12 #> cmeans  Col mean scores differ 53.631  3 1.3450e-11 #> general    General association 64.318  9 1.9580e-10 #>  #>  #> $`Patients:New Orleans` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:New Orleans  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 28.863  1 7.7667e-08 #> rmeans  Row mean scores differ 30.594  3 1.0347e-06 #> cmeans  Col mean scores differ 29.054  3 2.1818e-06 #> general    General association 43.428  9 1.7990e-06 #>  #>    # also calculate overall tests, controlling for Patient CMHtest(MSPatients, overall=TRUE) #> $`Patients:Winnipeg` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:Winnipeg  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 51.424  1 7.4426e-13 #> rmeans  Row mean scores differ 55.393  3 5.6601e-12 #> cmeans  Col mean scores differ 53.631  3 1.3450e-11 #> general    General association 64.318  9 1.9580e-10 #>  #>  #> $`Patients:New Orleans` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:New Orleans  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 28.863  1 7.7667e-08 #> rmeans  Row mean scores differ 30.594  3 1.0347e-06 #> cmeans  Col mean scores differ 29.054  3 2.1818e-06 #> general    General association 43.428  9 1.7990e-06 #>  #>  #> $ALL #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tOverall tests, controlling for all strata  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 80.086  1 3.5848e-19 #> rmeans  Row mean scores differ 83.923  3 4.4189e-18 #> cmeans  Col mean scores differ 81.116  3 1.7685e-17 #> general    General association 101.21  9 8.9683e-18 #>  #>  # compare with mantelhaen.test mantelhaen.test(MSPatients) #>  #> \tCochran-Mantel-Haenszel test #>  #> data:  MSPatients #> Cochran-Mantel-Haenszel M^2 = 101.21, df = 9, p-value < 2.2e-16 #>   # formula interface CMHtest(~ ., data=MSPatients, overall=TRUE) #> $`Patients:Winnipeg` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:Winnipeg  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 51.424  1 7.4426e-13 #> rmeans  Row mean scores differ 55.393  3 5.6601e-12 #> cmeans  Col mean scores differ 53.631  3 1.3450e-11 #> general    General association 64.318  9 1.9580e-10 #>  #>  #> $`Patients:New Orleans` #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tin stratum Patients:New Orleans  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 28.863  1 7.7667e-08 #> rmeans  Row mean scores differ 30.594  3 1.0347e-06 #> cmeans  Col mean scores differ 29.054  3 2.1818e-06 #> general    General association 43.428  9 1.7990e-06 #>  #>  #> $ALL #> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist  #> \tOverall tests, controlling for all strata  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 80.086  1 3.5848e-19 #> rmeans  Row mean scores differ 83.923  3 4.4189e-18 #> cmeans  Col mean scores differ 81.116  3 1.7685e-17 #> general    General association 101.21  9 8.9683e-18 #>  #>   # using a frequency data.frame CMHtest(xtabs(Freq~ses+mental, data=Mental)) #> Cochran-Mantel-Haenszel Statistics for ses by mental  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 37.156  1 1.0907e-09 #> rmeans  Row mean scores differ 40.297  5 1.3012e-07 #> cmeans  Col mean scores differ 40.666  3 7.6971e-09 #> general    General association 45.958 15 5.4003e-05 #>  # or, more simply CMHtest(Freq~ses+mental, data=Mental) #> Cochran-Mantel-Haenszel Statistics for ses by mental  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 37.156  1 1.0907e-09 #> rmeans  Row mean scores differ 40.297  5 1.3012e-07 #> cmeans  Col mean scores differ 40.666  3 7.6971e-09 #> general    General association 45.958 15 5.4003e-05 #>   # conditioning formulae CMHtest(Freq~right+left|gender, data=VisualAcuity) #> $`gender:male` #> Cochran-Mantel-Haenszel Statistics for right by left  #> \tin stratum gender:male  #>  #>                  AltHypothesis  Chisq Df Prob #> cor        Nonzero correlation 1554.6  1    0 #> rmeans  Row mean scores differ 1556.3  3    0 #> cmeans  Col mean scores differ 1556.6  3    0 #> general    General association 3303.3  9    0 #>  #>  #> $`gender:female` #> Cochran-Mantel-Haenszel Statistics for right by left  #> \tin stratum gender:female  #>  #>                  AltHypothesis  Chisq Df Prob #> cor        Nonzero correlation 3691.3  1    0 #> rmeans  Row mean scores differ 3709.4  3    0 #> cmeans  Col mean scores differ 3724.0  3    0 #> general    General association 8095.8  9    0 #>  #>    CMHtest(Freq ~ attitude+memory|education+age, data=Punishment) #> $`education:elementary|age:15-24` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:elementary|age:15-24  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 3.5652  1 0.059002 #> rmeans  Row mean scores differ 3.5652  1 0.059002 #> cmeans  Col mean scores differ 3.5652  1 0.059002 #> general    General association 3.5652  1 0.059002 #>  #>  #> $`education:secondary|age:15-24` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:secondary|age:15-24  #>  #>                  AltHypothesis    Chisq Df   Prob #> cor        Nonzero correlation 0.077731  1 0.7804 #> rmeans  Row mean scores differ 0.077731  1 0.7804 #> cmeans  Col mean scores differ 0.077731  1 0.7804 #> general    General association 0.077731  1 0.7804 #>  #>  #> $`education:high|age:15-24` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:high|age:15-24  #>  #>                  AltHypothesis    Chisq Df    Prob #> cor        Nonzero correlation 0.089524  1 0.76478 #> rmeans  Row mean scores differ 0.089524  1 0.76478 #> cmeans  Col mean scores differ 0.089524  1 0.76478 #> general    General association 0.089524  1 0.76478 #>  #>  #> $`education:elementary|age:25-39` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:elementary|age:25-39  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 8.5433  1 0.003468 #> rmeans  Row mean scores differ 8.5433  1 0.003468 #> cmeans  Col mean scores differ 8.5433  1 0.003468 #> general    General association 8.5433  1 0.003468 #>  #>  #> $`education:secondary|age:25-39` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:secondary|age:25-39  #>  #>                  AltHypothesis   Chisq Df    Prob #> cor        Nonzero correlation 0.92897  1 0.33513 #> rmeans  Row mean scores differ 0.92897  1 0.33513 #> cmeans  Col mean scores differ 0.92897  1 0.33513 #> general    General association 0.92897  1 0.33513 #>  #>  #> $`education:high|age:25-39` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:high|age:25-39  #>  #>                  AltHypothesis Chisq Df    Prob #> cor        Nonzero correlation 0.472  1 0.49207 #> rmeans  Row mean scores differ 0.472  1 0.49207 #> cmeans  Col mean scores differ 0.472  1 0.49207 #> general    General association 0.472  1 0.49207 #>  #>  #> $`education:elementary|age:40-` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:elementary|age:40-  #>  #>                  AltHypothesis  Chisq Df       Prob #> cor        Nonzero correlation 11.606  1 0.00065737 #> rmeans  Row mean scores differ 11.606  1 0.00065737 #> cmeans  Col mean scores differ 11.606  1 0.00065737 #> general    General association 11.606  1 0.00065737 #>  #>  #> $`education:secondary|age:40-` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:secondary|age:40-  #>  #>                  AltHypothesis  Chisq Df    Prob #> cor        Nonzero correlation 6.0457  1 0.01394 #> rmeans  Row mean scores differ 6.0457  1 0.01394 #> cmeans  Col mean scores differ 6.0457  1 0.01394 #> general    General association 6.0457  1 0.01394 #>  #>  #> $`education:high|age:40-` #> Cochran-Mantel-Haenszel Statistics for attitude by memory  #> \tin stratum education:high|age:40-  #>  #>                  AltHypothesis  Chisq Df     Prob #> cor        Nonzero correlation 3.0436  1 0.081055 #> rmeans  Row mean scores differ 3.0436  1 0.081055 #> cmeans  Col mean scores differ 3.0436  1 0.081055 #> general    General association 3.0436  1 0.081055 #>  #>    # Stokes etal, Table 5.1, p 92: two unordered factors parties <- matrix(   c(221, 160, 360, 140,     200, 291, 160, 311,     208, 106, 316, 97), nrow=3, ncol=4, byrow=TRUE) dimnames(parties) <- list(party=c(\"Dem\", \"Indep\", \"Rep\"),              neighborhood=c(\"Bayside\", \"Highland\", \"Longview\", \"Sheffield\")) CMHtest(parties, rscores=NULL, cscores=NULL) #> Cochran-Mantel-Haenszel Statistics for party by neighborhood  #>  #>               AltHypothesis  Chisq Df       Prob #> general General association 273.81  6 3.3158e-56 #>  # compare with Pearson chisquare chisq.test(parties) #>  #> \tPearson's Chi-squared test #>  #> data:  parties #> X-squared = 273.92, df = 6, p-value < 2.2e-16 #>"},{"path":"http://friendly.github.io/vcdExtra/reference/collapse.table.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse Levels of a Table — collapse.table","title":"Collapse Levels of a Table — collapse.table","text":"Collapse (re-label) variables contingency table, array ftable object re-assigning levels table variables.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse Levels of a Table — collapse.table","text":"","code":"collapse.table(table, ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse Levels of a Table — collapse.table","text":"table table, array ftable object ... collection one assignments factors table   list levels","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Collapse Levels of a Table — collapse.table","text":"... arguments must form  variable = levels, variable name one table dimensions, levels character numeric vector length equal corresponding dimension table.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse Levels of a Table — collapse.table","text":"xtabs table object, representing original table one factors collapsed rearranged levels.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Collapse Levels of a Table — collapse.table","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/collapse.table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collapse Levels of a Table — collapse.table","text":"","code":"# create some sample data in table form sex <- c(\"Male\", \"Female\") age <- letters[1:6] education <- c(\"low\", 'med', 'high') data <- expand.grid(sex=sex, age=age, education=education) counts <- rpois(36, 100)  data <- cbind(data, counts) t1 <- xtabs(counts ~ sex + age + education, data=data) structable(t1) #>                  age   a   b   c   d   e   f #> sex    education                             #> Male   low           111 102  86 105  82 109 #>        med           112  86 113 110  96 114 #>        high           82  90  94  96 100  93 #> Female low           100 119  92 112  94 102 #>        med            93 106 104 103 105  98 #>        high          110  81 100 108  92  99  ##                  age   a   b   c   d   e   f ## sex    education                             ## Male   low           119 101 109  85  99  93 ##        med            94  98 103 108  84  84 ##        high           81  88  96 110 100  92 ## Female low           107 104  95  86 103  96 ##        med           104  98  94  95 110 106 ##        high           93  85  90 109  99  86   # collapse age to 3 levels t2 <- collapse.table(t1, age=c(\"A\", \"A\", \"B\", \"B\", \"C\", \"C\")) structable(t2) #>                  age   A   B   C #> sex    education                 #> Male   low           213 191 191 #>        med           198 223 210 #>        high          172 190 193 #> Female low           219 204 196 #>        med           199 207 203 #>        high          191 208 191  ##                  age   A   B   C ## sex    education                 ## Male   low           220 194 192 ##        med           192 211 168 ##        high          169 206 192 ## Female low           211 181 199 ##        med           202 189 216 ##        high          178 199 185   # collapse age to 3 levels and pool education: \"low\" and \"med\" to \"low\" t3 <- collapse.table(t1, age=c(\"A\", \"A\", \"B\", \"B\", \"C\", \"C\"),      education=c(\"low\", \"low\", \"high\")) structable(t3) #>                  age   A   B   C #> sex    education                 #> Male   low           411 414 401 #>        high          172 190 193 #> Female low           418 411 399 #>        high          191 208 191  ##                  age   A   B   C ## sex    education                 ## Male   low           412 405 360 ##        high          169 206 192 ## Female low           413 370 415 ##        high          178 199 185    # change labels for levels of education to 1:3 t4 <- collapse.table(t1,  education=1:3) structable(t4) #>                  age   a   b   c   d   e   f #> sex    education                             #> Male   1             111 102  86 105  82 109 #>        2             112  86 113 110  96 114 #>        3              82  90  94  96 100  93 #> Female 1             100 119  92 112  94 102 #>        2              93 106 104 103 105  98 #>        3             110  81 100 108  92  99  structable(t4) #>                  age   a   b   c   d   e   f #> sex    education                             #> Male   1             111 102  86 105  82 109 #>        2             112  86 113 110  96 114 #>        3              82  90  94  96 100  93 #> Female 1             100 119  92 112  94 102 #>        2              93 106 104 103 105  98 #>        3             110  81 100 108  92  99 ##                  age   a   b   c   d   e   f ## sex    education                             ## Male   1             119 101 109  85  99  93 ##        2              94  98 103 108  84  84 ##        3              81  88  96 110 100  92 ## Female 1             107 104  95  86 103  96 ##        2             104  98  94  95 110 106 ##        3              93  85  90 109  99  86"},{"path":"http://friendly.github.io/vcdExtra/reference/Cormorants.html","id":null,"dir":"Reference","previous_headings":"","what":"Advertising Behavior by Males Cormorants — Cormorants","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"Male double-crested cormorants use advertising behavior attract females breeding. study Meagan McRae (2015), cormorants observed two three times week six stations tree-nesting colony entire season, April 10, 2014-July 10, 2014. number advertising birds counted observations classified characteristics trees nests. goal determine behavior varies temporally season spatially, well characteristics nesting sites.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"","code":"data(\"Cormorants\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"data frame 343 observations following 8 variables. category Time season, divided 3 categories based breeding chronology, ordered factor levels Pre < Incubation < Chicks Present week Week season station Station observations two different peninsulas park, factor levels B1 B2 C1 C2 C3 C4 nest Type nest, ordered factor levels < partial < full height Relative height bird tree, ordered factor levels low < mid < high density Number nests tree, ordered factor levels zero < < moderate < high tree_health Health tree bird advertising , factor levels dead healthy count Number birds advertising, numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"Observations made 2 days weeks 3 4, 3 days weeks. One use log(days) offset, response measures rate. Cormorants$days <- ifelse(Cormorants$week %% 3:4, 2, 3)","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"McRae, M. (2015). Spatial, Habitat Frequency Changes Double-crested Cormorant Advertising Display  Tree-nesting Colony. Unpublished MA project, Environmental Studies, York University.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Cormorants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Advertising Behavior by Males Cormorants — Cormorants","text":"","code":"data(Cormorants) str(Cormorants) #> 'data.frame':\t343 obs. of  8 variables: #>  $ category   : Ord.factor w/ 3 levels \"Pre\"<\"Incubation\"<..: 1 1 1 1 1 1 1 1 1 1 ... #>  $ week       : int  1 1 1 1 1 1 1 1 1 1 ... #>  $ station    : Factor w/ 6 levels \"B1\",\"B2\",\"C1\",..: 3 3 3 3 3 3 3 4 4 4 ... #>  $ nest       : Ord.factor w/ 3 levels \"no\"<\"partial\"<..: 1 1 2 2 2 3 3 1 1 1 ... #>  $ height     : Ord.factor w/ 3 levels \"low\"<\"mid\"<\"high\": 2 3 2 3 3 2 3 2 2 3 ... #>  $ density    : Ord.factor w/ 4 levels \"zero\"<\"few\"<\"moderate\"<..: 2 2 2 2 2 2 2 2 2 2 ... #>  $ tree_health: Factor w/ 2 levels \"dead\",\"healthy\": 2 2 2 2 1 2 2 2 1 2 ... #>  $ count      : int  3 2 2 2 1 3 3 1 8 3 ...  if (require(\"ggplot2\")) {   print(ggplot(Cormorants, aes(count)) + geom_histogram(binwidth=0.5) +      labs(x=\"Number of birds advertising\"))  # Quick look at the data, on the log scale, for plots of `count ~ week`,  #   stratified by something else.    print(ggplot(Cormorants, aes(week, count, color=height)) + geom_jitter() +     stat_smooth(method=\"loess\", size=2) + scale_y_log10(breaks=c(1,2,5,10)) +     geom_vline(xintercept=c(4.5, 9.5))) } #> Loading required package: ggplot2  #> `geom_smooth()` using formula 'y ~ x'   # ### models using week  fit1 <-glm(count ~ week + station + nest + height + density + tree_health, data=Cormorants,     family =  poisson)  if (requireNamespace(\"car\"))   car::Anova(fit1) #> Analysis of Deviance Table (Type II tests) #>  #> Response: count #>             LR Chisq Df Pr(>Chisq)     #> week          62.791  1  2.298e-15 *** #> station       14.068  5    0.01518 *   #> nest         137.812  2  < 2.2e-16 *** #> height        47.988  2  3.797e-11 *** #> density       47.266  2  5.450e-11 *** #> tree_health    0.070  1    0.79199     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1    # plot fitted effects if (requireNamespace(\"effects\"))   plot(effects::allEffects(fit1))"},{"path":"http://friendly.github.io/vcdExtra/reference/Crossings.html","id":null,"dir":"Reference","previous_headings":"","what":"Crossings Interaction of Factors — Crossings","title":"Crossings Interaction of Factors — Crossings","text":"Given two ordered factors square, n x n frequency table, Crossings creates n-1 column matrix corresponding different degrees difficulty crossing one level next, described Goodman (1972).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Crossings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Crossings Interaction of Factors — Crossings","text":"","code":"Crossings(...)"},{"path":"http://friendly.github.io/vcdExtra/reference/Crossings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Crossings Interaction of Factors — Crossings","text":"... Two factors","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Crossings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Crossings Interaction of Factors — Crossings","text":"two factors n levels, returns binary indicator matrix n*n rows n-1 columns.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Crossings.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Crossings Interaction of Factors — Crossings","text":"Goodman, L. (1972).  multiplicative models analysis cross-classified data. : Proceedings Sixth Berkeley Symposium Mathematical Statistics Probability, Berkeley, CA: University California Press, pp. 649-696.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Crossings.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Crossings Interaction of Factors — Crossings","text":"Michael Friendly Heather Turner","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Crossings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Crossings Interaction of Factors — Crossings","text":"","code":"data(Hauser79) # display table structable(~Father+Son, data=Hauser79) #>        Son UpNM LoNM  UpM  LoM Farm #> Father                              #> UpNM       1414  521  302  643   40 #> LoNM        724  524  254  703   48 #> UpM         798  648  856 1676  108 #> LoM         756  914  771 3325  237 #> Farm        409  357  441 1611 1832  hauser.indep <- gnm(Freq ~ Father + Son, data=Hauser79, family=poisson) hauser.CR <- update(hauser.indep, ~ . + Crossings(Father,Son)) LRstats(hauser.CR) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CR 318.63 334.47   89.914 12  5.131e-14 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  hauser.CRdiag <- update(hauser.indep, ~ . + Crossings(Father,Son) + Diag(Father,Son)) LRstats(hauser.CRdiag) #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CRdiag 298.95 318.45   64.237  9   2.03e-10 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":null,"dir":"Reference","previous_headings":"","what":"Cut a Numeric Variable to a Factor — cutfac","title":"Cut a Numeric Variable to a Factor — cutfac","text":"cutfac acts like cut, dividing range x intervals coding values x according interval fall. However, gives nicer labels factor levels  default chooses convenient breaks among values based deciles. particularly useful plots one wants make numeric variable discrete purpose getting boxplots, spinograms mosaic plots.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cut a Numeric Variable to a Factor — cutfac","text":"","code":"cutfac(x, breaks = NULL, q = 10)"},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cut a Numeric Variable to a Factor — cutfac","text":"x numeric vector converted factor cutting breaks either numeric vector two unique cut points single number (greater equal 2) giving number intervals x cut. q number quantile groups used define breaks, specified.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cut a Numeric Variable to a Factor — cutfac","text":"default, cut chooses breaks equal lengths range x, whereas cutfac uses quantile choose breaks roughly equal count.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cut a Numeric Variable to a Factor — cutfac","text":"factor corresponding x returned","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cut a Numeric Variable to a Factor — cutfac","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Cut a Numeric Variable to a Factor — cutfac","text":"Achim Zeileis","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/cutfac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cut a Numeric Variable to a Factor — cutfac","text":"","code":"if (require(AER)) { data(\"NMES1988\", package=\"AER\") nmes <- NMES1988[, c(1, 6:8, 13, 15, 18)]  plot(log(visits+1) ~ cutfac(chronic), data = nmes,   ylab = \"Physician office visits (log scale)\",    xlab = \"Number of chronic conditions\", main = \"chronic\")  plot(log(visits+1) ~ cutfac(hospital, c(0:2, 8)), data = nmes,   ylab = \"Physician office visits (log scale)\",    xlab = \"Number of hospital stays\", main = \"hospital\") } #> Loading required package: AER #> Loading required package: lmtest #> Warning: package 'lmtest' was built under R version 4.1.3 #> Loading required package: zoo #>  #> Attaching package: 'zoo' #> The following objects are masked from 'package:base': #>  #>     as.Date, as.Date.numeric #> Loading required package: sandwich #> Loading required package: survival #> Warning: package 'survival' was built under R version 4.1.3"},{"path":"http://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":null,"dir":"Reference","previous_headings":"","what":"London Cycling Deaths — CyclingDeaths","title":"London Cycling Deaths — CyclingDeaths","text":"data frame containing number deaths cyclists London 2005 2012 fortnightly period.  Aberdein & Spiegelhalter (2013) discuss data relation observation six cyclists died London Nov. 5 Nov. 13, 2013.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"London Cycling Deaths — CyclingDeaths","text":"","code":"data(CyclingDeaths)"},{"path":"http://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"London Cycling Deaths — CyclingDeaths","text":"data frame 208 observations following 2 variables. date Date deaths number deaths, numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"London Cycling Deaths — CyclingDeaths","text":"https://data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data, STATS 19 data, 2005-2012, using files Casualty0512.csv  Accidents0512.csv","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"London Cycling Deaths — CyclingDeaths","text":"Aberdein, Jody Spiegelhalter, David (2013). London's roads become dangerous cyclists? Significance, 10(6), 46--48.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/CyclingDeaths.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"London Cycling Deaths — CyclingDeaths","text":"","code":"data(CyclingDeaths)  plot(deaths ~ date, data=CyclingDeaths, type=\"h\",    lwd=3, ylab=\"Number of deaths\", axes=FALSE) axis(1, at=seq(as.Date('2005-01-01'), by='years', length.out=9), labels=2005:2013) axis(2, at=0:3)   # make a one-way frequency table CyclingDeaths.tab <- table(CyclingDeaths$deaths)  gf <- goodfit(CyclingDeaths.tab) gf #>  #> Observed and fitted values for poisson distribution #> with parameters estimated by `ML'  #>  #>  count observed     fitted pearson residual #>      0      114 117.946412       -0.3633792 #>      1       75  66.911907        0.9887681 #>      2       14  18.979820       -1.1430562 #>      3        5   3.589133        0.4108395 summary(gf) #>  #> \t Goodness-of-fit test for poisson distribution #>  #>                       X^2 df  P(> X^2) #> Likelihood Ratio 4.151738  2 0.1254474  rootogram(gf, xlab=\"Number of Deaths\")  distplot(CyclingDeaths.tab)   # prob of 6 or more deaths in one fortnight lambda <- gf$par$lambda ppois(5, lambda, lower.tail=FALSE) #> [1] 2.854305e-05"},{"path":"http://friendly.github.io/vcdExtra/reference/datasets.html","id":null,"dir":"Reference","previous_headings":"","what":"Information on Data Sets in Packages — datasets","title":"Information on Data Sets in Packages — datasets","text":"data function used load data sets packages,  give display names titles data sets one packages, however return result can easily used get additional information nature data sets packages. datasets() function designed produce useful summary display data sets one packages.  extracts class dimension information (dim codelength) item, formats provide additional descriptors.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/datasets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information on Data Sets in Packages — datasets","text":"","code":"datasets(package, allClass=FALSE,      incPackage=length(package) > 1,     maxTitle=NULL)"},{"path":"http://friendly.github.io/vcdExtra/reference/datasets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Information on Data Sets in Packages — datasets","text":"package character vector giving package(s) look allClass include classes item (TRUE) just last class (FALSE)? incPackage include package name result? maxTitle maximum length data set Title","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/datasets.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Information on Data Sets in Packages — datasets","text":"requested packages must installed, silently loaded order extract class size information.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/datasets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Information on Data Sets in Packages — datasets","text":"data.frame whose rows correspond data sets found package. columns (single package) : Item data set name class class dim abbreviation dimensions data set Title data set title","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/datasets.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Information on Data Sets in Packages — datasets","text":"Michael Friendly, R-help Curt Seeliger","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/datasets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Information on Data Sets in Packages — datasets","text":"","code":"datasets(\"vcdExtra\") #>              Item      class       dim #> 1        Abortion      table     2x2x2 #> 2        Accident data.frame      80x5 #> 3        AirCrash data.frame     439x5 #> 4       Alligator data.frame      80x5 #> 5        Bartlett      table     2x2x2 #> 6            Burt data.frame      27x3 #> 7          Caesar      table   3x2x2x2 #> 8          Cancer      table     2x2x2 #> 9      Cormorants data.frame     343x8 #> 10  CyclingDeaths data.frame     208x2 #> 11   DaytonSurvey data.frame      32x6 #> 12        Depends      table        15 #> 13      Detergent      table   2x2x2x3 #> 14         Donner data.frame      90x5 #> 15      Draft1970 data.frame     366x3 #> 16 Draft1970table      table      12x3 #> 17           Dyke      table 2x2x2x2x2 #> 18      Fungicide      array   2x2x2x2 #> 19            GSS data.frame       6x3 #> 20       Geissler data.frame      90x4 #> 21          Gilby      table       6x4 #> 22          Glass data.frame      25x3 #> 23   HairEyePlace      array     4x5x2 #> 24       Hauser79 data.frame      25x3 #> 25          Heart      table     2x2x3 #> 26        Heckman      table 2x2x2x2x2 #> 27     HospVisits      table       3x3 #> 28           Hoyt      table   4x3x7x2 #> 29            ICU data.frame    200x22 #> 30         JobSat      table       4x4 #> 31     Mammograms      array       4x4 #> 32         Mental data.frame      24x3 #> 33           Mice data.frame      30x4 #> 34       Mobility      table       5x5 #> 35        PhdPubs data.frame     915x6 #> 36     ShakeWords data.frame     100x2 #> 37             TV      array    5x11x3 #> 38       Titanicp data.frame    1309x6 #> 39       Toxaemia data.frame      60x5 #> 40        Vietnam data.frame      40x4 #> 41       Vote1980 data.frame      28x4 #> 42      WorkerSat data.frame       8x4 #> 43    Yamaguchi87 data.frame      75x4 #>                                                    Title #> 1                                  Abortion Opinion Data #> 2             Traffic Accident Victims in France in 1958 #> 3                                         Air Crash Data #> 4                                  Alligator Food Choice #> 5                    Bartlett data on plum root cuttings #> 6       Burt (1950) Data on Hair, Eyes, Head and Stature #> 7         Risk Factors for Infection in Caesarian Births #> 8                     Survival of Breast Cancer Patients #> 9               Advertising Behavior by Males Cormorants #> 10                                 London Cycling Deaths #> 11                Dayton Student Survey on Substance Use #> 12                            Dependencies of R Packages #> 13                             Detergent preference data #> 14                          Survival in the Donner Party #> 15                           USA 1970 Draft Lottery Data #> 16                          USA 1970 Draft Lottery Table #> 17                        Sources of Knowledge of Cancer #> 18                   Carcinogenic Effects of a Fungicide #> 19      General Social Survey- Sex and Party affiliation #> 20                Geissler's Data on the Human Sex Ratio #> 21          Clothing and Intelligence Rating of Children #> 22              British Social Mobility from Glass(1954) #> 23    Hair Color and Eye Color in Caithness and Aberdeen #> 24                 Hauser (1979) Data on Social Mobility #> 25                     Sex, Occupation and Heart Disease #> 26 Labour Force Participation of Married Women 1967-1971 #> 27                                  Hospital Visits Data #> 28                       Minnesota High School Graduates #> 29                                          ICU data set #> 30    Cross-classification of job satisfaction by income #> 31                                     Mammogram Ratings #> 32                     Mental impairment and parents SES #> 33                                   Mice Depletion Data #> 34                                  Social Mobility data #> 35                        Publications of PhD Candidates #> 36                   Shakespeare's Word Type Frequencies #> 37                                       TV Viewing Data #> 38                             Passengers on the Titanic #> 39                        Toxaemia Symptoms in Pregnancy #> 40                 Student Opinion about the Vietnam War #> 41       Race and Politics in the 1980 Presidential Vote #> 42                              Worker Satisfaction Data #> 43              Occupational Mobility in Three Countries datasets(c(\"vcd\", \"vcdExtra\")) #>     Package            Item      class             dim #> 1       vcd       Arthritis data.frame            84x5 #> 2       vcd        Baseball data.frame          322x25 #> 3       vcd  BrokenMarriage data.frame            20x4 #> 4       vcd      Bundesliga data.frame         14018x7 #> 5       vcd   Bundestag2005      table            16x5 #> 6       vcd       Butterfly      table              24 #> 7       vcd      CoalMiners      table           2x2x9 #> 8       vcd   DanishWelfare data.frame           180x5 #> 9       vcd      Employment      table           2x6x2 #> 10      vcd      Federalist      table               7 #> 11      vcd         Hitters data.frame           154x4 #> 12      vcd      HorseKicks      table               5 #> 13      vcd        Hospital      table             3x3 #> 14      vcd JobSatisfaction data.frame             8x4 #> 15      vcd     JointSports data.frame            40x5 #> 16      vcd       Lifeboats data.frame            18x8 #> 17      vcd      MSPatients      array           4x4x2 #> 18      vcd     NonResponse data.frame            12x4 #> 19      vcd     OvaryCancer data.frame            16x5 #> 20      vcd          PreSex      table         2x2x2x2 #> 21      vcd      Punishment data.frame            36x5 #> 22      vcd         RepVict      table             8x8 #> 23      vcd        Rochdale      table 2x2x2x2x2x2x2x2 #> 24      vcd          Saxony      table              13 #> 25      vcd       SexualFun      table             4x4 #> 26      vcd    SpaceShuttle data.frame            24x6 #> 27      vcd         Suicide data.frame           306x6 #> 28      vcd          Trucks data.frame            24x5 #> 29      vcd        UKSoccer      table             5x5 #> 30      vcd    VisualAcuity data.frame            32x4 #> 31      vcd         VonBort data.frame           280x4 #> 32      vcd      WeldonDice      table              11 #> 33      vcd      WomenQueue      table              11 #> 34 vcdExtra        Abortion      table           2x2x2 #> 35 vcdExtra        Accident data.frame            80x5 #> 36 vcdExtra        AirCrash data.frame           439x5 #> 37 vcdExtra       Alligator data.frame            80x5 #> 38 vcdExtra        Bartlett      table           2x2x2 #> 39 vcdExtra            Burt data.frame            27x3 #> 40 vcdExtra          Caesar      table         3x2x2x2 #> 41 vcdExtra          Cancer      table           2x2x2 #> 42 vcdExtra      Cormorants data.frame           343x8 #> 43 vcdExtra   CyclingDeaths data.frame           208x2 #> 44 vcdExtra    DaytonSurvey data.frame            32x6 #> 45 vcdExtra         Depends      table              15 #> 46 vcdExtra       Detergent      table         2x2x2x3 #> 47 vcdExtra          Donner data.frame            90x5 #> 48 vcdExtra       Draft1970 data.frame           366x3 #> 49 vcdExtra  Draft1970table      table            12x3 #> 50 vcdExtra            Dyke      table       2x2x2x2x2 #> 51 vcdExtra       Fungicide      array         2x2x2x2 #> 52 vcdExtra             GSS data.frame             6x3 #> 53 vcdExtra        Geissler data.frame            90x4 #> 54 vcdExtra           Gilby      table             6x4 #> 55 vcdExtra           Glass data.frame            25x3 #> 56 vcdExtra    HairEyePlace      array           4x5x2 #> 57 vcdExtra        Hauser79 data.frame            25x3 #> 58 vcdExtra           Heart      table           2x2x3 #> 59 vcdExtra         Heckman      table       2x2x2x2x2 #> 60 vcdExtra      HospVisits      table             3x3 #> 61 vcdExtra            Hoyt      table         4x3x7x2 #> 62 vcdExtra             ICU data.frame          200x22 #> 63 vcdExtra          JobSat      table             4x4 #> 64 vcdExtra      Mammograms      array             4x4 #> 65 vcdExtra          Mental data.frame            24x3 #> 66 vcdExtra            Mice data.frame            30x4 #> 67 vcdExtra        Mobility      table             5x5 #> 68 vcdExtra         PhdPubs data.frame           915x6 #> 69 vcdExtra      ShakeWords data.frame           100x2 #> 70 vcdExtra              TV      array          5x11x3 #> 71 vcdExtra        Titanicp data.frame          1309x6 #> 72 vcdExtra        Toxaemia data.frame            60x5 #> 73 vcdExtra         Vietnam data.frame            40x4 #> 74 vcdExtra        Vote1980 data.frame            28x4 #> 75 vcdExtra       WorkerSat data.frame             8x4 #> 76 vcdExtra     Yamaguchi87 data.frame            75x4 #>                                                    Title #> 1                               Arthritis Treatment Data #> 2                                          Baseball Data #> 3                                   Broken Marriage Data #> 4                     Ergebnisse der Fussball-Bundesliga #> 5                Votes in German Bundestag Election 2005 #> 6                            Butterfly Species in Malaya #> 7               Breathlessness and Wheeze in Coal Miners #> 8                              Danish Welfare Study Data #> 9                                      Employment Status #> 10                            'May' in Federalist Papers #> 11                                          Hitters Data #> 12                                  Death by Horse Kicks #> 13                                         Hospital data #> 14                                 Job Satisfaction Data #> 15                           Opinions About Joint Sports #> 16                              Lifeboats on the Titanic #> 17                       Diagnosis of Multiple Sclerosis #> 18                              Non-Response Survey Data #> 19                                     Ovary Cancer Data #> 20                           Pre-marital Sex and Divorce #> 21                              Corporal Punishment Data #> 22                             Repeat Victimization Data #> 23                                         Rochdale Data #> 24                                    Families in Saxony #> 25                                            Sex is Fun #> 26                         Space Shuttle O-ring Failures #> 27                              Suicide Rates in Germany #> 28                                  Truck Accidents Data #> 29                                      UK Soccer Scores #> 30                  Visual Acuity in Left and Right Eyes #> 31                      Von Bortkiewicz Horse Kicks Data #> 32                                    Weldon's Dice Data #> 33                                       Women in Queues #> 34                                 Abortion Opinion Data #> 35            Traffic Accident Victims in France in 1958 #> 36                                        Air Crash Data #> 37                                 Alligator Food Choice #> 38                   Bartlett data on plum root cuttings #> 39      Burt (1950) Data on Hair, Eyes, Head and Stature #> 40        Risk Factors for Infection in Caesarian Births #> 41                    Survival of Breast Cancer Patients #> 42              Advertising Behavior by Males Cormorants #> 43                                 London Cycling Deaths #> 44                Dayton Student Survey on Substance Use #> 45                            Dependencies of R Packages #> 46                             Detergent preference data #> 47                          Survival in the Donner Party #> 48                           USA 1970 Draft Lottery Data #> 49                          USA 1970 Draft Lottery Table #> 50                        Sources of Knowledge of Cancer #> 51                   Carcinogenic Effects of a Fungicide #> 52      General Social Survey- Sex and Party affiliation #> 53                Geissler's Data on the Human Sex Ratio #> 54          Clothing and Intelligence Rating of Children #> 55              British Social Mobility from Glass(1954) #> 56    Hair Color and Eye Color in Caithness and Aberdeen #> 57                 Hauser (1979) Data on Social Mobility #> 58                     Sex, Occupation and Heart Disease #> 59 Labour Force Participation of Married Women 1967-1971 #> 60                                  Hospital Visits Data #> 61                       Minnesota High School Graduates #> 62                                          ICU data set #> 63    Cross-classification of job satisfaction by income #> 64                                     Mammogram Ratings #> 65                     Mental impairment and parents SES #> 66                                   Mice Depletion Data #> 67                                  Social Mobility data #> 68                        Publications of PhD Candidates #> 69                   Shakespeare's Word Type Frequencies #> 70                                       TV Viewing Data #> 71                             Passengers on the Titanic #> 72                        Toxaemia Symptoms in Pregnancy #> 73                 Student Opinion about the Vietnam War #> 74       Race and Politics in the 1980 Presidential Vote #> 75                              Worker Satisfaction Data #> 76              Occupational Mobility in Three Countries datasets(\"datasets\", maxTitle=50) #>                       Item      class     dim #> 1            AirPassengers         ts     144 #> 2                  BJsales         ts     150 #> 3   BJsales.lead (BJsales)         ts     150 #> 4                      BOD data.frame     6x2 #> 5                      CO2 data.frame    84x5 #> 6              ChickWeight data.frame   578x4 #> 7                    DNase data.frame   176x3 #> 8           EuStockMarkets     matrix  1860x4 #> 9             Formaldehyde data.frame     6x2 #> 10            HairEyeColor      table   4x4x2 #> 11            Harman23.cor       list       3 #> 12            Harman74.cor       list       3 #> 13                Indometh data.frame    66x3 #> 14            InsectSprays data.frame    72x2 #> 15          JohnsonJohnson         ts      84 #> 16               LakeHuron         ts      98 #> 17        LifeCycleSavings data.frame    50x5 #> 18                Loblolly data.frame    84x3 #> 19                    Nile         ts     100 #> 20                  Orange data.frame    35x3 #> 21           OrchardSprays data.frame    64x4 #> 22             PlantGrowth data.frame    30x2 #> 23               Puromycin data.frame    23x3 #> 24               Seatbelts         ts   192x8 #> 25                  Theoph data.frame   132x5 #> 26                 Titanic      table 4x2x2x2 #> 27             ToothGrowth data.frame    60x3 #> 28           UCBAdmissions      table   2x2x6 #> 29          UKDriverDeaths         ts     192 #> 30                   UKgas         ts     108 #> 31             USAccDeaths         ts      72 #> 32               USArrests data.frame    50x4 #> 33          USJudgeRatings data.frame   43x12 #> 34   USPersonalExpenditure      array     5x5 #> 35               UScitiesD       dist      45 #> 36                VADeaths      array     5x4 #> 37                WWWusage         ts     100 #> 38             WorldPhones      array     7x7 #> 39             ability.cov       list       3 #> 40                airmiles         ts      24 #> 41              airquality data.frame   153x6 #> 42                anscombe data.frame    11x8 #> 43                  attenu data.frame   182x5 #> 44                attitude data.frame    30x7 #> 45                 austres         ts      89 #> 46       beaver1 (beavers) data.frame   114x4 #> 47       beaver2 (beavers) data.frame   100x4 #> 48                    cars data.frame    50x2 #> 49                chickwts data.frame    71x2 #> 50                     co2         ts     468 #> 51                 crimtab      table   42x22 #> 52             discoveries         ts     100 #> 53                   esoph data.frame    88x5 #> 54                    euro    numeric      11 #> 55       euro.cross (euro)      array   11x11 #> 56                eurodist       dist     210 #> 57                faithful data.frame   272x2 #> 58  fdeaths (UKLungDeaths)         ts      72 #> 59                  freeny data.frame    39x5 #> 60       freeny.x (freeny)      array    39x4 #> 61       freeny.y (freeny)         ts      39 #> 62                  infert data.frame   248x8 #> 63                    iris data.frame   150x5 #> 64                   iris3      array  50x4x3 #> 65                 islands    numeric      48 #> 66  ldeaths (UKLungDeaths)         ts      72 #> 67                      lh         ts      48 #> 68                 longley data.frame    16x7 #> 69                    lynx         ts     114 #> 70  mdeaths (UKLungDeaths)         ts      72 #> 71                  morley data.frame   100x3 #> 72                  mtcars data.frame   32x11 #> 73                  nhtemp         ts      60 #> 74                  nottem         ts     240 #> 75                     npk data.frame    24x5 #> 76      occupationalStatus      table     8x8 #> 77                  precip    numeric      70 #> 78              presidents         ts     120 #> 79                pressure data.frame    19x2 #> 80                  quakes data.frame  1000x5 #> 81                   randu data.frame   400x3 #> 82                  rivers    numeric     141 #> 83                    rock data.frame    48x4 #> 84                   sleep data.frame    20x3 #> 85  stack.loss (stackloss)    numeric      21 #> 86     stack.x (stackloss)      array    21x3 #> 87               stackloss data.frame    21x4 #> 88       state.abb (state)  character      50 #> 89      state.area (state)    numeric      50 #> 90    state.center (state)       list       2 #> 91  state.division (state)     factor      50 #> 92      state.name (state)  character      50 #> 93    state.region (state)     factor      50 #> 94       state.x77 (state)      array    50x8 #> 95           sunspot.month         ts    3177 #> 96            sunspot.year         ts     289 #> 97                sunspots         ts    2820 #> 98                   swiss data.frame    47x6 #> 99                treering         ts    7980 #> 100                  trees data.frame    31x3 #> 101                  uspop         ts      19 #> 102                volcano      array   87x61 #> 103             warpbreaks data.frame    54x3 #> 104                  women data.frame    15x2 #>                                                  Title #> 1          Monthly Airline Passenger Numbers 1949-1960 #> 2                    Sales Data with Leading Indicator #> 3                    Sales Data with Leading Indicator #> 4                            Biochemical Oxygen Demand #> 5                Carbon Dioxide Uptake in Grass Plants #> 6       Weight versus age of chicks on different diets #> 7                                 Elisa assay of DNase #> 8   Daily Closing Prices of Major European Stock Indic #> 9                        Determination of Formaldehyde #> 10           Hair and Eye Color of Statistics Students #> 11                                  Harman Example 2.3 #> 12                                  Harman Example 7.4 #> 13                    Pharmacokinetics of Indomethacin #> 14                      Effectiveness of Insect Sprays #> 15      Quarterly Earnings per Johnson & Johnson Share #> 16                       Level of Lake Huron 1875-1972 #> 17                Intercountry Life-Cycle Savings Data #> 18                       Growth of Loblolly pine trees #> 19                              Flow of the River Nile #> 20                              Growth of Orange Trees #> 21                           Potency of Orchard Sprays #> 22          Results from an Experiment on Plant Growth #> 23          Reaction Velocity of an Enzymatic Reaction #> 24            Road Casualties in Great Britain 1969-84 #> 25                    Pharmacokinetics of Theophylline #> 26               Survival of passengers on the Titanic #> 27  The Effect of Vitamin C on Tooth Growth in Guinea  #> 28                   Student Admissions at UC Berkeley #> 29            Road Casualties in Great Britain 1969-84 #> 30                        UK Quarterly Gas Consumption #> 31               Accidental Deaths in the US 1973-1978 #> 32                     Violent Crime Rates by US State #> 33  Lawyers' Ratings of State Judges in the US Superio #> 34                           Personal Expenditure Data #> 35  Distances Between European Cities and Between US C #> 36                      Death Rates in Virginia (1940) #> 37                           Internet Usage per Minute #> 38                              The World's Telephones #> 39                      Ability and Intelligence Tests #> 40  Passenger Miles on Commercial US Airlines, 1937-19 #> 41                   New York Air Quality Measurements #> 42  Anscombe's Quartet of 'Identical' Simple Linear Re #> 43                   The Joyner-Boore Attenuation Data #> 44                  The Chatterjee-Price Attitude Data #> 45  Quarterly Time Series of the Number of Australian  #> 46              Body Temperature Series of Two Beavers #> 47              Body Temperature Series of Two Beavers #> 48                Speed and Stopping Distances of Cars #> 49                        Chicken Weights by Feed Type #> 50             Mauna Loa Atmospheric CO2 Concentration #> 51                       Student's 3000 Criminals Data #> 52             Yearly Numbers of Important Discoveries #> 53           Smoking, Alcohol and (O)esophageal Cancer #> 54                 Conversion Rates of Euro Currencies #> 55                 Conversion Rates of Euro Currencies #> 56  Distances Between European Cities and Between US C #> 57                            Old Faithful Geyser Data #> 58         Monthly Deaths from Lung Diseases in the UK #> 59                               Freeny's Revenue Data #> 60                               Freeny's Revenue Data #> 61                               Freeny's Revenue Data #> 62  Infertility after Spontaneous and Induced Abortion #> 63                          Edgar Anderson's Iris Data #> 64                          Edgar Anderson's Iris Data #> 65               Areas of the World's Major Landmasses #> 66         Monthly Deaths from Lung Diseases in the UK #> 67                Luteinizing Hormone in Blood Samples #> 68                  Longley's Economic Regression Data #> 69            Annual Canadian Lynx trappings 1821-1934 #> 70         Monthly Deaths from Lung Diseases in the UK #> 71                       Michelson Speed of Light Data #> 72                          Motor Trend Car Road Tests #> 73            Average Yearly Temperatures in New Haven #> 74  Average Monthly Temperatures at Nottingham, 1920-1 #> 75              Classical N, P, K Factorial Experiment #> 76       Occupational Status of Fathers and their Sons #> 77                   Annual Precipitation in US Cities #> 78         Quarterly Approval Ratings of US Presidents #> 79  Vapor Pressure of Mercury as a Function of Tempera #> 80                   Locations of Earthquakes off Fiji #> 81    Random Numbers from Congruential Generator RANDU #> 82              Lengths of Major North American Rivers #> 83              Measurements on Petroleum Rock Samples #> 84                                Student's Sleep Data #> 85                    Brownlee's Stack Loss Plant Data #> 86                    Brownlee's Stack Loss Plant Data #> 87                    Brownlee's Stack Loss Plant Data #> 88                          US State Facts and Figures #> 89                          US State Facts and Figures #> 90                          US State Facts and Figures #> 91                          US State Facts and Figures #> 92                          US State Facts and Figures #> 93                          US State Facts and Figures #> 94                          US State Facts and Figures #> 95        Monthly Sunspot Data, from 1749 to \"Present\" #> 96                      Yearly Sunspot Data, 1700-1988 #> 97                  Monthly Sunspot Numbers, 1749-1983 #> 98  Swiss Fertility and Socioeconomic Indicators (1888 #> 99                    Yearly Treering Data, -6000-1979 #> 100 Diameter, Height and Volume for Black Cherry Trees #> 101              Populations Recorded by the US Census #> 102 Topographic Information on Auckland's Maunga Whau  #> 103        The Number of Breaks in Yarn during Weaving #> 104     Average Heights and Weights for American Women"},{"path":"http://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":null,"dir":"Reference","previous_headings":"","what":"Dayton Student Survey on Substance Use — DaytonSurvey","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"data, Agresti (2002), Table 9.1, gives result 1992 survey Dayton Ohio  2276 high school seniors whether ever used  alcohol, cigarettes marijuana.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"","code":"data(DaytonSurvey)"},{"path":"http://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"frequency data frame 32 observations following 6 variables. cigarette factor levels Yes alcohol factor levels Yes marijuana factor levels Yes sex factor levels female male race factor levels white Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"Agresti uses letters G (sex), R (race), (alcohol), C (cigarette), M (marijuana) refer table variables, usage followed examples . Background variables include sex race respondent (GR), typically treated explanatory, model full table include term sex:race. Models reduced table, collapsed sex race entirely unreasonable, permit estimation effects variables responses. full 5-way table contains number cells counts 0 1, well many cells large counts, even ACM table collapsed GR small cell counts.  Consequently,  residuals models mosaic displays best represented standardized (adjusted) residuals.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"Agresti, . (2002). Categorical Data Analysis, 2nd Ed., New York: Wiley-Interscience, Table 9.1, p. 362.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"Thompson, L. (2009). R (S-PLUS) Manual Accompany Agresti's Categorical Data, http://www.stat.ufl.edu/~aa/cda/Thompson_manual.pdf","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/DaytonSurvey.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dayton Student Survey on Substance Use — DaytonSurvey","text":"","code":"data(DaytonSurvey)  mod.GR <- glm(Freq ~ . + sex*race, data=DaytonSurvey, family=poisson)  # mutual independence + GR mod.homog.assoc <- glm(Freq ~ .^2, data=DaytonSurvey, family=poisson)  # homogeneous association  # collapse over sex and race Dayton.ACM <- aggregate(Freq ~ cigarette+alcohol+marijuana, data=DaytonSurvey, FUN=sum)"},{"path":"http://friendly.github.io/vcdExtra/reference/Depends.html","id":null,"dir":"Reference","previous_headings":"","what":"Dependencies of R Packages — Depends","title":"Dependencies of R Packages — Depends","text":"one-way table gives type-token distribution number dependencies declared 4983 packages listed CRAN January 17, 2014.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Depends.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dependencies of R Packages — Depends","text":"","code":"data(Depends)"},{"path":"http://friendly.github.io/vcdExtra/reference/Depends.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dependencies of R Packages — Depends","text":"format :  'table' int [1:15(1d)] 986 1347 993 685 375 298 155 65 32 19 ...  - attr(*, \"dimnames\")=List 1   ..$ Depends: chr [1:15] \"0\" \"1\" \"2\" \"3\" ...","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Depends.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dependencies of R Packages — Depends","text":"Using code https://blog.revolutionanalytics.com/2013/12/-look---distribution--r-package-dependencies.html","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Depends.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dependencies of R Packages — Depends","text":"","code":"data(Depends) plot(Depends, xlab=\"Number of Dependencies\", ylab=\"Number of R Packages\", lwd=8)   if (FALSE) { # The code below, from Joseph Rickert, downloads and tabulates the data p <- as.data.frame(available.packages(),stringsAsFactors=FALSE) names(p)  pkgs <- data.frame(p[,c(1,4)])                  # Pick out Package names and Depends row.names(pkgs) <- NULL                         # Get rid of row names pkgs <- pkgs[complete.cases(pkgs[,2]),]         # Remove NAs  pkgs$Depends2 <-strsplit(pkgs$Depends,\",\")      # split list of Depends pkgs$numDepends <- as.numeric(lapply(pkgs$Depends2,length)) # Count number of dependencies in list zeros <- c(rep(0,dim(p)[1] - dim(pkgs)[1]))     # Account for packages with no dependencies Deps <- as.vector(c(zeros,pkgs$numDepends))     # Set up to tablate Depends <- table(Deps)  }"},{"path":"http://friendly.github.io/vcdExtra/reference/Detergent.html","id":null,"dir":"Reference","previous_headings":"","what":"Detergent preference data — Detergent","title":"Detergent preference data — Detergent","text":"Cross-classification sample 1008 consumers according  () softness laundry water used, (b) previous use detergent Brand M, (c) temperature laundry water used (d) expressed preference Brand X Brand M blind trial.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Detergent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detergent preference data — Detergent","text":"","code":"data(Detergent)"},{"path":"http://friendly.github.io/vcdExtra/reference/Detergent.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Detergent preference data — Detergent","text":"    4-dimensional array resulting cross-tabulating    4 variables  1008 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Detergent.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Detergent preference data — Detergent","text":"Fienberg, S. E. (1980). Analysis Cross-Classified Categorical Data Cambridge, MA: MIT Press, p. 71.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Detergent.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Detergent preference data — Detergent","text":"Ries, P. N. & Smith, H. (1963). use chi-square preference testing multidimensional problems.  Chemical Engineering Progress, 59, 39-43.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Detergent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Detergent preference data — Detergent","text":"","code":"data(Detergent)  # example goes here mosaic(Detergent, shade=TRUE)   require(MASS) (det.mod0 <- loglm(~ Preference + Temperature + M_User + Water_softness, data=Detergent)) #> Call: #> loglm(formula = ~Preference + Temperature + M_User + Water_softness,  #>     data = Detergent) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 42.92866 18 0.0008190181 #> Pearson          43.90225 18 0.0005957483 # examine addition of two-way terms add1(det.mod0, ~ .^2, test=\"Chisq\") #> Single term additions #>  #> Model: #> ~Preference + Temperature + M_User + Water_softness #>                            Df    AIC     LRT  Pr(>Chi)     #> <none>                        54.929                       #> Preference:Temperature      1 52.567  4.3616   0.03676 *   #> Preference:M_User           1 36.347 20.5815 5.715e-06 *** #> Preference:Water_softness   2 58.533  0.3953   0.82066     #> Temperature:M_User          1 55.676  1.2531   0.26296     #> Temperature:Water_softness  2 52.830  6.0991   0.04738 *   #> M_User:Water_softness       2 57.854  1.0751   0.58418     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # model for Preference as a response (det.mod1 <- loglm(~ Preference + (Temperature * M_User * Water_softness), data=Detergent)) #> Call: #> loglm(formula = ~Preference + (Temperature * M_User * Water_softness),  #>     data = Detergent) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 32.82562 11 0.0005615017 #> Pearson          32.46939 11 0.0006410272 mosaic(det.mod0)"},{"path":"http://friendly.github.io/vcdExtra/reference/Donner.html","id":null,"dir":"Reference","previous_headings":"","what":"Survival in the Donner Party — Donner","title":"Survival in the Donner Party — Donner","text":"data frame contains information members Donner Party, group people attempted migrate California 1846. trapped early blizzard eastern side Sierra Nevada mountains, rescued,  nearly half party died. factors affected lived died?","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Donner.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Survival in the Donner Party — Donner","text":"","code":"data(Donner)"},{"path":"http://friendly.github.io/vcdExtra/reference/Donner.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Survival in the Donner Party — Donner","text":"data frame 90 observations following 5 variables. family family name, factor 10 levels age age person, numeric vector sex factor levels Female Male survived numeric vector, 0 1 death date death died rescue, POSIXct","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Donner.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Survival in the Donner Party — Donner","text":"data frame uses person's name row labels. family reflects recoding last names individuals reduce number factor levels. main families Donner party : Donner, Graves, Breen Reed. families Murphy, Foster Pike grouped 'MurFosPik', Fosdick Wolfinger coded 'FosdWolf', others ''.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Donner.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Survival in the Donner Party — Donner","text":"D. K. Grayson, 1990, \"Donner party deaths: demographic assessment\", J. Anthropological Research, 46, 223-242. Johnson, K. (1996). Unfortunate Emigrants: Narratives Donner Party.  Logan, UT: Utah State University Press.  Additions, dates death http://user.xmission.com/~octa/DonnerParty/Roster.htm.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Donner.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Survival in the Donner Party — Donner","text":"Ramsey, F.L. Schafer, D.W. (2002).  Statistical Sleuth: Course Methods Data Analysis, (2nd ed), Duxbury. Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Donner.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Survival in the Donner Party — Donner","text":"","code":"# conditional density plots op <- par(mfrow=c(1,2), cex.lab=1.5) cdplot(factor(survived) ~ age, subset=sex=='Male', data=Donner,      main=\"Donner party: Males\", ylevels=2:1, ylab=\"Survived\", yaxlabels=c(\"yes\", \"no\")) with(Donner, rug(jitter(age[sex==\"Male\"]), col=\"white\", quiet=TRUE)) cdplot(factor(survived) ~ age, subset=sex=='Female', data=Donner,      main=\"Donner party: Females\", ylevels=2:1, ylab=\"Survived\", yaxlabels=c(\"yes\", \"no\")) with(Donner, rug(jitter(age[sex==\"Female\"]), col=\"white\", quiet=TRUE))  par(op)   # fit some models (mod1 <- glm(survived ~ age + sex, data=Donner, family=binomial)) #>  #> Call:  glm(formula = survived ~ age + sex, family = binomial, data = Donner) #>  #> Coefficients: #> (Intercept)          age      sexMale   #>      1.5992      -0.0338      -1.2068   #>  #> Degrees of Freedom: 89 Total (i.e. Null);  87 Residual #> Null Deviance:\t    124.4  #> Residual Deviance: 111.1 \tAIC: 117.1 (mod2 <- glm(survived ~ age * sex, data=Donner, family=binomial)) #>  #> Call:  glm(formula = survived ~ age * sex, family = binomial, data = Donner) #>  #> Coefficients: #> (Intercept)          age      sexMale  age:sexMale   #>     1.85515     -0.04565     -1.62177      0.01957   #>  #> Degrees of Freedom: 89 Total (i.e. Null);  86 Residual #> Null Deviance:\t    124.4  #> Residual Deviance: 110.7 \tAIC: 118.7 anova(mod2, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model: binomial, link: logit #>  #> Response: survived #>  #> Terms added sequentially (first to last) #>  #>  #>         Df Deviance Resid. Df Resid. Dev Pr(>Chi)    #> NULL                       89     124.37             #> age      1   6.5113        88     117.86 0.010719 *  #> sex      1   6.7274        87     111.13 0.009494 ** #> age:sex  1   0.4003        86     110.73 0.526922    #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  (mod3 <- glm(survived ~ poly(age,2) * sex, data=Donner, family=binomial)) #>  #> Call:  glm(formula = survived ~ poly(age, 2) * sex, family = binomial,  #>     data = Donner) #>  #> Coefficients: #>           (Intercept)          poly(age, 2)1          poly(age, 2)2   #>                0.7622               -26.9689               -30.5626   #>               sexMale  poly(age, 2)1:sexMale  poly(age, 2)2:sexMale   #>               -1.0996                22.7211                28.8976   #>  #> Degrees of Freedom: 89 Total (i.e. Null);  84 Residual #> Null Deviance:\t    124.4  #> Residual Deviance: 97.8 \tAIC: 109.8 anova(mod3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model: binomial, link: logit #>  #> Response: survived #>  #> Terms added sequentially (first to last) #>  #>  #>                  Df Deviance Resid. Df Resid. Dev Pr(>Chi)    #> NULL                                89    124.366             #> poly(age, 2)      2   9.5441        87    114.822 0.008463 ** #> sex               1   8.0908        86    106.731 0.004449 ** #> poly(age, 2):sex  2   8.9321        84     97.799 0.011492 *  #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 LRstats(glmlist(mod1, mod2, mod3)) #> Likelihood summary table: #>         AIC    BIC LR Chisq Df Pr(>Chisq)   #> mod1 117.13 124.63  111.128 87    0.04159 * #> mod2 118.73 128.73  110.727 86    0.03755 * #> mod3 109.80 124.80   97.799 84    0.14408   #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # plot fitted probabilities from mod2 and mod3 # idea from: http://www.ling.upenn.edu/~joseff/rstudy/summer2010_ggplot2_intro.html library(ggplot2)  # separate linear fits on age for M/F ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\", method.args = list(family = binomial), formula = y ~ x,            alpha = 0.2, size=2, aes(fill = sex))   # separate quadratics ggplot(Donner, aes(age, survived, color = sex)) +   geom_point(position = position_jitter(height = 0.02, width = 0)) +   stat_smooth(method = \"glm\", method.args = list(family = binomial), formula = y ~ poly(x,2),            alpha = 0.2, size=2, aes(fill = sex))"},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970.html","id":null,"dir":"Reference","previous_headings":"","what":"USA 1970 Draft Lottery Data — Draft1970","title":"USA 1970 Draft Lottery Data — Draft1970","text":"data set gives results 1970 US draft lottery, form data frame.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"USA 1970 Draft Lottery Data — Draft1970","text":"","code":"data(Draft1970)"},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"USA 1970 Draft Lottery Data — Draft1970","text":"data frame 366 observations following 3 variables. Day day year, 1:366 Rank draft priority rank people born day Month ordered factor levels Jan < Feb ... < Dec","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"USA 1970 Draft Lottery Data — Draft1970","text":"draft lottery used determine order eligible men called Selective Service draft. days year (including  February 29) represented  numbers 1 366 written slips paper. slips placed separate plastic capsules  mixed  shoebox  dumped  deep glass jar. Capsules drawn jar one time. first  number drawn  258  (September 14),   registrants birthday assigned lottery number Rank 1. second number drawn corresponded April 24, forth.  men draft age  (born 1944 1950)  shared birthdate called serve . first 195 birthdates drawn  later called  serve   order  drawn;  last   September 24.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"USA 1970 Draft Lottery Data — Draft1970","text":"Starr, N. (1997). Nonrandom Risk: 1970 Draft Lottery, Journal Statistics Education, v.5, n.2 http://jse.amstat.org/v5n2/datasets.starr.html","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"USA 1970 Draft Lottery Data — Draft1970","text":"Fienberg, S. E. (1971),  \"Randomization Social Affairs: 1970 Draft Lottery,\" Science, 171, 255-261. https://en.wikipedia.org/wiki/Draft_lottery_(1969)","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"USA 1970 Draft Lottery Data — Draft1970","text":"","code":"data(Draft1970) # scatterplot plot(Rank ~ Day, data=Draft1970) with(Draft1970, lines(lowess(Day, Rank), col=\"red\", lwd=2)) abline(lm(Rank ~ Day, data=Draft1970), col=\"blue\")    # boxplots plot(Rank ~ Month, data=Draft1970, col=\"bisque\")   lm(Rank ~ Month, data=Draft1970) #>  #> Call: #> lm(formula = Rank ~ Month, data = Draft1970) #>  #> Coefficients: #> (Intercept)      Month.L      Month.Q      Month.C      Month^4      Month^5   #>     183.528      -84.330      -31.503        5.020      -20.904      -14.052   #>     Month^6      Month^7      Month^8      Month^9     Month^10     Month^11   #>       2.122        3.488       21.150        1.747       15.582        1.126   #>  anova(lm(Rank ~ Month, data=Draft1970)) #> Analysis of Variance Table #>  #> Response: Rank #>            Df  Sum Sq Mean Sq F value  Pr(>F)    #> Month      11  290507   26410  2.4634 0.00558 ** #> Residuals 354 3795120   10721                    #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # make the table version Draft1970$Risk <- cut(Draft1970$Rank, breaks=3, labels=c(\"High\", \"Med\", \"Low\")) with(Draft1970, table(Month, Risk)) #>      Risk #> Month High Med Low #>   Jan    9  12  10 #>   Feb    7  12  10 #>   Mar    5  10  16 #>   Apr    8   8  14 #>   May    9   7  15 #>   Jun   11   7  12 #>   Jul   12   7  12 #>   Aug   13   7  11 #>   Sep   10  15   5 #>   Oct    9  15   7 #>   Nov   12  12   6 #>   Dec   17  10   4"},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":null,"dir":"Reference","previous_headings":"","what":"USA 1970 Draft Lottery Table — Draft1970table","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"data set gives results 1970 US draft lottery, form frequency table. rows months year, Jan--Dec columns  give number days month fall three draft risk categories High, Medium, Low, corresponding chances called serve US army.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"","code":"data(Draft1970table)"},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"format :  'table' int [1:12, 1:3] 9 7 5 8 9 11 12 13 10 9 ...  - attr(*, \"dimnames\")=List 2   ..$ Month: chr [1:12] \"Jan\" \"Feb\" \"Mar\" \"Apr\" ...   ..$ Risk : chr [1:3] \"High\" \"Med\" \"Low\"","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"lottery numbers divided three categories   risk called draft -- High, Medium, Low --  representing roughly one third days year.  birthdays highest risk lottery numbers  1-122, medium risk numbers 123-244, lowest risk  category contains lottery numbers 245-366.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"data available several forms, table version obtained https://sas.uwaterloo.ca/~rwoldfor/software/eikosograms/data/draft-70","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"Fienberg, S. E. (1971),  \"Randomization Social Affairs: 1970 Draft Lottery,\" Science, 171, 255-261. Starr, N. (1997). Nonrandom Risk: 1970 Draft Lottery, Journal Statistics Education, v.5, n.2 http://jse.amstat.org/v5n2/datasets.starr.html","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Draft1970table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"USA 1970 Draft Lottery Table — Draft1970table","text":"","code":"data(Draft1970table) chisq.test(Draft1970table) #>  #> \tPearson's Chi-squared test #>  #> data:  Draft1970table #> X-squared = 37.156, df = 22, p-value = 0.02274 #>   # plot.table -> graphics:::mosaicplot plot(Draft1970table, shade=TRUE)  mosaic(Draft1970table, gp=shading_Friendly)   # correspondence analysis if(require(ca)) {   ca(Draft1970table)   plot(ca(Draft1970table)) }   # convert to a frequency data frame with ordered factors Draft1970df <- as.data.frame(Draft1970table)  Draft1970df <- within(Draft1970df, {   Month <- ordered(Month)   Risk <- ordered(Risk, levels=rev(levels(Risk)))   }) str(Draft1970df) #> 'data.frame':\t36 obs. of  3 variables: #>  $ Month: Ord.factor w/ 12 levels \"Jan\"<\"Feb\"<\"Mar\"<..: 1 2 3 4 5 6 7 8 9 10 ... #>  $ Risk : Ord.factor w/ 3 levels \"Low\"<\"Med\"<\"High\": 3 3 3 3 3 3 3 3 3 3 ... #>  $ Freq : int  9 7 5 8 9 11 12 13 10 9 ...  # similar model, as a Poisson GLM   indep <- glm(Freq ~ Month + Risk, family = poisson, data = Draft1970df)  mosaic(indep, residuals_type=\"rstandard\", gp=shading_Friendly) #> Warning: no formula provided, assuming ~Month + Risk   # numeric scores for tests of ordinal factors Cscore <- as.numeric(Draft1970df$Risk) Rscore <- as.numeric(Draft1970df$Month)  # linear x linear association between Month and Risk linlin <- glm(Freq ~ Month + Risk + Rscore:Cscore, family = poisson, data = Draft1970df)  # compare models anova(indep, linlin, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Month + Risk #> Model 2: Freq ~ Month + Risk + Rscore:Cscore #>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     #> 1        22     38.261                           #> 2        21     23.885  1   14.376 0.0001497 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 mosaic(linlin, residuals_type=\"rstandard\", gp=shading_Friendly) #> Warning: no formula provided, assuming ~Month + Risk"},{"path":"http://friendly.github.io/vcdExtra/reference/Dyke.html","id":null,"dir":"Reference","previous_headings":"","what":"Sources of Knowledge of Cancer — Dyke","title":"Sources of Knowledge of Cancer — Dyke","text":"Observational data sample 1729 individuals, cross-classified 2^5 table according sources  information (read newspapers, listen radio, 'solid' reading, attend lectures) whether good poor knowledge regarding cancer.  Knowledge cancer often treated response.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Dyke.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sources of Knowledge of Cancer — Dyke","text":"","code":"data(Dyke)"},{"path":"http://friendly.github.io/vcdExtra/reference/Dyke.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sources of Knowledge of Cancer — Dyke","text":"5-dimensional array resulting cross-tabulating 5 variables  1729 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Dyke.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sources of Knowledge of Cancer — Dyke","text":"Fienberg, S. E. (1980). Analysis Cross-Classified Categorical Data Cambridge, MA: MIT Press, p. 85, Table 5-6.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Dyke.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sources of Knowledge of Cancer — Dyke","text":"Dyke, G. V. Patterson, H. D. (1952). Analysis factorial arrangements data proportions. Biometrics, 8, 1-12. Lindsey, J. K. (1993).  Models Repeated Measurements Oxford, UK: Oxford University Press, p. 57.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Dyke.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sources of Knowledge of Cancer — Dyke","text":"","code":"data(Dyke)  # independence model mosaic(Dyke, shade=TRUE)   # null model, Knowledge as response, independent of others require(MASS) dyke.mod0 <- loglm(~ Knowledge + (Reading * Radio * Lectures * Newspaper), data=Dyke) dyke.mod0 #> Call: #> loglm(formula = ~Knowledge + (Reading * Radio * Lectures * Newspaper),  #>     data = Dyke) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 216.2594 15        0 #> Pearson          207.5194 15        0 mosaic(dyke.mod0)   # view as doubledecker plot Dyke <- Dyke[2:1,,,,]    # make Good the highlighted value of Knowledge doubledecker(Knowledge ~ ., data=Dyke)  # better version, with some options doubledecker(Knowledge ~ Lectures + Reading + Newspaper + Radio, data=Dyke,   margins = c(1,6, length(dim(Dyke)) + 1, 1),    fill_boxes=list(rep(c(\"white\", gray(.90)),4))   )   # separate (conditional) plots for those who attend lectures and those who do not doubledecker(Knowledge ~ Reading + Newspaper + Radio, data=Dyke[,,,1,],   main=\"Do not attend lectures\",   margins = c(1,6, length(dim(Dyke)) + 1, 1),    fill_boxes=list(rep(c(\"white\", gray(.90)),3))   )  doubledecker(Knowledge ~ Reading + Newspaper + Radio, data=Dyke[,,,2,],   main=\"Attend lectures\",   margins = c(1,6, length(dim(Dyke)) + 1, 1),    fill_boxes=list(rep(c(\"white\", gray(.90)),3))   )    drop1(dyke.mod0, test=\"Chisq\") #> Single term deletions #>  #> Model: #> ~Knowledge + (Reading * Radio * Lectures * Newspaper) #>                                  Df    AIC    LRT Pr(>Chi)     #> <none>                              250.26                     #> Knowledge                         1 338.37 90.114   <2e-16 *** #> Reading:Radio:Lectures:Newspaper  1 248.63  0.374   0.5406     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand a frequency table to case form — expand.dft","title":"Expand a frequency table to case form — expand.dft","text":"Converts frequency table, given either table object data frame frequency form  data frame representing individual observations table.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand a frequency table to case form — expand.dft","text":"","code":"expand.dft(x, var.names = NULL, freq = \"Freq\", ...)  expand.table(x, var.names = NULL, freq = \"Freq\", ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand a frequency table to case form — expand.dft","text":"x table object, data frame frequency form containing factors one numeric variable   representing cell frequency combination factors. var.names list variable names factors, wish override already table freq name frequency variable table ... arguments passed type.convert.  particular, pay attention    na.strings (default: na.strings=NA missing cells) .  (default: .=FALSE, converting character vectors factors).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Expand a frequency table to case form — expand.dft","text":"expand.table synonym expand.dft.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand a frequency table to case form — expand.dft","text":"data frame containing factors table many observations represented total freq variable.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Expand a frequency table to case form — expand.dft","text":"Originally posted R-Help, Jan 20, 2009, http://tolstoy.newcastle.edu.au/R/e6/help/09/01/1873.html Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Expand a frequency table to case form — expand.dft","text":"Mark Schwarz","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/expand.dft.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Expand a frequency table to case form — expand.dft","text":"","code":"library(vcd) art <- xtabs(~Treatment + Improved, data = Arthritis) art #>          Improved #> Treatment None Some Marked #>   Placebo   29    7      7 #>   Treated   13    7     21 artdf <- expand.dft(art) str(artdf) #> 'data.frame':\t84 obs. of  2 variables: #>  $ Treatment: chr  \"Placebo\" \"Placebo\" \"Placebo\" \"Placebo\" ... #>  $ Improved : chr  \"None\" \"None\" \"None\" \"None\" ...  # 1D case (tab <- table(sample(head(letters), 20, replace=TRUE))) #>  #> a b c d e  #> 5 3 2 4 6  expand.table(tab, var.names=\"letter\") #>    letter #> 1       a #> 2       a #> 3       a #> 4       a #> 5       a #> 6       b #> 7       b #> 8       b #> 9       c #> 10      c #> 11      d #> 12      d #> 13      d #> 14      d #> 15      e #> 16      e #> 17      e #> 18      e #> 19      e #> 20      e"},{"path":"http://friendly.github.io/vcdExtra/reference/Fungicide.html","id":null,"dir":"Reference","previous_headings":"","what":"Carcinogenic Effects of a Fungicide — Fungicide","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"Data Gart (1971) carcinogenic effects certain fungicide two strains mice. interest association group (Control, Treated) outcome (Tumor, Tumor) varies sex strain mice. Breslow (1976) used data illustrate application linear models log odds ratios.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"","code":"data(Fungicide)"},{"path":"http://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"data comprise set four 2 x 2 tables classifying 403 mice, either \tControl Treated whether tumor later observed.   \tfour groups represent combinations sex strain mice.   format :  num [1:2, 1:2, 1:2, 1:2] 5 4 74 12 3 2 84 14 10 4 ...  - attr(*, \"dimnames\")=List 4   ..$ group  : chr [1:2] \"Control\" \"Treated\"   ..$ outcome: chr [1:2] \"Tumor\" \"NoTumor\"   ..$ sex    : chr [1:2] \"M\" \"F\"   ..$ strain : chr [1:2] \"1\" \"2\"","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"tables small cells, continuity correction recommended.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"Gart, J. J. (1971). comparison proportions: review significance tests,    confidence intervals adjustments stratification.     International Statistical Review,    39, 148-169.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"Breslow, N. (1976), Regression analysis log odds ratio:    method retrospective studies, Biometrics, 32(3), 409-416.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Fungicide.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Carcinogenic Effects of a Fungicide — Fungicide","text":"","code":"data(Fungicide) # loddsratio was moved to vcd; requires vcd_1.3-3+ if (FALSE) { if (require(vcd)) { fung.lor <- loddsratio(Fungicide, correct=TRUE) fung.lor confint(fung.lor) } }  # visualize odds ratios in fourfold plots cotabplot(Fungicide, panel=cotab_fourfold)  #  -- fourfold() requires vcd >= 1.2-10 fourfold(Fungicide, p_adjust_method=\"none\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Geissler.html","id":null,"dir":"Reference","previous_headings":"","what":"Geissler's Data on the Human Sex Ratio — Geissler","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"Geissler (1889) published data distributions boys girls families  Saxony, collected period 1876-1885. Geissler data tabulates  family composition 991,958 families number boys girls listed table supplied Edwards (1958, Table 1).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Geissler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"","code":"data(Geissler)"},{"path":"http://friendly.github.io/vcdExtra/reference/Geissler.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"data frame 90 observations following 4 variables.  rows represent   non-NA entries Edwards' table. boys number boys family, 0:12 girls number girls family, 0:12 size family size: boys+girls Freq number families sex composition","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Geissler.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"data family composition available , birth child, parents state sex children birth certificate. family records necessarily independent, given family may several children 10 year period, included  multiple records.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Geissler.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"Edwards, . W. F. (1958). Analysis Geissler's Data Human Sex Ratio. Annals Human Genetics,  23, 6-15.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Geissler.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Geissler, . (1889). Beitrage zur Frage des Geschlechts verhaltnisses der Geborenen Z. K. Sachsischen Statistischen Bureaus, 35, n.p. Lindsey, J. K. & Altham, P. M. E. (1998).  Analysis human sex ratio using overdispersion models. Journal Royal Statistical Society: Series C (Applied Statistics),  47, 149-157.","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Geissler.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Geissler's Data on the Human Sex Ratio — Geissler","text":"","code":"data(Geissler) ## maybe str(Geissler) ; plot(Geissler) ...  # reproduce Saxony data, families of size 12 Saxony12<-subset(Geissler, size==12, select=c(boys, Freq)) rownames(Saxony12)<-NULL  # make a 1-way table xtabs(Freq~boys, Saxony12) #> boys #>    0    1    2    3    4    5    6    7    8    9   10   11   12  #>    3   24  104  286  670 1033 1343 1112  829  478  181   45    7   # extract data for other family sizes Saxony11<-subset(Geissler, size==11, select=c(boys, Freq)) rownames(Saxony11)<-NULL Saxony10<-subset(Geissler, size==10, select=c(boys, Freq)) rownames(Saxony10)<-NULL"},{"path":"http://friendly.github.io/vcdExtra/reference/Gilby.html","id":null,"dir":"Reference","previous_headings":"","what":"Clothing and Intelligence Rating of Children — Gilby","title":"Clothing and Intelligence Rating of Children — Gilby","text":"Schoolboys classified according clothing teachers rating \"dullness\" (lack intelligence), 5 x 7 table originally  Gilby (1911). Anscombe (1981) presents slightly collapsed 4 x 6 table, used ,  last two categories clothing pooled first two categories dullness due small counts. Dullnes Clothing ordered categories, models methods examine association terms ordinal categories profitable.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Gilby.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clothing and Intelligence Rating of Children — Gilby","text":"","code":"data(Gilby)"},{"path":"http://friendly.github.io/vcdExtra/reference/Gilby.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Clothing and Intelligence Rating of Children — Gilby","text":"    2-dimensional array resulting cross-tabulating    2 variables  1725 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Gilby.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Clothing and Intelligence Rating of Children — Gilby","text":"Anscombe, F. J. (1981). Computing Statistical Science APL. New York: Springer-Verlag, p. 302","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Gilby.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Clothing and Intelligence Rating of Children — Gilby","text":"Gilby, W. H. (1911).    significance teacher's appreciation    general intelligence.  Biometrika, 8, 93-108 (esp. p. 94).    [Quoted Kendall (1943,..., 1953) Table 13.1, p 320.]","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Gilby.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clothing and Intelligence Rating of Children — Gilby","text":"","code":"data(Gilby)  mosaic(Gilby, shade=TRUE)   # correspondence analysis to see relations among categories if(require(ca)){   ca(Gilby)   plot(ca(Gilby))   title(xlab=\"Dimension 1\", ylab=\"Dimension 2\") }"},{"path":"http://friendly.github.io/vcdExtra/reference/GKgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Goodman-Kruskal \\(\\gamma\\) statistic measure association ordinal factors two-way table proposed Goodman Kruskal (1954).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"","code":"GKgamma(x, level = 0.95)  <!-- %\\method{print}{GKgamma}{x, digits = 3, ...} -->"},{"path":"http://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"x two-way frequency table, matrix table form.  rows columns   \tconsidered ordinal factors level Confidence level significance test \\(\\gamma \\ne =\\)","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Returns object class \"GKgamma\" 6 components, follows gamma gamma statistic C Total number concordant pairs table D Total number discordant pairs table sigma Standard error gamma CIlevel Confidence level CI Confidence interval","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Agresti, . Categorical Data Analysis. John Wiley & Sons, 2002, pp. 57--59. Goodman, L. ., & Kruskal, W. H. (1954). Measures association cross classifications. Journal American Statistical Association, 49, 732-764. Goodman, L. ., & Kruskal, W. H. (1963). Measures association cross classifications III: Approximate sampling theory. Journal American Statistical Association, 58, 310-364.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"Michael Friendly; original version Laura Thompson","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/GKgamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Goodman-Kruskal Gamma for ordered tables — GKgamma","text":"","code":"data(JobSat) GKgamma(JobSat) #> gamma        : 0.221  #> std. error   : 0.117  #> CI           : -0.009 0.451"},{"path":"http://friendly.github.io/vcdExtra/reference/Glass.html","id":null,"dir":"Reference","previous_headings":"","what":"British Social Mobility from Glass(1954) — Glass","title":"British Social Mobility from Glass(1954) — Glass","text":"Glass(1954) gave 5 x 5 table occupations 3500 British fathers sons.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Glass.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"British Social Mobility from Glass(1954) — Glass","text":"","code":"data(\"Glass\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Glass.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"British Social Mobility from Glass(1954) — Glass","text":"frequency data frame 25 observations following 3 variables representing 5 x 5 table 3500 cases. father factor levels Managerial Professional Skilled Supervisory Unskilled son factor levels Managerial Professional Skilled Supervisory Unskilled Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Glass.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"British Social Mobility from Glass(1954) — Glass","text":"occupational categories order status : (1) Professional \\& High Administrative (2) Managerial, Executive \\& High Supervisory (3) Low Inspectional \\& Supervisory (4) Routine Nonmanual \\& Skilled Manual (5) Semi- \\& Unskilled Manual However, make point factors ordered alphabetically default, Friendly \\& Meyer (2016) introduce data set form given .","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Glass.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"British Social Mobility from Glass(1954) — Glass","text":"Glass, D. V. (1954), Social Mobility Britain. Free Press.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Glass.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"British Social Mobility from Glass(1954) — Glass","text":"Bishop, Y. M. M. Fienberg, S. E. Holland, P. W. (1975). Discrete Multivariate Analysis: Theory Practice, MIT Press. Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Glass.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"British Social Mobility from Glass(1954) — Glass","text":"","code":"data(Glass) glass.tab <- xtabs(Freq ~ father + son, data=Glass)  largs <- list(set_varnames=list(father=\"Father's Occupation\", son=\"Son's Occupation\"),               abbreviate=10) gargs <- list(interpolate=c(1,2,4,8)) mosaic(glass.tab, shade=TRUE, labeling_args=largs, gp_args=gargs,   main=\"Alphabetic order\", legend=FALSE, rot_labels=c(20,90,0,70))   # reorder by status ord <- c(2, 1, 4, 3, 5)  mosaic(glass.tab[ord, ord], shade=TRUE, labeling_args=largs,  gp_args=gargs,   main=\"Effect order\", legend=FALSE, rot_labels=c(20,90,0,70))"},{"path":"http://friendly.github.io/vcdExtra/reference/glmlist.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Model List Object — glmlist","title":"Create a Model List Object — glmlist","text":"glmlist creates glmlist object containing list fitted glm objects names. loglmlist loglm objects. intention provide object classes facilitate model comparison, extraction, summary plotting model components, etc., perhaps using lapply similar. exists anova.glm method glmlist objects.  , coef method also defined, collecting coefficients models single object type determined result.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/glmlist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Model List Object — glmlist","text":"","code":"glmlist(...) loglmlist(...)  # S3 method for glmlist coef(object, result=c(\"list\", \"matrix\", \"data.frame\"), ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/glmlist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Model List Object — glmlist","text":"... One model objects, appropriate function, optionally assigned names list. object glmlist object result type result returned","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/glmlist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a Model List Object — glmlist","text":"arguments glmlist  loglmlist form value name=value. objects inherit appropriate class glm loglm excluded, warning. coef method, coefficients different models matched name list unique names across models.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/glmlist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Model List Object — glmlist","text":"object class glmlistloglmlist, just like list, except model given name attribute.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/glmlist.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create a Model List Object — glmlist","text":"Michael Friendly; coef method John Fox","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/glmlist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Model List Object — glmlist","text":"","code":"data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)                  # use object names mods <- glmlist(indep, coleff, roweff, linlin) names(mods) #> [1] \"indep\"  \"coleff\" \"roweff\" \"linlin\"  # assign new names mods <- glmlist(Indep=indep, Col=coleff, Row=roweff, LinxLin=linlin) names(mods) #> [1] \"Indep\"   \"Col\"     \"Row\"     \"LinxLin\"  LRstats(mods) #> Likelihood summary table: #>            AIC    BIC LR Chisq Df Pr(>Chisq)     #> Indep   209.59 220.19   47.418 15  3.155e-05 *** #> Col     179.00 195.50    6.829 10     0.7415     #> Row     174.45 188.59    6.281 12     0.9013     #> LinxLin 174.07 185.85    9.895 14     0.7698     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  coef(mods, result='data.frame') #>                             Indep        Col        Row     LinxLin #> (Intercept)            4.18756842  4.8631072  4.7061332  3.37942319 #> mental.L               0.04507501  0.6795332 -0.6818052 -0.66051890 #> mental.Q              -0.30073728 -0.3233129 -0.3277282 -0.32176183 #> mental.C               0.39412292  0.3936983  0.1992104  0.39415885 #> ses.L                 -0.04968094 -1.0342736  0.5629992 -0.99933120 #> ses.Q                 -0.30335318 -0.5581022 -0.3328887 -0.33029582 #> ses.C                 -0.19797985 -0.1707521 -0.1979530 -0.19811915 #> ses^4                  0.17490822  0.1230409  0.1749295  0.17494245 #> ses^5                  0.14682648  0.2429662  0.1468266  0.14682693 #> ses1:Rscore                    NA -0.4459213         NA          NA #> ses2:Rscore                    NA -0.4594090         NA          NA #> ses3:Rscore                    NA -0.3342208         NA          NA #> ses4:Rscore                    NA -0.2814884         NA          NA #> ses5:Rscore                    NA -0.1393421         NA          NA #> ses6:Rscore                    NA         NA         NA          NA #> mentalWell:Cscore              NA         NA -0.3068185          NA #> mentalMild:Cscore              NA         NA -0.1617300          NA #> mentalModerate:Cscore          NA         NA -0.1433864          NA #> mentalImpaired:Cscore          NA         NA         NA          NA #> Rscore:Cscore                  NA         NA         NA  0.09068661  #extract model components unlist(lapply(mods, deviance)) #>     Indep       Col       Row   LinxLin  #> 47.417847  6.829334  6.280761  9.895124   res <- lapply(mods, residuals) boxplot(as.data.frame(res), main=\"Residuals from various models\")"},{"path":"http://friendly.github.io/vcdExtra/reference/GSS.html","id":null,"dir":"Reference","previous_headings":"","what":"General Social Survey-- Sex and Party affiliation — GSS","title":"General Social Survey-- Sex and Party affiliation — GSS","text":"Data General Social Survey, 1991, relation  sex party affiliation.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/GSS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"General Social Survey-- Sex and Party affiliation — GSS","text":"","code":"data(GSS)"},{"path":"http://friendly.github.io/vcdExtra/reference/GSS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"General Social Survey-- Sex and Party affiliation — GSS","text":"data frame frequency form 6 observations following 3 variables. sex factor levels female male party factor levels dem indep rep count numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/GSS.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"General Social Survey-- Sex and Party affiliation — GSS","text":"Agresti, . Categorical Data Analysis John Wiley & Sons, 2002, Table 3.11, p. 106.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/GSS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"General Social Survey-- Sex and Party affiliation — GSS","text":"","code":"data(GSS) ## maybe str(GSS) ; plot(GSS) ... (GSStab <- xtabs(count ~ sex + party, data=GSS)) #>         party #> sex      dem indep rep #>   female 279    73 225 #>   male   165    47 191  mod.glm <- glm(count ~ sex + party, family = poisson, data = GSS)"},{"path":"http://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":null,"dir":"Reference","previous_headings":"","what":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"three-way frequency table crossing eye color hair color two places, Caithness Aberdeen, Scotland. data interest Fisher (1940) others mixtures people Nordic, Celtic Anglo-Saxon origin. One tables widely analyzed conjunction RC canonical correlation models categorical data, e.g., Becker Clogg (1989).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"","code":"data(HairEyePlace)"},{"path":"http://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"format :  num [1:4, 1:5, 1:2] 326 688 343 98 38 116 84 48 241 584 ...  - attr(*, \"dimnames\")=List 3   ..$ Eye  : chr [1:4] \"Blue\" \"Light\" \"Medium\" \"Dark\"   ..$ Hair : chr [1:5] \"Fair\" \"Red\" \"Medium\" \"Dark\" ...   ..$ Place: chr [1:2] \"Caithness\" \"Aberdeen\"","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"hair eye colors ordered original source, suggesting form ordered categories.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"data taken colors data logmult.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"Becker, M. P., Clogg, C. C. (1989).  Analysis Sets Two-Way Contingency Tables Using Association Models.  Journal American Statistical Association, 84(405), 142-151. Fisher, R.. (1940) precision discriminant functions.  Annals Eugenics, 10, 422-429.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HairEyePlace.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hair Color and Eye Color in Caithness and Aberdeen — HairEyePlace","text":"","code":"data(HairEyePlace)  # separate mosaics mosaic(HairEyePlace[,,1], shade=TRUE, main=\"Caithness\")  mosaic(HairEyePlace[,,2], shade=TRUE, main=\"Aberdeen\")   # condition on Place mosaic(~Hair + Eye |Place, data=HairEyePlace, shade=TRUE, legend=FALSE)   cotabplot(~Hair+Eye|Place, data=HairEyePlace, shade=TRUE, legend=FALSE)"},{"path":"http://friendly.github.io/vcdExtra/reference/Hauser79.html","id":null,"dir":"Reference","previous_headings":"","what":"Hauser (1979) Data on Social Mobility — Hauser79","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"Hauser (1979) presented two-way frequency table, cross-classifying occupational categories sons fathers United States.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"","code":"data(Hauser79)"},{"path":"http://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"frequency data frame 25 observations following 3 variables, representing   cross-classification 19912 individuals father's occupation son's first occupation. Son factor levels UpNM LoNM UpM LoM Farm Father factor levels UpNM LoNM UpM LoM Farm Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"R.M. Hauser (1979), exploratory methods modeling mobility tables cross-classified data.  : K.F. Schuessler (Ed.), Sociological Methodology, 1980, Jossey-Bass, San Francisco, pp. 413-458.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"Powers, D.. Xie, Y. (2008). Statistical Methods Categorical Data Analysis,  Bingley, UK: Emerald.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hauser79.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hauser (1979) Data on Social Mobility — Hauser79","text":"","code":"data(Hauser79) str(Hauser79) #> 'data.frame':\t25 obs. of  3 variables: #>  $ Son   : Factor w/ 5 levels \"UpNM\",\"LoNM\",..: 1 2 3 4 5 1 2 3 4 5 ... #>  $ Father: Factor w/ 5 levels \"UpNM\",\"LoNM\",..: 1 1 1 1 1 2 2 2 2 2 ... #>  $ Freq  : num  1414 521 302 643 40 ...  # display table structable(~Father+Son, data=Hauser79) #>        Son UpNM LoNM  UpM  LoM Farm #> Father                              #> UpNM       1414  521  302  643   40 #> LoNM        724  524  254  703   48 #> UpM         798  648  856 1676  108 #> LoM         756  914  771 3325  237 #> Farm        409  357  441 1611 1832  #Examples from Powers & Xie, Table 4.15 # independence model mosaic(Freq ~ Father + Son, data=Hauser79, shade=TRUE)   hauser.indep <- gnm(Freq ~ Father + Son, data=Hauser79, family=poisson) mosaic(hauser.indep, ~Father+Son, main=\"Independence model\", gp=shading_Friendly)   hauser.quasi <-  update(hauser.indep, ~ . + Diag(Father,Son)) mosaic(hauser.quasi, ~Father+Son, main=\"Quasi-independence model\", gp=shading_Friendly)   hauser.qsymm <-  update(hauser.indep, ~ . + Diag(Father,Son) + Symm(Father,Son)) mosaic(hauser.qsymm, ~Father+Son, main=\"Quasi-symmetry model\", gp=shading_Friendly)  #mosaic(hauser.qsymm, ~Father+Son, main=\"Quasi-symmetry model\")   # numeric scores for row/column effects Sscore <- as.numeric(Hauser79$Son) Fscore <- as.numeric(Hauser79$Father)  # row effects model hauser.roweff <- update(hauser.indep, ~ . + Father*Sscore) LRstats(hauser.roweff) #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.roweff 2308.9 2324.7   2080.2 12  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # uniform association hauser.UA <- update(hauser.indep, ~ . + Fscore*Sscore) LRstats(hauser.UA) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.UA 2503.4 2515.6   2280.7 15  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # uniform association, omitting diagonals hauser.UAdiag <- update(hauser.indep, ~ . + Fscore*Sscore + Diag(Father,Son)) LRstats(hauser.UAdiag) #> Likelihood summary table: #>                  AIC BIC LR Chisq Df Pr(>Chisq)     #> hauser.UAdiag 305.72 324   73.007 10  1.161e-11 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # Levels for Hauser 5-level model levels <- matrix(c(   2,  4,  5,  5,  5,   3,  4,  5,  5,  5,   5,  5,  5,  5,  5,   5,  5,  5,  4,  4,   5,  5,  5,  4,  1   ), 5, 5, byrow=TRUE)  hauser.topo <- update(hauser.indep, ~ . + Topo(Father, Son, spec=levels)) mosaic(hauser.topo, ~Father+Son, main=\"Topological model\", gp=shading_Friendly)   hauser.RC <- update(hauser.indep, ~ . + Mult(Father, Son), verbose=FALSE) mosaic(hauser.RC, ~Father+Son, main=\"RC model\", gp=shading_Friendly)  LRstats(hauser.RC) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.RC 920.16 939.66   685.45  9  < 2.2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # crossings models  hauser.CR <- update(hauser.indep, ~ . + Crossings(Father,Son)) mosaic(hauser.topo, ~Father+Son, main=\"Crossings model\", gp=shading_Friendly)  LRstats(hauser.CR) #> Likelihood summary table: #>              AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CR 318.63 334.47   89.914 12  5.131e-14 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  hauser.CRdiag <- update(hauser.indep, ~ . + Crossings(Father,Son) + Diag(Father,Son)) LRstats(hauser.CRdiag) #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.CRdiag 298.95 318.45   64.237  9   2.03e-10 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1   # compare model fit statistics modlist <- glmlist(hauser.indep, hauser.roweff, hauser.UA, hauser.UAdiag,                     hauser.quasi, hauser.qsymm,  hauser.topo,                     hauser.RC, hauser.CR, hauser.CRdiag) sumry <- LRstats(modlist) sumry[order(sumry$AIC, decreasing=TRUE),] #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.indep  6390.8 6401.8   6170.1 16  < 2.2e-16 *** #> hauser.UA     2503.4 2515.6   2280.7 15  < 2.2e-16 *** #> hauser.roweff 2308.9 2324.7   2080.2 12  < 2.2e-16 *** #> hauser.RC      920.2  939.7    685.4  9  < 2.2e-16 *** #> hauser.quasi   914.1  931.1    683.3 11  < 2.2e-16 *** #> hauser.CR      318.6  334.5     89.9 12  5.131e-14 *** #> hauser.UAdiag  305.7  324.0     73.0 10  1.161e-11 *** #> hauser.CRdiag  298.9  318.5     64.2  9  2.030e-10 *** #> hauser.topo    295.3  311.1     66.6 12  1.397e-09 *** #> hauser.qsymm   268.2  291.3     27.4  6  0.0001193 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 # or, more simply LRstats(modlist, sortby=\"AIC\") #> Likelihood summary table: #>                  AIC    BIC LR Chisq Df Pr(>Chisq)     #> hauser.indep  6390.8 6401.8   6170.1 16  < 2.2e-16 *** #> hauser.UA     2503.4 2515.6   2280.7 15  < 2.2e-16 *** #> hauser.roweff 2308.9 2324.7   2080.2 12  < 2.2e-16 *** #> hauser.RC      920.2  939.7    685.4  9  < 2.2e-16 *** #> hauser.quasi   914.1  931.1    683.3 11  < 2.2e-16 *** #> hauser.CR      318.6  334.5     89.9 12  5.131e-14 *** #> hauser.UAdiag  305.7  324.0     73.0 10  1.161e-11 *** #> hauser.CRdiag  298.9  318.5     64.2  9  2.030e-10 *** #> hauser.topo    295.3  311.1     66.6 12  1.397e-09 *** #> hauser.qsymm   268.2  291.3     27.4  6  0.0001193 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  mods <- substring(rownames(sumry),8) with(sumry,   {plot(Df, AIC, cex=1.3, pch=19, xlab='Degrees of freedom', ylab='AIC')   text(Df, AIC, mods, adj=c(0.5,-.5), col='red', xpd=TRUE)   })"},{"path":"http://friendly.github.io/vcdExtra/reference/Heart.html","id":null,"dir":"Reference","previous_headings":"","what":"Sex, Occupation and Heart Disease — Heart","title":"Sex, Occupation and Heart Disease — Heart","text":"Classification individuals gender, occupational category occurrence heart disease","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heart.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sex, Occupation and Heart Disease — Heart","text":"","code":"data(Heart)"},{"path":"http://friendly.github.io/vcdExtra/reference/Heart.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sex, Occupation and Heart Disease — Heart","text":"    3-dimensional array resulting cross-tabulating    3 variables 21522 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heart.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sex, Occupation and Heart Disease — Heart","text":"Karger, (1980).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heart.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sex, Occupation and Heart Disease — Heart","text":"","code":"data(Heart)  # example goes here"},{"path":"http://friendly.github.io/vcdExtra/reference/Heckman.html","id":null,"dir":"Reference","previous_headings":"","what":"Labour Force Participation of Married Women 1967-1971 — Heckman","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"1583 married women surveyed years 1967-1971,  recording whether employed labor force. data, originally Heckman & Willis (1977) provide example modeling longitudinal categorical data, e.g., markov chain models dependence time.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heckman.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"","code":"data(Heckman)"},{"path":"http://friendly.github.io/vcdExtra/reference/Heckman.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"    5-dimensional array resulting cross-tabulating    5 variables  1583 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heckman.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"Lindsey (1993) fits initial set logistic regression models examining dependence employment 1971 (e1971) successive subsets previous years,  e1970, e1969, ... e1967. Alternatively, one can examine markov chain models first-order (dependence previous year), second-order (dependence previous two years), etc.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heckman.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"Lindsey, J. K. (1993).  Models Repeated Measurements Oxford, UK: Oxford University Press, p. 185.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heckman.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"Heckman, J.J. & Willis, R.J. (1977).  \"beta-logistic model analysis sequential labor force participation married women.\"  Journal Political Economy, 85: 27-58","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Heckman.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Labour Force Participation of Married Women 1967-1971 — Heckman","text":"","code":"data(Heckman)  # independence model mosaic(Heckman, shade=TRUE)  # same, as a loglm() require(MASS) (heckman.mod0 <- loglm(~ e1971+e1970+e1969+e1968+e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 + e1970 + e1969 + e1968 + e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 3824.863 26        0 #> Pearson          8747.019 26        0 mosaic(heckman.mod0, main=\"Independence model\")   # first-order markov chain: bad fit (heckman.mod1 <- loglm(~ e1971*e1970 + e1970*e1969 +e1969*e1968 + e1968*e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 * e1970 + e1970 * e1969 + e1969 * e1968 +  #>     e1968 * e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 210.2251 22        0 #> Pearson          254.8971 22        0 mosaic(heckman.mod1, main=\"1st order markov chain model\")   # second-order markov chain: bad fit (heckman.mod2 <- loglm(~ e1971*e1970*e1969 + e1970*e1969*e1968 +e1969*e1968*e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 * e1970 * e1969 + e1970 * e1969 * e1968 +  #>     e1969 * e1968 * e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 62.67163 16 1.845162e-07 #> Pearson          75.99393 16 8.698373e-10 mosaic(heckman.mod2, main=\"2nd order markov chain model\")   # third-order markov chain: fits OK (heckman.mod3 <- loglm(~ e1971*e1970*e1969*e1968 + e1970*e1969*e1968*e1967, data=Heckman)) #> Call: #> loglm(formula = ~e1971 * e1970 * e1969 * e1968 + e1970 * e1969 *  #>     e1968 * e1967, data = Heckman) #>  #> Statistics: #>                       X^2 df  P(> X^2) #> Likelihood Ratio 9.023246  8 0.3403388 #> Pearson          8.155529  8 0.4184270 mosaic(heckman.mod2, main=\"3rd order markov chain model\")"},{"path":"http://friendly.github.io/vcdExtra/reference/HLtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"HLtest function computes classical Hosmer-Lemeshow (1980) goodness fit test binomial glm object logistic regression general idea assesses whether observed event rates match expected event rates subgroups  model population. Hosmer-Lemeshow test specifically identifies subgroups deciles fitted event values, quantiles determined g argument. Given subgroups, simple chisquare test g-2 df used. addition print summary methods, plot method supplied visualize discrepancies observed fitted frequencies.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HLtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"","code":"HosmerLemeshow(model, g = 10)  HLtest(model, g = 10)  # S3 method for HLtest print(x, ...) # S3 method for HLtest summary(object, ...) # S3 method for HLtest plot(x, ...) # S3 method for HLtest rootogram(x, ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/HLtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"model glm model object binomial family g Number groups used partition fitted values GOF test. x, object HLtest object ... arguments passed methods","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HLtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"class HLtest object  following components: table data.frame describing results partitioning data g   \tgroups following columns: cut, total, obs, exp, chi chisq chisquare statistics df Degrees freedom p.value p value groups Number groups call model call","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HLtest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"Hosmer, David W., Lemeshow, Stanley (1980).  goodness--fit test multiple logistic regression model. Communications Statistics, Series , 9, 1043-1069. Hosmer, David W., Lemeshow, Stanley (2000).  Applied Logistic Regression, New York: Wiley, ISBN 0-471-61553-6 Lemeshow, S. Hosmer, D.W.  (1982).  review goodness fit statistics use development logistic regression models.  American Journal Epidemiology, 115(1), 92-106.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HLtest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/HLtest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hosmer-Lemeshow Goodness of Fit Test — HLtest","text":"","code":"data(birthwt, package=\"MASS\") # how to do this without attach? attach(birthwt) #> The following object is masked from package:ca: #>  #>     smoke   race = factor(race, labels = c(\"white\", \"black\", \"other\"))   ptd = factor(ptl > 0)   ftv = factor(ftv)   levels(ftv)[-(1:2)] = \"2+\"   bwt <- data.frame(low = factor(low), age, lwt, race,       smoke = (smoke > 0), ptd, ht = (ht > 0), ui = (ui > 0), ftv) detach(birthwt) options(contrasts = c(\"contr.treatment\", \"contr.poly\")) BWmod <- glm(low ~ ., family=binomial, data=bwt)  (hlt <- HLtest(BWmod)) #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ ., family = binomial, data = bwt) #>  ChiSquare df   P_value #>   5.981786  8 0.6492722 str(hlt) #> List of 6 #>  $ table  :'data.frame':\t10 obs. of  5 variables: #>   ..$ cut  : chr [1:10] \"[0.0161,0.0788]\" \"(0.0788,0.119]\" \"(0.119,0.189]\" \"(0.189,0.229]\" ... #>   ..$ total: num [1:10] 19 19 19 19 19 18 19 19 19 19 #>   ..$ obs  : num [1:10] 19 17 15 13 16 15 11 10 9 5 #>   ..$ exp  : num [1:10] 18 17.2 16.2 15.1 14.3 ... #>   ..$ chi  : num [1:10] 0.242 -0.0374 -0.3036 -0.5317 0.4611 ... #>  $ chisq  : num 5.98 #>  $ df     : num 8 #>  $ p.value: num 0.649 #>  $ groups : num 10 #>  $ call   : language glm(formula = low ~ ., family = binomial, data = bwt) #>  - attr(*, \"class\")= chr \"HLtest\" summary(hlt) #> Partition for Hosmer and Lemeshow Goodness-of-Fit Test  #>  #>                cut total obs       exp         chi #> 1  [0.0161,0.0788]    19  19 17.974124  0.24197519 #> 2   (0.0788,0.119]    19  17 17.154854 -0.03738777 #> 3    (0.119,0.189]    19  15 16.222714 -0.30357311 #> 4    (0.189,0.229]    19  13 15.063836 -0.53174994 #> 5    (0.229,0.268]    19  16 14.259007  0.46105470 #> 6    (0.268,0.312]    18  15 12.757257  0.62791490 #> 7    (0.312,0.402]    19  11 12.545096 -0.43623285 #> 8    (0.402,0.493]    19  10 10.593612 -0.18238140 #> 9    (0.493,0.618]    19   9  8.552849  0.15289685 #> 10   (0.618,0.904]    19   5  4.876650  0.05585725 #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ ., family = binomial, data = bwt) #>  ChiSquare df   P_value #>   5.981786  8 0.6492722 plot(hlt)   # basic model BWmod0 <- glm(low ~ age, family=binomial, data=bwt) (hlt0 <- HLtest(BWmod0)) #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ age, family = binomial, data = bwt) #>  ChiSquare df   P_value #>   9.307311  8 0.3170385 str(hlt0) #> List of 6 #>  $ table  :'data.frame':\t10 obs. of  5 variables: #>   ..$ cut  : chr [1:10] \"[0.128,0.231]\" \"(0.231,0.26]\" \"(0.26,0.29]\" \"(0.29,0.301]\" ... #>   ..$ total: num [1:10] 20 23 26 13 13 25 18 16 22 13 #>   ..$ obs  : num [1:10] 17 19 14 8 8 18 10 13 15 8 #>   ..$ exp  : num [1:10] 15.76 17.23 18.6 9.09 8.95 ... #>   ..$ chi  : num [1:10] 0.311 0.426 -1.066 -0.361 -0.317 ... #>  $ chisq  : num 9.31 #>  $ df     : num 8 #>  $ p.value: num 0.317 #>  $ groups : num 10 #>  $ call   : language glm(formula = low ~ age, family = binomial, data = bwt) #>  - attr(*, \"class\")= chr \"HLtest\" summary(hlt0) #> Partition for Hosmer and Lemeshow Goodness-of-Fit Test  #>  #>              cut total obs       exp         chi #> 1  [0.128,0.231]    20  17 15.764147  0.31126591 #> 2   (0.231,0.26]    23  19 17.229899  0.42643885 #> 3    (0.26,0.29]    26  14 18.599113 -1.06641920 #> 4   (0.29,0.301]    13   8  9.088499 -0.36106223 #> 5  (0.301,0.312]    13   8  8.947209 -0.31666633 #> 6  (0.312,0.334]    25  18 16.793786  0.29434049 #> 7  (0.334,0.346]    18  10 11.779364 -0.51844629 #> 8  (0.346,0.357]    16  13 10.284015  0.84692725 #> 9  (0.357,0.381]    22  15 13.736398  0.34093679 #> 10 (0.381,0.418]    13   8  7.777571  0.07975704 #> Hosmer and Lemeshow Goodness-of-Fit Test  #>  #> Call: #> glm(formula = low ~ age, family = binomial, data = bwt) #>  ChiSquare df   P_value #>   9.307311  8 0.3170385 plot(hlt0)"},{"path":"http://friendly.github.io/vcdExtra/reference/HospVisits.html","id":null,"dir":"Reference","previous_headings":"","what":"Hospital Visits Data — HospVisits","title":"Hospital Visits Data — HospVisits","text":"Length stay hospital 132 schizophrenic patients, classified visiting patterns, originally Wing (1962).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hospital Visits Data — HospVisits","text":"","code":"data(\"HospVisits\")"},{"path":"http://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hospital Visits Data — HospVisits","text":"3 3 frequency table, format:  table [1:3, 1:3] 43 6 9 16 11 18 3 10 16  - attr(*, \"dimnames\")=List 2   ..$ visit: chr [1:3] \"Regular\" \"Infrequent\" \"Never\"   ..$ stay : chr [1:3] \"2-9\" \"10-19\" \"20+\"","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hospital Visits Data — HospVisits","text":"table variables can considered ordinal. variable visit refers visiting patterns recorded hospital.  category labels abbreviations given Goodman (1983); e.g., \"Regular\" short “received visitors regularly patient went home”. variable stay refers length stay hospital, year groups.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hospital Visits Data — HospVisits","text":"Goodman, L. . (1983) analysis dependence cross-classifications ordered categories, using log-linear models frequencies log-linear models odds.  Biometrics, 39, 149-160.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hospital Visits Data — HospVisits","text":"Wing, J. K. (1962). Institutionalism Mental Hospitals, British Journal Social Clinical Psychology, 1 (1), 38-51.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/HospVisits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hospital Visits Data — HospVisits","text":"","code":"data(HospVisits) mosaic(HospVisits, gp=shading_Friendly)   library(ca) ca(HospVisits) #>  #>  Principal inertias (eigenvalues): #>            1        2     #> Value      0.266408 4e-05 #> Percentage 99.98%   0.02% #>  #>  #>  Rows: #>           Regular Infrequent    Never #> Mass     0.469697   0.204545 0.325758 #> ChiDist  0.548379   0.472911 0.493871 #> Inertia  0.141247   0.045745 0.079455 #> Dim. 1  -1.062448   0.915982 0.956750 #> Dim. 2   0.015355  -1.746386 1.074428 #>  #>  #>  Columns: #>               2-9    10-19       20+ #> Mass     0.439394 0.340909  0.219697 #> ChiDist  0.544465 0.228999  0.733852 #> Inertia  0.130255 0.017878  0.118315 #> Dim. 1  -1.054853 0.443377  1.421707 #> Dim. 2  -0.403915 1.317858 -1.237123 # surprisingly 1D ! plot(ca(HospVisits))"},{"path":"http://friendly.github.io/vcdExtra/reference/Hoyt.html","id":null,"dir":"Reference","previous_headings":"","what":"Minnesota High School Graduates — Hoyt","title":"Minnesota High School Graduates — Hoyt","text":"Minnesota high school graduates June 1930 classified respect  () Rank thirds graduating class, (b) post-high school Status April 1939 (4 levels), (c) Sex,  (d) father's Occupational status (7 levels, 1=High 7=Low). data first presented Hoyt et al. (1959) analyzed Fienberg(1980), Plackett(1974) others.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Minnesota High School Graduates — Hoyt","text":"","code":"data(Hoyt)"},{"path":"http://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Minnesota High School Graduates — Hoyt","text":"    4-dimensional array resulting cross-tabulating    4 variables 13968 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Minnesota High School Graduates — Hoyt","text":"Post high-school Status natural consider response. Rank father's Occupation ordinal variables.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Minnesota High School Graduates — Hoyt","text":"Fienberg, S. E. (1980). Analysis Cross-Classified Categorical Data. Cambridge, MA: MIT Press, p. 91-92. R. L. Plackett, (1974). Analysis Categorical Data. London: Griffin.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Minnesota High School Graduates — Hoyt","text":"Hoyt, C. J., Krishnaiah, P. R. Torrance, E. P. (1959)  Analysis complex contingency tables,  Journal Experimental Education 27, 187-194.","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Hoyt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Minnesota High School Graduates — Hoyt","text":"","code":"data(Hoyt)  # display the table structable(Status+Sex ~ Rank+Occupation, data=Hoyt) #>                   Status College        School         Job        Other        #>                   Sex       Male Female   Male Female Male Female  Male Female #> Rank   Occupation                                                              #> Low    1                      87     53      3      7   17     13   105     76 #>        2                      72     36      6     16   18     11   209    111 #>        3                      52     52     17     28   14     49   541    521 #>        4                      88     48      9     18   14     29   328    191 #>        5                      32     12      1      5   12     10   124    101 #>        6                      14      9      2      1    5     15   148    130 #>        7                      20      3      3      1    4      6   109     88 #> Middle 1                     216    163      4     30   14     28   118    118 #>        2                     159    116     14     41   28     53   227    214 #>        3                     119    162     13     64   44    129   578    708 #>        4                     158    130     15     47   36     62   304    305 #>        5                      43     35      5     11    7     37   119    152 #>        6                      24     19      6     13   15     22   131    174 #>        7                      41     25      5      9   13     15    88    158 #> High   1                     256    309      2     17   10     38    53     89 #>        2                     176    225      8     49   22     68    95    210 #>        3                     119    243     10     79   33    184   257    448 #>        4                     144    237     12     57   20     63   115    219 #>        5                      42     72      2     20    7     21    56     95 #>        6                      24     42      2     10    4     19    61    105 #>        7                      32     36      2     14    4     19    41     93  # mosaic for independence model plot(Hoyt, shade=TRUE)   # examine all pairwise mosaics pairs(Hoyt, shade=TRUE)   # collapse Status to College vs. Non-College Hoyt1 <- collapse.table(Hoyt, Status=c(\"College\", rep(\"Non-College\",3))) plot(Hoyt1, shade=TRUE)   ################################################# # fitting models with loglm, plotting with mosaic #################################################  # fit baseline log-linear model for Status as response require(MASS) hoyt.mod0 <- loglm(~ Status + (Sex*Rank*Occupation), data=Hoyt1) hoyt.mod0 #> Call: #> loglm(formula = ~Status + (Sex * Rank * Occupation), data = Hoyt1) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 2080.359 41        0 #> Pearson          2090.750 41        0 mosaic(hoyt.mod0, gp=shading_Friendly, main=\"Baseline model: Status + (Sex*Rank*Occ)\") #> Error in loglm(formula = ~Status + (Sex * Rank * Occupation), data = Hoyt1,     fitted = TRUE): object 'Hoyt1' not found  # add one-way association of Status with factors hoyt.mod1 <- loglm(~ Status * (Sex + Rank + Occupation) + (Sex*Rank*Occupation), data=Hoyt1) hoyt.mod1 #> Call: #> loglm(formula = ~Status * (Sex + Rank + Occupation) + (Sex *  #>     Rank * Occupation), data = Hoyt1) #>  #> Statistics: #>                       X^2 df   P(> X^2) #> Likelihood Ratio 50.10913 32 0.02175915 #> Pearson          49.33936 32 0.02578430 mosaic(hoyt.mod1, gp=shading_Friendly, main=\"Status * (Sex + Rank + Occ)\") #> Error in loglm(formula = ~Status * (Sex + Rank + Occupation) + (Sex *     Rank * Occupation), data = Hoyt1, fitted = TRUE): object 'Hoyt1' not found  # can we drop any terms? drop1(hoyt.mod1, test=\"Chisq\") #> Error in loglm(formula = ~Status + Sex + Rank + Occupation + Status:Rank +     Status:Occupation + Sex:Rank + Sex:Occupation + Rank:Occupation +     Sex:Rank:Occupation, data = Hoyt1, evaluate = FALSE): object 'Hoyt1' not found  # assess model fit anova(hoyt.mod0, hoyt.mod1) #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Status + (Sex * Rank * Occupation)  #> Model 2: #>  ~Status * (Sex + Rank + Occupation) + (Sex * Rank * Occupation)  #>  #>             Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   2080.35910 41                                     #> Model 2     50.10913 32 2030.24997         9        0.00000 #> Saturated    0.00000  0   50.10913        32        0.02176  # what terms to add? add1(hoyt.mod1, ~.^2, test=\"Chisq\") #> Error in loglm(formula = ~Status + Sex + Rank + Occupation + Status:Sex +     Status:Rank + Status:Occupation + Sex:Rank + Sex:Occupation +     Rank:Occupation + Sex:Rank:Occupation + Status:Sex:Rank,     data = Hoyt1, evaluate = FALSE): object 'Hoyt1' not found  # add interaction of Sex:Occupation on Status hoyt.mod2 <- update(hoyt.mod1, ~.+Status:Sex:Occupation) mosaic(hoyt.mod2, gp=shading_Friendly, main=\"Adding Status:Sex:Occupation\") #> Error in loglm(formula = ~Status + Sex + Rank + Occupation + Status:Sex +     Status:Rank + Status:Occupation + Sex:Rank + Sex:Occupation +     Rank:Occupation + Sex:Rank:Occupation + Status:Sex:Occupation,     data = Hoyt1, fitted = TRUE): object 'Hoyt1' not found  # compare model fits anova(hoyt.mod0, hoyt.mod1, hoyt.mod2) #> LR tests for hierarchical log-linear models #>  #> Model 1: #>  ~Status + (Sex * Rank * Occupation)  #> Model 2: #>  ~Status * (Sex + Rank + Occupation) + (Sex * Rank * Occupation)  #> Model 3: #>  ~Status + Sex + Rank + Occupation + Status:Sex + Status:Rank + Status:Occupation + Sex:Rank + Sex:Occupation + Rank:Occupation + Sex:Rank:Occupation + Status:Sex:Occupation  #>  #>             Deviance df Delta(Dev) Delta(df) P(> Delta(Dev) #> Model 1   2080.35910 41                                     #> Model 2     50.10913 32 2030.24997         9        0.00000 #> Model 3     21.01300 26   29.09613         6        0.00006 #> Saturated    0.00000  0   21.01300        26        0.74129  # Alternatively, try stepwise analysis, heading toward the saturated model steps <- step(hoyt.mod0, direction=\"forward\", scope=~Status*Sex*Rank*Occupation) #> Start:  AIC=2166.36 #> ~Status + (Sex * Rank * Occupation) #>  #> Error in loglm(formula = ~Status + Sex + Rank + Occupation + Sex:Rank +     Sex:Occupation + Rank:Occupation + Status:Sex + Sex:Rank:Occupation,     data = Hoyt1, evaluate = FALSE): object 'Hoyt1' not found # display anova steps$anova #> Error in eval(expr, envir, enclos): object 'steps' not found"},{"path":"http://friendly.github.io/vcdExtra/reference/ICU.html","id":null,"dir":"Reference","previous_headings":"","what":"ICU data set — ICU","title":"ICU data set — ICU","text":"ICU data set consists sample 200 subjects part much larger study survival patients following admission adult intensive care unit (ICU), derived   Hosmer, Lemeshow Sturdivant (2013) Friendly (2000). major goal study develop logistic regression model predict probability survival hospital discharge patients study risk factors associated  ICU mortality. clinical details study described  Lemeshow, Teres, Avrunin, Pastides (1988). data set often used illustrate model selection methods logistic regression.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ICU.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ICU data set — ICU","text":"","code":"data(ICU)"},{"path":"http://friendly.github.io/vcdExtra/reference/ICU.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"ICU data set — ICU","text":"data frame 200 observations following 22 variables. died Died discharge?, factor levels Yes age Patient age, numeric vector sex Patient sex, factor levels Female Male race Patient race, factor levels Black White.  Also represented white. service Service ICU Admission, factor levels Medical Surgical cancer Cancer part present problem?, factor levels Yes renal History chronic renal failure?, factor levels Yes infect Infection probable ICU admission?, factor levels Yes cpr Patient received CPR prior ICU admission?, factor levels Yes systolic Systolic blood pressure admission (mm Hg), numeric vector hrtrate Heart rate ICU Admission (beats/min), numeric vector previcu Previous admission ICU within 6 Months?, factor levels Yes admit Type admission, factor levels Elective Emergency fracture Admission long bone, multiple, neck, single area, hip fracture?     factor levels Yes po2 PO2 initial blood gases, factor levels >60 <=60 ph pH initial blood gases, factor levels >=7.25 <7.25 pco PCO2 initial blood gases, factor levels <=45 >45 bic Bicarbonate (HCO3) level initial blood gases, factor levels >=18 <18 creatin Creatinine, initial blood gases, factor levels <=2 >2 coma Level unconsciousness admission ICU,\tfactor levels None Stupor Coma white recoding race,  factor levels White Non-white uncons recoding coma factor levels Yes","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ICU.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ICU data set — ICU","text":"Patient ID numbers rownames data frame. Note last two variables white uncons recoding respectively race coma binary variables.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ICU.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"ICU data set — ICU","text":"M. Friendly (2000), Visualizing Categorical Data, Appendix B.4. SAS Institute, Cary, NC. Hosmer, D. W. Jr., Lemeshow, S. Sturdivant, R. X. (2013)  \tApplied Logistic Regression, NY: Wiley, \t Third Edition.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ICU.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ICU data set — ICU","text":"Lemeshow, S., Teres, D., Avrunin, J. S., Pastides, H. (1988). Predicting     Outcome Intensive Care Unit Patients. Journal American     Statistical Association, 83, 348-356.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ICU.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ICU data set — ICU","text":"","code":"data(ICU) # remove redundant variables (race, coma) ICU1 <- ICU[,-c(4,20)]  # fit full model icu.full <- glm(died ~ ., data=ICU1, family=binomial) summary(icu.full) #>  #> Call: #> glm(formula = died ~ ., family = binomial, data = ICU1) #>  #> Deviance Residuals:  #>      Min        1Q    Median        3Q       Max   #> -1.80396  -0.56064  -0.20440  -0.08635   2.97729   #>  #> Coefficients: #>                  Estimate Std. Error z value Pr(>|z|)     #> (Intercept)     -6.726704   2.385512  -2.820  0.00481 **  #> age              0.056393   0.018624   3.028  0.00246 **  #> sexMale          0.639725   0.531393   1.204  0.22864     #> serviceSurgical -0.673522   0.601902  -1.119  0.26315     #> cancerYes        3.107051   1.045846   2.971  0.00297 **  #> renalYes        -0.035708   0.801647  -0.045  0.96447     #> infectYes       -0.204933   0.553191  -0.370  0.71104     #> cprYes           1.053483   1.006614   1.047  0.29530     #> systolic        -0.015472   0.008497  -1.821  0.06864 .   #> hrtrate         -0.002769   0.009607  -0.288  0.77317     #> previcuYes       1.131942   0.671450   1.686  0.09183 .   #> admitEmergency   3.079583   1.081584   2.847  0.00441 **  #> fractureYes      1.411402   1.029705   1.371  0.17047     #> po2<=60          0.073822   0.857044   0.086  0.93136     #> ph<7.25          2.354078   1.208804   1.947  0.05148 .   #> pco>45          -3.018442   1.253448  -2.408  0.01604 *   #> bic<18          -0.709284   0.909777  -0.780  0.43561     #> creatin>2        0.295143   1.116925   0.264  0.79159     #> whiteNon-white   0.565729   0.926828   0.610  0.54160     #> unconsYes        5.232292   1.226303   4.267 1.98e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for binomial family taken to be 1) #>  #>     Null deviance: 200.16  on 199  degrees of freedom #> Residual deviance: 120.78  on 180  degrees of freedom #> AIC: 160.78 #>  #> Number of Fisher Scoring iterations: 6 #>   # simpler model (found from a \"best\" subsets procedure) icu.mod1 <- glm(died ~ age + sex + cancer + systolic + admit + uncons, data=ICU1, family=binomial) summary(icu.mod1) #>  #> Call: #> glm(formula = died ~ age + sex + cancer + systolic + admit +  #>     uncons, family = binomial, data = ICU1) #>  #> Deviance Residuals:  #>     Min       1Q   Median       3Q      Max   #> -2.6490  -0.5822  -0.3426  -0.1222   2.5231   #>  #> Coefficients: #>                 Estimate Std. Error z value Pr(>|z|)     #> (Intercept)    -5.884702   1.758997  -3.345 0.000821 *** #> age             0.038875   0.013130   2.961 0.003069 **  #> sexMale         0.524194   0.479374   1.093 0.274176     #> cancerYes       2.386534   0.896958   2.661 0.007798 **  #> systolic       -0.011683   0.006833  -1.710 0.087309 .   #> admitEmergency  3.171332   0.962323   3.295 0.000982 *** #> unconsYes       3.934575   0.961746   4.091 4.29e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for binomial family taken to be 1) #>  #>     Null deviance: 200.16  on 199  degrees of freedom #> Residual deviance: 134.38  on 193  degrees of freedom #> AIC: 148.38 #>  #> Number of Fisher Scoring iterations: 6 #>   # even simpler model icu.mod2 <- glm(died ~ age + cancer  + admit + uncons, data=ICU1, family=binomial) summary(icu.mod2) #>  #> Call: #> glm(formula = died ~ age + cancer + admit + uncons, family = binomial,  #>     data = ICU1) #>  #> Deviance Residuals:  #>     Min       1Q   Median       3Q      Max   #> -2.5631  -0.6241  -0.3253  -0.1487   2.4928   #>  #> Coefficients: #>                Estimate Std. Error z value Pr(>|z|)     #> (Intercept)    -6.86978    1.31882  -5.209 1.90e-07 *** #> age             0.03718    0.01277   2.911 0.003600 **  #> cancerYes       2.09711    0.83847   2.501 0.012381 *   #> admitEmergency  3.10218    0.91860   3.377 0.000733 *** #> unconsYes       3.70546    0.87647   4.228 2.36e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for binomial family taken to be 1) #>  #>     Null deviance: 200.16  on 199  degrees of freedom #> Residual deviance: 139.13  on 195  degrees of freedom #> AIC: 149.13 #>  #> Number of Fisher Scoring iterations: 6 #>   anova(icu.mod2, icu.mod1, icu.full, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: died ~ age + cancer + admit + uncons #> Model 2: died ~ age + sex + cancer + systolic + admit + uncons #> Model 3: died ~ age + sex + service + cancer + renal + infect + cpr +  #>     systolic + hrtrate + previcu + admit + fracture + po2 + ph +  #>     pco + bic + creatin + white + uncons #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi)   #> 1       195     139.13                        #> 2       193     134.38  2   4.7582  0.09263 . #> 3       180     120.78 13  13.5981  0.40274   #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  ## Reproduce Fig 6.12 from VCD  icu.fit <- data.frame(ICU, prob=predict(icu.mod2, type=\"response\"))  # combine categorical risk factors to a single string risks <- ICU[, c(\"cancer\", \"admit\", \"uncons\")] risks[,1] <- ifelse(risks[,1]==\"Yes\", \"Cancer\", \"\") risks[,2] <- ifelse(risks[,2]==\"Emergency\", \"Emerg\", \"\") risks[,3] <- ifelse(risks[,3]==\"Yes\", \"Uncons\", \"\") risks <- apply(risks, 1, paste, collapse=\"\") risks[risks==\"\"] <- \"(none)\" icu.fit$risks <- risks  library(ggplot2) ggplot(icu.fit, aes(x=age, y=prob, color=risks)) +   geom_point(size=2) +   geom_line(size=1.25, alpha=0.5) +   theme_bw() + ylab(\"Probability of death\")"},{"path":"http://friendly.github.io/vcdExtra/reference/JobSat.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-classification of job satisfaction by income — JobSat","title":"Cross-classification of job satisfaction by income — JobSat","text":"data set contingency table job satisfaction income small sample black males 1996 General Social Survey, used Agresti (2002) example.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/JobSat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-classification of job satisfaction by income — JobSat","text":"","code":"data(JobSat)"},{"path":"http://friendly.github.io/vcdExtra/reference/JobSat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cross-classification of job satisfaction by income — JobSat","text":"4 x 4 contingency table income satisfaction, following structure:","code":"table [1:4, 1:4] 1 2 1 0 3 3 6 1 10 10 ...  - attr(*, \"dimnames\")=List of 2   ..$ income      : chr [1:4] \"< 15k\" \"15-25k\" \"25-40k\" \"> 40k\"   ..$ satisfaction: chr [1:4] \"VeryD\" \"LittleD\" \"ModerateS\" \"VeryS\""},{"path":"http://friendly.github.io/vcdExtra/reference/JobSat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-classification of job satisfaction by income — JobSat","text":"income satisfaction ordinal variables, ordered table.  Measures association, visualizations, models take ordinality account.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/JobSat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Cross-classification of job satisfaction by income — JobSat","text":"Agresti, . Categorical Data Analysis John Wiley & Sons, 2002, Table 2.8, p. 57.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/JobSat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-classification of job satisfaction by income — JobSat","text":"","code":"data(JobSat) assocstats(JobSat) #>                     X^2 df P(> X^2) #> Likelihood Ratio 6.7641  9  0.66167 #> Pearson          5.9655  9  0.74336 #>  #> Phi-Coefficient   : NA  #> Contingency Coeff.: 0.242  #> Cramer's V        : 0.144  GKgamma(JobSat) #> gamma        : 0.221  #> std. error   : 0.117  #> CI           : -0.009 0.451"},{"path":"http://friendly.github.io/vcdExtra/reference/Kway.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit All K-way Models in a GLM — Kway","title":"Fit All K-way Models in a GLM — Kway","text":"Generate fit 0-way, 1-way, 2-way, ... k-way terms glm. function designed mainly hierarchical loglinear models (glms poisson family), desired find  highest-order terms necessary achieve satisfactory fit. Using anova resulting glmlist object give sequential tests pooled contributions terms degree \\(k+1\\) degree \\(k\\). function also intended example generating function glmlist objects, facilitate model comparison, extraction,  summary plotting model components, etc., perhaps using lapply similar.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Kway.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit All K-way Models in a GLM — Kway","text":"","code":"Kway(formula, family=poisson, data, ..., order = nt, prefix = \"kway\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Kway.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit All K-way Models in a GLM — Kway","text":"formula two-sided formula 1-way effects model. LHS response, RHS first-order terms connected + signs. family description   error distribution  link  function  used model.   can   character string  naming  family  function,  family function result call family function.  (See family details family functions.) data  optional  data   frame,  list    environment  ( object   coercible  .data.frame  data frame) containing  variables  model.  found data, variables taken environment(formula), typically  environment glm called. ... arguments passed glm order Highest order interaction models generated. Defaults number terms model formula. prefix Prefix used label models fit glmlist object.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Kway.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit All K-way Models in a GLM — Kway","text":"y response formula, 0-way (null) model y ~ 1.   1-way (\"main effects\") model specified formula argument.  k-way model generated using formula . ~ .^k. default order = nt, final model saturated model. presently written, function requires two-sided formula explicit response LHS. frequency data table form (e.g., produced xtabs) data argument coerced data.frame,  supply formula form Freq ~  ....","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Kway.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit All K-way Models in a GLM — Kway","text":"object class glmlist, length order+1containing 0-way, 1-way, ...  models degree order.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Kway.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fit All K-way Models in a GLM — Kway","text":"Michael Friendly Heather Turner","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Kway.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit All K-way Models in a GLM — Kway","text":"","code":"## artificial data factors <- expand.grid(A=factor(1:3), B=factor(1:2), C=factor(1:3), D=factor(1:2)) Freq <- rpois(nrow(factors), lambda=40) df <- cbind(factors, Freq)  mods3 <- Kway(Freq ~ A + B + C, data=df, family=poisson) LRstats(mods3) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq) #> kway.0 240.09 241.67   39.097 35     0.2909 #> kway.1 242.97 252.47   31.978 30     0.3686 #> kway.2 241.60 263.77   14.613 22     0.8783 #> kway.3 246.37 274.87   11.377 18     0.8777 mods4 <- Kway(Freq ~ A + B + C + D, data=df, family=poisson) LRstats(mods4) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq) #> kway.0 240.09 241.67   39.097 35     0.2909 #> kway.1 243.51 254.60   30.522 29     0.3883 #> kway.2 248.01 279.68    9.019 16     0.9126 #> kway.3 264.64 315.31    1.649  4     0.8000 #> kway.4 270.99 328.00    0.000  0     1.0000  # JobSatisfaction data data(JobSatisfaction, package=\"vcd\") modSat <- Kway(Freq ~ management+supervisor+own, data=JobSatisfaction,                 family=poisson, prefix=\"JobSat\") LRstats(modSat) #> Likelihood summary table: #>              AIC     BIC LR Chisq Df Pr(>Chisq)     #> JobSat.0 260.251 260.330  208.775  7     <2e-16 *** #> JobSat.1 175.472 175.790  117.997  4     <2e-16 *** #> JobSat.2  63.541  64.097    0.065  1     0.7989     #> JobSat.3  65.476  66.111    0.000  0     <2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(modSat, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ 1 #> Model 2: Freq ~ management + supervisor + own #> Model 3: Freq ~ management + supervisor + own + management:supervisor +  #>     management:own + supervisor:own #> Model 4: Freq ~ management + supervisor + own + management:supervisor +  #>     management:own + supervisor:own + management:supervisor:own #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi)     #> 1         7    208.775                          #> 2         4    117.997  3   90.778   <2e-16 *** #> 3         1      0.065  3  117.932   <2e-16 *** #> 4         0      0.000  1    0.065   0.7989     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # Rochdale data: very sparse, in table form data(Rochdale, package=\"vcd\") if (FALSE) { modRoch <- Kway(Freq~EconActive + Age + HusbandEmployed + Child +                       Education + HusbandEducation + Asian + HouseholdWorking,                 data=Rochdale, family=poisson) LRstats(modRoch) }"},{"path":"http://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":null,"dir":"Reference","previous_headings":"","what":"Log-Likelihood of a loglm Object — logLik.loglm","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"Calculates log-likelihood value loglm model represented object  evaluated estimated coefficients. allows use AIC BIC, require logLik method exists extract corresponding log-likelihood  model.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"","code":"# S3 method for loglm logLik(object, ..., zero=1E-10)"},{"path":"http://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"object loglm object ... compatibility S3 generic; used zero value used replace zero frequencies calculating log-likelihood","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"cell frequencies stored loglm object (via argument keep.frequencies = TRUE), obtained using update. function calculates log-likelihood way allows non-integer frequencies, case 0.5 added cell frequencies allow sampling zeros.  frequencies still contain zero values, replaced value start. integer frequencies, gives result corresponding model fit using glm, whereas glm returns -Inf non-integer frequencies.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"Returns object class logLik.  number one attribute, \"df\" (degrees freedom),  giving number (estimated) parameters model.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"Achim Zeileis","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/logLik.loglm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Log-Likelihood of a loglm Object — logLik.loglm","text":"","code":"data(Titanic, package=\"datasets\")    require(MASS) titanic.mod1 <- loglm(~ (Class * Age * Sex) + Survived, data=Titanic) titanic.mod2 <- loglm(~ (Class * Age * Sex) + Survived*(Class + Age + Sex), data=Titanic) titanic.mod3 <- loglm(~ (Class * Age * Sex) + Survived*(Class + Age * Sex), data=Titanic)  logLik(titanic.mod1) #> 'log Lik.' -399.6822 (df=17) AIC(titanic.mod1, titanic.mod2, titanic.mod3) #>              df      AIC #> titanic.mod1 17 833.3644 #> titanic.mod2 22 283.9687 #> titanic.mod3 23 267.9503 BIC(titanic.mod1, titanic.mod2, titanic.mod3) #>              df      BIC #> titanic.mod1 17 858.2819 #> titanic.mod2 22 316.2149 #> titanic.mod3 23 301.6622  # compare with models fit using glm() titanic <- as.data.frame(Titanic) titanic.glm1 <- glm(Freq ~ (Class * Age * Sex) + Survived,                      data=titanic, family=poisson) titanic.glm2 <- glm(Freq ~ (Class * Age * Sex) + Survived*(Class + Age + Sex),                      data=titanic, family=poisson) titanic.glm3 <- glm(Freq ~ (Class * Age * Sex) + Survived*(Class + Age * Sex),                      data=titanic, family=poisson)  logLik(titanic.glm1) #> 'log Lik.' -399.6822 (df=17) AIC(titanic.glm1, titanic.glm2, titanic.glm3) #>              df      AIC #> titanic.glm1 17 833.3644 #> titanic.glm2 22 283.9687 #> titanic.glm3 23 267.9503 BIC(titanic.glm1, titanic.glm2, titanic.glm3) #>              df      BIC #> titanic.glm1 17 858.2819 #> titanic.glm2 22 316.2149 #> titanic.glm3 23 301.6622"},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglinear Model Utilities — loglin-utilities","title":"Loglinear Model Utilities — loglin-utilities","text":"functions generate lists terms specify loglinear model form compatible loglin also provide conversion equivalent loglm specification shorthand character string representation. allow conceptual way specify models function type, opposed just uninterpreted list model terms also allow easy specification marginal models given contingency table. intended used tools higher-level modeling  graphics functions, can also used directly.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglinear Model Utilities — loglin-utilities","text":"","code":"conditional(nf, table = NULL, factors = 1:nf, with = nf)  joint(nf, table = NULL, factors = 1:nf, with = nf)  markov(nf, factors = 1:nf, order = 1)  mutual(nf, table = NULL, factors = 1:nf)  saturated(nf, table = NULL, factors = 1:nf)  loglin2formula(x, env = parent.frame())  loglin2string(x, brackets = c(\"[\", \"]\"), sep = \",\", collapse = \" \", abbrev)"},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglinear Model Utilities — loglin-utilities","text":"nf number factors generate model table contingency table used factor names model, typically output table possibly permuted aperm factors names factors used model formula table specified joint conditional models, gives indices factors others considered jointly  conditionally independent order markov, gives order Markov chain model factors.  order=1 Markov chain allows associations among sequential pairs factors, e.g., [,B], [B,C], [C,D] .... order=2 Markov chain allows associations among sequential triples. x loglin2* functions,  list terms loglinear model, returned conditional, joint,   ... env loglin2formula, environment evaluate formula brackets loglin2string,  characters use surround model terms.   Either single character string containing two characters (e.g., '[]' character vector length two. sep loglin2string, separator character string used factor names within given model term collapse loglin2string, character string used terms model string abbrev loglin2string, whether abbreviate terms string representation. yet implemented.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Loglinear Model Utilities — loglin-utilities","text":"main model specification functions, conditional, joint,    markov, ..., saturated,   return list vectors indicating marginal totals fit,   via margin argument loglin.   element list corresponds high-order   term hierarchical loglinear model, , e.g., term   like c(\"\", \"B\") equivalent loglm   term \":B\" hence automatically includes low-order terms. Note can used supply expected argument   default mosaic function, data supplied   contingency table. table shows typical results terms standard shorthand   notation loglinear models, factors , B, C, ..., brackets   used delimit high-order terms loglinear model.  loglin2formula converts output one model formula   suitable formula loglm. loglin2string converts output one string   describing loglinear model shorthand bracket notation,   e.g., \"[,B] [,C]\".","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loglinear Model Utilities — loglin-utilities","text":"main model specification functions, conditional, joint,  markov, ..., result    list vectors (terms), elements vector    names factors. elements list given names term1, term2, ....","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loglinear Model Utilities — loglin-utilities","text":"functions inspired original SAS implementation mosaic displays, described User's Guide, http://www.datavis.ca/mosaics/mosaics.pdf","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Loglinear Model Utilities — loglin-utilities","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/loglin-utilities.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loglinear Model Utilities — loglin-utilities","text":"","code":"joint(3, table=HairEyeColor) #> $term1 #> [1] \"Hair\" \"Eye\"  #>  #> $term2 #> [1] \"Sex\" #>  # as a formula or string loglin2formula(joint(3, table=HairEyeColor)) #> ~Hair:Eye + Sex #> <environment: 0x000000004c7acf48> loglin2string(joint(3, table=HairEyeColor)) #> [1] \"[Hair,Eye] [Sex]\"  joint(2, HairEyeColor)  # marginal model for [Hair] [Eye] #> $term1 #> [1] \"Hair\" #>  #> $term2 #> [1] \"Eye\" #>   # other possibilities joint(4, factors=letters, with=1) #> $term1 #> [1] \"b\" \"c\" \"d\" #>  #> $term2 #> [1] \"a\" #>  joint(5, factors=LETTERS) #> $term1 #> [1] \"A\" \"B\" \"C\" \"D\" #>  #> $term2 #> [1] \"E\" #>  joint(5, factors=LETTERS, with=4:5) #> $term1 #> [1] \"A\" \"B\" \"C\" #>  #> $term2 #> [1] \"D\" \"E\" #>   conditional(4) #> $term1 #> [1] 1 4 #>  #> $term2 #> [1] 2 4 #>  #> $term3 #> [1] 3 4 #>  conditional(4, with=3:4) #> $term1 #> [1] 1 3 4 #>  #> $term2 #> [1] 2 3 4 #>   # use in mosaic displays or other strucplots mosaic(HairEyeColor, expected=joint(3))  mosaic(HairEyeColor, expected=conditional(3))   # use with MASS::loglm cond3 <- loglin2formula(conditional(3, table=HairEyeColor)) cond3 <- loglin2formula(conditional(3))  # same, with factors 1,2,3 require(MASS) loglm(cond3, data=HairEyeColor) #> Call: #> loglm(formula = cond3, data = HairEyeColor) #>  #> Statistics: #>                       X^2 df P(> X^2) #> Likelihood Ratio 156.6779 18        0 #> Pearson          147.9440 18        0  saturated(3, HairEyeColor) #> $term1 #> [1] \"Hair\" \"Eye\"  \"Sex\"  #>  loglin2formula(saturated(3, HairEyeColor)) #> ~Hair:Eye:Sex #> <environment: 0x000000004c7acf48> loglin2string(saturated(3, HairEyeColor)) #> [1] \"[Hair,Eye,Sex]\" loglin2string(saturated(3, HairEyeColor), brackets='{}', sep=', ') #> [1] \"{Hair, Eye, Sex}\""},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":null,"dir":"Reference","previous_headings":"","what":"The Logarithmic Series Distribution — logseries","title":"The Logarithmic Series Distribution — logseries","text":"logarithmic series distribution long-tailed distribution introduced Fisher etal. (1943) connection data abundance individuals classified species. functions provide density, distribution function, quantile function  random generation  logarithmic series distribution parameter prob.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Logarithmic Series Distribution — logseries","text":"","code":"dlogseries(x, prob = 0.5, log = FALSE)  plogseries(q, prob = 0.5, lower.tail = TRUE, log.p = FALSE)  qlogseries(p, prob = 0.5, lower.tail = TRUE, log.p = FALSE, max.value = 10000)  rlogseries(n, prob = 0.5)"},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Logarithmic Series Distribution — logseries","text":"x, q vector quantiles representing number events. prob parameter distribution, 0 < prob < 1 log, log.p logical; TRUE, probabilities p given log(p) lower.tail logical; TRUE (default), probabilities \\(P[X \\le x]\\),  otherwise, \\(P[X > x]\\). p vector probabilities max.value maximum value returned qlogseries n number observations rlogseries","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Logarithmic Series Distribution — logseries","text":"logarithmic series distribution prob = \\(p\\) density $$ \tp ( x )  = \\alpha p^x / x $$ \\(x = 1, 2, \\dots\\), \\(\\alpha= -1 / \\log(1 - p)\\) \\(0 < p <1\\).  Note counts x==2 occur.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Logarithmic Series Distribution — logseries","text":"dlogseries gives density,  plogseries gives distribution function,  qlogseries gives quantile function,  rlogseries generates random deviates.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Logarithmic Series Distribution — logseries","text":"https://en.wikipedia.org/wiki/Logarithmic_distribution Fisher, R. . Corbet, . S. Williams, C. B. (1943). relation number species number individuals  Journal Animal Ecology, 12, 42-58.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The Logarithmic Series Distribution — logseries","text":"Michael Friendly, using original code modified gmlss.dist package Mikis Stasinopoulos.","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/logseries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Logarithmic Series Distribution — logseries","text":"","code":"XL <-expand.grid(x=1:5, p=c(0.33, 0.66, 0.99)) lgs.df <- data.frame(XL, prob=dlogseries(XL[,\"x\"], XL[,\"p\"])) lgs.df$p = factor(lgs.df$p) str(lgs.df) #> 'data.frame':\t15 obs. of  3 variables: #>  $ x   : int  1 2 3 4 5 1 2 3 4 5 ... #>  $ p   : Factor w/ 3 levels \"0.33\",\"0.66\",..: 1 1 1 1 1 2 2 2 2 2 ... #>  $ prob: num  0.82402 0.13596 0.02991 0.0074 0.00195 ...  require(lattice) #> Loading required package: lattice #>  #> Attaching package: 'lattice' #> The following object is masked from 'package:gnm': #>  #>     barley mycol <- palette()[2:4] xyplot( prob ~ x, data=lgs.df, groups=p,   xlab=list('Number of events (k)', cex=1.25),   ylab=list('Probability',  cex=1.25),   type='b', pch=15:17, lwd=2, cex=1.25, col=mycol,   key = list(           title = 'p',           points = list(pch=15:17, col=mycol, cex=1.25),           lines = list(lwd=2, col=mycol),           text = list(levels(lgs.df$p)),           x=0.9, y=0.98, corner=c(x=1, y=1)           )   )    # random numbers hist(rlogseries(200, prob=.4), xlab='x')  hist(rlogseries(200, prob=.8), xlab='x')"},{"path":"http://friendly.github.io/vcdExtra/reference/LRstats.html","id":null,"dir":"Reference","previous_headings":"","what":"Brief Summary of Model Fit for glm and loglm Models — LRstats","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"glm objects, print summary methods give much information one wants see brief summary model goodness fit, easy way display compact comparison model goodness fit collection models fit data. loglm models equivalent glm forms,  print summary methods give quite different results. LRstats provides brief summary one models fit dataset logLik nobs methods exist (e.g., glm loglm models).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/LRstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"","code":"LRstats(object, ...)  # S3 method for glmlist LRstats(object, ..., saturated = NULL, sortby = NULL) # S3 method for loglmlist LRstats(object, ..., saturated = NULL, sortby = NULL) # S3 method for default LRstats(object, ..., saturated = NULL, sortby = NULL)"},{"path":"http://friendly.github.io/vcdExtra/reference/LRstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"object fitted model object exists logLik method extract corresponding log-likelihood ... optionally fitted model objects saturated saturated model log likelihood reference value (use 0 deviance available) sortby either numeric character string specifying column result rows sorted (decreasing order)","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/LRstats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"function relies residual degrees freedom LR chisq test available model object.  true objects inheriting  lm, glm, loglm, polr negbin.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/LRstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"data frame (also class anova) columns  c(\"AIC\", \"BIC\", \"LR Chisq\", \"Df\", \"Pr(>Chisq)\"). Row names taken names model object(s).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/LRstats.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"Achim Zeileis","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/LRstats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brief Summary of Model Fit for glm and loglm Models — LRstats","text":"","code":"data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) LRstats(indep) #> Likelihood summary table: #>          AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep 209.59 220.19   47.418 15  3.155e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)                  # compare models LRstats(indep, coleff, roweff, linlin) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep  209.59 220.19   47.418 15  3.155e-05 *** #> coleff 179.00 195.50    6.829 10     0.7415     #> roweff 174.45 188.59    6.281 12     0.9013     #> linlin 174.07 185.85    9.895 14     0.7698     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://friendly.github.io/vcdExtra/reference/Mammograms.html","id":null,"dir":"Reference","previous_headings":"","what":"Mammogram Ratings — Mammograms","title":"Mammogram Ratings — Mammograms","text":"Kundel & Polansky (2003) give (possibly contrived) data  set 110 mammograms rated two readers.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mammograms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mammogram Ratings — Mammograms","text":"","code":"data(Mammograms)"},{"path":"http://friendly.github.io/vcdExtra/reference/Mammograms.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mammogram Ratings — Mammograms","text":"frequency table matrix form.  format :  num [1:4, 1:4] 34 6 2 0 10 8 5 1 2 8 ...  - attr(*, \"dimnames\")=List 2   ..$ Reader2: chr [1:4] \"Absent\" \"Minimal\" \"Moderate\" \"Severe\"   ..$ Reader1: chr [1:4] \"Absent\" \"Minimal\" \"Moderate\" \"Severe\"","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mammograms.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mammogram Ratings — Mammograms","text":"Kundel, H. L. & Polansky, M. (2003),  \"Measurement Observer Agreement\", Radiology, 228, 303-308, Table A1","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mammograms.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mammogram Ratings — Mammograms","text":"","code":"data(Mammograms) B <- agreementplot(Mammograms, main=\"Mammogram ratings\")  # agreement measures B #> $Bangdiwala #>           [,1] #> [1,] 0.4272076 #>  #> $Bangdiwala_Weighted #>           [,1] #> [1,] 0.8366481 #>  #> $weights #> [1] 1.0000000 0.8888889 #>  Kappa(Mammograms) #>             value     ASE      z  Pr(>|z|) #> Unweighted 0.3713 0.06033  6.154 7.560e-10 #> Weighted   0.5964 0.04923 12.114 8.901e-34  ## other displays mosaic(Mammograms, shade=TRUE)   sieve(Mammograms, pop = FALSE, shade = TRUE) labeling_cells(text = Mammograms, gp_text = gpar(fontface = 2, cex=1.75))(as.table(Mammograms))"},{"path":"http://friendly.github.io/vcdExtra/reference/mcaplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple and enhanced plot of MCA solutions — mcaplot","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"function intended alternative plot.mjca plotting multiple correspondence analysis solutions. provides flexibility labeling factor levels connecting lines. support features plot.mjca (centroids, supplementary points, arrows, etc.)","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"","code":"mcaplot(obj, map = \"symmetric\", dim = 1:2,          col = c(\"blue\", \"red\", \"brown\", \"black\", \"green3\", \"purple\"),          pch = 15:20, cex = 1.2, pos = 3, lines = TRUE, lwd = 2,          legend = FALSE, legend.pos = \"topright\",          xlab = \"_auto_\", ylab = \"_auto_\",          rev.axes  = c(FALSE, FALSE),         ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"obj \"mjca\" object map Character string specifying map type, .e., scaling applied coordinates different types MCA representations. Allowed options include:         \"symmetric\" (default),         \"rowprincipal\",   \"colprincipal\", \"symbiplot\",         \"rowgab\", \"colgab\", \"rowgreen\", \"colgreen\".         See mjca details. dim Dimensions plot, integer vector length 2 col Vector colors, one factor MCA pch Vector point symbols category levels, one factor cex Character size points level labels pos Position level labels relative category points; either single number              vector length equal number category points. lines logical integer vector indicating factors              joined lines using multilines lwd Line width(s) lines legend Logical; draw legend factor names? legend.pos Position legend plot, legend xlab,ylab Labels horizontal vertical axes.  default, \"_auto_\" means function auto-generates label  form \"Dimension X (xx.x %)\" rev.axes logical vector length 2, TRUE reverses direction              corresponding axis ... Arguments passed plot","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"Returns coordinates category points invisibly","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/mcaplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simple and enhanced plot of MCA solutions — mcaplot","text":"","code":"require(ca) data(Titanic) titanic.mca <- mjca(Titanic) #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE mcaplot(titanic.mca, legend=TRUE, legend.pos=\"topleft\")   data(HairEyeColor) haireye.mca <- mjca(HairEyeColor) #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE #> Warning: 'as.is' should be specified by the caller; using TRUE mcaplot(haireye.mca, legend=TRUE, cex.lab=1.3)"},{"path":"http://friendly.github.io/vcdExtra/reference/Mental.html","id":null,"dir":"Reference","previous_headings":"","what":"Mental impairment and parents SES — Mental","title":"Mental impairment and parents SES — Mental","text":"6 x 4 contingency table representing cross-classification mental health status (mental) 1660 young New York residents parents' socioeconomic status (ses).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mental.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mental impairment and parents SES — Mental","text":"","code":"data(Mental)"},{"path":"http://friendly.github.io/vcdExtra/reference/Mental.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mental impairment and parents SES — Mental","text":"data frame frequency table 24 observations following 3 variables. ses ordered factor levels 1 < 2 < 3 < 4 < 5 < 6 mental ordered factor levels Well < Mild < Moderate < Impaired Freq cell frequency: numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mental.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mental impairment and parents SES — Mental","text":"ses mental can treated ordered factors integer scores.  ses, 1=\"High\" 6=\"Low\".","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mental.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mental impairment and parents SES — Mental","text":"Haberman, S. J.  Analysis Qualitative Data: New Developments, Academic Press, 1979, Vol. II, p. 375. Srole, L.; Langner, T. S.; Michael, S. T.; Kirkpatrick, P.; Opler, M. K. & Rennie, T. . C.  Mental Health Metropolis: Midtown Manhattan Study, NYU Press, 1978, p. 289","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mental.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mental impairment and parents SES — Mental","text":"Friendly, M. Visualizing Categorical Data, Cary, NC: SAS Institute, 2000, Appendix B.7.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mental.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mental impairment and parents SES — Mental","text":"","code":"data(Mental) str(Mental) #> 'data.frame':\t24 obs. of  3 variables: #>  $ ses   : Ord.factor w/ 6 levels \"1\"<\"2\"<\"3\"<\"4\"<..: 1 1 1 1 2 2 2 2 3 3 ... #>  $ mental: Ord.factor w/ 4 levels \"Well\"<\"Mild\"<..: 1 2 3 4 1 2 3 4 1 2 ... #>  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ... (Mental.tab <- xtabs(Freq ~ ses+mental, data=Mental)) #>    mental #> ses Well Mild Moderate Impaired #>   1   64   94       58       46 #>   2   57   94       54       40 #>   3   57  105       65       60 #>   4   72  141       77       94 #>   5   36   97       54       78 #>   6   21   71       54       71  # mosaic and sieve plots mosaic(Mental.tab, gp=shading_Friendly)  sieve(Mental.tab, gp=shading_Friendly)   library(ca) plot(ca(Mental.tab), main=\"Mental impairment & SES\") title(xlab=\"Dim 1\", ylab=\"Dim 2\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Mice.html","id":null,"dir":"Reference","previous_headings":"","what":"Mice Depletion Data — Mice","title":"Mice Depletion Data — Mice","text":"Data Kastenbaum Lamphiear (1959). table gives number depletions (deaths) 657 litters mice, classified litter size treatment.  data set become classic analysis contingency tables, yet unfortunately little information details experiment published.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mice.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mice Depletion Data — Mice","text":"","code":"data(\"Mice\")"},{"path":"http://friendly.github.io/vcdExtra/reference/Mice.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mice Depletion Data — Mice","text":"frequency data frame 30 observations following 4 variables, representing 5 x 2 x 3 contingency table. litter litter size, numeric vector treatment treatment, factor levels B deaths number depletions, factor levels 0 1 2+ Freq cell frequency, numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mice.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mice Depletion Data — Mice","text":"Goodman, L. . (1983) analysis dependence cross-classifications ordered categories, using log-linear models frequencies log-linear models odds. Biometrics, 39, 149-160.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mice.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mice Depletion Data — Mice","text":"Kastenbaum, M. . & Lamphiear, D. E. (1959) Calculation chi-square calculate three-factor interaction hypothesis. Biometrics, 15, 107-115.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mice.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mice Depletion Data — Mice","text":"","code":"data(Mice) # make a table ftable(mice.tab <- xtabs(Freq ~ litter + treatment + deaths, data=Mice)) #>                  deaths  0  1 2+ #> litter treatment                 #> 7      A                58 11  5 #>        B                75 19  7 #> 8      A                49 14 10 #>        B                58 17  8 #> 9      A                33 18 15 #>        B                45 22 10 #> 10     A                15 13 15 #>        B                39 22 18 #> 11     A                 4 12 17 #>        B                 5 15  8  library(vcd) mosaic(mice.tab, shade=TRUE)"},{"path":"http://friendly.github.io/vcdExtra/reference/Mobility.html","id":null,"dir":"Reference","previous_headings":"","what":"Social Mobility data — Mobility","title":"Social Mobility data — Mobility","text":"Data social mobility, recording occupational category fathers sons.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mobility.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Social Mobility data — Mobility","text":"","code":"data(Mobility)"},{"path":"http://friendly.github.io/vcdExtra/reference/Mobility.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Social Mobility data — Mobility","text":"    2-dimensional array resulting cross-tabulating    2 variables 19912 observations. variable names levels :","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mobility.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Social Mobility data — Mobility","text":"Falguerolles, . de Mathieu, J. R. (1988).  Proceedings COMPSTAT 88, Copenhagen,  Denmark, Springer-Verlag.  Featherman, D. L. Hauser, R. M. Occupations social mobility United States.  Sociological Microjournal, 12, Fiche 62. Copenhagen: Sociological Institute.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Mobility.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Social Mobility data — Mobility","text":"","code":"data(Mobility)  # example goes here"},{"path":"http://friendly.github.io/vcdExtra/reference/modFit.html","id":null,"dir":"Reference","previous_headings":"","what":"Brief Summary of Model Fit for a glm or loglm Object — modFit","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"Formats brief summary model fit glm loglm object, showing likelihood ratio Chisq (df) value AIC.  Useful inclusion plot title annotation.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/modFit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"","code":"modFit(x, ...) # S3 method for glm modFit(x, stats=\"chisq\", digits=2, ...) # S3 method for loglm modFit(x, stats=\"chisq\", digits=2, ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/modFit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"x glm loglm object ... Arguments passed stats One chisq aic, determining statistics displayed. digits Number digits decimal point displayed statistics.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/modFit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"character string containing formatted values chosen statistics.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/modFit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/modFit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brief Summary of Model Fit for a glm or loglm Object — modFit","text":"","code":"data(Mental) require(MASS) (Mental.tab <- xtabs(Freq ~ ses+mental, data=Mental)) #>    mental #> ses Well Mild Moderate Impaired #>   1   64   94       58       46 #>   2   57   94       54       40 #>   3   57  105       65       60 #>   4   72  141       77       94 #>   5   36   97       54       78 #>   6   21   71       54       71 (Mental.mod <- loglm(~ses+mental, Mental.tab)) #> Call: #> loglm(formula = ~ses + mental, data = Mental.tab) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 47.41785 15 3.155408e-05 #> Pearson          45.98526 15 5.345771e-05 Mental.mod #> Call: #> loglm(formula = ~ses + mental, data = Mental.tab) #>  #> Statistics: #>                       X^2 df     P(> X^2) #> Likelihood Ratio 47.41785 15 3.155408e-05 #> Pearson          45.98526 15 5.345771e-05 modFit(Mental.mod) #> [1] \"G^2(15)=47.42\"  # use to label mosaic() mosaic(Mental.mod, main=paste(\"Independence model,\", modFit(Mental.mod))) #> Error in loglm(formula = ~ses + mental, data = Mental.tab, fitted = TRUE): object 'Mental.tab' not found"},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"Produces mosaic plots (plots strucplot framework)  log-linear model fitted glm generalized nonlinear model fitted gnm. methods extend range strucplot visualizations well beyond models can fit loglm. intended models counts using Poisson family (quasi-poisson), sensible long () response variable non-negative (b) predictors visualized strucplot discrete factors.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"","code":"# S3 method for glm mosaic(x, formula = NULL, panel = mosaic,       type = c(\"observed\", \"expected\"),       residuals = NULL,       residuals_type = c(\"pearson\", \"deviance\", \"rstandard\"),       gp = shading_hcl, gp_args = list(), ...) # S3 method for glm sieve(x,  ...) # S3 method for glm assoc(x,  ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"x glm gnm object. response variable, typically      cell frequency, non-negative. formula one-sided formula indexing factors plot     separated '+', determining order variables used mosaic.      formula must provided unless x$data     inherits class \"table\" -- case indexing     factors table used, factors x$data     (model.frame(x) x$data environment) exactly     cross-classify data -- case set     cross-classifying factors used. panel Panel function used draw plot visualizing observed values, residuals     expected values. Currently, one \"mosaic\", \"assoc\", \"sieve\"    vcd. type character string indicating whether    \"observed\" \"expected\" values table visualized   area tiles bars. residuals optional array vector residuals corresponding cells   data, example, calculated residuals.glm(x), residuals.gnm(x). residuals_type residuals argument NULL, residuals calculated internally   used display.  case, residual_type can \"pearson\",    \"deviance\" \"rstandard\".  Otherwise (residuals supplied),   residuals_type used label legend    plot. gp Object class \"gpar\", shading function corresponding generating function    (see strucplot Details shadings).    Ignored shade = FALSE. gp_args list arguments shading-generating function, specified. ... arguments passed panel function e.g., mosaic","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"poisson family generalized linear models loglinear models, standardized residuals provided rstandard (sometimes called adjusted residuals) often preferred  constant unit asymptotic variance. sieve assoc methods simple convenience interfaces plot method, setting panel argument accordingly.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"structable visualized strucplot returned invisibly.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"Heather Turner, Michael Friendly, help Achim Zeileis","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm","text":"","code":"GSStab <- xtabs(count ~ sex + party, data=GSS) # using the data in table form mod.glm1 <- glm(Freq ~ sex + party, family = poisson, data = GSStab) res <- residuals(mod.glm1)     std <- rstandard(mod.glm1)  # For mosaic.default(), need to re-shape residuals to conform to data stdtab <- array(std, dim=dim(GSStab), dimnames=dimnames(GSStab)) mosaic(GSStab, gp=shading_Friendly, residuals=stdtab, residuals_type=\"Std\\nresiduals\",         labeling = labeling_residuals)    # Using externally calculated residuals with the glm() object mosaic.glm(mod.glm1, residuals=std, labeling = labeling_residuals, shade=TRUE)   # Using residuals_type mosaic.glm(mod.glm1, residuals_type=\"rstandard\", labeling = labeling_residuals, shade=TRUE)   ## Ordinal factors and structured associations data(Mental) xtabs(Freq ~ mental+ses, data=Mental) #>           ses #> mental       1   2   3   4   5   6 #>   Well      64  57  57  72  36  21 #>   Mild      94  94 105 141  97  71 #>   Moderate  58  54  65  77  54  54 #>   Impaired  46  40  60  94  78  71 long.labels <- list(set_varnames = c(mental=\"Mental Health Status\", ses=\"Parent SES\"))  # fit independence model # Residual deviance: 47.418 on 15 degrees of freedom indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental)  long.labels <- list(set_varnames = c(mental=\"Mental Health Status\",                                       ses=\"Parent SES\")) mosaic(indep,residuals_type=\"rstandard\", labeling_args = long.labels, labeling=labeling_residuals) #> Warning: no formula provided, assuming ~ses + mental  # or, show as a sieve diagram mosaic(indep, labeling_args = long.labels, panel=sieve, gp=shading_Friendly) #> Warning: no formula provided, assuming ~ses + mental   # fit linear x linear (uniform) association.  Use integer scores for rows/cols  Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental) mosaic(linlin,residuals_type=\"rstandard\",   labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly,  main=\"Lin x Lin model\") #> Warning: no formula provided, assuming ~ses + mental   ##  Goodman Row-Column association model fits even better (deviance 3.57, df 8) if (require(gnm)) { Mental$mental <- C(Mental$mental, treatment) Mental$ses <- C(Mental$ses, treatment) RC1model <- gnm(Freq ~ ses + mental + Mult(ses, mental),                 family = poisson, data = Mental)  mosaic(RC1model,residuals_type=\"rstandard\",   labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly,  main=\"RC1 model\")  } #> Initialising #> Running start-up iterations.. #> Running main iterations........ #> Done #> Warning: no formula provided, assuming ~ses + mental     ############# UCB Admissions data, fit using glm()    structable(Dept ~ Admit+Gender,UCBAdmissions) #>                 Dept   A   B   C   D   E   F #> Admit    Gender                              #> Admitted Male        512 353 120 138  53  22 #>          Female       89  17 202 131  94  24 #> Rejected Male        313 207 205 279 138 351 #>          Female       19   8 391 244 299 317   berkeley <- as.data.frame(UCBAdmissions) berk.glm1 <- glm(Freq ~ Dept * (Gender+Admit), data=berkeley, family=\"poisson\") summary(berk.glm1) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit), family = \"poisson\",  #>     data = berkeley) #>  #> Deviance Residuals:  #>     Min       1Q   Median       3Q      Max   #> -3.4776  -0.4144   0.0098   0.3089   2.2321   #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.27557    0.04248 147.744  < 2e-16 *** #> DeptB               -0.40575    0.06770  -5.993 2.06e-09 *** #> DeptC               -1.53939    0.08305 -18.536  < 2e-16 *** #> DeptD               -1.32234    0.08159 -16.207  < 2e-16 *** #> DeptE               -2.40277    0.11014 -21.816  < 2e-16 *** #> DeptF               -3.09624    0.15756 -19.652  < 2e-16 *** #> GenderFemale        -2.03325    0.10233 -19.870  < 2e-16 *** #> AdmitRejected       -0.59346    0.06838  -8.679  < 2e-16 *** #> DeptB:GenderFemale  -1.07581    0.22860  -4.706 2.52e-06 *** #> DeptC:GenderFemale   2.63462    0.12343  21.345  < 2e-16 *** #> DeptD:GenderFemale   1.92709    0.12464  15.461  < 2e-16 *** #> DeptE:GenderFemale   2.75479    0.13510  20.391  < 2e-16 *** #> DeptF:GenderFemale   1.94356    0.12683  15.325  < 2e-16 *** #> DeptB:AdmitRejected  0.05059    0.10968   0.461    0.645     #> DeptC:AdmitRejected  1.20915    0.09726  12.432  < 2e-16 *** #> DeptD:AdmitRejected  1.25833    0.10152  12.395  < 2e-16 *** #> DeptE:AdmitRejected  1.68296    0.11733  14.343  < 2e-16 *** #> DeptF:AdmitRejected  3.26911    0.16707  19.567  < 2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   21.736  on  6  degrees of freedom #> AIC: 216.8 #>  #> Number of Fisher Scoring iterations: 4 #>  mosaic(berk.glm1, gp=shading_Friendly, labeling=labeling_residuals, formula=~Admit+Dept+Gender)  # the same, displaying studentized residuals; note use of formula to reorder factors in the mosaic mosaic(berk.glm1, residuals_type=\"rstandard\", labeling=labeling_residuals, shade=TRUE,    formula=~Admit+Dept+Gender, main=\"Model: [DeptGender][DeptAdmit]\")   ## all two-way model berk.glm2 <- glm(Freq ~ (Dept + Gender + Admit)^2, data=berkeley, family=\"poisson\") summary(berk.glm2) #>  #> Call: #> glm(formula = Freq ~ (Dept + Gender + Admit)^2, family = \"poisson\",  #>     data = berkeley) #>  #> Deviance Residuals:  #>        1         2         3         4         5         6         7         8   #> -0.75481   0.99471   1.96454  -3.15768  -0.03402   0.04449   0.15709  -0.22034   #>        9        10        11        12        13        14        15        16   #>  1.01273  -0.73839  -0.74367   0.54896   0.06760  -0.04741  -0.06911   0.05080   #>       17        18        19        20        21        22        23        24   #>  1.05578  -0.61236  -0.73617   0.42678  -0.20117   0.05113   0.19803  -0.05370   #>  #> Coefficients: #>                            Estimate Std. Error z value Pr(>|z|)     #> (Intercept)                 6.27150    0.04271 146.855  < 2e-16 *** #> DeptB                      -0.40322    0.06784  -5.944 2.78e-09 *** #> DeptC                      -1.57790    0.08949 -17.632  < 2e-16 *** #> DeptD                      -1.35000    0.08526 -15.834  < 2e-16 *** #> DeptE                      -2.44982    0.11755 -20.840  < 2e-16 *** #> DeptF                      -3.13787    0.16174 -19.401  < 2e-16 *** #> GenderFemale               -1.99859    0.10593 -18.866  < 2e-16 *** #> AdmitRejected              -0.58205    0.06899  -8.436  < 2e-16 *** #> DeptB:GenderFemale         -1.07482    0.22861  -4.701 2.58e-06 *** #> DeptC:GenderFemale          2.66513    0.12609  21.137  < 2e-16 *** #> DeptD:GenderFemale          1.95832    0.12734  15.379  < 2e-16 *** #> DeptE:GenderFemale          2.79519    0.13925  20.073  < 2e-16 *** #> DeptF:GenderFemale          2.00232    0.13571  14.754  < 2e-16 *** #> DeptB:AdmitRejected         0.04340    0.10984   0.395    0.693     #> DeptC:AdmitRejected         1.26260    0.10663  11.841  < 2e-16 *** #> DeptD:AdmitRejected         1.29461    0.10582  12.234  < 2e-16 *** #> DeptE:AdmitRejected         1.73931    0.12611  13.792  < 2e-16 *** #> DeptF:AdmitRejected         3.30648    0.16998  19.452  < 2e-16 *** #> GenderFemale:AdmitRejected -0.09987    0.08085  -1.235    0.217     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   20.204  on  5  degrees of freedom #> AIC: 217.26 #>  #> Number of Fisher Scoring iterations: 4 #>  mosaic.glm(berk.glm2, residuals_type=\"rstandard\", labeling = labeling_residuals, shade=TRUE,   formula=~Admit+Dept+Gender, main=\"Model: [DeptGender][DeptAdmit][AdmitGender]\")  anova(berk.glm1, berk.glm2, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ (Dept + Gender + Admit)^2 #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi) #> 1         6     21.735                      #> 2         5     20.204  1   1.5312   0.2159  # Add 1 df term for association of [GenderAdmit] only in Dept A berkeley <- within(berkeley, dept1AG <- (Dept=='A')*(Gender=='Female')*(Admit=='Admitted')) berkeley[1:6,] #>      Admit Gender Dept Freq dept1AG #> 1 Admitted   Male    A  512       0 #> 2 Rejected   Male    A  313       0 #> 3 Admitted Female    A   89       1 #> 4 Rejected Female    A   19       0 #> 5 Admitted   Male    B  353       0 #> 6 Rejected   Male    B  207       0 berk.glm3 <- glm(Freq ~ Dept * (Gender+Admit) + dept1AG, data=berkeley, family=\"poisson\") summary(berk.glm3) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit) + dept1AG, family = \"poisson\",  #>     data = berkeley) #>  #> Deviance Residuals:  #>        1         2         3         4         5         6         7         8   #>  0.00000   0.00000   0.00000   0.00000  -0.06316   0.08273   0.29514  -0.40088   #>        9        10        11        12        13        14        15        16   #>  0.55733  -0.41519  -0.41820   0.30511  -0.30655   0.21843   0.32036  -0.23141   #>       17        18        19        20        21        22        23        24   #>  0.69837  -0.41419  -0.49916   0.28628  -0.42032   0.10861   0.42684  -0.11382   #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.23832    0.04419 141.157  < 2e-16 *** #> DeptB               -0.36850    0.06879  -5.357 8.47e-08 *** #> DeptC               -1.50215    0.08394 -17.895  < 2e-16 *** #> DeptD               -1.28509    0.08250 -15.577  < 2e-16 *** #> DeptE               -2.36552    0.11081 -21.347  < 2e-16 *** #> DeptF               -3.05899    0.15803 -19.357  < 2e-16 *** #> GenderFemale        -2.80176    0.23628 -11.858  < 2e-16 *** #> AdmitRejected       -0.49212    0.07175  -6.859 6.94e-12 *** #> dept1AG              1.05208    0.26271   4.005 6.21e-05 *** #> DeptB:GenderFemale  -0.30730    0.31243  -0.984    0.325     #> DeptC:GenderFemale   3.40313    0.24615  13.825  < 2e-16 *** #> DeptD:GenderFemale   2.69560    0.24676  10.924  < 2e-16 *** #> DeptE:GenderFemale   3.52330    0.25220  13.970  < 2e-16 *** #> DeptF:GenderFemale   2.71207    0.24787  10.941  < 2e-16 *** #> DeptB:AdmitRejected -0.05074    0.11181  -0.454    0.650     #> DeptC:AdmitRejected  1.10781    0.09966  11.116  < 2e-16 *** #> DeptD:AdmitRejected  1.15699    0.10381  11.145  < 2e-16 *** #> DeptE:AdmitRejected  1.58162    0.11933  13.254  < 2e-16 *** #> DeptF:AdmitRejected  3.16777    0.16848  18.803  < 2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.0952  on 23  degrees of freedom #> Residual deviance:    2.6815  on  5  degrees of freedom #> AIC: 199.74 #>  #> Number of Fisher Scoring iterations: 3 #>  mosaic.glm(berk.glm3, residuals_type=\"rstandard\", labeling = labeling_residuals, shade=TRUE,   formula=~Admit+Dept+Gender, main=\"Model: [DeptGender][DeptAdmit] + DeptA*[GA]\")  anova(berk.glm1, berk.glm3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ Dept * (Gender + Admit) + dept1AG #>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     #> 1         6    21.7355                           #> 2         5     2.6815  1   19.054 1.271e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":null,"dir":"Reference","previous_headings":"","what":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"function provides convenient interface viewing mosaic displays associated collection glm models frequency tables stored glmlist loglmlist object.  can plot either selected models individually, mosaics models array viewports.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"","code":"# S3 method for glmlist mosaic(x, selection,    panel=mosaic,   type=c(\"observed\", \"expected\"),    legend=ask | !missing(selection),   main=NULL,   ask=TRUE, graphics=TRUE, rows, cols, newpage=TRUE,   ...)  # S3 method for loglmlist mosaic(x, selection,    panel=mosaic,   type=c(\"observed\", \"expected\"),    legend=ask | !missing(selection),   main=NULL,   ask=TRUE, graphics=TRUE, rows, cols, newpage=TRUE,   ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"x glmlist loglmlist object selection index name one glm loglm object x.  selection specified, menu models presented models plotted. panel strucplot panel function, typically mosaic sieve type character string indicating whether \"observed\" \"expected\" values table visualized legend logical: show legend residuals mosaic display(s)?  default behavior include legend single plot shown, .e., ask TRUE selection specified. main either logical, vector character strings used plotting main title.  main logical TRUE, name selected glm object  used. ask logical: function display menu models, one specified selection? selection supplied ask TRUE (default),  menu model names presented;  ask FALSE, mosaics models plotted array. graphics logical: use graphic dialog box ask=TRUE? rows,cols ask=FALSE, number rows columns plot mosaics. newpage start new page? (applies ask=FALSE) ... arguments passed mosaic.glm ultimately mosaic.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"details plots produced can controlled via ... arguments shown examples .  particular, panel=sieve need also pass gp=shading_Friendly get color version.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"Returns result mosaic.glm.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"David Meyer, Achim Zeileis, Kurt Hornik (2006). Strucplot Framework: Visualizing Multi-Way   Contingency Tables vcd. Journal Statistical Software, 17(3), 1-48.     doi: 10.18637/jss.v017.i03 ,   available vignette(\"strucplot\", package=\"vcd\").","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic.glmlist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mosaic Displays for glmlist and logllmlist Objects — mosaic.glmlist","text":"","code":"data(JobSatisfaction, package=\"vcd\")  # view all pairwise mosaics pairs(xtabs(Freq~management+supervisor+own, data=JobSatisfaction),      shade=TRUE, diag_panel=pairs_diagonal_mosaic)   modSat <- Kway(Freq ~ management+supervisor+own, data=JobSatisfaction,                 family=poisson, prefix=\"JobSat\") names(modSat) #> [1] \"JobSat.0\" \"JobSat.1\" \"JobSat.2\" \"JobSat.3\"  if (FALSE) { mosaic(modSat)              # uses menu, if interactive() } mosaic(modSat, \"JobSat.1\")  # model label #> Warning: no formula provided, assuming ~management + supervisor + own  mosaic(modSat, 2)           # model index #> Warning: no formula provided, assuming ~management + supervisor + own   # supply a formula to determine the order of variables in the mosaic mosaic(modSat, 2, formula=~own+supervisor+management)   mosaic(modSat, ask=FALSE)   # uses viewports  #> Warning: no formula provided, assuming ~management + supervisor + own #> Warning: no formula provided, assuming ~management + supervisor + own #> Warning: no formula provided, assuming ~management + supervisor + own #> Warning: no formula provided, assuming ~management + supervisor + own   # use a different panel function, label the observed valued in the cells mosaic(modSat, 1, main=TRUE, panel=sieve, gp=shading_Friendly, labeling=labeling_values) #> Warning: no formula provided, assuming ~management + supervisor + own   data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)  # assign names for the plot labels modMental <- glmlist(Indep=indep, ColEff=coleff, RowEff=roweff, `Lin x Lin`=linlin) mosaic(modMental, ask=FALSE, margins=c(3,1,1,2), labeling_args=list(abbreviate_labs=5)) #> Warning: no formula provided, assuming ~ses + mental #> Warning: no formula provided, assuming ~ses + mental #> Warning: no formula provided, assuming ~ses + mental #> Warning: no formula provided, assuming ~ses + mental"},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":null,"dir":"Reference","previous_headings":"","what":"3D Mosaic Plots — mosaic3d","title":"3D Mosaic Plots — mosaic3d","text":"Produces 3D mosaic plot contingency table (link[MASS]{loglm} model)  using rgl-package. Generalizing 2D mosaic plot, begins given 3D shape (unit cube), successively sub-divides along X, Y, Z dimensions according table margins, generating nested set 3D tiles. volume resulting tiles  therefore proportional frequency represented table cells. Residuals given loglinear model used color shade tiles. developing implementation.  arguments details subject change.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"3D Mosaic Plots — mosaic3d","text":"","code":"mosaic3d(x, ...)  # S3 method for loglm mosaic3d(x, type = c(\"observed\", \"expected\"),      residuals_type = c(\"pearson\", \"deviance\"), ...)  # S3 method for default mosaic3d(x, expected = NULL, residuals = NULL,     type = c(\"observed\", \"expected\"), residuals_type = NULL,    shape = rgl::cube3d(alpha = alpha), alpha = 0.5,    spacing = 0.1, split_dir = 1:3, shading = shading_basic, interpolate=c(2,4),    zero_size=.05,   label_edge,   labeling_args = list(), newpage = TRUE, box=FALSE, ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"3D Mosaic Plots — mosaic3d","text":"x link[MASS]{loglm} model object. Alternatively, multidimensional array table structable  frequencies contingency table.  present implementation, dimensions taken sequential order. Use link[base]{aperm} structable change . expected optionally, contingency tables, array expected frequencies dimension x, alternatively  corresponding loglinear model specification used link[stats]{loglin} link[MASS]{loglm} (see structable details). residuals optionally, array residuals dimension x (see details). type character string indicating whether \"observed\" \"expected\"  frequencies table visualized volume 3D tiles. residuals_type character string indicating type residuals computed none supplied.   residuals   NULL,  residuals_type  must   one   \"pearson\" (default;  giving  components   Pearson's  chi-squared),   \"deviance\"  (giving components likelihood ratio  chi-squared),  \"FT\"  Freeman-Tukey residuals.   value   argument can  abbreviated. shape initial 3D shape mosaic based.  Typically call rgl function, must produce shape3d object. default \"unit cube\" (-1, +1), transparency specified alpha. alpha Specifies transparency 3D tiles used compose 3D mosaic. spacing number vector giving total amount space used separate 3D tiles along dimensions table. values specified re-cycled number table dimensions. split_dir numeric vector composed integers 1:3 character vector composed c(\"x\", \"y\", \"z\"), split_dir[] specifies axis along tiles split dimension table. values specified re-cycled number table dimensions. shading function, taking array vector residuals given model, returning vector colors.  present, default shading=shading_basic provided.  roughly equivalent use shade argument mosaicplot use gp=shading_Friendly mosaic. interpolate vector interpolation values shading   function. zero_size radius small sphere used mark zero cells display. label_edge character vector composed c(\"-\", \"+\") indicating whether labels given table dimension written minima (\"-\") maxima (\"+\") dimensions plot. default rep( c('-', '+'), =3, length=ndim), meaning first three table variables labeled minima, successive ones maxima. labeling_args argument intended used specify details rendering labels table dimensions, present effect. newpage logical indicating whether new page created plot . box logical indicating whether bounding box drawn around plot. ... arguments passed mosaic.default  3D functions.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"3D Mosaic Plots — mosaic3d","text":"Friendly (1995), Friendly [Sect. 4.5](2000) Theus Lauer (1999) used idea 3D mosaic displays explain various aspects loglinear models (iterative proportional fitting algorithm, structure various models 3-way n-way tables, etc.), implementation 3D mosaics previously available. default method, residuals, used color shade 3D tiles, can passed explicitly, , typically, computed  needed observed expected  frequencies. case,  expected  frequencies   optionally  computed     specified loglinear model given expected argument. loglm method, residuals observed frequencies calculated model object.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"3D Mosaic Plots — mosaic3d","text":"Invisibly, list shape3d objects used draw 3D mosaic, names corresponding concatenation level labels, separated \":\".","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"3D Mosaic Plots — mosaic3d","text":"Friendly, M. (1995). Conceptual Visual Models Categorical Data,  American Statistician, 49, 153-160. Friendly, M. Visualizing Categorical Data, Cary NC: SAS Institute, 2000. Web materials: http://www.datavis.ca/books/vcd/. Theus, M. & Lauer, S. R. W. (1999) Visualizing Loglinear Models.  Journal Computational Graphical Statistics, 8, 396-412.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"3D Mosaic Plots — mosaic3d","text":"Michael Friendly, help Duncan Murdoch Achim Zeileis","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/mosaic3d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"3D Mosaic Plots — mosaic3d","text":"","code":"# 2 x 2 x 2 if(requireNamespace(\"rgl\")){ mosaic3d(Bartlett, box=TRUE) # compare with expected frequencies under model of mutual independence mosaic3d(Bartlett, type=\"expected\", box=TRUE)    # 2 x 2 x 3 mosaic3d(Heart, box=TRUE) } #> Loading required namespace: rgl  if (FALSE) { # 2 x 2 x 2 x 3 # illustrates a 4D table mosaic3d(Detergent)  # compare 2D and 3D mosaics demo(\"mosaic-hec\") }"},{"path":"http://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":null,"dir":"Reference","previous_headings":"","what":"Publications of PhD Candidates — PhdPubs","title":"Publications of PhD Candidates — PhdPubs","text":"data set giving number publications doctoral candidates biochemistry relation various predictors, originally Long (1997). large number zero counts. evidence separate group non-publishers?","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Publications of PhD Candidates — PhdPubs","text":"","code":"data(PhdPubs)"},{"path":"http://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Publications of PhD Candidates — PhdPubs","text":"data frame 915 observations following 6 variables. articles number articles published final three years PhD studies female dummy variable gender, coded 1 female married dummy variable marital status, coded 1 married kid5 number young children, age 5 phdprestige prestige PhD department.  higher number prestigious program. mentor number publications mentor preceeding three years","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Publications of PhD Candidates — PhdPubs","text":"version data set, phdprestige rounded nearest integer. Stata version continuous values subsequently found https://www.stata-press.com/data/lf2/couart2.dta","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Publications of PhD Candidates — PhdPubs","text":"Long, J. S. (1997). Regression Models Categorical Limited Dependent Variables, Sage. Long, J. S. & Freese, J. (2006). Regression Models Categorical Dependent Variables Using Stata, 2nd Ed., Stata Press.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/PhdPubs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Publications of PhD Candidates — PhdPubs","text":"","code":"data(PhdPubs) # very uninformative hist(PhdPubs$articles, breaks=0:19, col=\"pink\", xlim=c(0,20),      xlab=\"Number of Articles\")   library(vcd) rootogram(goodfit(PhdPubs$articles), xlab=\"Number of Articles\")  # compare with negative binomial rootogram(goodfit(PhdPubs$articles, type=\"nbinomial\"),    xlab=\"Number of Articles\", main=\"Negative binomial\")"},{"path":"http://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Kappa — print.Kappa","title":"Print Kappa — print.Kappa","text":"replacement print.Kappa method vcd,   adding display z values vcd version   optional confidence intervals.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Kappa — print.Kappa","text":"","code":"# S3 method for Kappa print(x, digits=max(getOption(\"digits\") - 3, 3), CI=FALSE, level=0.95,  ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Kappa — print.Kappa","text":"x Kappa object digits number digits print CI Include confidence intervals display? level confidence level ... arguments","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Kappa — print.Kappa","text":"Returns Kappa object, invisibly.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print Kappa — print.Kappa","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/print.Kappa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print Kappa — print.Kappa","text":"","code":"data(\"SexualFun\") Kappa(SexualFun) #>             value     ASE     z Pr(>|z|) #> Unweighted 0.1293 0.06860 1.885 0.059387 #> Weighted   0.2374 0.07832 3.031 0.002437 print(Kappa(SexualFun), CI=TRUE) #>             value     ASE     z Pr(>|z|)    lower  upper #> Unweighted 0.1293 0.06860 1.885 0.059387 -0.00512 0.2638 #> Weighted   0.2374 0.07832 3.031 0.002437  0.08388 0.3909  # stratified 3-way table apply(MSPatients, 3, Kappa) #> $Winnipeg #>             value     ASE     z  Pr(>|z|) #> Unweighted 0.2079 0.05046 4.121 3.767e-05 #> Weighted   0.3797 0.05167 7.350 1.988e-13 #>  #> $`New Orleans` #>             value     ASE     z  Pr(>|z|) #> Unweighted 0.2965 0.07850 3.777 1.587e-04 #> Weighted   0.4773 0.07303 6.535 6.352e-11 #>"},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":null,"dir":"Reference","previous_headings":"","what":"Sequential Loglinear Models for an N-way Table — seq_loglm","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"function takes n-way contingency table fits series sequential models 1-, 2-, ... n-way marginal tables, corresponding variety types loglinear models.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"","code":"seq_loglm(x,     type = c(\"joint\", \"conditional\", \"mutual\", \"markov\", \"saturated\"),     marginals = 1:nf, vorder = 1:nf,     k = NULL, prefix = \"model\", fitted = TRUE, ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"x contingency table array form, optional category labels specified  dimnames(x) attribute, else data.frame frequency form, frequency variable named \"Freq\". type type sequential model fit, character string. One \"joint\", \"conditional\", \"mutual\", \"markov\",  \"saturated\". marginals marginal sub-tables fit? vector (sub)set integers, 1:nf nf number factors full n-way table. vorder order variables, permutation integers 1:nf, used reorder variables original table purpose fitting sequential marginal models. k conditioning variable(s) type = \"joint\", \"conditional\"  Markov chain order type = \"markov\" prefix prefix used give names sequential models fitted argument passed loglm store fitted values  model objects ... arguments, passed ","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"Sequential marginal models n-way tables begin model equal-probability one-way margin (equivalent chisq.test) add successive variables one time order specified vorder. model types give result two-way margin, namely test independence first two factors. Sequential models joint independence (type=\"joint\") particularly simple interpretation, decompose likelihood ratio test model  mutual independence full n-way table, hence account \"total\" association terms portions attributable conditional probabilities new variable, given prior variables.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"object class \"loglmlist\", class \"loglm\" object","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"functions inspired original SAS implementation mosaic displays, described User's Guide, http://www.datavis.ca/mosaics/mosaics.pdf","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"One-way marginal tables bit problem , fit directly using loglm. present version uses loglin, repairs result look like loglm object (sort ).","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/seq_loglm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sequential Loglinear Models for an N-way Table — seq_loglm","text":"","code":"data(Titanic, package=\"datasets\") # variables are in the order Class, Sex, Age, Survived tt <- seq_loglm(Titanic)"},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":null,"dir":"Reference","previous_headings":"","what":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"function takes n-way contingency table plots mosaics series sequential models 1-, 2-, ... n-way marginal tables, corresponding variety types loglinear models.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"","code":"seq_mosaic(x, panel = mosaic,     type = c(\"joint\", \"conditional\", \"mutual\", \"markov\", \"saturated\"),     plots = 1:nf, vorder = 1:nf,     k = NULL, ...)"},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"x contingency table array form, optional category labels specified  dimnames(x) attribute, else data.frame frequency form, frequency variable named \"Freq\". panel strucplot panel function,  typically mosaic sieve. yet implemented. type type sequential model fit, character string. One \"joint\", \"conditional\", \"mutual\", \"markov\",  \"saturated\". plots marginal sub-tables plot? vector (sub)set integers, 1:nf nf number factors full n-way table. vorder order variables, permutation integers 1:nf, used reorder variables original table purpose fitting sequential marginal models. k conditioning variable(s) type = \"joint\", \"conditional\"  Markov chain order type = \"markov\" ... arguments passed mosaic.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"function produces  similar plots use mosaic.loglmlist, called result seq_loglm.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"None. Used side-effect producing plots","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"functions inspired original SAS implementation mosaic displays, described User's Guide, http://www.datavis.ca/mosaics/mosaics.pdf","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/seq_mosaic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sequential Mosaics and Strucplots for an N-way Table — seq_mosaic","text":"","code":"data(Titanic, package=\"datasets\")  seq_mosaic(Titanic)  # models of joint independence, Survived last     seq_mosaic(Titanic, type=\"condit\")     seq_mosaic(Titanic, type=\"mutual\")      # other panel functions and options: presently BUGGED if (FALSE) { seq_mosaic(Titanic, type=\"mutual\", panel=sieve,     gp=shading_Friendly, labeling=labeling_values) }"},{"path":"http://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":null,"dir":"Reference","previous_headings":"","what":"Shakespeare's Word Type Frequencies — ShakeWords","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"data set, Efron Thisted (1976),  gives number distinct words types (Freq) words appeared exactly , twice, etc. 100 times (count) complete works Shakespeare.  works, Shakespeare used 31,534 distinct words (types), comprising 884,647 words total. Efron & Thisted used data ask question, \"many words Shakespeare know?\"  Put another way, suppose another new corpus works Shakespeare discovered, also 884,647 words. many new word types appear? answer main question involves contemplating infinite number new corpora.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"","code":"data(ShakeWords)"},{"path":"http://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"data frame 100 observations following 2 variables. count number times word type appeared Shakespeare's written works Freq number different words (types) appearing count.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"addition words appear 1:100 times, 846 words  appear 100 times, listed data set.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"Bradley Efron Ronald Thisted (1976). Estimating Number Unseen Species: Many Words Shakespeare Know? Biometrika, Vol. 63, . 3, pp. 435-447,","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/ShakeWords.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shakespeare's Word Type Frequencies — ShakeWords","text":"","code":"data(ShakeWords) ## maybe str(ShakeWords) ; plot(ShakeWords) ..."},{"path":"http://friendly.github.io/vcdExtra/reference/split3d.html","id":null,"dir":"Reference","previous_headings":"","what":"Subdivide a 3D Object — split3d","title":"Subdivide a 3D Object — split3d","text":"Subdivides shape3d object list shape3d objects objects shape along given dimension according proportions frequencies specified vector(s). split3d basic workhorse used mosaic3d, \tmay useful contexts. range3d center3d utility functions, also useful contexts.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/split3d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subdivide a 3D Object — split3d","text":"","code":"split3d(obj, ...)  # S3 method for shape3d split3d(obj, p, dim, space = 0.1, ...)  # S3 method for list split3d(obj, p, dim, space = 0.1, ...)  range3d(obj)  center3d(obj)"},{"path":"http://friendly.github.io/vcdExtra/reference/split3d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subdivide a 3D Object — split3d","text":"obj shape3d object, list composed ... arguments split3d methods p single shade3d object, vector proportions (vector non-negative numbers normed proportions) indicating number subdivisions scaling along dimension dim. list shade3d objects, matrix whose columns indicate subdivisions object. dim dimension along object subdivided. Either integer: 1, 2, 3, character: \"x\", \"y\", \"z\". space total space used separate copies object along dimension dim. unit inter-object space therefore space/(length(p)-1).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/split3d.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Subdivide a 3D Object — split3d","text":"resulting list shape3d objects actually composed copies input object(s), scaled according proportions p translated make range along splitting dimension equal input object(s).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/split3d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subdivide a 3D Object — split3d","text":"split3d returns list shape3d objects. range3d returns 2 x 3 matrix, whose first row contains minima dimensions x, y, z, whose second row contains maxima. center3d returns numeric vector containing means minima maxima dimensions x, y, z.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/split3d.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Subdivide a 3D Object — split3d","text":"Duncan Murdoch, refinements Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/split3d.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subdivide a 3D Object — split3d","text":"","code":"if (require(rgl)) {   open3d()   cube <- cube3d(alpha=0.4)   sl1 <- split3d(cube, c(.2, .3, .5), 1)   col <- c(\"#FF000080\", \"#E5E5E580\", \"#0000FF80\")   shapelist3d(sl1, col=col)      open3d()   p <- matrix(c(.6, .4, .5, .5, .2, .8), nrow=2)   sl2 <- split3d(sl1, p, 2)   shapelist3d(sl2, col=col)     } #> Loading required package: rgl  {\"x\":{\"material\":{\"color\":\"#000000\",\"alpha\":1,\"lit\":true,\"ambient\":\"#000000\",\"specular\":\"#FFFFFF\",\"emission\":\"#000000\",\"shininess\":50,\"smooth\":true,\"front\":\"filled\",\"back\":\"filled\",\"size\":3,\"lwd\":1,\"fog\":true,\"point_antialias\":false,\"line_antialias\":false,\"texture\":null,\"textype\":\"rgb\",\"texmipmap\":false,\"texminfilter\":\"linear\",\"texmagfilter\":\"linear\",\"texenvmap\":false,\"depth_mask\":true,\"depth_test\":\"less\",\"isTransparent\":false,\"polygon_offset\":[0,0],\"margin\":\"\",\"floating\":false,\"tag\":\"\"},\"rootSubscene\":65,\"objects\":{\"71\":{\"id\":71,\"type\":\"quads\",\"material\":{\"alpha\":0.400000005960464,\"isTransparent\":true},\"vertices\":\"0\",\"colors\":\"2\",\"centers\":\"3\",\"normals\":\"1\",\"ignoreExtent\":false,\"flags\":32811},\"72\":{\"id\":72,\"type\":\"quads\",\"material\":{\"alpha\":0.400000005960464,\"isTransparent\":true},\"vertices\":\"4\",\"colors\":\"6\",\"centers\":\"7\",\"normals\":\"5\",\"ignoreExtent\":false,\"flags\":32811},\"73\":{\"id\":73,\"type\":\"quads\",\"material\":{\"alpha\":0.400000005960464,\"isTransparent\":true},\"vertices\":\"8\",\"colors\":\"10\",\"centers\":\"11\",\"normals\":\"9\",\"ignoreExtent\":false,\"flags\":32811},\"74\":{\"id\":74,\"type\":\"quads\",\"material\":{\"alpha\":0.400000005960464,\"isTransparent\":true},\"vertices\":\"12\",\"colors\":\"14\",\"centers\":\"15\",\"normals\":\"13\",\"ignoreExtent\":false,\"flags\":32811},\"75\":{\"id\":75,\"type\":\"quads\",\"material\":{\"alpha\":0.400000005960464,\"isTransparent\":true},\"vertices\":\"16\",\"colors\":\"18\",\"centers\":\"19\",\"normals\":\"17\",\"ignoreExtent\":false,\"flags\":32811},\"76\":{\"id\":76,\"type\":\"quads\",\"material\":{\"alpha\":0.400000005960464,\"isTransparent\":true},\"vertices\":\"20\",\"colors\":\"22\",\"centers\":\"23\",\"normals\":\"21\",\"ignoreExtent\":false,\"flags\":32811},\"69\":{\"id\":69,\"type\":\"light\",\"vertices\":[[0,0,1]],\"colors\":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],\"viewpoint\":true,\"finite\":false},\"68\":{\"id\":68,\"type\":\"background\",\"material\":{},\"colors\":\"24\",\"centers\":\"25\",\"sphere\":false,\"fogtype\":\"none\",\"fogscale\":1,\"flags\":32768},\"70\":{\"id\":70,\"type\":\"background\",\"material\":{\"lit\":false,\"back\":\"lines\"},\"colors\":\"26\",\"centers\":\"27\",\"sphere\":false,\"fogtype\":\"none\",\"fogscale\":1,\"flags\":32768},\"65\":{\"id\":65,\"type\":\"subscene\",\"par3d\":{\"antialias\":8,\"FOV\":30,\"ignoreExtent\":false,\"listeners\":65,\"mouseMode\":{\"none\":\"none\",\"left\":\"trackball\",\"right\":\"zoom\",\"middle\":\"fov\",\"wheel\":\"pull\"},\"observer\":[0,0,6.71451187133789],\"modelMatrix\":[[1,0,0,0],[0,0.342020153999329,0.939692616462708,-0.00342019833624363],[0,-0.939692616462708,0.342020153999329,-6.70511484146118],[0,0,0,1]],\"projMatrix\":[[3.73205065727234,0,0,0],[0,3.73205065727234,0,0],[0,0,-3.86370348930359,-24.2050399780273],[0,0,-1,0]],\"skipRedraw\":false,\"userMatrix\":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],\"userProjection\":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],\"scale\":[1,1,1],\"viewport\":{\"x\":0,\"y\":0,\"width\":1,\"height\":1},\"zoom\":1,\"bbox\":[-1,1,-1,1.01999998092651,-1,1],\"windowRect\":[0,0,256,256],\"family\":\"sans\",\"font\":1,\"cex\":1,\"useFreeType\":false,\"fontname\":\"NULL\",\"maxClipPlanes\":2147483647,\"glVersion\":\"NA\",\"activeSubscene\":0},\"embeddings\":{\"viewport\":\"replace\",\"projection\":\"replace\",\"model\":\"replace\",\"mouse\":\"replace\"},\"objects\":[70,71,72,73,74,75,76,69],\"subscenes\":[],\"flags\":33067}},\"crosstalk\":{\"key\":[],\"group\":[],\"id\":[],\"options\":[]},\"width\":700,\"height\":432.632880098888,\"context\":{\"shiny\":false,\"rmarkdown\":null},\"buffer\":{\"accessors\":[{\"bufferView\":0,\"componentType\":5126,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":1,\"componentType\":5120,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":2,\"componentType\":5126,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":3,\"componentType\":5126,\"count\":6,\"type\":\"VEC3\"},{\"bufferView\":4,\"componentType\":5126,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":5,\"componentType\":5120,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":6,\"componentType\":5126,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":7,\"componentType\":5126,\"count\":6,\"type\":\"VEC3\"},{\"bufferView\":8,\"componentType\":5126,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":9,\"componentType\":5120,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":10,\"componentType\":5126,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":11,\"componentType\":5126,\"count\":6,\"type\":\"VEC3\"},{\"bufferView\":12,\"componentType\":5126,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":13,\"componentType\":5120,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":14,\"componentType\":5126,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":15,\"componentType\":5126,\"count\":6,\"type\":\"VEC3\"},{\"bufferView\":16,\"componentType\":5126,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":17,\"componentType\":5120,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":18,\"componentType\":5126,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":19,\"componentType\":5126,\"count\":6,\"type\":\"VEC3\"},{\"bufferView\":20,\"componentType\":5126,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":21,\"componentType\":5120,\"count\":24,\"type\":\"VEC3\"},{\"bufferView\":22,\"componentType\":5126,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":23,\"componentType\":5126,\"count\":6,\"type\":\"VEC3\"},{\"bufferView\":24,\"componentType\":5126,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":25,\"componentType\":5121,\"count\":1,\"type\":\"VEC3\"},{\"bufferView\":26,\"componentType\":5121,\"count\":1,\"type\":\"VEC4\"},{\"bufferView\":27,\"componentType\":5121,\"count\":1,\"type\":\"VEC3\"}],\"bufferViews\":[{\"buffer\":0,\"byteLength\":288,\"byteOffset\":0},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":288},{\"buffer\":0,\"byteLength\":16,\"byteOffset\":360},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":376},{\"buffer\":0,\"byteLength\":288,\"byteOffset\":448},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":736},{\"buffer\":0,\"byteLength\":16,\"byteOffset\":808},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":824},{\"buffer\":0,\"byteLength\":288,\"byteOffset\":896},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":1184},{\"buffer\":0,\"byteLength\":16,\"byteOffset\":1256},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":1272},{\"buffer\":0,\"byteLength\":288,\"byteOffset\":1344},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":1632},{\"buffer\":0,\"byteLength\":16,\"byteOffset\":1704},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":1720},{\"buffer\":0,\"byteLength\":288,\"byteOffset\":1792},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":2080},{\"buffer\":0,\"byteLength\":16,\"byteOffset\":2152},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":2168},{\"buffer\":0,\"byteLength\":288,\"byteOffset\":2240},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":2528},{\"buffer\":0,\"byteLength\":16,\"byteOffset\":2600},{\"buffer\":0,\"byteLength\":72,\"byteOffset\":2616},{\"buffer\":0,\"byteLength\":16,\"byteOffset\":2688},{\"buffer\":0,\"byteLength\":3,\"byteOffset\":2704},{\"buffer\":0,\"byteLength\":4,\"byteOffset\":2707},{\"buffer\":0,\"byteLength\":3,\"byteOffset\":2711}],\"buffers\":[{\"byteLength\":2714,\"bytes\":\"AACAvwAAgL8AAIC/AACAvwrXoz0AAIC/CtcjvwrXoz0AAIC/CtcjvwAAgL8AAIC/AACAvwrX\\noz0AAIC/AACAvwrXoz0AAIA/CtcjvwrXoz0AAIA/CtcjvwrXoz0AAIC/CtcjvwAAgL8AAIC/\\nCtcjvwrXoz0AAIC/CtcjvwrXoz0AAIA/CtcjvwAAgL8AAIA/AACAvwAAgL8AAIC/AACAvwAA\\ngL8AAIA/AACAvwrXoz0AAIA/AACAvwrXoz0AAIC/AACAvwAAgL8AAIC/CtcjvwAAgL8AAIC/\\nCtcjvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/CtcjvwAAgL8AAIA/CtcjvwrX\\noz0AAIA/AACAvwrXoz0AAIA/AAD/AAD/AAD/AAD/AAEAAAEAAAEAAAEAAQAAAQAAAQAAAQAA\\n/wAA/wAA/wAA/wAAAP8AAP8AAP8AAP8AAAABAAABAAABAAABAAAAAAAAAAAAAAAAzczMPoTr\\nUb8fheu+AACAv4TrUb8K16M9AAAAAArXI78fheu+AAAAAAAAgL8eheu+AAAAAIXrUb8AAIC/\\nAAAAAIXrUb8eheu+AACAPwAAgL+amZk+AACAvwAAgL9cj4I/AACAvwrXI79cj4I/AACAvwrX\\nI7+amZk+AACAvwAAgL9cj4I/AACAvwAAgL9cj4I/AACAPwrXI79cj4I/AACAPwrXI79cj4I/\\nAACAvwrXI7+amZk+AACAvwrXI79cj4I/AACAvwrXI79cj4I/AACAPwrXI7+amZk+AACAPwAA\\ngL+amZk+AACAvwAAgL+amZk+AACAPwAAgL9cj4I/AACAPwAAgL9cj4I/AACAvwAAgL+amZk+\\nAACAvwrXI7+amZk+AACAvwrXI7+amZk+AACAPwAAgL+amZk+AACAPwAAgL+amZk+AACAPwrX\\nI7+amZk+AACAPwrXI79cj4I/AACAPwAAgL9cj4I/AACAPwAA/wAA/wAA/wAA/wABAAABAAAB\\nAAABAAEAAAEAAAEAAAEAAP8AAP8AAP8AAP8AAAD/AAD/AAD/AAD/AAAAAQAAAQAAAQAAAQAA\\nAAAAAAAAAAAAAM3MzD6E61G/wvUoPwAAgL+E61G/XI+CPwAAAAAK1yO/wvUoPwAAAAAAAIC/\\nwvUoPwAAAACF61G/mpmZPgAAAACF61G/wvUoPwAAgD/NzAy/AACAvwAAgL/NzAy/zczMvQAA\\ngL8K1yO8zczMvQAAgL8K1yO8AACAvwAAgL/NzAy/zczMvQAAgL/NzAy/zczMvQAAgD8K1yO8\\nzczMvQAAgD8K1yO8zczMvQAAgL8K1yO8AACAvwAAgL8K1yO8zczMvQAAgL8K1yO8zczMvQAA\\ngD8K1yO8AACAvwAAgD/NzAy/AACAvwAAgL/NzAy/AACAvwAAgD/NzAy/zczMvQAAgD/NzAy/\\nzczMvQAAgL/NzAy/AACAvwAAgL8K1yO8AACAvwAAgL8K1yO8AACAvwAAgD/NzAy/AACAvwAA\\ngD/NzAy/AACAvwAAgD8K1yO8AACAvwAAgD8K1yO8zczMvQAAgD/NzAy/zczMvQAAgD8AAP8A\\nAP8AAP8AAP8AAQAAAQAAAQAAAQABAAABAAABAAABAAD/AAD/AAD/AAD/AAAA/wAA/wAA/wAA\\n/wAAAAEAAAEAAAEAAAEAAAAAAAAAAAAAAADNzMw+KVyPvs3MDL8AAIC/KVyPvs3MzL0AAAAA\\nCtcjvM3MDL8AAAAAzcwMv8zMDL8AAAAAKVyPvgAAgL8AAAAAKVyPvszMDL8AAIA/zcwMv83M\\nzD0AAIC/zcwMvwAAgD8AAIC/CtcjvAAAgD8AAIC/CtcjvM3MzD0AAIC/zcwMvwAAgD8AAIC/\\nzcwMvwAAgD8AAIA/CtcjvAAAgD8AAIA/CtcjvAAAgD8AAIC/CtcjvM3MzD0AAIC/CtcjvAAA\\ngD8AAIC/CtcjvAAAgD8AAIA/CtcjvM3MzD0AAIA/zcwMv83MzD0AAIC/zcwMv83MzD0AAIA/\\nzcwMvwAAgD8AAIA/zcwMvwAAgD8AAIC/zcwMv83MzD0AAIC/CtcjvM3MzD0AAIC/CtcjvM3M\\nzD0AAIA/zcwMv83MzD0AAIA/zcwMv83MzD0AAIA/CtcjvM3MzD0AAIA/CtcjvAAAgD8AAIA/\\nzcwMvwAAgD8AAIA/AAD/AAD/AAD/AAD/AAEAAAEAAAEAAAEAAQAAAQAAAQAAAQAA/wAA/wAA\\n/wAA/wAAAP8AAP8AAP8AAP8AAAABAAABAAABAAABAAAAAAAAAAAAAAAAzczMPilcj77MzAw/\\nAACAvylcj74AAIA/AAAAAArXI7zMzAw/AAAAAM3MDL/NzAw/AAAAAClcj77NzMw9AAAAAClc\\nj77NzAw/AACAP83MzD0AAIC/AACAv83MzD0K1yO/AACAvwAAgD8K1yO/AACAvwAAgD8AAIC/\\nAACAv83MzD0K1yO/AACAv83MzD0K1yO/AACAPwAAgD8K1yO/AACAPwAAgD8K1yO/AACAvwAA\\ngD8AAIC/AACAvwAAgD8K1yO/AACAvwAAgD8K1yO/AACAPwAAgD8AAIC/AACAP83MzD0AAIC/\\nAACAv83MzD0AAIC/AACAP83MzD0K1yO/AACAP83MzD0K1yO/AACAv83MzD0AAIC/AACAvwAA\\ngD8AAIC/AACAvwAAgD8AAIC/AACAP83MzD0AAIC/AACAP83MzD0AAIC/AACAPwAAgD8AAIC/\\nAACAPwAAgD8K1yO/AACAP83MzD0K1yO/AACAPwAA/wAA/wAA/wAA/wABAAABAAABAAABAAEA\\nAAEAAAEAAAEAAP8AAP8AAP8AAP8AAAD/AAD/AAD/AAD/AAAAAQAAAQAAAQAAAQAAAAAAAAAA\\nAAAAAM3MzD7NzAw/hetRvwAAgL/NzAw/CtcjvwAAAAAAAIA/hetRvwAAAADNzMw9hOtRvwAA\\nAADMzAw/AACAvwAAAADMzAw/hOtRvwAAgD/NzMw9AAAAvwAAgL/NzMw916NwPwAAgL8AAIA/\\n16NwPwAAgL8AAIA/AAAAvwAAgL/NzMw916NwPwAAgL/NzMw916NwPwAAgD8AAIA/16NwPwAA\\ngD8AAIA/16NwPwAAgL8AAIA/AAAAvwAAgL8AAIA/16NwPwAAgL8AAIA/16NwPwAAgD8AAIA/\\nAAAAvwAAgD/NzMw9AAAAvwAAgL/NzMw9AAAAvwAAgD/NzMw916NwPwAAgD/NzMw916NwPwAA\\ngL/NzMw9AAAAvwAAgL8AAIA/AAAAvwAAgL8AAIA/AAAAvwAAgD/NzMw9AAAAvwAAgD/NzMw9\\nAAAAvwAAgD8AAIA/AAAAvwAAgD8AAIA/16NwPwAAgD/NzMw916NwPwAAgD8AAP8AAP8AAP8A\\nAP8AAQAAAQAAAQAAAQABAAABAAABAAABAAD/AAD/AAD/AAD/AAAA/wAA/wAA/wAA/wAAAAEA\\nAAEAAAEAAAEAAAAAAAAAAAAAAADNzMw+zcwMP65HYT4AAIC/zcwMP9ejcD8AAAAAAACAP65H\\nYT4AAAAAzczMPa5HYT4AAAAAzMwMPwAAAL8AAAAAzMwMP65HYT4AAIA/mZiYPpmYmD6ZmJg+\\nAACAPwAAAAEBAQEAAAA=\"}]},\"players\":[],\"webGLoptions\":{\"preserveDrawingBuffer\":true}},\"evals\":[],\"jsHooks\":[]}"},{"path":"http://friendly.github.io/vcdExtra/reference/Summarise.html","id":null,"dir":"Reference","previous_headings":"","what":"Brief Summary of Model Fit for glm and loglm Models — Summarise","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"glm objects, print summary methods give much information one wants see brief summary model goodness fit, easy way display compact comparison model goodness fit collection models fit data. loglm models equivalent glm forms,  print summary methods give quite different results. Summarise provides brief summary one models fit dataset logLik nobs methods exist (e.g., glm loglm models).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Summarise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"","code":"Summarise(object, ...)  # S3 method for glmlist Summarise(object, ..., saturated = NULL, sortby = NULL) # S3 method for loglmlist Summarise(object, ..., saturated = NULL, sortby = NULL) # S3 method for default Summarise(object, ..., saturated = NULL, sortby = NULL)"},{"path":"http://friendly.github.io/vcdExtra/reference/Summarise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"object fitted model object exists logLik method extract corresponding log-likelihood ... optionally fitted model objects saturated saturated model log likelihood reference value (use 0 deviance available) sortby either numeric character string specifying column result rows sorted (decreasing order)","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Summarise.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"function relies residual degrees freedom LR chisq test available model object.  true objects inheriting  lm, glm, loglm, polr negbin.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Summarise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"data frame (also class anova) columns  c(\"AIC\", \"BIC\", \"LR Chisq\", \"Df\", \"Pr(>Chisq)\"). Row names taken names model object(s).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Summarise.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"Achim Zeileis","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/Summarise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Brief Summary of Model Fit for glm and loglm Models — Summarise","text":"","code":"data(Mental) indep <- glm(Freq ~ mental+ses,                 family = poisson, data = Mental) Summarise(indep) #> Likelihood summary table: #>          AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep 209.59 220.19   47.418 15  3.155e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 Cscore <- as.numeric(Mental$ses) Rscore <- as.numeric(Mental$mental)  coleff <- glm(Freq ~ mental + ses + Rscore:ses,                 family = poisson, data = Mental) roweff <- glm(Freq ~ mental + ses + mental:Cscore,                 family = poisson, data = Mental) linlin <- glm(Freq ~ mental + ses + Rscore:Cscore,                 family = poisson, data = Mental)                  # compare models Summarise(indep, coleff, roweff, linlin) #> Likelihood summary table: #>           AIC    BIC LR Chisq Df Pr(>Chisq)     #> indep  209.59 220.19   47.418 15  3.155e-05 *** #> coleff 179.00 195.50    6.829 10     0.7415     #> roweff 174.45 188.59    6.281 12     0.9013     #> linlin 174.07 185.85    9.895 14     0.7698     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"http://friendly.github.io/vcdExtra/reference/Titanicp.html","id":null,"dir":"Reference","previous_headings":"","what":"Passengers on the Titanic — Titanicp","title":"Passengers on the Titanic — Titanicp","text":"Data passengers RMS Titanic, excluding Crew individual identifier variables.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Passengers on the Titanic — Titanicp","text":"","code":"data(Titanicp)"},{"path":"http://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Passengers on the Titanic — Titanicp","text":"data frame 1309 observations following 6 variables. pclass factor levels 1st 2nd 3rd survived factor levels died survived sex factor levels female male age passenger age years (fractions year, children), numeric vector; age missing 263 passengers sibsp number siblings spouses aboard, integer: 0:8 parch number parents children aboard, integer: 0:6","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Passengers on the Titanic — Titanicp","text":"number related versions Titanic data, various formats. version derived ptitanic rpart.plot package, modifying remove Class 'labelled' attributes variables (inherited Frank Harrell's titanic3 version) caused problems applications, notably ggplot2. versions: Titanic 4-way frequency table 2201 people aboard Titanic, including passengers crew.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Passengers on the Titanic — Titanicp","text":"original R source dataset compiled Frank Harrell Robert Dawson: https://biostat.app.vumc.org/wiki/pub/Main/DataSets/titanic.html, described detail https://biostat.app.vumc.org/wiki/pub/Main/DataSets/titanic3info.txt version Titanic data, passenger details deleted,  survived cast factor, name changed Titanicp minimize confusion  versions.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Titanicp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Passengers on the Titanic — Titanicp","text":"","code":"data(Titanicp) ## maybe str(Titanicp) ; plot(Titanicp) ..."},{"path":"http://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":null,"dir":"Reference","previous_headings":"","what":"Toxaemia Symptoms in Pregnancy — Toxaemia","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"Brown et al (1983) gave data two signs toxaemia, abnormal condition pregnancy characterized high blood pressure (hypertension) high levels protein urine.  untreated, mother baby risk complications death. data frame Toxaemia represents 13384 expectant mothers Bradford, England first pregnancy, also classified according social class number cigarettes smoked per day.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"","code":"data(Toxaemia)"},{"path":"http://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"data frame frequency form representing 5 x 3 x 2 x 2 contingency table,   60 observations following 5 variables. class Social class mother, factor levels 1 2 3 4 5 smoke Cigarettes smoked per day pregnancy, factor levels 0 1-19 20+ hyper Hypertension level, factor levels Low High urea Protein urea level, factor levels Low High Freq frequency cell, numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"Brown, P. J., Stone, J. Ord-Smith, C. (1983),  Toxaemic signs pregnancy. JRSS, Series C, Applied Statistics, 32, 69-72","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"Friendly, M.  (2000), Visualizing Categorical Data, SAS Institute, Cary, NC, Example 7.15. Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Example 10.10.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Toxaemia.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Toxaemia Symptoms in Pregnancy — Toxaemia","text":"","code":"data(Toxaemia)  tox.tab <- xtabs(Freq~class+smoke+hyper+urea,Toxaemia) ftable(tox.tab, row.vars=1) #>       smoke    0                1-19                 20+                #>       hyper  Low      High       Low      High       Low      High      #>       urea   Low High  Low High  Low High  Low High  Low High  Low High #> class                                                                   #> 1            286   21   82   28   71    5   24    5   13    0    3    1 #> 2            785   34  266   50  284   17   92   13   34    3   15    0 #> 3           3160  164 1101  278 2300  142  492  120  383   32   92   16 #> 4            656   52  213   63  649   46  129   35  163   12   40    7 #> 5            245   23   78   20  321   34   74   22   65    4   14    7   # symptoms by smoking mosaic(~smoke+hyper+urea, data=tox.tab, shade=TRUE)   # symptoms by social class mosaic(~class+hyper+urea, data=tox.tab, shade=TRUE)   # predictors mosaic(~smoke+class, data=tox.tab, shade=TRUE)   # responses mosaic(~hyper+urea, data=tox.tab, shade=TRUE)   # log odds ratios for urea and hypertension, by class and smoke if (FALSE) { LOR <-loddsratio(aperm(tox.tab)) LOR }"},{"path":"http://friendly.github.io/vcdExtra/reference/TV.html","id":null,"dir":"Reference","previous_headings":"","what":"TV Viewing Data — TV","title":"TV Viewing Data — TV","text":"data set TV comprises 5 x 11 x 3 contingency table based   audience viewing data Neilsen Media Research week starting   November 6, 1995.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/TV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TV Viewing Data — TV","text":"","code":"data(TV)"},{"path":"http://friendly.github.io/vcdExtra/reference/TV.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"TV Viewing Data — TV","text":"5 x 11 x 3 array cell frequencies following structure:","code":"int [1:5, 1:11, 1:3] 146 244 233 174 294 151 181 161 183 281 ...  - attr(*, \"dimnames\")=List of 3   ..$ Day    : chr [1:5] \"Monday\" \"Tuesday\" \"Wednesday\" \"Thursday\" ...   ..$ Time   : chr [1:11] \"8:00\" \"8:15\" \"8:30\" \"8:45\" ...   ..$ Network: chr [1:3] \"ABC\" \"CBS\" \"NBC\""},{"path":"http://friendly.github.io/vcdExtra/reference/TV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"TV Viewing Data — TV","text":"original data, tv.dat, contains two additional networks: \"Fox\" \"\", small frequencies. levels removed current version. also fourth factor, transition State transition (turn television , Switch channels, Persist viewing current channel). TV data includes Persist observations.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/TV.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"TV Viewing Data — TV","text":"original data, tv.dat, came initial implementation  mosaic displays R Jay Emerson (1998). Similar data used Hartigan Kleiner (1984) illustration.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/TV.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"TV Viewing Data — TV","text":"Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Emerson, John W. Mosaic Displays S-PLUS: General Implementation Case Study. Statistical Graphics Computing Newsletter, 1998, 9(1), 17--23,  http://www.stat.yale.edu/~jay/R/mosaic/v91.pdf Hartigan, J. . & Kleiner, B. Mosaic Television Ratings. American Statistician, 1984, 38, 32-35.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/TV.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"TV Viewing Data — TV","text":"","code":"data(TV) structable(TV) #>                   Time 8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30 #> Day       Network                                                                #> Monday    ABC           146  151  156   83  325  350  386  340   352   280   278 #>           CBS           337  293  304  233  311  251  241  164   252   265   272 #>           NBC           263  219  236  140  226  235  239  246   279   263   283 #> Tuesday   ABC           244  181  231  205  385  283  345  192   329   351   364 #>           CBS           173  180  184  109  218  235  256  250   274   263   261 #>           NBC           315  254  280  241  370  214  195  111   188   190   210 #> Wednesday ABC           233  161  194  156  339  264  279  140   237   228   203 #>           CBS           158  126  207   59   98  103  122   86   109   105   110 #>           NBC           134  146  166   66  194  230  264  143   274   289   306 #> Thursday  ABC           174  183  197  181  187  198  211   86   110   122   117 #>           CBS           196  185  195  104  106  116  116   47   102    84    84 #>           NBC           515  463  472  477  590  473  446  349   649   705   747 #> Friday    ABC           294  281  305  239  278  246  245  138   246   232   233 #>           CBS           130  144  154   81  129  153  136  126   138   136   152 #>           NBC           195  220  248  160  172  164  169   85   183   198   204 doubledecker(TV)   # reduce number of levels of Time TV.df <- as.data.frame.table(TV) levels(TV.df$Time) <- rep(c(\"8:00-8:59\", \"9:00-9:59\", \"10:00-10:44\"), c(4, 4, 3)) TV2 <- xtabs(Freq ~ Day + Time + Network, TV.df)  # re-label for mosaic display levels(TV.df$Time) <- c(\"8\", \"9\", \"10\") # fit mode of joint independence, showing association of Network with Day*Time mosaic(~ Day + Network + Time, data = TV.df, expected = ~ Day:Time + Network, legend = FALSE)  # with doubledecker arrangement mosaic(~ Day + Network + Time, data = TV.df, expected = ~ Day:Time + Network,   split = c(TRUE, TRUE, FALSE), spacing = spacing_highlighting, legend = FALSE)"},{"path":"http://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":null,"dir":"Reference","previous_headings":"","what":"Update method for a xtabs object — update.xtabs","title":"Update method for a xtabs object — update.xtabs","text":"Provides update method \"xtabs\" objects, typically removing terms formula collapse .","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update method for a xtabs object — update.xtabs","text":"","code":"# S3 method for xtabs update(object, formula., ..., evaluate = TRUE)"},{"path":"http://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update method for a xtabs object — update.xtabs","text":"object existing \"xtabs\" object formula. Changes formula ? see update.formula details ... Additional arguments call, arguments changed values. evaluate TRUE, evaluate new call else return call","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update method for a xtabs object — update.xtabs","text":"evaluate == TRUE, new \"xtabs\" object, otherwise updated call","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Update method for a xtabs object — update.xtabs","text":"Michael Friendly","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/update.xtabs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update method for a xtabs object — update.xtabs","text":"","code":"vietnam.tab <- xtabs(Freq ~ sex + year + response, data=Vietnam)  update(vietnam.tab, formula = ~ . -year) #>         response #> sex        A   B   C   D #>   Female  71 105 369  37 #>   Male   730 633 950 252"},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-deprecated.html","id":null,"dir":"Reference","previous_headings":"","what":"Deprecated Functions in vcdExtra Package — vcdExtra-deprecated","title":"Deprecated Functions in vcdExtra Package — vcdExtra-deprecated","text":"functions provided compatibility older versions vcdExtra package .    replaced LRstats.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-deprecated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Deprecated Functions in vcdExtra Package — vcdExtra-deprecated","text":"","code":"summarise(...) <!-- %summarise.glm(...) --> <!-- %summarise.glmlist(...) --> <!-- %summarise.loglm(...) --> <!-- %summarise.loglmlist(...) -->"},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-deprecated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Deprecated Functions in vcdExtra Package — vcdExtra-deprecated","text":"... pass arguments .","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-deprecated.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Deprecated Functions in vcdExtra Package — vcdExtra-deprecated","text":"summarise.* replaced LRstats functions.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"package provides additional data sets, documentation, functions designed extend vcd package Visualizing Categorical Data gnm package Generalized Nonlinear Models.  particular, vcdExtra extends mosaic, assoc sieve plots vcd handle glm() gnm() models adds 3D version mosaic3d. package now support package book, Discrete Data Analysis R Michael Friendly David Meyer, Chapman & Hall/CRC, 2016,  https://www.crcpress.com/Discrete-Data-Analysis--R-Visualization--Modeling-Techniques-/Friendly-Meyer/9781498725835 number additional data sets, functions. web site book http://ddar.datavis.ca.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"main purpose package serve sandbox introducing extensions mosaic plots related graphical methods apply loglinear models fitted using glm() related, generalized nonlinear models fitted gnm() gnm-package package. related purpose fill holes analysis categorical data R, provided base R, vcd,  commonly used packages. method mosaic.glm  extends mosaic.loglm method vcd package wider class models.  method also works generalized nonlinear models fit gnm-package package, including models square tables models multiplicative associations. mosaic3d introduces 3D generalization mosaic displays using rgl package. addition, several new data sets, tutorial vignette, vcd-tutorial Working categorical data R vcd package, vignette(\"vcd-tutorial\", package = \"vcdExtra\") functions manipulating categorical data sets working models categorical data. new class, glmlist, introduced working collections glm objects, e.g., Kway fitting K-way models basic marginal model, LRstats brief statistical summaries goodness--fit collection models. square tables ordered factors, Crossings supplements  specification terms model formulas using Symm, Diag,  Topo, etc. gnm-package. extensions may migrated vcd gnm. collection demos included illustrate fitting visualizing wide variety models: mental-glm Mental health data: mosaics glm() gnm() models occStatus Occupational status data: Compare mosaic using expected= mosaic.glm ucb-glm UCBAdmissions data: Conditional independence via loglm() glm() vision-quasi VisualAcuity data: Quasi- Symmetry models yaish-unidiff Yaish data: Unidiff model 3-way table Wong2-3 Political views support women work (U, R, C, R+C RC(1) models) Wong3-1 Political views, support women work national welfare spending (3-way, marginal, conditional independence models) housing Visualize glm(), multinom() polr() models example(housing, package=\"MASS\") Use  demo(package=\"vcdExtra\") complete current list. vcdExtra package now contains large number data sets illustrating various forms categorical data analysis related visualizations, simple advanced. Use data(package=\"vcdExtra\") complete list, datasets(package=\"vcdExtra\") annotated one showing class dim data set.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"Michael Friendly Maintainer: Michael Friendly <friendly yorku.ca> || (ORCID)","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"Friendly, M. Visualizing Categorical Data, Cary NC: SAS Institute, 2000. Web materials: http://www.datavis.ca/books/vcd/. Friendly, M. Meyer, D. (2016).  Discrete Data Analysis R: Visualization Modeling Techniques Categorical Count Data.  Boca Raton, FL: Chapman & Hall/CRC. http://ddar.datavis.ca. Meyer, D.; Zeileis, . & Hornik, K.  Strucplot Framework: Visualizing Multi-way Contingency Tables vcd  Journal Statistical Software, 2006, 17, 1-48. Available R via vignette(\"strucplot\", package = \"vcd\") Turner, H. Firth, D. Generalized nonlinear models R: overview gnm package, 2007,  http://eprints.ncrm.ac.uk/472/. Available R via vignette(\"gnmOverview\", package = \"gnm\").","code":""},{"path":[]},{"path":"http://friendly.github.io/vcdExtra/reference/vcdExtra-package.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package","text":"","code":"example(mosaic.glm) #>  #> msc.gl> GSStab <- xtabs(count ~ sex + party, data=GSS) #>  #> msc.gl> # using the data in table form #> msc.gl> mod.glm1 <- glm(Freq ~ sex + party, family = poisson, data = GSStab) #>  #> msc.gl> res <- residuals(mod.glm1)     #>  #> msc.gl> std <- rstandard(mod.glm1) #>  #> msc.gl> # For mosaic.default(), need to re-shape residuals to conform to data #> msc.gl> stdtab <- array(std, dim=dim(GSStab), dimnames=dimnames(GSStab)) #>  #> msc.gl> mosaic(GSStab, gp=shading_Friendly, residuals=stdtab, residuals_type=\"Std\\nresiduals\",  #> msc.gl+        labeling = labeling_residuals)  #>  #> msc.gl> # Using externally calculated residuals with the glm() object #> msc.gl> mosaic.glm(mod.glm1, residuals=std, labeling = labeling_residuals, shade=TRUE)  #>  #> msc.gl> # Using residuals_type #> msc.gl> mosaic.glm(mod.glm1, residuals_type=\"rstandard\", labeling = labeling_residuals, shade=TRUE) #>  #> msc.gl> ## Ordinal factors and structured associations #> msc.gl> data(Mental) #>  #> msc.gl> xtabs(Freq ~ mental+ses, data=Mental) #>           ses #> mental       1   2   3   4   5   6 #>   Well      64  57  57  72  36  21 #>   Mild      94  94 105 141  97  71 #>   Moderate  58  54  65  77  54  54 #>   Impaired  46  40  60  94  78  71 #>  #> msc.gl> long.labels <- list(set_varnames = c(mental=\"Mental Health Status\", ses=\"Parent SES\")) #>  #> msc.gl> # fit independence model #> msc.gl> # Residual deviance: 47.418 on 15 degrees of freedom #> msc.gl> indep <- glm(Freq ~ mental+ses, #> msc.gl+                 family = poisson, data = Mental) #>  #> msc.gl> long.labels <- list(set_varnames = c(mental=\"Mental Health Status\",  #> msc.gl+                                      ses=\"Parent SES\")) #>  #> msc.gl> mosaic(indep,residuals_type=\"rstandard\", labeling_args = long.labels, labeling=labeling_residuals) #> Warning: no formula provided, assuming ~ses + mental  #>  #> msc.gl> # or, show as a sieve diagram #> msc.gl> mosaic(indep, labeling_args = long.labels, panel=sieve, gp=shading_Friendly) #> Warning: no formula provided, assuming ~ses + mental  #>  #> msc.gl> # fit linear x linear (uniform) association.  Use integer scores for rows/cols  #> msc.gl> Cscore <- as.numeric(Mental$ses) #>  #> msc.gl> Rscore <- as.numeric(Mental$mental) #>  #> msc.gl> linlin <- glm(Freq ~ mental + ses + Rscore:Cscore, #> msc.gl+                 family = poisson, data = Mental) #>  #> msc.gl> mosaic(linlin,residuals_type=\"rstandard\",  #> msc.gl+  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> msc.gl+  main=\"Lin x Lin model\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> msc.gl> ##  Goodman Row-Column association model fits even better (deviance 3.57, df 8) #> msc.gl> if (require(gnm)) { #> msc.gl+ Mental$mental <- C(Mental$mental, treatment) #> msc.gl+ Mental$ses <- C(Mental$ses, treatment) #> msc.gl+ RC1model <- gnm(Freq ~ ses + mental + Mult(ses, mental), #> msc.gl+                 family = poisson, data = Mental) #> msc.gl+  #> msc.gl+ mosaic(RC1model,residuals_type=\"rstandard\",  #> msc.gl+  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> msc.gl+  main=\"RC1 model\") #> msc.gl+  } #> Initialising #> Running start-up iterations.. #> Running main iterations........ #> Done #> Warning: no formula provided, assuming ~ses + mental   #>  #> msc.gl>  ############# UCB Admissions data, fit using glm() #> msc.gl>   #> msc.gl>  structable(Dept ~ Admit+Gender,UCBAdmissions) #>                 Dept   A   B   C   D   E   F #> Admit    Gender                              #> Admitted Male        512 353 120 138  53  22 #>          Female       89  17 202 131  94  24 #> Rejected Male        313 207 205 279 138 351 #>          Female       19   8 391 244 299 317 #>  #> msc.gl> berkeley <- as.data.frame(UCBAdmissions) #>  #> msc.gl> berk.glm1 <- glm(Freq ~ Dept * (Gender+Admit), data=berkeley, family=\"poisson\") #>  #> msc.gl> summary(berk.glm1) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit), family = \"poisson\",  #>     data = berkeley) #>  #> Deviance Residuals:  #>     Min       1Q   Median       3Q      Max   #> -3.4776  -0.4144   0.0098   0.3089   2.2321   #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.27557    0.04248 147.744  < 2e-16 *** #> DeptB               -0.40575    0.06770  -5.993 2.06e-09 *** #> DeptC               -1.53939    0.08305 -18.536  < 2e-16 *** #> DeptD               -1.32234    0.08159 -16.207  < 2e-16 *** #> DeptE               -2.40277    0.11014 -21.816  < 2e-16 *** #> DeptF               -3.09624    0.15756 -19.652  < 2e-16 *** #> GenderFemale        -2.03325    0.10233 -19.870  < 2e-16 *** #> AdmitRejected       -0.59346    0.06838  -8.679  < 2e-16 *** #> DeptB:GenderFemale  -1.07581    0.22860  -4.706 2.52e-06 *** #> DeptC:GenderFemale   2.63462    0.12343  21.345  < 2e-16 *** #> DeptD:GenderFemale   1.92709    0.12464  15.461  < 2e-16 *** #> DeptE:GenderFemale   2.75479    0.13510  20.391  < 2e-16 *** #> DeptF:GenderFemale   1.94356    0.12683  15.325  < 2e-16 *** #> DeptB:AdmitRejected  0.05059    0.10968   0.461    0.645     #> DeptC:AdmitRejected  1.20915    0.09726  12.432  < 2e-16 *** #> DeptD:AdmitRejected  1.25833    0.10152  12.395  < 2e-16 *** #> DeptE:AdmitRejected  1.68296    0.11733  14.343  < 2e-16 *** #> DeptF:AdmitRejected  3.26911    0.16707  19.567  < 2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   21.736  on  6  degrees of freedom #> AIC: 216.8 #>  #> Number of Fisher Scoring iterations: 4 #>  #>  #> msc.gl> mosaic(berk.glm1, gp=shading_Friendly, labeling=labeling_residuals, formula=~Admit+Dept+Gender)  #>  #> msc.gl> # the same, displaying studentized residuals; note use of formula to reorder factors in the mosaic #> msc.gl> mosaic(berk.glm1, residuals_type=\"rstandard\", labeling=labeling_residuals, shade=TRUE,  #> msc.gl+ \tformula=~Admit+Dept+Gender, main=\"Model: [DeptGender][DeptAdmit]\")  #>  #> msc.gl> ## all two-way model #> msc.gl> berk.glm2 <- glm(Freq ~ (Dept + Gender + Admit)^2, data=berkeley, family=\"poisson\") #>  #> msc.gl> summary(berk.glm2) #>  #> Call: #> glm(formula = Freq ~ (Dept + Gender + Admit)^2, family = \"poisson\",  #>     data = berkeley) #>  #> Deviance Residuals:  #>        1         2         3         4         5         6         7         8   #> -0.75481   0.99471   1.96454  -3.15768  -0.03402   0.04449   0.15709  -0.22034   #>        9        10        11        12        13        14        15        16   #>  1.01273  -0.73839  -0.74367   0.54896   0.06760  -0.04741  -0.06911   0.05080   #>       17        18        19        20        21        22        23        24   #>  1.05578  -0.61236  -0.73617   0.42678  -0.20117   0.05113   0.19803  -0.05370   #>  #> Coefficients: #>                            Estimate Std. Error z value Pr(>|z|)     #> (Intercept)                 6.27150    0.04271 146.855  < 2e-16 *** #> DeptB                      -0.40322    0.06784  -5.944 2.78e-09 *** #> DeptC                      -1.57790    0.08949 -17.632  < 2e-16 *** #> DeptD                      -1.35000    0.08526 -15.834  < 2e-16 *** #> DeptE                      -2.44982    0.11755 -20.840  < 2e-16 *** #> DeptF                      -3.13787    0.16174 -19.401  < 2e-16 *** #> GenderFemale               -1.99859    0.10593 -18.866  < 2e-16 *** #> AdmitRejected              -0.58205    0.06899  -8.436  < 2e-16 *** #> DeptB:GenderFemale         -1.07482    0.22861  -4.701 2.58e-06 *** #> DeptC:GenderFemale          2.66513    0.12609  21.137  < 2e-16 *** #> DeptD:GenderFemale          1.95832    0.12734  15.379  < 2e-16 *** #> DeptE:GenderFemale          2.79519    0.13925  20.073  < 2e-16 *** #> DeptF:GenderFemale          2.00232    0.13571  14.754  < 2e-16 *** #> DeptB:AdmitRejected         0.04340    0.10984   0.395    0.693     #> DeptC:AdmitRejected         1.26260    0.10663  11.841  < 2e-16 *** #> DeptD:AdmitRejected         1.29461    0.10582  12.234  < 2e-16 *** #> DeptE:AdmitRejected         1.73931    0.12611  13.792  < 2e-16 *** #> DeptF:AdmitRejected         3.30648    0.16998  19.452  < 2e-16 *** #> GenderFemale:AdmitRejected -0.09987    0.08085  -1.235    0.217     #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.095  on 23  degrees of freedom #> Residual deviance:   20.204  on  5  degrees of freedom #> AIC: 217.26 #>  #> Number of Fisher Scoring iterations: 4 #>  #>  #> msc.gl> mosaic.glm(berk.glm2, residuals_type=\"rstandard\", labeling = labeling_residuals, shade=TRUE, #> msc.gl+ \tformula=~Admit+Dept+Gender, main=\"Model: [DeptGender][DeptAdmit][AdmitGender]\")  #>  #> msc.gl> anova(berk.glm1, berk.glm2, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ (Dept + Gender + Admit)^2 #>   Resid. Df Resid. Dev Df Deviance Pr(>Chi) #> 1         6     21.735                      #> 2         5     20.204  1   1.5312   0.2159 #>  #> msc.gl> # Add 1 df term for association of [GenderAdmit] only in Dept A #> msc.gl> berkeley <- within(berkeley, dept1AG <- (Dept=='A')*(Gender=='Female')*(Admit=='Admitted')) #>  #> msc.gl> berkeley[1:6,] #>      Admit Gender Dept Freq dept1AG #> 1 Admitted   Male    A  512       0 #> 2 Rejected   Male    A  313       0 #> 3 Admitted Female    A   89       1 #> 4 Rejected Female    A   19       0 #> 5 Admitted   Male    B  353       0 #> 6 Rejected   Male    B  207       0 #>  #> msc.gl> berk.glm3 <- glm(Freq ~ Dept * (Gender+Admit) + dept1AG, data=berkeley, family=\"poisson\") #>  #> msc.gl> summary(berk.glm3) #>  #> Call: #> glm(formula = Freq ~ Dept * (Gender + Admit) + dept1AG, family = \"poisson\",  #>     data = berkeley) #>  #> Deviance Residuals:  #>        1         2         3         4         5         6         7         8   #>  0.00000   0.00000   0.00000   0.00000  -0.06316   0.08273   0.29514  -0.40088   #>        9        10        11        12        13        14        15        16   #>  0.55733  -0.41519  -0.41820   0.30511  -0.30655   0.21843   0.32036  -0.23141   #>       17        18        19        20        21        22        23        24   #>  0.69837  -0.41419  -0.49916   0.28628  -0.42032   0.10861   0.42684  -0.11382   #>  #> Coefficients: #>                     Estimate Std. Error z value Pr(>|z|)     #> (Intercept)          6.23832    0.04419 141.157  < 2e-16 *** #> DeptB               -0.36850    0.06879  -5.357 8.47e-08 *** #> DeptC               -1.50215    0.08394 -17.895  < 2e-16 *** #> DeptD               -1.28509    0.08250 -15.577  < 2e-16 *** #> DeptE               -2.36552    0.11081 -21.347  < 2e-16 *** #> DeptF               -3.05899    0.15803 -19.357  < 2e-16 *** #> GenderFemale        -2.80176    0.23628 -11.858  < 2e-16 *** #> AdmitRejected       -0.49212    0.07175  -6.859 6.94e-12 *** #> dept1AG              1.05208    0.26271   4.005 6.21e-05 *** #> DeptB:GenderFemale  -0.30730    0.31243  -0.984    0.325     #> DeptC:GenderFemale   3.40313    0.24615  13.825  < 2e-16 *** #> DeptD:GenderFemale   2.69560    0.24676  10.924  < 2e-16 *** #> DeptE:GenderFemale   3.52330    0.25220  13.970  < 2e-16 *** #> DeptF:GenderFemale   2.71207    0.24787  10.941  < 2e-16 *** #> DeptB:AdmitRejected -0.05074    0.11181  -0.454    0.650     #> DeptC:AdmitRejected  1.10781    0.09966  11.116  < 2e-16 *** #> DeptD:AdmitRejected  1.15699    0.10381  11.145  < 2e-16 *** #> DeptE:AdmitRejected  1.58162    0.11933  13.254  < 2e-16 *** #> DeptF:AdmitRejected  3.16777    0.16848  18.803  < 2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> (Dispersion parameter for poisson family taken to be 1) #>  #>     Null deviance: 2650.0952  on 23  degrees of freedom #> Residual deviance:    2.6815  on  5  degrees of freedom #> AIC: 199.74 #>  #> Number of Fisher Scoring iterations: 3 #>  #>  #> msc.gl> mosaic.glm(berk.glm3, residuals_type=\"rstandard\", labeling = labeling_residuals, shade=TRUE, #> msc.gl+ \tformula=~Admit+Dept+Gender, main=\"Model: [DeptGender][DeptAdmit] + DeptA*[GA]\")  #>  #> msc.gl> anova(berk.glm1, berk.glm3, test=\"Chisq\") #> Analysis of Deviance Table #>  #> Model 1: Freq ~ Dept * (Gender + Admit) #> Model 2: Freq ~ Dept * (Gender + Admit) + dept1AG #>   Resid. Df Resid. Dev Df Deviance  Pr(>Chi)     #> 1         6    21.7355                           #> 2         5     2.6815  1   19.054 1.271e-05 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  demo(\"mental-glm\") #>  #>  #> \tdemo(mental-glm) #> \t---- ~~~~~~~~~~ #>  #> > ## Mental health data: mosaics for glm() and gnm() models #> > library(gnm) #>  #> > library(vcdExtra) #>  #> > data(Mental) #>  #> > # display the frequency table #> > (Mental.tab <- xtabs(Freq ~ mental+ses, data=Mental)) #>           ses #> mental       1   2   3   4   5   6 #>   Well      64  57  57  72  36  21 #>   Mild      94  94 105 141  97  71 #>   Moderate  58  54  65  77  54  54 #>   Impaired  46  40  60  94  78  71 #>  #> > # fit independence model #> > # Residual deviance: 47.418 on 15 degrees of freedom #> > indep <- glm(Freq ~ mental+ses, #> +                 family = poisson, data = Mental) #>  #> > deviance(indep) #> [1] 47.41785 #>  #> > long.labels <- list(set_varnames = c(mental=\"Mental Health Status\", ses=\"Parent SES\")) #>  #> > mosaic(indep,residuals_type=\"rstandard\", labeling_args = long.labels, labeling=labeling_residuals, #> +        main=\"Mental health data: Independence\") #> Warning: no formula provided, assuming ~ses + mental #>  #> > # as a sieve diagram #> > mosaic(indep, labeling_args = long.labels, panel=sieve, gp=shading_Friendly, #> +        main=\"Mental health data: Independence\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > # fit linear x linear (uniform) association.  Use integer scores for rows/cols  #> > Cscore <- as.numeric(Mental$ses) #>  #> > Rscore <- as.numeric(Mental$mental) #>  #> > # column effects model (ses) #> > coleff <- glm(Freq ~ mental + ses + Rscore:ses, #> +                 family = poisson, data = Mental) #>  #> > mosaic(coleff,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: Col effects (ses)\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > # row effects model (mental) #> > roweff <- glm(Freq ~ mental + ses + mental:Cscore, #> +                 family = poisson, data = Mental) #>  #> > mosaic(roweff,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: Row effects (mental)\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > linlin <- glm(Freq ~ mental + ses + Rscore:Cscore, #> +                 family = poisson, data = Mental) #>  #> > # compare models #> > anova(indep, roweff, coleff, linlin) #> Analysis of Deviance Table #>  #> Model 1: Freq ~ mental + ses #> Model 2: Freq ~ mental + ses + mental:Cscore #> Model 3: Freq ~ mental + ses + Rscore:ses #> Model 4: Freq ~ mental + ses + Rscore:Cscore #>   Resid. Df Resid. Dev Df Deviance #> 1        15     47.418             #> 2        12      6.281  3   41.137 #> 3        10      6.829  2   -0.549 #> 4        14      9.895 -4   -3.066 #>  #> > AIC(indep, roweff, coleff, linlin) #>        df      AIC #> indep   9 209.5908 #> roweff 12 174.4537 #> coleff 14 179.0023 #> linlin 10 174.0681 #>  #> > mosaic(linlin,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: Linear x Linear\") #> Warning: no formula provided, assuming ~ses + mental  #>  #> > ##  Goodman Row-Column association model fits well (deviance 3.57, df 8) #> > Mental$mental <- C(Mental$mental, treatment) #>  #> > Mental$ses <- C(Mental$ses, treatment) #>  #> > RC1model <- gnm(Freq ~ mental + ses + Mult(mental, ses), #> +                 family = poisson, data = Mental) #> Initialising #> Running start-up iterations.. #> Running main iterations....... #> Done #>  #> > mosaic(RC1model,residuals_type=\"rstandard\",  #> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly, #> +  main=\"Mental health data: RC1 model\") #> Warning: no formula provided, assuming ~ses + mental"},{"path":"http://friendly.github.io/vcdExtra/reference/Vietnam.html","id":null,"dir":"Reference","previous_headings":"","what":"Student Opinion about the Vietnam War — Vietnam","title":"Student Opinion about the Vietnam War — Vietnam","text":"survey student opinion Vietnam War taken University North Carolina Chapel Hill May 1967 published student newspaper. Students asked fill ballot papers stating policy ,B,C D supported. Responses cross-classified gender/year. response categories : Defeat North Vietnam widespread bombing land invasion B Maintain present policy C De-escalate military activity, stop bombing begin negotiations D Withdraw military forces Immediately","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Student Opinion about the Vietnam War — Vietnam","text":"","code":"data(Vietnam)"},{"path":"http://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Student Opinion about the Vietnam War — Vietnam","text":"frequency data frame 40 observations representing 2 x 5 x 4 contingency table    following 4 variables. sex factor levels Female Male year year study, ordered factor levels        Freshmen, Sophomore, Junior, Senior, Grad student response factor levels B C D Freq cell frequency, numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Student Opinion about the Vietnam War — Vietnam","text":"analyses, useful treat year numeric, possibly assign grad students value year=7.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Student Opinion about the Vietnam War — Vietnam","text":"Aitken, M. etal, 1989,  Statistical Modelling GLIM","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Student Opinion about the Vietnam War — Vietnam","text":"Friendly, M.  (2000), Visualizing Categorical Data, SAS Institute, Cary, NC, Example 7.9.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vietnam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Student Opinion about the Vietnam War — Vietnam","text":"","code":"data(Vietnam) ## maybe str(Vietnam) ; plot(Vietnam) ..."},{"path":"http://friendly.github.io/vcdExtra/reference/Vote1980.html","id":null,"dir":"Reference","previous_headings":"","what":"Race and Politics in the 1980 Presidential Vote — Vote1980","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"Data 1982 General Social Survey votes 1980 U.S. presidential election relation race political  conservatism.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"","code":"data(Vote1980)"},{"path":"http://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"frequency data frame representing 2 x 7 x 2 table, 28 observations following 4 variables. race factor levels NonWhite White conservatism factor levels 1 2 3 4 5 6 7,       1=liberal, 7=conservative votefor factor levels Carter Reagan; Carter        represents Jimmy Carter . Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"data contains number sampling zeros frequencies NonWhites voting Ronald Reagan.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"Clogg, C. & Shockey, J. W. (1988). Nesselroade, J. R. & Cattell, R. B. (ed.)  Multivariate Analysis Discrete Data, Handbook Multivariate Experimental Psychology,  New York: Plenum Press.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"Agresti, . (1990) Categorical Data Analysis, Table 4.12 New York: Wiley-Interscience. Friendly, M. (2000) Visualizing Categorical Data, Example 7.5 Cary, NC: SAS Institute.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Vote1980.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Race and Politics in the 1980 Presidential Vote — Vote1980","text":"","code":"data(Vote1980) fourfold(xtabs(Freq ~ race + votefor + conservatism, data=Vote1980), mfrow=c(2,4))"},{"path":"http://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":null,"dir":"Reference","previous_headings":"","what":"Worker Satisfaction Data — WorkerSat","title":"Worker Satisfaction Data — WorkerSat","text":"Blue collar workers job satisfaction large scale investigation Denmark 1968 (Andersen, 1991).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Worker Satisfaction Data — WorkerSat","text":"","code":"data(\"WorkerSat\")"},{"path":"http://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Worker Satisfaction Data — WorkerSat","text":"frequency data frame 8 observations following 4 variables, representing 2 x 2 x 2 classification 715 cases. Manage Quality management, ordered factor levels bad < good Super Supervisor satisfaction, ordered factor levels low < high Worker Worker job satisfaction, ordered factor levels low < high Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Worker Satisfaction Data — WorkerSat","text":"Originally https://online.stat.psu.edu/stat504/lesson/10/","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Worker Satisfaction Data — WorkerSat","text":"Andersen, E. B. (1991) Statistical Analysis Categorical Data, 2nd Ed., Springer-Verlag.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/WorkerSat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Worker Satisfaction Data — WorkerSat","text":"","code":"data(WorkerSat)  worker.tab <- xtabs(Freq ~ Worker + Super + Manage, data=WorkerSat) fourfold(worker.tab)  mosaic(worker.tab, shade=TRUE)"},{"path":"http://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":null,"dir":"Reference","previous_headings":"","what":"Occupational Mobility in Three Countries — Yamaguchi87","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"Yamaguchi (1987) presented three-way frequency table, cross-classifying occupational categories sons fathers United States, United Kingdom Japan.  data set become classic models comparing two-way mobility tables across layers corresponding countries, groups time (e.g., Goodman Hout, 1998; Xie, 1992). US data derived 1973 OCG-II survey; UK 1972 Oxford Social Mobility Survey; Japan came 1975 Social Stratification Mobility survey. pertain men aged 20-64.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"","code":"data(Yamaguchi87)"},{"path":"http://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"frequency data frame 75 observations following 4 variables. total sample size 28887. Son factor levels UpNM LoNM UpM LoM Farm Father factor levels UpNM LoNM UpM LoM Farm Country factor levels US UK Japan Freq numeric vector","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"Five status categories -- upper lower nonmanuals (UpNM, LoNM),  upper lower manuals (UpM, LoM),  Farm) used fathers' occupations sons' occupations. Upper nonmanuals professionals, managers, officials; lower nonmanuals proprietors, sales workers, clerical workers; upper manuals skilled workers; lower manuals semi-skilled unskilled nonfarm workers; farm workers farmers farm laborers. models Xie (1992), Table 1, fit demo(yamaguchi-xie).","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"Yamaguchi, K. (1987).  Models comparing mobility tables: toward parsimony substance,  American Sociological Review, vol. 52 (Aug.), 482-494, Table 1","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"Goodman, L. . Hout, M. (1998). Statistical Methods Graphical Displays Analyzing Association Two Qualitative Variables Differs Among Countries, Among Groups, Time:  Modified Regression-Type Approach. Sociological Methodology, 28 (1), 175-230. Xie, Yu (1992). log-multiplicative layer effect model comparing mobility tables. American Sociological Review, 57 (June), 380-395.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/Yamaguchi87.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Occupational Mobility in Three Countries — Yamaguchi87","text":"","code":"data(Yamaguchi87) # reproduce Table 1 structable(~ Father + Son + Country, Yamaguchi87) #>                Son UpNM LoNM  UpM  LoM Farm #> Father Country                              #> UpNM   US          1275  364  274  272   17 #>        UK           474  129   87  124   11 #>        Japan        127  101   24   30   12 #> LoNM   US          1055  597  394  443   31 #>        UK           300  218  171  220    8 #>        Japan         86  207   64   61   13 #> UpM    US          1043  587 1045  951   47 #>        UK           438  254  669  703   16 #>        Japan         43   73  122   60   13 #> LoM    US          1159  791 1323 2046   52 #>        UK           601  388  932 1789   37 #>        Japan         35   51   62   66   11 #> Farm   US           666  496 1031 1632  646 #>        UK            76   56  125  295  191 #>        Japan        109  206  184  253  325 # create table form Yama.tab <- xtabs(Freq ~ Son + Father + Country, data=Yamaguchi87)  # define mosaic labeling_args for convenient reuse in 3-way displays largs <- list(rot_labels=c(right=0), offset_varnames = c(right = 0.6),                offset_labels = c(right = 0.2),               set_varnames = c(Son=\"Son's status\", Father=\"Father's status\")               )  ################################### # Fit some models & display mosaics    # Mutual independence yama.indep <- glm(Freq ~ Son + Father + Country, data=Yamaguchi87, family=poisson) anova(yama.indep) #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>         Df Deviance Resid. Df Resid. Dev #> NULL                       74      34313 #> Son      4   7034.4        70      27279 #> Father   4   3859.2        66      23419 #> Country  2  14231.1        64       9188  mosaic(yama.indep, ~Son+Father, main=\"[S][F] ignoring country\")  mosaic(yama.indep, ~Country + Son + Father, condvars=\"Country\",        labeling_args=largs,         main='[S][F][C] Mutual independence')    # no association between S and F given country ('perfect mobility') # asserts same associations for all countries yama.noRC <- glm(Freq ~ (Son + Father) * Country, data=Yamaguchi87, family=poisson) anova(yama.noRC) #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>                Df Deviance Resid. Df Resid. Dev #> NULL                              74      34313 #> Son             4   7034.4        70      27279 #> Father          4   3859.2        66      23419 #> Country         2  14231.1        64       9188 #> Son:Country     8   1062.9        56       8125 #> Father:Country  8   2533.8        48       5592 mosaic(yama.noRC, ~~Country + Son + Father, condvars=\"Country\",         labeling_args=largs,         main=\"[SC][FC] No [SF] (perfect mobility)\")   # ignore diagonal cells yama.quasi <- update(yama.noRC, ~ . + Diag(Son,Father):Country) anova(yama.quasi) #> Analysis of Deviance Table #>  #> Model: poisson, link: log #>  #> Response: Freq #>  #> Terms added sequentially (first to last) #>  #>  #>                           Df Deviance Resid. Df Resid. Dev #> NULL                                         74      34313 #> Son                        4   7034.4        70      27279 #> Father                     4   3859.2        66      23419 #> Country                    2  14231.1        64       9188 #> Son:Country                8   1062.9        56       8125 #> Father:Country             8   2533.8        48       5592 #> Country:Diag(Son, Father) 15   4255.3        33       1336 mosaic(yama.quasi, ~Son+Father, main=\"Quasi [S][F]\")   ## see also: # demo(yamaguchi-xie) ##"},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Score test for zero inflation in Poisson data — zero.test","title":"Score test for zero inflation in Poisson data — zero.test","text":"Carries simple score test (van den Broek, 1995) excess zeros  otherwise Poisson distribution counts.  gives \\(\\chi^2_1\\) statistic one degree freedom.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score test for zero inflation in Poisson data — zero.test","text":"","code":"zero.test(x)"},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score test for zero inflation in Poisson data — zero.test","text":"x vector non-negative counts, one-way frequency table counts.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Score test for zero inflation in Poisson data — zero.test","text":"test first calculates rate estimate mean, \\(\\hat{\\lambda} = \\bar{x}\\). number observed zeros, \\(n_0\\) compared expected number, \\(n \\hat{p_0}\\), \\(\\hat{p}_0=\\exp[-\\hat{\\lambda}]\\). test statistic calculated formula:  $$\\frac{(n_0 - n\\hat{p}_0)^2}{n\\hat{p}_0(1-\\hat{p}_0) - n\\bar{x}\\hat{p}_0^2}$$  test statistic \\(\\chi^2_1\\) distribution.","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Score test for zero inflation in Poisson data — zero.test","text":"Returns invisibly list three elements: statistic Description 'comp1' df Description 'comp2' pvalue Upper tail p-value","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Score test for zero inflation in Poisson data — zero.test","text":"original R code came Stackexchange question, https://stats.stackexchange.com/questions/118322/--test--zero-inflation---dataset Van den Broek, J. (1995).  Score Test Zero Inflation Poisson Distribution.  Biometrics, 51(2), 738-743. https://www.jstor.org/stable/2532959 Yang, Zhao, James W. Hardin, Cheryl L. Addy (2010).  Score Tests Zero-Inflation Overdispersed Count Data.  Communications Statistics - Theory Methods 39 (11) 2008-2030.  doi: 10.1080/03610920902948228","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Score test for zero inflation in Poisson data — zero.test","text":"Michael Friendly","code":""},{"path":"http://friendly.github.io/vcdExtra/reference/zero.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Score test for zero inflation in Poisson data — zero.test","text":"","code":"# synthetic tests zero.test(rpois(100, 1)) #> Score test for zero inflation #>  #>  \tChi-square = 0.29431  #>  \tdf = 1 #>  \tpvalue: 0.58747  zero.test(rpois(100, 5)) #> Score test for zero inflation #>  #>  \tChi-square = 0.84642  #>  \tdf = 1 #>  \tpvalue: 0.35757  # add some extra zeros zero.test(c(rep(0, 20), rpois(100, 5))) #> Score test for zero inflation #>  #>  \tChi-square = 220.13433  #>  \tdf = 1 #>  \tpvalue: < 2.22e-16   # Articles by Phd candidates data(PhdPubs, package=\"vcdExtra\") zero.test(PhdPubs$articles) #> Score test for zero inflation #>  #>  \tChi-square = 133.91825  #>  \tdf = 1 #>  \tpvalue: < 2.22e-16   phd.tab <- table(PhdPubs$articles) zero.test(phd.tab) #> Score test for zero inflation #>  #>  \tChi-square = 133.91825  #>  \tdf = 1 #>  \tpvalue: < 2.22e-16"},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-08-0-2022-04-20","dir":"Changelog","previous_headings":"","what":"Version 0.8-0 (2022-04-20)","title":"Version 0.8-0 (2022-04-20)","text":"Fixed warning expand.dft() re type.convert Old .Rnw vignettes converted .Rmd","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-07-6-2022-02-12","dir":"Changelog","previous_headings":"","what":"Version 0.7-6 (2022-02-12)","title":"Version 0.7-6 (2022-02-12)","text":"CRAN release: 2022-02-14 Fix issues CMHtest() types argument #PR11 [Thx: ShuguangSun, Matt Kumar] Fix Winbuilder URL nits; extensive spell checking","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-07-5-2020-12-25","dir":"Changelog","previous_headings":"","what":"Version 0.7-5 (2020-12-25)","title":"Version 0.7-5 (2020-12-25)","text":"CRAN release: 2021-01-25 Fix problem re use rgl mosaic3d() examples","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-07-4-2019-09-25","dir":"Changelog","previous_headings":"","what":"Version 0.7-4 (2019-09-25)","title":"Version 0.7-4 (2019-09-25)","text":"Fix datasets() work packages using LazyData #PR7 [Thx: Duncan Murdock] Bump package Version","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-07-3-2018-06-04","dir":"Changelog","previous_headings":"","what":"Version 0.7-3 (2018-06-04)","title":"Version 0.7-3 (2018-06-04)","text":"fix Version number gnm DESCRIPTION fix expand.dft expand.table work tibbles [Thx: Duncan Murdoch] vcdExtra gets hex sticker","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-07-1-2017-09-28","dir":"Changelog","previous_headings":"","what":"Version 0.7-1 (2017-09-28)","title":"Version 0.7-1 (2017-09-28)","text":"CRAN release: 2017-09-29 Fixed buglet expand.dft() table 1-dim [Thx: Long Qu] Added zero.test(), simple score test zero inflation Development moved https://github.com/friendly/vcdExtra","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-07-0-2016-01-27","dir":"Changelog","previous_headings":"","what":"Version 0.7-0 (2016-01-27)","title":"Version 0.7-0 (2016-01-27)","text":"CRAN release: 2016-02-25 Added Glass data introduce links references DDAR added mcaplot() plot MCA solutions DDAR style added update.xtabs() method updated vignette refer DDAR","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-12-2015-10-06","dir":"Changelog","previous_headings":"","what":"Version 0.6-12 (2015-10-06)","title":"Version 0.6-12 (2015-10-06)","text":"CRAN release: 2015-12-23 Added Burt data Fixed examples/vignette ggplot_2.0.0","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-11-2015-09-14","dir":"Changelog","previous_headings":"","what":"Version 0.6-11 (2015-09-14)","title":"Version 0.6-11 (2015-09-14)","text":"CRAN release: 2015-09-17 bump pkg Version CRAN","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-10-2015-07-27","dir":"Changelog","previous_headings":"","what":"Version 0.6-10 (2015-07-27)","title":"Version 0.6-10 (2015-07-27)","text":"Added HospVisits data","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-9-2015-06-11","dir":"Changelog","previous_headings":"","what":"Version 0.6-9 (2015-06-11)","title":"Version 0.6-9 (2015-06-11)","text":"CRAN release: 2015-07-11 Added Mice data Removed uses summarise() Summarise() demos examples, preparation deprecating . summarise() now deprecated Now use importsFrom() functions recommended packages","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-8-2015-04-15","dir":"Changelog","previous_headings":"","what":"Version 0.6-8 (2015-04-15)","title":"Version 0.6-8 (2015-04-15)","text":"CRAN release: 2015-04-16 Fixed Title: Description: CRAN","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-7-2015-04-02","dir":"Changelog","previous_headings":"","what":"Version 0.6-7 (2015-04-02)","title":"Version 0.6-7 (2015-04-02)","text":"Removed loddsratio (now vcd) (rev 252) Removed print.Kappa (now vcd) (rev 253) Fixed bug CMHtest(): rmeans cmeans labels reversed (rev 254) Fixed error Fungicide.Rd, now require vcd_1.3-3 (rev 254) Added WorkerSat data - 2 x 2 x 2 Added AirCrash data","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-6-2015-02-04","dir":"Changelog","previous_headings":"","what":"Version 0.6-6 (2015-02-04)","title":"Version 0.6-6 (2015-02-04)","text":"Minor doc changes","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-5-2014-11-07","dir":"Changelog","previous_headings":"","what":"Version 0.6-5 (2014-11-07)","title":"Version 0.6-5 (2014-11-07)","text":"CRAN release: 2015-01-03 Added Cormorants data (fixed latest) Added LRstats(), replace Summarise. Older summarise() Summarise() eventually deprecated. Now Suggests: AER NMES1988 data collapse.table() now works array objects","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-3-2014-10-27","dir":"Changelog","previous_headings":"","what":"Version 0.6-3 (2014-10-27)","title":"Version 0.6-3 (2014-10-27)","text":"CRAN release: 2014-11-01 Fixed bug logLik.loglm data contain zero frequencies (rev 228) Made Summarise generic, adding method “glmlist” objects (rev 230) Added coef() method “glmlist” objects (thx: John Fox) Added Summarise.loglmlist method (rev 232) Replaced documentation uses summarise() Summarise() (rev 233) Added cutfac(), convenience wrapper cut() (rev 234) Now use rgl:: mosaic3d functions","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-2-2014-06-30","dir":"Changelog","previous_headings":"","what":"Version 0.6-2 (2014-06-30)","title":"Version 0.6-2 (2014-06-30)","text":"added Summarise, replace summarise Added HairEyePlace data - 4 x 5 x 2, Caithness Aberdeen hair/eye color (rev 223) Added PhdPubs data Long (1997) - publications PhD candidates Allow Summarise work models w/o deviance() function Fixed bug Summarise wrt degrees freedom","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-1-2014-04-14","dir":"Changelog","previous_headings":"","what":"Version 0.6-1 (2014-04-14)","title":"Version 0.6-1 (2014-04-14)","text":"CRAN release: 2014-06-10 Added ICU data Added Toxaemia data - multivariate response contingency table (rev 209) Added Vietnam data - 2 x 5 x 4 frequency table (rev 210) Added logLik.loglm allow use AIC() BIC() loglm models (rev 212) Fixed loddsratio.Rd work revised vcd::CoalMiners data (rev 212) Added blogits bivariate binary response data Added Vote1980 data (rev 214)","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-06-0-2014-03-07","dir":"Changelog","previous_headings":"","what":"Version 0.6-0 (2014-03-07)","title":"Version 0.6-0 (2014-03-07)","text":"CRAN release: 2014-03-08 Removed Authors: DESCRIPTION, bumped Version","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-12-2013-12-16","dir":"Changelog","previous_headings":"","what":"Version 0.5-12 (2013-12-16)","title":"Version 0.5-12 (2013-12-16)","text":"Added ShakeWords data set- word frequency counts Shakespeare (rev 188) Added Geissler data– family sizes Saxony sex composition data (rev 190) Added logseries functions logarithmic series distribution (rev 191) Added Depends data – dependencies r packages (rev 192) Fixed buglet seq_loglm() respecting arrays Added seq_mosaic() (rev 194) Added CyclingDeaths data (rev 196) mosaic3d() gets interpolate= option control shading levels (rev 197) Fixed bug seq_mosaic, thx David Meyer (rev 200) Fixed bug seq_loglm() marginals != 1:nf","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-11-2013-07-01","dir":"Changelog","previous_headings":"","what":"Version 0.5-11 (2013-07-01)","title":"Version 0.5-11 (2013-07-01)","text":"CRAN release: 2013-09-16 Added mosaic.glmlist plot mosaics (strucplots) models glmlist (rev 169) Added loglim-utilities.R, containing suite functions provide conceptual way specify loglinear models type (‘joint’, ‘conditional’, ‘mutual’, ‘markov’, ‘saturated’) (rev 171) Added mosaic.loglmlist, similar mosaic.glmlist models fit using MASS::loglm (rev 173) mosaic.glmlist mosaic.glmlist get explicit panel=argument; get sensible default default arguments (rev 175) Added seq_loglm fit sequential loglm models marginal subtables, giving loglmlist result (rev 176) Added Accident data (rev 178); fleshed Accident examples (rev 180) Fixed use ::: R 3.0.1 (rev 179) Fixed various problems related use MASS:loglm (rev 181-183) Added Titanicp datasets (rev 185)","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-8-2013-03-06","dir":"Changelog","previous_headings":"","what":"Version 0.5-8 (2013-03-06)","title":"Version 0.5-8 (2013-03-06)","text":"Revised vcd-tutorial showing examples plyr; added section RC models Added Donner data example ggplot2 plot binomial glm() Added vcd-tutorial section using ggplot2 Donner data Enhanced datasets() provide maxTitle argument (rev 153) Added doubledecker plots Dyke.Rd (rev 156) Added Draft1970table Draft1970 data sets (rev 158) Added example doubledecker plots vcd-tutorial vignette (rev 164)","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-7-2013-03-01","dir":"Changelog","previous_headings":"","what":"Version 0.5-7 (2013-03-01)","title":"Version 0.5-7 (2013-03-01)","text":"CRAN release: 2013-03-05 Completed CMHtest methods, adding overall tests across strata general way CMHtest now gets S3 generic formula interface print Kappa gets digits= CI= arguments","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-6-2012-11-30","dir":"Changelog","previous_headings":"","what":"Version 0.5-6 (2012-11-30)","title":"Version 0.5-6 (2012-11-30)","text":"CRAN release: 2013-02-28 Added Hosmer Lemeshow HLtest methods, including plotting via vcd::rootogram() Added CMHtest general Cochran-Mantel-Haenszel tests Revised vcd-tutorial vignette, adding section CMH tests; removed dependence Z.cls","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-3-2012-03-07","dir":"Changelog","previous_headings":"","what":"Version 0.5-3 (2012-03-07)","title":"Version 0.5-3 (2012-03-07)","text":"CRAN release: 2012-05-08 Added Mammograms data (4x4, ordered factors, agreement) Extended mosaic.glm examples Added Alligator data (4x2x2x5, frequency form) Added DaytonSurvey data (5-way, 2x2x2x2x2 frequency form) Extended vcd-tutorial vignette section collapsing factors Removed aperm.* now aperm.table base R","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-2-2010-11-28","dir":"Changelog","previous_headings":"","what":"Version 0.5-2 (2010-11-28)","title":"Version 0.5-2 (2010-11-28)","text":"CRAN release: 2011-03-24 Added loddsratio related methods log odds ratios, generalizing vcd::oddsratio 2 x 2 (x strata) tables R x C (x strata) tables Added .matrix.loddsratio, .array.loddsratio methods Added simple plot examples example(loddsratio), anticipating plot method Added data(Fungicide), 2 x 2 x 2 x 2 table Renamed summarize() related methods summarise() avoid conflict plyr. Addition vcd-tutorial vignette use aperm() table objects Updated demo(yamaguchi-xie) correct row/col nomenclature add plot BIC Added aperm() S3 generic handle table objects Moved tv.dat inst/doc/extdata avoid warnings R 2.12+","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-1-2010-09-17","dir":"Changelog","previous_headings":"","what":"Version 0.5-1 (2010-09-17)","title":"Version 0.5-1 (2010-09-17)","text":"CRAN release: 2010-11-29 Added Yamaguchi87 data (5x5x3 three-way mobility table frequency form) Added demo(yamaguchi-xie) illustrating fitting visualization models homogeneous log multiplicative layer effects fit Xie (1992, Table 1) Added BIC summarize() friends Added Hauser79 data (two-way mobility table), plus examples Powers Xie (2008) Added Crossings() construct interactions Goodman 1972 crossings model. Added datasets() list datasets packages Extended description examples Kway() Added meanResiduals() extended mosaic.glm() (Heather Turner) summarize() gets sortby argument glmlist loglmlist objects","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-05-0-2010-04-28","dir":"Changelog","previous_headings":"","what":"Version 0.5-0 (2010-04-28)","title":"Version 0.5-0 (2010-04-28)","text":"CRAN release: 2010-04-16 Fleshed mosaic3d, allowing display observed expected, internally calculated externally supplied residuals, specifying initial 3D shape, etc. completes ‘top-level’ work mosaic3d(), borrowing code vcd::strucplot. Added initial handling zero cells table mosaic3d(). Added center3d() finding mean coordinates shape3d objects. Added demo(mosaic-hec) comparing 2D 3D mosaics HairEyeColor data Gave mosaic3d label_edge argument, allowing labels dimensions minima maxima Made mosaic3d object oriented, giving loglm method Added Kway(), fitting 0-way, 1-way, 2-way, … k-way models glm","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-04-3-2010-03-25","dir":"Changelog","previous_headings":"","what":"Version 0.4-3 (2010-03-25)","title":"Version 0.4-3 (2010-03-25)","text":"Added demo(mosaic3d-demo), proof--concept 3D mosaic displays Added mosaic3d(), initial basic Version. Factored split3d() gave S3 methods","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-04-2-2010-03-09","dir":"Changelog","previous_headings":"","what":"Version 0.4-2 (2010-03-09)","title":"Version 0.4-2 (2010-03-09)","text":"CRAN release: 2010-03-18 Revised vignette(“vcd-tutorial”): added hints mosaic(), corrected stuff regarding prior limitations mosaic.glm() Added demo(Wong3-1): three-way table, models conditional association Added Suggest: effects effects plots glm(), multinom() polr() models Added demo(housing): visualize models fit example(housing, package=“MASS”) using mosaic() effect plots. Updated demo(Wong2-3): added model comparison plots, glmlist processing Added Suggest: VGAM Extended package description vcdExtra-package.Rd Added glmlist() facilitate processing, extraction, plotting, etc. collection glm() models Added loglmlist(), collections loglm() objects Added summarize methods glm, glmlist, loglm loglmlist objects","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-04-1-2010-02-21","dir":"Changelog","previous_headings":"","what":"Version 0.4-1 (2010-02-21)","title":"Version 0.4-1 (2010-02-21)","text":"CRAN release: 2010-03-07 Added example(Caesar), illustrating structural zeros Re-named Heckman variables e1971, …, e1968 (errors loglm); began example(Heckman) Added example(Detergent), example(Dyke) Fixed bug mosaic.glm data global environment (Heather Turner) Added sieve.glm assoc.glm methods (MF) Added modFit.glm modFit.loglm Added demo(Wong2-3)","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-04-0-2010-02-23","dir":"Changelog","previous_headings":"","what":"Version 0.4-0 (2010-02-23)","title":"Version 0.4-0 (2010-02-23)","text":"CRAN release: 2010-02-28 Added new datasets: data/{Abortion, Bartlett, Caesar, Cancer, Detergent, Dyke, Gilby, Heart, Heckman, Hoyt, Mobility} mosdata.sas via md2r.sas converter. Fixed small documentation warnings Switched inst/CHANGES NEWS","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-03-6-2009-04-21","dir":"Changelog","previous_headings":"","what":"Version 0.3-6 (2009-04-21)","title":"Version 0.3-6 (2009-04-21)","text":"Added Depends: gnm Added demo/{mental-glm, ucb-glm, vision-quasi} Added demo/{occStatus,yaish-unidiff} Initial release CRAN","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-03-5-2009-3-6","dir":"Changelog","previous_headings":"","what":"Version 0.3-5 (2009-3-6)","title":"Version 0.3-5 (2009-3-6)","text":"mosaic.glm now uses object$data available","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-03-4-2009-2-11","dir":"Changelog","previous_headings":"","what":"Version 0.3-4 (2009-2-11)","title":"Version 0.3-4 (2009-2-11)","text":"Fixed bugs mosaic.glm, mosaic.gnm models terms like Diag(dest, origin) get included x$xlevels","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-03-3-2009-2-10","dir":"Changelog","previous_headings":"","what":"Version 0.3-3 (2009-2-10)","title":"Version 0.3-3 (2009-2-10)","text":"Fixed bugs mosaic.gnm Fixed print.GKgamma Added example GKgamma vcd-tutorial","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-03-2-2009-2-8","dir":"Changelog","previous_headings":"","what":"Version 0.3-2 (2009-2-8)","title":"Version 0.3-2 (2009-2-8)","text":"Added examples mosaic.glm.Rd","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-03-0-2009-2-6","dir":"Changelog","previous_headings":"","what":"Version 0.3-0 (2009-2-6)","title":"Version 0.3-0 (2009-2-6)","text":"Fixed bugs mosaic.glm mosaic.gnm","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-02-2009-2-1","dir":"Changelog","previous_headings":"","what":"Version 0.2 (2009-2-1)","title":"Version 0.2 (2009-2-1)","text":"Added vcd-tutorial vignette","code":""},{"path":"http://friendly.github.io/vcdExtra/news/index.html","id":"version-01-2009-1-26","dir":"Changelog","previous_headings":"","what":"Version 0.1 (2009-1-26)","title":"Version 0.1 (2009-1-26)","text":"Initial Version R-Forge.","code":""}]
