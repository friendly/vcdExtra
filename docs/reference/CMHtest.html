<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized Cochran-Mantel-Haenszel Tests — CMHtest • vcdExtra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Cochran-Mantel-Haenszel Tests — CMHtest"><meta name="description" content="Provides generalized Cochran-Mantel-Haenszel tests of association of two possibly ordered factors,
optionally stratified other factor(s).  With strata, CMHtest calculates these tests for
each level of the stratifying variables and also provides overall tests controlling for the
strata.
For ordinal factors, more powerful tests than the test for general association
(independence) are obtained by assigning scores to the row and column categories."><meta property="og:description" content="Provides generalized Cochran-Mantel-Haenszel tests of association of two possibly ordered factors,
optionally stratified other factor(s).  With strata, CMHtest calculates these tests for
each level of the stratifying variables and also provides overall tests controlling for the
strata.
For ordinal factors, more powerful tests than the test for general association
(independence) are obtained by assigning scores to the row and column categories."><meta property="og:image" content="http://friendly.github.io/vcdExtra/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="../articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="../articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="../articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="../articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="../articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="../articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generalized Cochran-Mantel-Haenszel Tests</h1>

      <div class="d-none name"><code>CMHtest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides generalized Cochran-Mantel-Haenszel tests of association of two possibly ordered factors,
optionally stratified other factor(s).  With strata, <code>CMHtest</code> calculates these tests for
each level of the stratifying variables and also provides overall tests controlling for the
strata.</p>
<p>For ordinal factors, more powerful tests than the test for general association
(independence) are obtained by assigning scores to the row and column categories.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="cn">NULL</span>, subset <span class="op">=</span> <span class="cn">NULL</span>, na.action <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">x</span>, </span>
<span>   strata <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>   rscores <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span>, </span>
<span>   cscores <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">C</span>, </span>
<span>   types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cor"</span>, <span class="st">"rmeans"</span>, <span class="st">"cmeans"</span>, <span class="st">"general"</span><span class="op">)</span>, </span>
<span>   overall<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>   details<span class="op">=</span><span class="va">overall</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'CMHtest'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A 2+ way contingency table in array form, or a class <code>"table"</code> object
with optional category labels specified in the dimnames(x) attribute.</p></dd>

  <dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a formula specifying the variables used to create a contingency table from <code>data</code>.
  This should be a one-sided formula when <code>data</code> is in array form, and a two-sided formula
  with a response <code>Freq</code> if <code>data</code> is a data frame with a cell frequency variable.
  For convenience, conditioning formulas can be specified indicating strata.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>either a data frame, or an object of class <code>"table"</code> or <code>"ftable"</code>.</p></dd>

  <dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional vector specifying a subset of observations to be used.</p></dd>

  <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function which indicates what should happen when the data contain <code>NA</code>s.
  Ignored if <code>data</code> is a contingency table</p></dd>


  <dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>For a 3- or higher-way table, the names or numbers of the factors
to be treated as strata.  By default, the first 2 factors are treated
as the main table variables, and all others considered stratifying factors.</p></dd>

  <dt id="arg-rscores">rscores<a class="anchor" aria-label="anchor" href="#arg-rscores"></a></dt>
<dd><p>Row scores.  Either a set of numbers (typically integers, <code>1:R</code>)
or the string <code>"midrank"</code> for standardized midrank scores,
or <code>NULL</code> to exclude tests that depend on row scores.</p></dd>

  <dt id="arg-cscores">cscores<a class="anchor" aria-label="anchor" href="#arg-cscores"></a></dt>
<dd><p>Column scores. Same as for row scores.</p></dd>

  <dt id="arg-types">types<a class="anchor" aria-label="anchor" href="#arg-types"></a></dt>
<dd><p>Types of CMH tests to compute: Any one or more of
<code>c("cor", "cmeans", "rmeans", "general")</code>,
or <code>"ALL"</code> for all of these.</p></dd>

  <dt id="arg-overall">overall<a class="anchor" aria-label="anchor" href="#arg-overall"></a></dt>
<dd><p>logical. Whether to calculate overall tests, controlling for
the stratifying factors.</p></dd>

  <dt id="arg-details">details<a class="anchor" aria-label="anchor" href="#arg-details"></a></dt>
<dd><p>logical.  Whether to include computational details in the result</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to default method.</p></dd>


  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Digits to print.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The standard \(\chi^2\) tests for association in a two-way table
treat both table factors as nominal (unordered) categories.
When one or both factors of a two-way table are
quantitative or ordinal, more powerful tests of association
may be obtained by taking ordinality into account using
row and or column scores to test for linear trends or differences
in row or column means.</p>
<p>The CMH analysis for a two-way table produces generalized Cochran-Mantel-Haenszel statistics
(Landis etal., 1978).</p>
<p>These include the CMH <b>correlation</b> statistic (<code>"cor"</code>),
treating both factors as ordered.
For a given statum, with equally spaced row and column scores,
this CMH statistic reduces to \((n-1) r^2\),
where \(r\) is the Pearson correlation between X and Y.
With <code>"midrank"</code> scores, this CMH statistic is analogous
to \((n-1) r_S^2\), using the Spearman rank correlation.</p>
<p>The <b>ANOVA</b> (row mean scores and column mean scores) statistics,
treat the columns and rows respectively as ordinal,
and are sensitive to mean shifts over columns or rows.
These are transforms of the \(F\) statistics from one-way ANOVAs
with equally spaced scores and to Kruskal-Wallis tests with
<code>"midrank"</code> scores.</p>
<p>The CMH <b>general</b> association statistic treat both factors as unordered,
and give a test closely related to the Pearson \(\chi^2\) test.
When there is more than one stratum, the overall general CMH statistic
gives a stratum-adjusted Pearson \(\chi^2\),
equivalent to what is calculated by <code><a href="https://rdrr.io/r/stats/mantelhaen.test.html" class="external-link">mantelhaen.test</a></code>.</p>
<p>For a 3+ way table, one table of CMH tests is produced for each
combination of the factors identified as <code>strata</code>.
If <code>overall=TRUE</code>, an additional table is calculated for
the same two primary variables, controlling for (pooling over)
the <code>strata</code> variables.</p>
<p>These overall tests implicitly assume no interactions  between the
primary variables and the strata and they will have low power in the
presence of interactions.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"CMHtest"</code> , a list with the following 4 components:</p>
<dl><dt>table</dt>
<dd><p>A matrix containing the test statistics, with columns
  	<code>Chisq</code>, <code>Df</code> and <code>Prob</code></p></dd>

  <dt>names</dt>
<dd><p>The names of the table row and column variables</p></dd>

  <dt>rscore</dt>
<dd><p>Row scores</p></dd>

  <dt>cscore</dt>
<dd><p>Column scores</p></dd>


</dl><p>If <code>details==TRUE</code>, additional components are included.</p>
<p>If there are strata, the result is a list of <code>"CMHtest"</code> objects.
If <code>overall=TRUE</code> another component, labeled <code>ALL</code>
is appended to the list.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stokes, M. E. &amp; Davis, C. S.  &amp; Koch, G., (2000).
 <em>Categorical Data Analysis using the SAS System</em>, 2nd Ed.,
 Cary, NC: SAS Institute,
 pp 74-75, 92-101, 124-129.
 Details of the computation are given at:
 <a href="http://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_freq_a0000000648.htm%0A" class="external-link">http://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_freq_a0000000648.htm
</a></p>
<p>Cochran, W. G. (1954), Some Methods for Strengthening the Common \(\chi^2\) Tests,
<em>Biometrics</em>, 10, 417-451.</p>
<p>Landis, R. J., Heyman, E. R., and Koch, G. G. (1978).
 Average Partial Association in Three-way Contingency Tables:
 A Review and Discussion of Alternative Tests,
 <em>International Statistical Review</em>, <b>46</b>, 237-254.</p>
<p>Mantel, N. (1963), Chi-square Tests with One Degree of Freedom: Extensions of the Mantel-Haenszel Procedure,"
<em>Journal of the American Statistical Association</em>, 58, 690-700.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/coin/man/ContingencyTests.html" class="external-link">cmh_test</a></code> provides the CMH test of general association;
<code><a href="https://rdrr.io/pkg/coin/man/ContingencyTests.html" class="external-link">lbl_test</a></code> provides the CMH correlation test of linear by linear association.</p>
<p><code><a href="https://rdrr.io/r/stats/mantelhaen.test.html" class="external-link">mantelhaen.test</a></code> provides the overall general
Cochran-Mantel-Haenszel chi-squared test of the null that two nominal variables are conditionally independent
in each stratum, assuming that there is no three-way interaction</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">JobSat</span>, package<span class="op">=</span><span class="st">"vcdExtra"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">JobSat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for income by satisfaction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df     Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 2.9830  1 0.084144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 4.4774  3 0.214318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 3.1036  3 0.375931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 5.9034  9 0.749549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">JobSat</span>, rscores<span class="op">=</span><span class="st">"midrank"</span>, cscores<span class="op">=</span><span class="st">"midrank"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for income by satisfaction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df     Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 2.9726  1 0.084685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 4.1200  3 0.248799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 3.3108  3 0.346144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 5.9034  9 0.749549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># formula interface</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">JobSat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for income by satisfaction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df     Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 2.9830  1 0.084144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 4.4774  3 0.214318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 3.1036  3 0.375931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 5.9034  9 0.749549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A 3-way table (both factors ordinal)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MSPatients</span>, package<span class="op">=</span><span class="st">"vcd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">MSPatients</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Patients:Winnipeg`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum Patients:Winnipeg </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 51.424  1 7.4426e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 55.393  3 5.6601e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 53.631  3 1.3450e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 64.318  9 1.9580e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Patients:New Orleans`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum Patients:New Orleans </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 28.863  1 7.7667e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 30.594  3 1.0347e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 29.054  3 2.1818e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 43.428  9 1.7990e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># also calculate overall tests, controlling for Patient</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">MSPatients</span>, overall <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Patients:Winnipeg`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum Patients:Winnipeg </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 51.424  1 7.4426e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 55.393  3 5.6601e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 53.631  3 1.3450e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 64.318  9 1.9580e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Patients:New Orleans`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum Patients:New Orleans </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 28.863  1 7.7667e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 30.594  3 1.0347e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 29.054  3 2.1818e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 43.428  9 1.7990e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ALL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Overall tests, controlling for all strata </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 80.086  1 3.5848e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 83.923  3 4.4189e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 81.116  3 1.7685e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 101.21  9 8.9683e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># compare with mantelhaen.test</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/mantelhaen.test.html" class="external-link">mantelhaen.test</a></span><span class="op">(</span><span class="va">MSPatients</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Cochran-Mantel-Haenszel test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  MSPatients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel M^2 = 101.21, df = 9, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># formula interface</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">MSPatients</span>, overall <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Patients:Winnipeg`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum Patients:Winnipeg </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 51.424  1 7.4426e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 55.393  3 5.6601e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 53.631  3 1.3450e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 64.318  9 1.9580e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Patients:New Orleans`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum Patients:New Orleans </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 28.863  1 7.7667e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 30.594  3 1.0347e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 29.054  3 2.1818e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 43.428  9 1.7990e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ALL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for New Orleans Neurologist by Winnipeg Neurologist </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Overall tests, controlling for all strata </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 80.086  1 3.5848e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 83.923  3 4.4189e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 81.116  3 1.7685e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 101.21  9 8.9683e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using a frequency data.frame</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">~</span><span class="va">ses</span> <span class="op">+</span> <span class="va">mental</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for ses by mental </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 37.156  1 1.0907e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 40.297  5 1.3012e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 40.666  3 7.6971e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 45.958 15 5.4003e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># or, more simply</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">Freq</span><span class="op">~</span><span class="va">ses</span> <span class="op">+</span> <span class="va">mental</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for ses by mental </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 37.156  1 1.0907e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 40.297  5 1.3012e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 40.666  3 7.6971e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 45.958 15 5.4003e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># conditioning formulae</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">Freq</span><span class="op">~</span><span class="va">right</span> <span class="op">+</span> <span class="va">left</span> <span class="op">|</span> <span class="va">gender</span>, data <span class="op">=</span> <span class="va">VisualAcuity</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`gender:male`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for right by left </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum gender:male </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 1554.6  1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 1556.3  3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 1556.6  3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 3303.3  9    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`gender:female`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for right by left </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum gender:female </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 3691.3  1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 3709.4  3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 3724.0  3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 8095.8  9    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">attitude</span> <span class="op">+</span> <span class="va">memory</span> <span class="op">|</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">Punishment</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:elementary|age:15-24`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:elementary|age:15-24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df     Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 3.5652  1 0.059002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 3.5652  1 0.059002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 3.5652  1 0.059002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 3.5652  1 0.059002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:secondary|age:15-24`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:secondary|age:15-24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis    Chisq Df   Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 0.077731  1 0.7804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 0.077731  1 0.7804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 0.077731  1 0.7804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 0.077731  1 0.7804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:high|age:15-24`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:high|age:15-24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis    Chisq Df    Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 0.089524  1 0.76478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 0.089524  1 0.76478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 0.089524  1 0.76478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 0.089524  1 0.76478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:elementary|age:25-39`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:elementary|age:25-39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df     Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 8.5433  1 0.003468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 8.5433  1 0.003468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 8.5433  1 0.003468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 8.5433  1 0.003468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:secondary|age:25-39`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:secondary|age:25-39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis   Chisq Df    Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 0.92897  1 0.33513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 0.92897  1 0.33513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 0.92897  1 0.33513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 0.92897  1 0.33513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:high|age:25-39`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:high|age:25-39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis Chisq Df    Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 0.472  1 0.49207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 0.472  1 0.49207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 0.472  1 0.49207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 0.472  1 0.49207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:elementary|age:40-`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:elementary|age:40- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 11.606  1 0.00065737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 11.606  1 0.00065737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 11.606  1 0.00065737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 11.606  1 0.00065737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:secondary|age:40-`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:secondary|age:40- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df    Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 6.0457  1 0.01394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 6.0457  1 0.01394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 6.0457  1 0.01394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 6.0457  1 0.01394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`education:high|age:40-`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for attitude by memory </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	in stratum education:high|age:40- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AltHypothesis  Chisq Df     Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor        Nonzero correlation 3.0436  1 0.081055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rmeans  Row mean scores differ 3.0436  1 0.081055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cmeans  Col mean scores differ 3.0436  1 0.081055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general    General association 3.0436  1 0.081055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stokes etal, Table 5.1, p 92: two unordered factors</span></span></span>
<span class="r-in"><span><span class="va">parties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">221</span>, <span class="fl">160</span>, <span class="fl">360</span>, <span class="fl">140</span>,</span></span>
<span class="r-in"><span>    <span class="fl">200</span>, <span class="fl">291</span>, <span class="fl">160</span>, <span class="fl">311</span>,</span></span>
<span class="r-in"><span>    <span class="fl">208</span>, <span class="fl">106</span>, <span class="fl">316</span>, <span class="fl">97</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">4</span>, </span></span>
<span class="r-in"><span>  byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">parties</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>party<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dem"</span>, <span class="st">"Indep"</span>, <span class="st">"Rep"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             neighborhood<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bayside"</span>, <span class="st">"Highland"</span>, <span class="st">"Longview"</span>, <span class="st">"Sheffield"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">CMHtest</span><span class="op">(</span><span class="va">parties</span>, rscores<span class="op">=</span><span class="cn">NULL</span>, cscores<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cochran-Mantel-Haenszel Statistics for party by neighborhood </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AltHypothesis  Chisq Df       Prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> general General association 273.81  6 3.3158e-56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare with Pearson chisquare</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">parties</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Pearson's Chi-squared test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  parties</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 273.92, df = 6, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

