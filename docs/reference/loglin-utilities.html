<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions generate lists of terms to specify a loglinear model
in a form compatible with loglin and also provide for conversion to an
equivalent loglm specification or a shorthand character
string representation.  
They allow for a more conceptual
way to specify such models by a function for their type, as opposed
to just an uninterpreted list of model terms
and also allow
easy specification of marginal models for a given contingency table.
They are intended to be used as tools in higher-level modeling and 
graphics functions, but can also be used directly."><title>Loglinear Model Utilities — loglin-utilities • vcdExtra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loglinear Model Utilities — loglin-utilities"><meta property="og:description" content="These functions generate lists of terms to specify a loglinear model
in a form compatible with loglin and also provide for conversion to an
equivalent loglm specification or a shorthand character
string representation.  
They allow for a more conceptual
way to specify such models by a function for their type, as opposed
to just an uninterpreted list of model terms
and also allow
easy specification of marginal models for a given contingency table.
They are intended to be used as tools in higher-level modeling and 
graphics functions, but can also be used directly."><meta property="og:image" content="http://friendly.github.io/vcdExtra/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/continuous.html">Continuous predictors</a>
    <a class="dropdown-item" href="../articles/creating.html">Creating and manipulating frequency tables</a>
    <a class="dropdown-item" href="../articles/demo-housing.html">Demo - Housing Data</a>
    <a class="dropdown-item" href="../articles/loglinear.html">Loglinear Models</a>
    <a class="dropdown-item" href="../articles/mosaics.html">Mosaic plots</a>
    <a class="dropdown-item" href="../articles/tests.html">Tests of Independence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Loglinear Model Utilities</h1>
      
      <div class="d-none name"><code>loglin-utilities.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions generate lists of terms to specify a loglinear model
in a form compatible with <code><a href="https://rdrr.io/r/stats/loglin.html" class="external-link">loglin</a></code> and also provide for conversion to an
equivalent <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></code> specification or a shorthand character
string representation.</p>  
<p>They allow for a more conceptual
way to specify such models by a function for their type, as opposed
to just an uninterpreted list of model terms
and also allow
easy specification of marginal models for a given contingency table.</p>
<p>They are intended to be used as tools in higher-level modeling and 
graphics functions, but can also be used directly.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">conditional</span><span class="op">(</span><span class="va">nf</span>, table <span class="op">=</span> <span class="cn">NULL</span>, factors <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nf</span>, with <span class="op">=</span> <span class="va">nf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">joint</span><span class="op">(</span><span class="va">nf</span>, table <span class="op">=</span> <span class="cn">NULL</span>, factors <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nf</span>, with <span class="op">=</span> <span class="va">nf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">markov</span><span class="op">(</span><span class="va">nf</span>, factors <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nf</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mutual</span><span class="op">(</span><span class="va">nf</span>, table <span class="op">=</span> <span class="cn">NULL</span>, factors <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">saturated</span><span class="op">(</span><span class="va">nf</span>, table <span class="op">=</span> <span class="cn">NULL</span>, factors <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglin2formula</span><span class="op">(</span><span class="va">x</span>, env <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglin2string</span><span class="op">(</span><span class="va">x</span>, brackets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"["</span>, <span class="st">"]"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span>, collapse <span class="op">=</span> <span class="st">" "</span>, <span class="va">abbrev</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>nf</dt>
<dd><p>number of factors for which to generate the model</p></dd>

  <dt>table</dt>
<dd><p>a contingency table used only for factor names in the model, typically the output from <code><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></code>
and possibly permuted with <code>aperm</code></p></dd>

  <dt>factors</dt>
<dd><p>names of factors used in the model formula when <code>table</code> is not specified</p></dd>

  <dt>with</dt>
<dd><p>For <code>joint</code> and <code>conditional</code> models, <code>with</code> gives the
indices of the factors against which all others are considered jointly 
or conditionally independent</p></dd>


  <dt>order</dt>
<dd><p>For <code>markov</code>, this gives the order of the Markov chain model for the
factors.  An <code>order=1</code> Markov chain allows associations among
sequential pairs of factors, e.g., <code>[A,B], [B,C], [C,D]</code> ....
An <code>order=2</code> Markov chain allows associations among
sequential triples.</p></dd>


  <dt>x</dt>
<dd><p>For the <code>loglin2*</code> functions, 
a list of terms in a loglinear model, such as returned by <code>conditional</code>, <code>joint</code>, 
 ...</p></dd>


  <dt>env</dt>
<dd><p>For <code>loglin2formula</code>, environment in which to evaluate the formula</p></dd>

  <dt>brackets</dt>
<dd><p>For <code>loglin2string</code>, 
characters to use to surround model terms.  
Either a single character string containing two characters (e.g., <code>'[]'</code>
or a character vector of length two.</p></dd>

  <dt>sep</dt>
<dd><p>For <code>loglin2string</code>,
the separator character string used for factor names within a given model term</p></dd>

  <dt>collapse</dt>
<dd><p>For <code>loglin2string</code>,
the character string used between terms in the the model string</p></dd>

  <dt>abbrev</dt>
<dd><p>For <code>loglin2string</code>,
whether and how to abbreviate the terms in the string representation.
This has not yet been implemented.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The main model specification functions, <code>conditional</code>, <code>joint</code>, 
  <code>markov</code>, ..., <code>saturated</code>,
  return a list of vectors indicating the marginal totals to be fit,
  via the <code>margin</code> argument to <code><a href="https://rdrr.io/r/stats/loglin.html" class="external-link">loglin</a></code>.
  Each element of this list corresponds to a high-order
  term in a hierarchical loglinear model, where, e.g., a term
  like <code>c("A", "B")</code> is equivalent to the <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></code>
  term <code>"A:B"</code> and hence automatically includes all low-order terms.</p>  
<p>Note that these can be used to supply the <code>expected</code> argument for
  the default <code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code> function, when the data is supplied
  as a contingency table.</p>  
<p>The table below shows some typical results in terms of the standard shorthand
  notation for loglinear models, with factors A, B, C, ..., where brackets
  are used to delimit the high-order terms in the loglinear model.</p>
<p></p><table class="table table"><tr><td><strong>function</strong></td><td><strong>3-way</strong></td><td><strong>4-way</strong></td><td><strong>5-way</strong></td></tr><tr><td><code>mutual</code></td><td>[A]  [B]  [C]</td><td>[A]  [B]  [C]  [D]</td><td>[A]  [B]  [C]  [D]  [E]</td></tr><tr><td><code>joint</code></td><td>[AB]  [C]</td><td>[ABC]  [D]</td><td>[ABCE]  [E]</td></tr><tr><td><code>joint (with=1)</code></td><td>[A]  [BC]</td><td>[A]  [BCD]</td><td>[A]  [BCDE]</td></tr><tr><td><code>conditional</code></td><td>[AC]  [BC]</td><td>[AD]  [BD]  [CD]</td><td>[AE]  [BE]  [CE]  [DE]</td></tr><tr><td><code>condit (with=1)</code></td><td>[AB]  [AC]</td><td>[AB]  [AC]  [AD]</td><td>[AB]  [AC]  [AD]  [AE]</td></tr><tr><td><code>markov (order=1)</code></td><td>[AB]  [BC]</td><td>[AB]  [BC]  [CD]</td><td>[AB]  [BC]  [CD]  [DE]</td></tr><tr><td><code>markov (order=2)</code></td><td>[A]  [B]  [C]</td><td>[ABC]  [BCD]</td><td>[ABC]  [BCD]  [CDE]</td></tr><tr><td><code>saturated</code></td><td>[ABC]</td><td>[ABCD]</td><td>[ABCDE]</td></tr></table><p><code>loglin2formula</code> converts the output of one of these to a model formula
  suitable as the <code>formula</code> for of <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></code>.</p>  
<p><code>loglin2string</code> converts the output of one of these to a string
  describing the loglinear model in the shorthand bracket notation,
  e.g., <code>"[A,B] [A,C]"</code>.</p>  
  

    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For the main model specification functions, <code>conditional</code>, <code>joint</code>,</p>
<p></p>
<p><code>markov</code>, ..., the result is
   a list of vectors (terms), where the elements in each vector are the
   names of the factors. The elements of the list are given names</p>
<p></p>
<p><code>term1, term2, ...</code>.</p>


    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>These functions were inspired by the original SAS implementation of
mosaic displays, described in the <em>User's Guide</em>,
<a href="http://www.datavis.ca/mosaics/mosaics.pdf" class="external-link">http://www.datavis.ca/mosaics/mosaics.pdf</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/loglin.html" class="external-link">loglin</a></code>,
<code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">joint</span><span class="op">(</span><span class="fl">3</span>, table<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Hair" "Eye" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Sex"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># as a formula or string</span></span></span>
<span class="r-in"><span><span class="fu">loglin2formula</span><span class="op">(</span><span class="fu">joint</span><span class="op">(</span><span class="fl">3</span>, table<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~Hair:Eye + Sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x0000029f3bb6a1f0&gt;</span>
<span class="r-in"><span><span class="fu">loglin2string</span><span class="op">(</span><span class="fu">joint</span><span class="op">(</span><span class="fl">3</span>, table<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "[Hair,Eye] [Sex]"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">joint</span><span class="op">(</span><span class="fl">2</span>, <span class="va">HairEyeColor</span><span class="op">)</span>  <span class="co"># marginal model for [Hair] [Eye]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Hair"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Eye"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># other possibilities</span></span></span>
<span class="r-in"><span><span class="fu">joint</span><span class="op">(</span><span class="fl">4</span>, factors<span class="op">=</span><span class="va">letters</span>, with<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "b" "c" "d"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "a"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">joint</span><span class="op">(</span><span class="fl">5</span>, factors<span class="op">=</span><span class="va">LETTERS</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A" "B" "C" "D"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "E"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">joint</span><span class="op">(</span><span class="fl">5</span>, factors<span class="op">=</span><span class="va">LETTERS</span>, with<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A" "B" "C"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "D" "E"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">conditional</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">conditional</span><span class="op">(</span><span class="fl">4</span>, with<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 3 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 3 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use in mosaic displays or other strucplots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">HairEyeColor</span>, expected<span class="op">=</span><span class="fu">joint</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="loglin-utilities-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">HairEyeColor</span>, expected<span class="op">=</span><span class="fu">conditional</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="loglin-utilities-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use with MASS::loglm</span></span></span>
<span class="r-in"><span><span class="va">cond3</span> <span class="op">&lt;-</span> <span class="fu">loglin2formula</span><span class="op">(</span><span class="fu">conditional</span><span class="op">(</span><span class="fl">3</span>, table<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cond3</span> <span class="op">&lt;-</span> <span class="fu">loglin2formula</span><span class="op">(</span><span class="fu">conditional</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>  <span class="co"># same, with factors 1,2,3</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></span><span class="op">(</span><span class="va">cond3</span>, data<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> loglm(formula = cond3, data = HairEyeColor)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       X^2 df P(&gt; X^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood Ratio 156.6779 18        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pearson          147.9440 18        0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">saturated</span><span class="op">(</span><span class="fl">3</span>, <span class="va">HairEyeColor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $term1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Hair" "Eye"  "Sex" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">loglin2formula</span><span class="op">(</span><span class="fu">saturated</span><span class="op">(</span><span class="fl">3</span>, <span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~Hair:Eye:Sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x0000029f3bb6a1f0&gt;</span>
<span class="r-in"><span><span class="fu">loglin2string</span><span class="op">(</span><span class="fu">saturated</span><span class="op">(</span><span class="fl">3</span>, <span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "[Hair,Eye,Sex]"</span>
<span class="r-in"><span><span class="fu">loglin2string</span><span class="op">(</span><span class="fu">saturated</span><span class="op">(</span><span class="fl">3</span>, <span class="va">HairEyeColor</span><span class="op">)</span>, brackets<span class="op">=</span><span class="st">'{}'</span>, sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "{Hair, Eye, Sex}"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

