<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>3D Mosaic Plots — mosaic3d • vcdExtra</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3D Mosaic Plots — mosaic3d"><meta name="description" content="Produces a 3D mosaic plot for a contingency table (or a
link[MASS]{loglm} model) using the rgl-package."><meta property="og:description" content="Produces a 3D mosaic plot for a contingency table (or a
link[MASS]{loglm} model) using the rgl-package."><meta property="og:image" content="https://friendly.github.io/vcdExtra/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="../articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="../articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="../articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="../articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="../articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="../articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tidyCats.html">tidyCat: Tidy Methods For Categorical Data Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>3D Mosaic Plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/vcdExtra/blob/master/R/mosaic3d.R" class="external-link"><code>R/mosaic3d.R</code></a></small>
      <div class="d-none name"><code>mosaic3d.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produces a 3D mosaic plot for a contingency table (or a
<code>link[MASS]{loglm}</code> model) using the <code><a href="https://dmurdoch.github.io/rgl/dev/reference/rgl-package.html" class="external-link">rgl-package</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'loglm'</span></span>
<span><span class="fu">mosaic3d</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"expected"</span><span class="op">)</span>,</span>
<span>  residuals_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"deviance"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">mosaic3d</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  expected <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"expected"</span><span class="op">)</span>,</span>
<span>  residuals_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shape <span class="op">=</span> <span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/cube3d.html" class="external-link">cube3d</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  spacing <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  split_dir <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  shading <span class="op">=</span> <span class="va">shading_basic</span>,</span>
<span>  interpolate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  zero_size <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">label_edge</span>,</span>
<span>  labeling_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  newpage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  box <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>link[MASS]{loglm}</code> model object. Alternatively, a multidimensional <code>array</code> or <code>table</code>
or<code><a href="https://rdrr.io/pkg/vcd/man/structable.html" class="external-link">structable</a></code> of frequencies in a contingency table.  In the present implementation, the dimensions
are taken in sequential order. Use <code>link[base]{aperm}</code> or <code><a href="https://rdrr.io/pkg/vcd/man/structable.html" class="external-link">structable</a></code> to change this.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed down to <code>mosaic.default</code> or 3D functions.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>a character string indicating whether the <code>"observed"</code> or the <code>"expected"</code> frequencies in the table should be
visualized by the volume of the 3D tiles.</p></dd>


<dt id="arg-residuals-type">residuals_type<a class="anchor" aria-label="anchor" href="#arg-residuals-type"></a></dt>
<dd><p>a character string indicating the type of residuals to be computed when none are supplied.  If residuals is <code>NULL</code>,
<code>residuals_type</code> must be one of <code>"pearson"</code> (default; giving components of Pearson's chi-squared), <code>"deviance"</code>
(giving components of the likelihood ratio chi-squared), or <code>"FT"</code> for the Freeman-Tukey residuals.  The value of this
argument can be abbreviated.</p></dd>


<dt id="arg-expected">expected<a class="anchor" aria-label="anchor" href="#arg-expected"></a></dt>
<dd><p>optionally, for contingency tables, an array of expected frequencies of the same dimension as <code>x</code>, or alternatively the
corresponding loglinear model specification as used by<code>link[stats]{loglin}</code> or <code>link[MASS]{loglm}</code> (see
<code><a href="https://rdrr.io/pkg/vcd/man/structable.html" class="external-link">structable</a></code> for details).</p></dd>


<dt id="arg-residuals">residuals<a class="anchor" aria-label="anchor" href="#arg-residuals"></a></dt>
<dd><p>optionally, an array of residuals of the same dimension as <code>x</code> (see details).</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>The initial 3D shape on which the mosaic is based.  Typically this is a call to an rgl function, and must produce a <code>shape3d</code> object.
The default is a "unit cube" on (-1, +1), with transparency specified by <code>alpha</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Specifies the transparency of the 3D tiles used to compose the 3D mosaic.</p></dd>


<dt id="arg-spacing">spacing<a class="anchor" aria-label="anchor" href="#arg-spacing"></a></dt>
<dd><p>A number or vector giving the total amount of space used to separate the 3D tiles along each of the
dimensions of the table. The values specified are re-cycled to the number of table dimensions.</p></dd>


<dt id="arg-split-dir">split_dir<a class="anchor" aria-label="anchor" href="#arg-split-dir"></a></dt>
<dd><p>A numeric vector composed of the integers <code>1:3</code> or a character vector composed of <code>c("x", "y", "z")</code>, where
<code>split_dir[i]</code> specifies the axis along which the tiles should be split
for dimension <code>i</code> of the table. The values specified are re-cycled to the number of table dimensions.</p></dd>


<dt id="arg-shading">shading<a class="anchor" aria-label="anchor" href="#arg-shading"></a></dt>
<dd><p>A function, taking an array or vector of residuals for the
given model, returning a vector of colors.  At present, only the default <code>shading=shading_basic</code> is provided.
This is roughly equivalent to the
use of the <code>shade</code> argument in <code><a href="https://rdrr.io/r/graphics/mosaicplot.html" class="external-link">mosaicplot</a></code> or to
the use of <code>gp=shading_Friendly</code> in <code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code>.</p></dd>


<dt id="arg-interpolate">interpolate<a class="anchor" aria-label="anchor" href="#arg-interpolate"></a></dt>
<dd><p>a vector of interpolation values for the <code>shading</code> function.</p></dd>


<dt id="arg-zero-size">zero_size<a class="anchor" aria-label="anchor" href="#arg-zero-size"></a></dt>
<dd><p>The radius of a small sphere used to mark zero cells in the display.</p></dd>


<dt id="arg-label-edge">label_edge<a class="anchor" aria-label="anchor" href="#arg-label-edge"></a></dt>
<dd><p>A character vector composed of <code>c("-", "+")</code> indicating whether the labels for a given table dimension
are to be written at the minima (<code>"-"</code>) or maxima (<code>"+"</code>) of the <em>other</em>
dimensions in the plot. The default is <code>rep( c('-', '+'), each=3, length=ndim)</code>, meaning that the first three
table variables are labeled at the minima, and successive ones at the maxima.</p></dd>


<dt id="arg-labeling-args">labeling_args<a class="anchor" aria-label="anchor" href="#arg-labeling-args"></a></dt>
<dd><p>This argument is intended to be used to specify details of the rendering of labels for the table dimensions, but
at present has no effect.</p></dd>


<dt id="arg-newpage">newpage<a class="anchor" aria-label="anchor" href="#arg-newpage"></a></dt>
<dd><p>logical indicating whether a new page should be created for the plot or not.</p></dd>


<dt id="arg-box">box<a class="anchor" aria-label="anchor" href="#arg-box"></a></dt>
<dd><p>logical indicating whether a bounding box should be drawn around the plot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly, the list of <code>shape3d</code> objects used to draw the 3D
mosaic, with names corresponding to the concatenation of the level labels,
separated by ":".</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Generalizing the 2D mosaic plot, this begins with a given 3D shape (a unit
cube), and successively sub-divides it along the X, Y, Z dimensions
according to the table margins, generating a nested set of 3D tiles. The
volume of the resulting tiles is therefore proportional to the frequency
represented in the table cells. Residuals from a given loglinear model are
then used to color or shade each of the tiles.</p>
<p>This is a developing implementation.  The arguments and details are subject
to change.</p>
<p>Friendly (1995), Friendly (2000, Sect. 4.5) and Theus and Lauer (1999) have
all used the idea of 3D mosaic displays to explain various aspects of
loglinear models (the iterative proportional fitting algorithm, the
structure of various models for 3-way and n-way tables, etc.), but no
implementation of 3D mosaics was previously available.</p>
<p>For the default method, residuals, used to color and shade the 3D tiles, can
be passed explicitly, or, more typically, are computed as needed from
observed and expected frequencies. In this case, the expected frequencies
are optionally computed for a specified loglinear model given by the
<code>expected</code> argument. For the loglm method, residuals and observed
frequencies are calculated from the model object.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Friendly, M. (1995). Conceptual and Visual Models for
Categorical Data, <em>The American Statistician</em>, <strong>49</strong>, 153-160.</p>
<p>Friendly, M. <em>Visualizing Categorical Data</em>, Cary NC: SAS Institute,
2000. Web materials: <a href="http://www.datavis.ca/books/vcd/" class="external-link">http://www.datavis.ca/books/vcd/</a>.</p>
<p>Theus, M. &amp; Lauer, S. R. W. (1999) Visualizing Loglinear Models.
<em>Journal of Computational and Graphical Statistics</em>, <strong>8</strong>, 396-412.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/vcd/man/strucplot.html" class="external-link">strucplot</a></code>, <code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code>,
<code><a href="https://rdrr.io/r/graphics/mosaicplot.html" class="external-link">mosaicplot</a></code> for aspects of mosaic plots.</p>
<p><code><a href="https://rdrr.io/r/stats/loglin.html" class="external-link">loglin</a></code>, <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></code> for details on
fitting loglinear models</p>
<p><code><a href="https://dmurdoch.github.io/rgl/dev/reference/play3d.html" class="external-link">play3d</a></code>, <code><a href="https://dmurdoch.github.io/rgl/dev/reference/play3d.html" class="external-link">movie3d</a></code> for what you can do with a 3D mosaic plot</p>
<p>Other mosaic plots:
<code><a href="mosaic.glm.html">mosaic.glm()</a></code>,
<code><a href="mosaic.glmlist.html">mosaic.glmlist()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly, with the help of Duncan Murdoch and Achim Zeileis</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2 x 2 x 2</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/rgl.useNULL.html" class="external-link">rgl.useNULL</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Bartlett</span>, box<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># compare with expected frequencies under model of mutual independence</span></span></span>
<span class="r-in"><span><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Bartlett</span>, type<span class="op">=</span><span class="st">"expected"</span>, box<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2 x 2 x 3</span></span></span>
<span class="r-in"><span><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Heart</span>, box<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make a dynamic display</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Heart</span>, box<span class="op">=</span><span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, interpolate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">play3d</span><span class="op">(</span><span class="fu">spin3d</span><span class="op">(</span>axis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, rpm <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, duration <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># 2 x 2 x 2 x 3</span></span></span>
<span class="r-in"><span><span class="co"># illustrates a 4D table</span></span></span>
<span class="r-in"><span><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Detergent</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare 2D and 3D mosaics</span></span></span>
<span class="r-in"><span><span class="co">#demo("mosaic-hec")</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

