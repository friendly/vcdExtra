<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Produces a 3D mosaic plot for a contingency table (or a link[MASS]{loglm} model)
 using the rgl-package. 
Generalizing the 2D mosaic plot, this begins
with a given 3D shape
(a unit cube), and successively sub-divides it along the X, Y, Z dimensions
according to the table margins, generating a nested set of 3D tiles.
The volume of the resulting tiles 
is therefore proportional to the frequency represented in the
table cells.
Residuals from a given loglinear model are then used to color or shade each of the tiles.

This is a developing implementation.  The arguments and details are subject to change."><title>3D Mosaic Plots — mosaic3d • vcdExtra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3D Mosaic Plots — mosaic3d"><meta property="og:description" content="Produces a 3D mosaic plot for a contingency table (or a link[MASS]{loglm} model)
 using the rgl-package. 
Generalizing the 2D mosaic plot, this begins
with a given 3D shape
(a unit cube), and successively sub-divides it along the X, Y, Z dimensions
according to the table margins, generating a nested set of 3D tiles.
The volume of the resulting tiles 
is therefore proportional to the frequency represented in the
table cells.
Residuals from a given loglinear model are then used to color or shade each of the tiles.

This is a developing implementation.  The arguments and details are subject to change."><meta property="og:image" content="http://friendly.github.io/vcdExtra/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A_creating.html">Creating and manipulating frequency tables</a>
    <a class="dropdown-item" href="../articles/B_tests.html">Tests of Independence</a>
    <a class="dropdown-item" href="../articles/C_loglinear.html">Loglinear Models</a>
    <a class="dropdown-item" href="../articles/D_mosaics.html">Mosaic plots</a>
    <a class="dropdown-item" href="../articles/E_continuous.html">Continuous predictors</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>3D Mosaic Plots</h1>
      
      <div class="d-none name"><code>mosaic3d.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produces a 3D mosaic plot for a contingency table (or a <code>link[MASS]{loglm}</code> model)
 using the <code><a href="https://dmurdoch.github.io/rgl/dev/reference/rgl-package.html" class="external-link">rgl-package</a></code>.</p> 
<p>Generalizing the 2D mosaic plot, this begins
with a given 3D shape
(a unit cube), and successively sub-divides it along the X, Y, Z dimensions
according to the table margins, generating a nested set of 3D tiles.
The volume of the resulting tiles 
is therefore proportional to the frequency represented in the
table cells.
Residuals from a given loglinear model are then used to color or shade each of the tiles.</p>

<p>This is a developing implementation.  The arguments and details are subject to change.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for loglm</span>
<span class="fu">mosaic3d</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"expected"</span><span class="op">)</span>, 
    residuals_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"deviance"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">mosaic3d</span><span class="op">(</span><span class="va">x</span>, expected <span class="op">=</span> <span class="cn">NULL</span>, residuals <span class="op">=</span> <span class="cn">NULL</span>,  
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"expected"</span><span class="op">)</span>, residuals_type <span class="op">=</span> <span class="cn">NULL</span>, 
  shape <span class="op">=</span> <span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/cube3d.html" class="external-link">cube3d</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, 
  spacing <span class="op">=</span> <span class="fl">0.1</span>, split_dir <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, shading <span class="op">=</span> <span class="va">shading_basic</span>, interpolate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, 
  zero_size<span class="op">=</span><span class="fl">.05</span>,
  <span class="va">label_edge</span>,
  labeling_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, newpage <span class="op">=</span> <span class="cn">TRUE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A <code>link[MASS]{loglm}</code> model object. Alternatively,
a multidimensional <code>array</code> or <code>table</code> or <code><a href="https://rdrr.io/pkg/vcd/man/structable.html" class="external-link">structable</a></code> 
of frequencies in a contingency table. 
In the present implementation, the dimensions are taken in sequential order.
Use <code>link[base]{aperm}</code> or <code><a href="https://rdrr.io/pkg/vcd/man/structable.html" class="external-link">structable</a></code> to change this.</p></dd>
<dt>expected</dt>
<dd><p>optionally, for contingency tables,
an array of expected frequencies of the same dimension as <code>x</code>, or alternatively 
the corresponding loglinear model specification as used by <code>link[stats]{loglin}</code>
or <code>link[MASS]{loglm}</code> (see <code><a href="https://rdrr.io/pkg/vcd/man/structable.html" class="external-link">structable</a></code> for details).</p></dd>
<dt>residuals</dt>
<dd><p>optionally, an array of residuals of the same dimension as <code>x</code> (see details).</p></dd>
<dt>type</dt>
<dd><p>a character string indicating whether the <code>"observed"</code> or the <code>"expected"</code> 
frequencies in the table should be visualized by the volume of the 3D tiles.</p></dd>
<dt>residuals_type</dt>
<dd><p>a character string indicating the type of residuals to be computed when none are
supplied.  If  residuals  is  <code>NULL</code>,  <code>residuals_type</code>  must  be  one  of 
<code>"pearson"</code> (default;  giving  components  of  Pearson's  chi-squared),  
<code>"deviance"</code>  (giving components of the likelihood ratio  chi-squared), 
or <code>"FT"</code> for the  Freeman-Tukey residuals.  
The value  of this  argument can  be abbreviated.</p></dd>
<dt>shape</dt>
<dd><p>The initial 3D shape on which the mosaic is based.  Typically this is a
call to an rgl function, and must produce a <code>shape3d</code> object.
The default is a "unit cube" on (-1, +1), with transparency specified by
<code>alpha</code>.</p></dd>
<dt>alpha</dt>
<dd><p>Specifies the transparency of the 3D tiles used to compose the 3D mosaic.</p></dd>
<dt>spacing</dt>
<dd><p>A number or vector giving the total amount of space used to separate the
3D tiles along each of the dimensions of the table. The values specified
are re-cycled to the number of table dimensions.</p></dd>
<dt>split_dir</dt>
<dd><p>A numeric vector composed of the integers <code>1:3</code> or a character vector
composed of <code>c("x", "y", "z")</code>, where <code>split_dir[i]</code> specifies the
axis along which the tiles should be split for dimension <code>i</code> of the
table. The values specified are re-cycled to the number of table dimensions.</p></dd>
<dt>shading</dt>
<dd><p>A function, taking an array or vector of residuals for the given model,
returning a vector of colors.  At present, only the default
<code>shading=shading_basic</code> is provided.  This is roughly equivalent
to the use of the <code>shade</code> argument in <code><a href="https://rdrr.io/r/graphics/mosaicplot.html" class="external-link">mosaicplot</a></code>
or to the use of <code>gp=shading_Friendly</code> in <code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code>.</p></dd>
<dt>interpolate</dt>
<dd><p>a vector of interpolation values for the <code>shading</code>
  function.</p></dd>
<dt>zero_size</dt>
<dd><p>The radius of a small sphere used to mark zero cells in the display.</p></dd>
<dt>label_edge</dt>
<dd><p>A character vector composed of <code>c("-", "+")</code> indicating whether the
labels for a given table dimension are to be written at the minima (<code>"-"</code>)
or maxima (<code>"+"</code>) of the <em>other</em> dimensions in the plot.
The default is <code>rep( c('-', '+'), each=3, length=ndim)</code>, meaning
that the first three table variables are labeled at the minima,
and successive ones at the maxima.</p></dd>
<dt>labeling_args</dt>
<dd><p>This argument is intended to be used to specify details of the rendering
of labels for the table dimensions, but at present has no effect.</p></dd>
<dt>newpage</dt>
<dd><p>logical indicating whether a new page should be created for the plot or not.</p></dd>
<dt>box</dt>
<dd><p>logical indicating whether a bounding box should be drawn around the plot.</p></dd>
<dt>...</dt>
<dd><p>Other arguments passed down to <code>mosaic.default</code> or  3D functions.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Friendly (1995), Friendly [Sect. 4.5](2000) and Theus and Lauer (1999)
have all used the idea of 3D mosaic displays to explain various aspects
of loglinear models (the iterative proportional fitting algorithm,
the structure of various models for 3-way and n-way tables, etc.),
but no implementation of 3D mosaics was previously available.</p>
<p>For the default method,
residuals, used to color and shade the 3D tiles, can be passed explicitly,
or, more typically,
are computed as  needed from observed and expected  frequencies.
In this case, the  expected  frequencies  are  optionally  computed  for  a   specified
loglinear model given by the <code>expected</code> argument.
For the loglm method, residuals and observed frequencies are calculated from the model
object.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly, the list of <code>shape3d</code> objects used to draw the 3D mosaic,
with names corresponding to the concatenation of the level labels, separated
by ":".</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Friendly, M. (1995).
Conceptual and Visual Models for Categorical Data, 
<em>The American Statistician</em>, <b>49</b>, 153-160.</p>
<p>Friendly, M. <em>Visualizing Categorical Data</em>, Cary NC: SAS Institute, 2000.
Web materials: <a href="http://www.datavis.ca/books/vcd/" class="external-link">http://www.datavis.ca/books/vcd/</a>.</p>
<p>Theus, M. &amp; Lauer, S. R. W. (1999)
Visualizing Loglinear Models. 
<em>Journal of Computational and Graphical Statistics</em>, <b>8</b>, 396-412.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly, with the help of Duncan Murdoch and Achim Zeileis</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/vcd/man/strucplot.html" class="external-link">strucplot</a></code>,
<code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code>, 
<code><a href="https://rdrr.io/r/graphics/mosaicplot.html" class="external-link">mosaicplot</a></code></p>
<p><code><a href="https://rdrr.io/r/stats/loglin.html" class="external-link">loglin</a></code>,
<code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></code> for details on fitting loglinear models</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># 2 x 2 x 2</span></span>
<span class="r-in"><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"rgl"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in"><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Bartlett</span>, box<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># compare with expected frequencies under model of mutual independence</span></span>
<span class="r-in"><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Bartlett</span>, type<span class="op">=</span><span class="st">"expected"</span>, box<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in"><span class="co"># 2 x 2 x 3</span></span>
<span class="r-in"><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Heart</span>, box<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: rgl</span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># 2 x 2 x 2 x 3</span></span>
<span class="r-in"><span class="co"># illustrates a 4D table</span></span>
<span class="r-in"><span class="fu">mosaic3d</span><span class="op">(</span><span class="va">Detergent</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compare 2D and 3D mosaics</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span><span class="st">"mosaic-hec"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

