<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm • vcdExtra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mosaic plots for fitted generalized linear and generalized nonlinear models — mosaic.glm"><meta name="description" content="Produces mosaic plots (and other plots in the strucplot framework)
for a log-linear model fitted with glm
or for a generalized nonlinear model fitted with gnm.
These methods extend the range of strucplot
visualizations well beyond the models that can
be fit with loglm.
They are intended for models for counts using the Poisson family (or quasi-poisson),
but should be sensible as long as (a) the response variable is non-negative and (b) the
predictors visualized in the strucplot are discrete factors."><meta property="og:description" content="Produces mosaic plots (and other plots in the strucplot framework)
for a log-linear model fitted with glm
or for a generalized nonlinear model fitted with gnm.
These methods extend the range of strucplot
visualizations well beyond the models that can
be fit with loglm.
They are intended for models for counts using the Poisson family (or quasi-poisson),
but should be sensible as long as (a) the response variable is non-negative and (b) the
predictors visualized in the strucplot are discrete factors."><meta property="og:image" content="http://friendly.github.io/vcdExtra/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="../articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="../articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="../articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="../articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="../articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="../articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Mosaic plots for fitted generalized linear and generalized nonlinear models</h1>

      <div class="d-none name"><code>mosaic.glm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produces mosaic plots (and other plots in the <code><a href="https://rdrr.io/pkg/vcd/man/strucplot.html" class="external-link">strucplot</a></code> framework)
for a log-linear model fitted with <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>
or for a generalized nonlinear model fitted with <code><a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link">gnm</a></code>.</p>
<p>These methods extend the range of strucplot
visualizations well beyond the models that can
be fit with <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></code>.
They are intended for models for counts using the Poisson family (or quasi-poisson),
but should be sensible as long as (a) the response variable is non-negative and (b) the
predictors visualized in the <code>strucplot</code> are discrete factors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'glm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">x</span>, formula <span class="op">=</span> <span class="cn">NULL</span>, panel <span class="op">=</span> <span class="va">mosaic</span>, </span>
<span>     type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"expected"</span><span class="op">)</span>, </span>
<span>     residuals <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>     residuals_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"deviance"</span>, <span class="st">"rstandard"</span><span class="op">)</span>, </span>
<span>     gp <span class="op">=</span> <span class="va">shading_hcl</span>, gp_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'glm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/sieve.html" class="external-link">sieve</a></span><span class="op">(</span><span class="va">x</span>,  <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'glm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/assoc.html" class="external-link">assoc</a></span><span class="op">(</span><span class="va">x</span>,  <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>glm</code> or <code>gnm</code> object. The response variable, typically a
    cell frequency, should be non-negative.</p></dd>

  <dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A one-sided formula with the indexing factors of the plot
    separated by '+', determining the order in which the variables are used in the mosaic.
    A formula must be provided unless <code>x$data</code>
    inherits from class <code>"table"</code> – in which case the indexing
    factors of this table are used, or the factors in <code>x$data</code>
    (or model.frame(x) if <code>x$data</code> is an environment) exactly
    cross-classify the data – in which case this set of
    cross-classifying factors are used.</p></dd>

   <dt id="arg-panel">panel<a class="anchor" aria-label="anchor" href="#arg-panel"></a></dt>
<dd><p>Panel function used to draw the plot for visualizing the observed values, residuals
   and expected values. Currently, one of <code>"mosaic"</code>, <code>"assoc"</code>, or <code>"sieve"</code>
   in <code>vcd</code>.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character string indicating whether the
  <code>"observed"</code> or the <code>"expected"</code> values of the table should be visualized
  by the area of the tiles or bars.</p></dd>

  <dt id="arg-residuals">residuals<a class="anchor" aria-label="anchor" href="#arg-residuals"></a></dt>
<dd><p>An optional array or vector of residuals corresponding to the cells in the
  data, for example, as calculated by <code>residuals.glm(x)</code>, <code>residuals.gnm(x)</code>.</p></dd>

  <dt id="arg-residuals-type">residuals_type<a class="anchor" aria-label="anchor" href="#arg-residuals-type"></a></dt>
<dd><p>If the <code>residuals</code> argument is <code>NULL</code>, residuals are calculated internally
  and used in the display.  In this case, <code>residual_type</code> can be <code>"pearson"</code>,
  <code>"deviance"</code> or <code>"rstandard"</code>.  Otherwise (when <code>residuals</code> is supplied),
  <code>residuals_type</code> is used as a label for the legend in the
  plot.</p></dd>

  <dt id="arg-gp">gp<a class="anchor" aria-label="anchor" href="#arg-gp"></a></dt>
<dd><p>Object of class <code>"gpar"</code>, shading function or a corresponding generating function
  (see <code><a href="https://rdrr.io/pkg/vcd/man/strucplot.html" class="external-link">strucplot</a></code> Details and <code><a href="https://rdrr.io/pkg/vcd/man/shadings.html" class="external-link">shadings</a></code>).
  Ignored if shade = FALSE.</p></dd>

  <dt id="arg-gp-args">gp_args<a class="anchor" aria-label="anchor" href="#arg-gp-args"></a></dt>
<dd><p>A list of arguments for the shading-generating function, if specified.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to the <code>panel</code> function e.g., <code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For both poisson family generalized linear models and loglinear models, standardized residuals
provided by <code>rstandard</code>
(sometimes called adjusted residuals) are often preferred because they have
constant unit asymptotic variance.</p>
<p>The <code>sieve</code> and <code>assoc</code> methods are simple convenience interfaces to this plot method, setting the panel argument accordingly.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>structable</code> visualized by <code><a href="https://rdrr.io/pkg/vcd/man/strucplot.html" class="external-link">strucplot</a></code> is returned invisibly.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Heather Turner, Michael Friendly, with help from Achim Zeileis</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, <code><a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link">gnm</a></code>, <code><a href="https://rdrr.io/pkg/vcd/man/plot.loglm.html" class="external-link">plot.loglm</a></code>, <code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">GSStab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">party</span>, data<span class="op">=</span><span class="va">GSS</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># using the data in table form</span></span></span>
<span class="r-in"><span><span class="va">mod.glm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">party</span>, family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">GSStab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mod.glm1</span><span class="op">)</span>    </span></span>
<span class="r-in"><span><span class="va">std</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstandard</a></span><span class="op">(</span><span class="va">mod.glm1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For mosaic.default(), need to re-shape residuals to conform to data</span></span></span>
<span class="r-in"><span><span class="va">stdtab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="va">std</span>, </span></span>
<span class="r-in"><span>                dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">GSStab</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">GSStab</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">GSStab</span>, </span></span>
<span class="r-in"><span>       gp<span class="op">=</span><span class="va">shading_Friendly</span>, </span></span>
<span class="r-in"><span>       residuals<span class="op">=</span><span class="va">stdtab</span>, </span></span>
<span class="r-in"><span>       residuals_type<span class="op">=</span><span class="st">"Std\nresiduals"</span>, </span></span>
<span class="r-in"><span>       labeling <span class="op">=</span> <span class="va">labeling_residuals</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mosaic.glm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using externally calculated residuals with the glm() object</span></span></span>
<span class="r-in"><span><span class="fu">mosaic.glm</span><span class="op">(</span><span class="va">mod.glm1</span>, </span></span>
<span class="r-in"><span>           residuals<span class="op">=</span><span class="va">std</span>, </span></span>
<span class="r-in"><span>           labeling <span class="op">=</span> <span class="va">labeling_residuals</span>, </span></span>
<span class="r-in"><span>           shade<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mosaic.glm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using residuals_type</span></span></span>
<span class="r-in"><span><span class="fu">mosaic.glm</span><span class="op">(</span><span class="va">mod.glm1</span>, </span></span>
<span class="r-in"><span>           residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span></span>
<span class="r-in"><span>           labeling <span class="op">=</span> <span class="va">labeling_residuals</span>, shade<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mosaic.glm-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Ordinal factors and structured associations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span><span class="op">+</span><span class="va">ses</span>, data<span class="op">=</span><span class="va">Mental</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mental       1   2   3   4   5   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Well      64  57  57  72  36  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mild      94  94 105 141  97  71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Moderate  58  54  65  77  54  54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Impaired  46  40  60  94  78  71</span>
<span class="r-in"><span><span class="va">long.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>set_varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mental<span class="op">=</span><span class="st">"Mental Health Status"</span>, </span></span>
<span class="r-in"><span>                                     ses<span class="op">=</span><span class="st">"Parent SES"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit independence model</span></span></span>
<span class="r-in"><span><span class="co"># Residual deviance: 47.418 on 15 degrees of freedom</span></span></span>
<span class="r-in"><span><span class="va">indep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span><span class="op">+</span><span class="va">ses</span>,</span></span>
<span class="r-in"><span>             family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">long.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>set_varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mental<span class="op">=</span><span class="st">"Mental Health Status"</span>, </span></span>
<span class="r-in"><span>                                     ses<span class="op">=</span><span class="st">"Parent SES"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">indep</span>,</span></span>
<span class="r-in"><span>       residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span></span>
<span class="r-in"><span>       labeling_args <span class="op">=</span> <span class="va">long.labels</span>, </span></span>
<span class="r-in"><span>       labeling<span class="op">=</span><span class="va">labeling_residuals</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="mosaic.glm-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or, show as a sieve diagram</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">indep</span>, </span></span>
<span class="r-in"><span>       labeling_args <span class="op">=</span> <span class="va">long.labels</span>, </span></span>
<span class="r-in"><span>       panel<span class="op">=</span><span class="va">sieve</span>, </span></span>
<span class="r-in"><span>       gp<span class="op">=</span><span class="va">shading_Friendly</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="mosaic.glm-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit linear x linear (uniform) association.  Use integer scores for rows/cols </span></span></span>
<span class="r-in"><span><span class="va">Cscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Rscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">mental</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">linlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">Rscore</span><span class="op">:</span><span class="va">Cscore</span>,</span></span>
<span class="r-in"><span>                family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">linlin</span>,</span></span>
<span class="r-in"><span>       residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span></span>
<span class="r-in"><span>       labeling_args <span class="op">=</span> <span class="va">long.labels</span>, </span></span>
<span class="r-in"><span>       labeling<span class="op">=</span><span class="va">labeling_residuals</span>, </span></span>
<span class="r-in"><span>       suppress<span class="op">=</span><span class="fl">1</span>, </span></span>
<span class="r-in"><span>       gp<span class="op">=</span><span class="va">shading_Friendly</span>,</span></span>
<span class="r-in"><span>       main<span class="op">=</span><span class="st">"Lin x Lin model"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="mosaic.glm-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##  Goodman Row-Column association model fits even better (deviance 3.57, df 8)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hturner/gnm" class="external-link">gnm</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">Mental</span><span class="op">$</span><span class="va">mental</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/zC.html" class="external-link">C</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">mental</span>, <span class="va">treatment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Mental</span><span class="op">$</span><span class="va">ses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/zC.html" class="external-link">C</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">ses</span>, <span class="va">treatment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RC1model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link">gnm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">mental</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Mult.html" class="external-link">Mult</a></span><span class="op">(</span><span class="va">ses</span>, <span class="va">mental</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">RC1model</span>,</span></span>
<span class="r-in"><span>       residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span></span>
<span class="r-in"><span>       labeling_args <span class="op">=</span> <span class="va">long.labels</span>, </span></span>
<span class="r-in"><span>       labeling<span class="op">=</span><span class="va">labeling_residuals</span>, </span></span>
<span class="r-in"><span>       suppress<span class="op">=</span><span class="fl">1</span>, </span></span>
<span class="r-in"><span>       gp<span class="op">=</span><span class="va">shading_Friendly</span>,</span></span>
<span class="r-in"><span>       main<span class="op">=</span><span class="st">"RC1 model"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running start-up iterations..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running main iterations.....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="mosaic.glm-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co">############# UCB Admissions data, fit using glm()</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/structable.html" class="external-link">structable</a></span><span class="op">(</span><span class="va">Dept</span> <span class="op">~</span> <span class="va">Admit</span><span class="op">+</span><span class="va">Gender</span>,<span class="va">UCBAdmissions</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Dept   A   B   C   D   E   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Admit    Gender                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Admitted Male        512 353 120 138  53  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Female       89  17 202 131  94  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rejected Male        313 207 205 279 138 351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Female       19   8 391 244 299 317</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="va">berkeley</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">UCBAdmissions</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">berk.glm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Dept</span> <span class="op">*</span> <span class="op">(</span><span class="va">Gender</span><span class="op">+</span><span class="va">Admit</span><span class="op">)</span>, data<span class="op">=</span><span class="va">berkeley</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">berk.glm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ Dept * (Gender + Admit), family = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = berkeley)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          6.27557    0.04248 147.744  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB               -0.40575    0.06770  -5.993 2.06e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC               -1.53939    0.08305 -18.536  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD               -1.32234    0.08159 -16.207  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE               -2.40277    0.11014 -21.816  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF               -3.09624    0.15756 -19.652  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale        -2.03325    0.10233 -19.870  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AdmitRejected       -0.59346    0.06838  -8.679  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:GenderFemale  -1.07581    0.22860  -4.706 2.52e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:GenderFemale   2.63462    0.12343  21.345  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:GenderFemale   1.92709    0.12464  15.461  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:GenderFemale   2.75479    0.13510  20.391  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:GenderFemale   1.94356    0.12683  15.325  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:AdmitRejected  0.05059    0.10968   0.461    0.645    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:AdmitRejected  1.20915    0.09726  12.432  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:AdmitRejected  1.25833    0.10152  12.395  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:AdmitRejected  1.68296    0.11733  14.343  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:AdmitRejected  3.26911    0.16707  19.567  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 2650.095  on 23  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:   21.736  on  6  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 216.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">berk.glm1</span>, </span></span>
<span class="r-in"><span>       gp<span class="op">=</span><span class="va">shading_Friendly</span>, </span></span>
<span class="r-in"><span>       labeling<span class="op">=</span><span class="va">labeling_residuals</span>, </span></span>
<span class="r-in"><span>       formula<span class="op">=</span><span class="op">~</span><span class="va">Admit</span><span class="op">+</span><span class="va">Dept</span><span class="op">+</span><span class="va">Gender</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mosaic.glm-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the same, displaying studentized residuals; </span></span></span>
<span class="r-in"><span><span class="co"># note use of formula to reorder factors in the mosaic</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">berk.glm1</span>, </span></span>
<span class="r-in"><span>       residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span></span>
<span class="r-in"><span>       labeling<span class="op">=</span><span class="va">labeling_residuals</span>, </span></span>
<span class="r-in"><span>       shade<span class="op">=</span><span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>       formula<span class="op">=</span><span class="op">~</span><span class="va">Admit</span><span class="op">+</span><span class="va">Dept</span><span class="op">+</span><span class="va">Gender</span>, </span></span>
<span class="r-in"><span>       main<span class="op">=</span><span class="st">"Model: [DeptGender][DeptAdmit]"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mosaic.glm-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## all two-way model</span></span></span>
<span class="r-in"><span><span class="va">berk.glm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="op">(</span><span class="va">Dept</span> <span class="op">+</span> <span class="va">Gender</span> <span class="op">+</span> <span class="va">Admit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, data<span class="op">=</span><span class="va">berkeley</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">berk.glm2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ (Dept + Gender + Admit)^2, family = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = berkeley)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                 6.27150    0.04271 146.855  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB                      -0.40322    0.06784  -5.944 2.78e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC                      -1.57790    0.08949 -17.632  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD                      -1.35000    0.08526 -15.834  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE                      -2.44982    0.11755 -20.840  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF                      -3.13787    0.16174 -19.401  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale               -1.99859    0.10593 -18.866  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AdmitRejected              -0.58205    0.06899  -8.436  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:GenderFemale         -1.07482    0.22861  -4.701 2.58e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:GenderFemale          2.66513    0.12609  21.137  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:GenderFemale          1.95832    0.12734  15.379  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:GenderFemale          2.79519    0.13925  20.073  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:GenderFemale          2.00232    0.13571  14.754  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:AdmitRejected         0.04340    0.10984   0.395    0.693    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:AdmitRejected         1.26260    0.10663  11.841  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:AdmitRejected         1.29461    0.10582  12.234  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:AdmitRejected         1.73931    0.12611  13.792  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:AdmitRejected         3.30648    0.16998  19.452  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale:AdmitRejected -0.09987    0.08085  -1.235    0.217    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 2650.095  on 23  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:   20.204  on  5  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 217.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mosaic.glm</span><span class="op">(</span><span class="va">berk.glm2</span>, </span></span>
<span class="r-in"><span>       residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span></span>
<span class="r-in"><span>       labeling <span class="op">=</span> <span class="va">labeling_residuals</span>, </span></span>
<span class="r-in"><span>       shade<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>       formula<span class="op">=</span><span class="op">~</span><span class="va">Admit</span><span class="op">+</span><span class="va">Dept</span><span class="op">+</span><span class="va">Gender</span>, </span></span>
<span class="r-in"><span>       main<span class="op">=</span><span class="st">"Model: [DeptGender][DeptAdmit][AdmitGender]"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mosaic.glm-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">berk.glm1</span>, <span class="va">berk.glm2</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: Freq ~ Dept * (Gender + Admit)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: Freq ~ (Dept + Gender + Admit)^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         6     21.735                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         5     20.204  1   1.5312   0.2159</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add 1 df term for association of [GenderAdmit] only in Dept A</span></span></span>
<span class="r-in"><span><span class="va">berkeley</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">berkeley</span>, </span></span>
<span class="r-in"><span>                   <span class="va">dept1AG</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Dept</span><span class="op">==</span><span class="st">'A'</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">Gender</span><span class="op">==</span><span class="st">'Female'</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">Admit</span><span class="op">==</span><span class="st">'Admitted'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">berkeley</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Admit Gender Dept Freq dept1AG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Admitted   Male    A  512       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Rejected   Male    A  313       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Admitted Female    A   89       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Rejected Female    A   19       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Admitted   Male    B  353       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Rejected   Male    B  207       0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">berk.glm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Dept</span> <span class="op">*</span> <span class="op">(</span><span class="va">Gender</span><span class="op">+</span><span class="va">Admit</span><span class="op">)</span> <span class="op">+</span> <span class="va">dept1AG</span>, data<span class="op">=</span><span class="va">berkeley</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">berk.glm3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ Dept * (Gender + Admit) + dept1AG, family = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = berkeley)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          6.23832    0.04419 141.157  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB               -0.36850    0.06879  -5.357 8.47e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC               -1.50215    0.08394 -17.895  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD               -1.28509    0.08250 -15.577  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE               -2.36552    0.11081 -21.347  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF               -3.05899    0.15803 -19.357  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale        -2.80176    0.23628 -11.858  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AdmitRejected       -0.49212    0.07175  -6.859 6.94e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dept1AG              1.05208    0.26271   4.005 6.21e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:GenderFemale  -0.30730    0.31243  -0.984    0.325    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:GenderFemale   3.40313    0.24615  13.825  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:GenderFemale   2.69560    0.24676  10.924  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:GenderFemale   3.52330    0.25220  13.970  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:GenderFemale   2.71207    0.24787  10.941  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:AdmitRejected -0.05074    0.11181  -0.454    0.650    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:AdmitRejected  1.10781    0.09966  11.116  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:AdmitRejected  1.15699    0.10381  11.145  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:AdmitRejected  1.58162    0.11933  13.254  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:AdmitRejected  3.16777    0.16848  18.803  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 2650.0952  on 23  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:    2.6815  on  5  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 199.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mosaic.glm</span><span class="op">(</span><span class="va">berk.glm3</span>, </span></span>
<span class="r-in"><span>           residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span></span>
<span class="r-in"><span>           labeling <span class="op">=</span> <span class="va">labeling_residuals</span>, </span></span>
<span class="r-in"><span>           shade<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>           formula<span class="op">=</span><span class="op">~</span><span class="va">Admit</span><span class="op">+</span><span class="va">Dept</span><span class="op">+</span><span class="va">Gender</span>, </span></span>
<span class="r-in"><span>           main<span class="op">=</span><span class="st">"Model: [DeptGender][DeptAdmit] + DeptA*[GA]"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mosaic.glm-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare models</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">berk.glm1</span>, <span class="va">berk.glm3</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: Freq ~ Dept * (Gender + Admit)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: Freq ~ Dept * (Gender + Admit) + dept1AG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         6    21.7355                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         5     2.6815  1   19.054 1.271e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

