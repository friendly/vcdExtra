<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package • vcdExtra</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extensions and additions to vcd: Visualizing Categorical Data — vcdExtra-package"><meta name="description" content=""><meta property="og:description" content=""><meta property="og:image" content="https://friendly.github.io/vcdExtra/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="../articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="../articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="../articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="../articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="../articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="../articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tidyCats.html">tidyCat: Tidy Methods For Categorical Data Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extensions and additions to vcd: Visualizing Categorical Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/vcdExtra/blob/master/R/vcdExtra-package.R" class="external-link"><code>R/vcdExtra-package.R</code></a></small>
      <div class="d-none name"><code>vcdExtra-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p></p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This package provides additional data sets, documentation, and a few
functions designed to extend the <code>vcd</code> package for Visualizing
Categorical Data and the <code>gnm</code> package for Generalized Nonlinear
Models. In particular, vcdExtra extends mosaic, assoc and sieve plots from
vcd to handle glm() and gnm() models and adds a 3D version in
<code><a href="mosaic3d.html">mosaic3d</a></code>.</p>
<p>This package is also a support package for the book, <em>Discrete Data
Analysis with R</em> by Michael Friendly and David Meyer, Chapman &amp; Hall/CRC,
2016,
<a href="https://www.routledge.com/Discrete-Data-Analysis-with-R-Visualization-and-Modeling-Techniques-for-Categorical-and-Count-Data/Friendly-Meyer/p/book/9781498725835" class="external-link">https://www.routledge.com/Discrete-Data-Analysis-with-R-Visualization-and-Modeling-Techniques-for-Categorical-and-Count-Data/Friendly-Meyer/p/book/9781498725835</a>
with a number of additional data sets, and functions. The web site for the
book is <a href="http://ddar.datavis.ca" class="external-link">http://ddar.datavis.ca</a>.</p>
<p>In addition, I teach a course, <em>Psy 6136: Categorical Data Analysis</em>,
<a href="https://friendly.github.io/psy6136/" class="external-link">https://friendly.github.io/psy6136/</a> using this package.</p>
<p>The main purpose of this package is to serve as a sandbox for introducing
extensions of mosaic plots and related graphical methods that apply to
loglinear models fitted using <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> and related, generalized
nonlinear models fitted with <code><a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link">gnm()</a></code> in the
<code><a href="https://rdrr.io/pkg/gnm/man/gnm-package.html" class="external-link">gnm-package</a></code> package. A related purpose is to fill in some
holes in the analysis of categorical data in R, not provided in base R, the
<span class="pkg">vcd</span>, or other commonly used packages.</p>
<p>The method <code><a href="mosaic.glm.html">mosaic.glm</a></code> extends the
<code><a href="https://rdrr.io/pkg/vcd/man/plot.loglm.html" class="external-link">mosaic.loglm</a></code> method in the <span class="pkg">vcd</span> package to this
wider class of models.  This method also works for the generalized nonlinear
models fit with the <code><a href="https://rdrr.io/pkg/gnm/man/gnm-package.html" class="external-link">gnm-package</a></code> package, including models
for square tables and models with multiplicative associations.</p>
<p><code><a href="mosaic3d.html">mosaic3d</a></code> introduces a 3D generalization of mosaic displays
using the <span class="pkg">rgl</span> package.</p>
<p>In addition, there are several new data sets, a tutorial vignette,</p><dl><dt>vcd-tutorial</dt>
<dd><p>Working with categorical data with R and the
vcd package, <code>vignette("vcd-tutorial", package = "vcdExtra") </code></p></dd>

</dl><p>and a
few functions for manipulating categorical data sets and working with models
for categorical data.</p>
<p>A new class, <code><a href="glmlist.html">glmlist</a></code>, is introduced for working with
collections of <code>glm</code> objects, e.g., <code><a href="Kway.html">Kway</a></code> for fitting all
K-way models from a basic marginal model, and <code><a href="LRstats.html">LRstats</a></code> for
brief statistical summaries of goodness-of-fit for a collection of models.</p>
<p>For square tables with ordered factors, <code><a href="Crossings.html">Crossings</a></code> supplements
the specification of terms in model formulas using <code><a href="https://rdrr.io/pkg/gnm/man/Symm.html" class="external-link">Symm</a></code>,
<code><a href="https://rdrr.io/pkg/gnm/man/Diag.html" class="external-link">Diag</a></code>, <code><a href="https://rdrr.io/pkg/gnm/man/Topo.html" class="external-link">Topo</a></code>, etc. in the
<code><a href="https://rdrr.io/pkg/gnm/man/gnm-package.html" class="external-link">gnm-package</a></code>.</p>
<p>Some of these extensions may be migrated into <span class="pkg">vcd</span> or <span class="pkg">gnm</span>.</p>
<p>A collection of demos is included to illustrate fitting and visualizing a
wide variety of models:</p><dl><dt>mental-glm</dt>
<dd><p>Mental health data:
mosaics for glm() and gnm() models</p></dd>
 <dt>occStatus</dt>
<dd><p>Occupational status
data: Compare mosaic using expected= to mosaic.glm</p></dd>

<dt>ucb-glm</dt>
<dd><p>UCBAdmissions data: Conditional independence via loglm() and
glm()</p></dd>
 <dt>vision-quasi</dt>
<dd><p>VisualAcuity data: Quasi- and Symmetry models</p></dd>

<dt>yaish-unidiff</dt>
<dd><p>Yaish data: Unidiff model for 3-way table</p></dd>

<dt>Wong2-3</dt>
<dd><p>Political views and support for women to work (U, R, C, R+C
and RC(1) models)</p></dd>
 <dt>Wong3-1</dt>
<dd><p>Political views, support for women to work
and national welfare spending (3-way, marginal, and conditional independence
models)</p></dd>
 <dt>housing</dt>
<dd><p>Visualize glm(), multinom() and polr() models from
<code>example(housing, package="MASS")</code></p></dd>

</dl><p>Use <code> demo(package="vcdExtra")</code> for a complete current list.</p>
<p>The <span class="pkg">vcdExtra</span> package now contains a large number of data sets
illustrating various forms of categorical data analysis and related
visualizations, from simple to advanced. Use <code>data(package="vcdExtra")</code>
for a complete list, or <code>datasets(package="vcdExtra")</code> for an annotated
one showing the <code>class</code> and <code>dim</code> for each data set.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Friendly, M. <em>Visualizing Categorical Data</em>, Cary NC: SAS
Institute, 2000. Web materials: <a href="http://www.datavis.ca/books/vcd/" class="external-link">http://www.datavis.ca/books/vcd/</a>.</p>
<p>Friendly, M. and Meyer, D. (2016). <em>Discrete Data Analysis with R:
Visualization and Modeling Techniques for Categorical and Count Data</em>. Boca
Raton, FL: Chapman &amp; Hall/CRC. <a href="http://ddar.datavis.ca" class="external-link">http://ddar.datavis.ca</a>.</p>
<p>Meyer, D.; Zeileis, A. &amp; Hornik, K. The Strucplot Framework: Visualizing
Multi-way Contingency Tables with vcd <em>Journal of Statistical
Software</em>, 2006, <strong>17</strong>, 1-48. Available in R via
<code><a href="https://cran.rstudio.com/web/packages/vcd/vignettes/strucplot.pdf" class="external-link">vignette("strucplot", package = "vcd")</a></code></p>
<p>Turner, H. and Firth, D. <em>Generalized nonlinear models in R: An
overview of the gnm package</em>, 2007, <a href="http://eprints.ncrm.ac.uk/472/" class="external-link">http://eprints.ncrm.ac.uk/472/</a>.
Available in R via <code><a href="https://cran.rstudio.com/web/packages/gnm/vignettes/gnmOverview.pdf" class="external-link">vignette("gnmOverview", package = "gnm")</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/gnm/man/gnm-package.html" class="external-link">gnm-package</a></code>, for an extended range of models for
contingency tables</p>
<p><code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></code> for details on mosaic displays within the
strucplot framework.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
<p>Maintainer: Michael Friendly
(<a href="https://orcid.org/0000-0002-3237-0941" class="external-link">ORCID</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="va">mosaic.glm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; library(vcdExtra)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; GSStab &lt;- xtabs(count ~ sex + party, data=GSS)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # using the data in table form</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mod.glm1 &lt;- glm(Freq ~ sex + party, family = poisson, data = GSStab)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; res &lt;- residuals(mod.glm1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; std &lt;- rstandard(mod.glm1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # For mosaic.default(), need to re-shape residuals to conform to data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; stdtab &lt;- array(std,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+                 dim=dim(GSStab),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+                 dimnames=dimnames(GSStab))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(GSStab,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals=stdtab,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type="Std\nresiduals",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling = labeling_residuals)</span>
<span class="r-plt img"><img src="vcdExtra-package-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # Using externally calculated residuals with the glm() object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(mod.glm1,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals=std,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling = labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        shade=TRUE)</span>
<span class="r-plt img"><img src="vcdExtra-package-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # Using residuals_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(mod.glm1,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type="rstandard",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling = labeling_residuals, shade=TRUE)</span>
<span class="r-plt img"><img src="vcdExtra-package-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; ## Ordinal factors and structured associations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; data(Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; xtabs(Freq ~ mental+ses, data=Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mental       1   2   3   4   5   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Well      64  57  57  72  36  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mild      94  94 105 141  97  71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Moderate  58  54  65  77  54  54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Impaired  46  40  60  94  78  71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; long.labels &lt;- list(set_varnames = c(mental="Mental Health Status",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+                                      ses="Parent SES"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # fit independence model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # Residual deviance: 47.418 on 15 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; indep &lt;- glm(Freq ~ mental+ses,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+              family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; long.labels &lt;- list(set_varnames = c(mental="Mental Health Status",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+                                      ses="Parent SES"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(indep,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type="rstandard",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling_args = long.labels,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling=labeling_residuals)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # or, show as a sieve diagram</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(indep,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling_args = long.labels,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        panel=sieve,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        gp=shading_Friendly)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # fit linear x linear (uniform) association.  Use integer scores for rows/cols</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; Cscore &lt;- as.numeric(Mental$ses)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; Rscore &lt;- as.numeric(Mental$mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; linlin &lt;- glm(Freq ~ mental + ses + Rscore:Cscore,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+                 family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(linlin,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type="rstandard",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling_args = long.labels,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling=labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        suppress=1,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        main="Lin x Lin model")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; ##  Goodman Row-Column association model fits even better (deviance 3.57, df 8)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; if (require(gnm)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ Mental$mental &lt;- C(Mental$mental, treatment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ Mental$ses &lt;- C(Mental$ses, treatment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ RC1model &lt;- gnm(Freq ~ ses + mental + Mult(ses, mental),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+                 family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ mosaic(RC1model,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type="rstandard",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling_args = long.labels,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling=labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        suppress=1,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        main="RC1 model")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+  }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running start-up iterations..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running main iterations........</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt;  ############# UCB Admissions data, fit using glm()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; structable(Dept ~ Admit+Gender,UCBAdmissions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Dept   A   B   C   D   E   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Admit    Gender                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Admitted Male        512 353 120 138  53  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Female       89  17 202 131  94  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rejected Male        313 207 205 279 138 351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Female       19   8 391 244 299 317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; berkeley &lt;- as.data.frame(UCBAdmissions)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; berk.glm1 &lt;- glm(Freq ~ Dept * (Gender+Admit), data=berkeley, family="poisson")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; summary(berk.glm1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ Dept * (Gender + Admit), family = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = berkeley)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          6.27557    0.04248 147.744  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB               -0.40575    0.06770  -5.993 2.06e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC               -1.53939    0.08305 -18.536  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD               -1.32234    0.08159 -16.207  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE               -2.40277    0.11014 -21.816  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF               -3.09624    0.15756 -19.652  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale        -2.03325    0.10233 -19.870  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AdmitRejected       -0.59346    0.06838  -8.679  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:GenderFemale  -1.07581    0.22860  -4.706 2.52e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:GenderFemale   2.63462    0.12343  21.345  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:GenderFemale   1.92709    0.12464  15.461  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:GenderFemale   2.75479    0.13510  20.391  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:GenderFemale   1.94356    0.12683  15.325  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:AdmitRejected  0.05059    0.10968   0.461    0.645    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:AdmitRejected  1.20915    0.09726  12.432  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:AdmitRejected  1.25833    0.10152  12.395  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:AdmitRejected  1.68296    0.11733  14.343  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:AdmitRejected  3.26911    0.16707  19.567  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 2650.095  on 23  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:   21.736  on  6  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 216.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(berk.glm1,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling=labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        formula=~Admit+Dept+Gender)</span>
<span class="r-plt img"><img src="vcdExtra-package-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # the same, displaying studentized residuals;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # note use of formula to reorder factors in the mosaic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(berk.glm1,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type="rstandard",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling=labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        shade=TRUE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ 	     formula=~Admit+Dept+Gender,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ 	     main="Model: [DeptGender][DeptAdmit]")</span>
<span class="r-plt img"><img src="vcdExtra-package-9.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; ## all two-way model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; berk.glm2 &lt;- glm(Freq ~ (Dept + Gender + Admit)^2, data=berkeley, family="poisson")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; summary(berk.glm2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ (Dept + Gender + Admit)^2, family = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = berkeley)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                 6.27150    0.04271 146.855  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB                      -0.40322    0.06784  -5.944 2.78e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC                      -1.57790    0.08949 -17.632  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD                      -1.35000    0.08526 -15.834  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE                      -2.44982    0.11755 -20.840  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF                      -3.13787    0.16174 -19.401  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale               -1.99859    0.10593 -18.866  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AdmitRejected              -0.58205    0.06899  -8.436  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:GenderFemale         -1.07482    0.22861  -4.701 2.58e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:GenderFemale          2.66513    0.12609  21.137  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:GenderFemale          1.95832    0.12734  15.379  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:GenderFemale          2.79519    0.13925  20.073  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:GenderFemale          2.00232    0.13571  14.754  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:AdmitRejected         0.04340    0.10984   0.395    0.693    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:AdmitRejected         1.26260    0.10663  11.841  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:AdmitRejected         1.29461    0.10582  12.234  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:AdmitRejected         1.73931    0.12611  13.792  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:AdmitRejected         3.30648    0.16998  19.452  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale:AdmitRejected -0.09987    0.08085  -1.235    0.217    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 2650.095  on 23  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:   20.204  on  5  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 217.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(berk.glm2,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type="rstandard",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling = labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        shade=TRUE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ 	     formula=~Admit+Dept+Gender,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ 	     main="Model: [DeptGender][DeptAdmit][AdmitGender]")</span>
<span class="r-plt img"><img src="vcdExtra-package-10.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; anova(berk.glm1, berk.glm2, test="Chisq")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: Freq ~ Dept * (Gender + Admit)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: Freq ~ (Dept + Gender + Admit)^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         6     21.735                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         5     20.204  1   1.5312   0.2159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # Add 1 df term for association of [GenderAdmit] only in Dept A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; berkeley &lt;- within(berkeley,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+                    dept1AG &lt;- (Dept=='A')*(Gender=='Female')*(Admit=='Admitted'))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; berkeley[1:6,]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Admit Gender Dept Freq dept1AG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Admitted   Male    A  512       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Rejected   Male    A  313       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Admitted Female    A   89       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Rejected Female    A   19       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Admitted   Male    B  353       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Rejected   Male    B  207       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; berk.glm3 &lt;- glm(Freq ~ Dept * (Gender+Admit) + dept1AG, data=berkeley, family="poisson")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; summary(berk.glm3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glm(formula = Freq ~ Dept * (Gender + Admit) + dept1AG, family = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = berkeley)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          6.23832    0.04419 141.157  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB               -0.36850    0.06879  -5.357 8.47e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC               -1.50215    0.08394 -17.895  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD               -1.28509    0.08250 -15.577  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE               -2.36552    0.11081 -21.347  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF               -3.05899    0.15803 -19.357  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GenderFemale        -2.80176    0.23628 -11.858  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AdmitRejected       -0.49212    0.07175  -6.859 6.94e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dept1AG              1.05208    0.26271   4.005 6.21e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:GenderFemale  -0.30730    0.31243  -0.984    0.325    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:GenderFemale   3.40313    0.24615  13.825  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:GenderFemale   2.69560    0.24676  10.924  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:GenderFemale   3.52330    0.25220  13.970  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:GenderFemale   2.71207    0.24787  10.941  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptB:AdmitRejected -0.05074    0.11181  -0.454    0.650    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptC:AdmitRejected  1.10781    0.09966  11.116  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptD:AdmitRejected  1.15699    0.10381  11.145  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptE:AdmitRejected  1.58162    0.11933  13.254  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DeptF:AdmitRejected  3.16777    0.16848  18.803  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 2650.0952  on 23  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance:    2.6815  on  5  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 199.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; mosaic(berk.glm3,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        residuals_type = "rstandard",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        labeling = labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+        shade=TRUE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ 	      formula = ~Admit+Dept+Gender,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl+ 	      main = "Model: [DeptGender][DeptAdmit] + DeptA*[GA]")</span>
<span class="r-plt img"><img src="vcdExtra-package-11.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; # compare models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msc.gl&gt; anova(berk.glm1, berk.glm3, test="Chisq")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: Freq ~ Dept * (Gender + Admit)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: Freq ~ Dept * (Gender + Admit) + dept1AG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         6    21.7355                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         5     2.6815  1   19.054 1.271e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span><span class="st">"mental-glm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	demo(mental-glm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	---- ~~~~~~~~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Mental health data: mosaics for glm() and gnm() models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; library(gnm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; library(vcdExtra)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; data(Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # display the frequency table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (Mental.tab &lt;- xtabs(Freq ~ mental+ses, data=Mental))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mental       1   2   3   4   5   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Well      64  57  57  72  36  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mild      94  94 105 141  97  71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Moderate  58  54  65  77  54  54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Impaired  46  40  60  94  78  71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # fit independence model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # Residual deviance: 47.418 on 15 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; indep &lt;- glm(Freq ~ mental+ses,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                 family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; deviance(indep)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 47.41785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; long.labels &lt;- list(set_varnames = c(mental="Mental Health Status", ses="Parent SES"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mosaic(indep,residuals_type="rstandard", labeling_args = long.labels, labeling=labeling_residuals,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +        main="Mental health data: Independence")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-12.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # as a sieve diagram</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mosaic(indep, labeling_args = long.labels, panel=sieve, gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +        main="Mental health data: Independence")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-13.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # fit linear x linear (uniform) association.  Use integer scores for rows/cols </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; Cscore &lt;- as.numeric(Mental$ses)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; Rscore &lt;- as.numeric(Mental$mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # column effects model (ses)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; coleff &lt;- glm(Freq ~ mental + ses + Rscore:ses,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                 family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mosaic(coleff,residuals_type="rstandard", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  main="Mental health data: Col effects (ses)")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-14.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # row effects model (mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; roweff &lt;- glm(Freq ~ mental + ses + mental:Cscore,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                 family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mosaic(roweff,residuals_type="rstandard", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  main="Mental health data: Row effects (mental)")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-15.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; linlin &lt;- glm(Freq ~ mental + ses + Rscore:Cscore,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                 family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; # compare models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; anova(indep, roweff, coleff, linlin)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: Freq ~ mental + ses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: Freq ~ mental + ses + mental:Cscore</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 3: Freq ~ mental + ses + Rscore:ses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 4: Freq ~ mental + ses + Rscore:Cscore</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        15     47.418                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        12      6.281  3   41.137 6.116e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        10      6.829  2   -0.549              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        14      9.895 -4   -3.066    0.5469    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; AIC(indep, roweff, coleff, linlin)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        df      AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> indep   9 209.5908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> roweff 12 174.4537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coleff 14 179.0023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> linlin 10 174.0681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mosaic(linlin,residuals_type="rstandard", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  main="Mental health data: Linear x Linear")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-16.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##  Goodman Row-Column association model fits well (deviance 3.57, df 8)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; Mental$mental &lt;- C(Mental$mental, treatment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; Mental$ses &lt;- C(Mental$ses, treatment)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; RC1model &lt;- gnm(Freq ~ mental + ses + Mult(mental, ses),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                 family = poisson, data = Mental)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialising</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running start-up iterations..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running main iterations.......</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mosaic(RC1model,residuals_type="rstandard", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  labeling_args = long.labels, labeling=labeling_residuals, suppress=1, gp=shading_Friendly,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +  main="Mental health data: RC1 model")</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no formula provided, assuming ~ses + mental</span>
<span class="r-plt img"><img src="vcdExtra-package-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

