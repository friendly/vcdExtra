<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4. Mosaic plots • vcdExtra</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="4. Mosaic plots">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="../articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="../articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="../articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="../articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="../articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="../articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tidyCats.html">tidyCat: Tidy Methods For Categorical Data Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>4. Mosaic plots</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly</h4>
            
            <h4 data-toc-skip class="date">2026-02-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/vcdExtra/blob/master/vignettes/a4-mosaics.Rmd" class="external-link"><code>vignettes/a4-mosaics.Rmd</code></a></small>
      <div class="d-none name"><code>a4-mosaics.Rmd</code></div>
    </div>

    
    
<p>Mosaic plots provide an ideal method both for visualizing contingency
tables and for visualizing the fit— or more importantly— <strong>lack of
fit</strong> of a loglinear model.</p>
<p>For a two-way table, <code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic()</a></code>, by default, fits a model
of independence, <span class="math inline">\([A][B]\)</span> or
<code>~A + B</code> as an R formula. The <code>vcdExtra</code> package
extends this to models fit using <code>glm(..., family=poisson)</code>,
which can include specialized models for ordered factors, or square
tables that are intermediate between the saturated model, <span class="math inline">\([A B]\)</span> = <code>A * B</code>, and the
independence model <span class="math inline">\([A][B]\)</span>.</p>
<p>For <span class="math inline">\(n\)</span>-way tables,
<code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">vcd::mosaic()</a></code> can fit any loglinear model, and can also be
used to plot a model fit with <code>MASS:loglm()</code>. The
<code>vcdExtra</code> package extends this to models fit using
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code> and, by extension, to non-linear models fit
using the <a href="https://cran.r-project.org/package=gnm" class="external-link">gnm
package</a>.</p>
<p>See <span class="citation">Friendly (1994)</span>, <span class="citation">Friendly (1999)</span> for the statistical ideas behind
these uses of mosaic displays in connection with loglinear models. Our
book <span class="citation">Friendly &amp; Meyer (2016)</span> gives a
detailed discussion of mosaic plots and many more examples.</p>
<p>The essential ideas are to:</p>
<ul>
<li>
<p>recursively sub-divide a unit square into rectangular “tiles” for
the cells of the table, such that the area of each tile is proportional
to the cell frequency. Tiles are split in a sequential order:</p>
<ul>
<li>First according to the <strong>marginal</strong> proportions of a
first variable, V1</li>
<li>Next according to the <strong>conditional</strong> proportions of a
2nd variable, V2 | V1</li>
<li>Next according to the <strong>conditional</strong> proportions of a
3rd variable, V3 | {V1, V2}</li>
<li>…</li>
</ul>
</li>
<li><p>For a given loglinear model, the tiles can then be shaded in
various ways to reflect the residuals (lack of fit) for a given
model.</p></li>
<li><p>The pattern of residuals can then be used to suggest a better
model or understand <em>where</em> a given model fits or does not
fit.</p></li>
</ul>
<p><code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic()</a></code> provides a wide range of options for the
directions of splitting, the specification of shading, labeling,
spacing, legend and many other details. It is actually implemented as a
special case of a more general class of displays for <span class="math inline">\(n\)</span>-way tables called
<code>strucplot</code>, including sieve diagrams, association plots,
double-decker plots as well as mosaic plots.</p>
<p>For details, see <code><a href="https://rdrr.io/pkg/vcd/man/strucplot.html" class="external-link">help(strucplot)</a></code> and the “See also”
links therein, and also <span class="citation">Meyer, Zeileis, &amp;
Hornik (2006)</span>, which is available as an R vignette via
<code><a href="https://cran.rstudio.com/web/packages/vcd/vignettes/strucplot.pdf" class="external-link">vignette("strucplot", package="vcd")</a></code>.</p>
<p><strong><em>Example</em></strong>: A mosaic plot for the Arthritis
treatment data fits the model of independence,
<code>~ Treatment + Improved</code> and displays the association in the
pattern of residual shading. The goal is to visualize the difference in
the proportions of <code>Improved</code> for the two levels of
<code>Treatment</code> : “Placebo” and “Treated”.</p>
<p>The plot below is produced with the following call to
<code><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic()</a></code>. With the first split by <code>Treatment</code>
and the shading used, it is easy to see that more people given the
placebo experienced no improvement, while more people given the active
treatment reported marked improvement.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Arthritis</span>, package<span class="op">=</span><span class="st">"vcd"</span><span class="op">)</span></span>
<span><span class="va">art</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">Treatment</span> <span class="op">+</span> <span class="va">Improved</span>, data <span class="op">=</span> <span class="va">Arthritis</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">art</span>, gp <span class="op">=</span> <span class="va">shading_max</span>, </span>
<span>            split_vertical <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            main<span class="op">=</span><span class="st">"Arthritis: [Treatment] [Improved]"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="a4-mosaics_files/figure-html/Arthritis1-1.png" class="r-plt" alt="Mosaic plot for the `Arthritis` data, using `shading_max`" width="672"><p class="caption">
Mosaic plot for the <code>Arthritis</code> data, using
<code>shading_max</code>
</p>
</div>
<p><code>gp = shading_max</code> specifies that color in the plot
signals a significant residual at a 90% or 99% significance level, with
the more intense shade for 99%. Note that the residuals for the
independence model were not large (as shown in the legend), yet the
association between <code>Treatment</code> and <code>Improved</code> is
highly significant.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">art</span><span class="op">)</span></span>
<span><span class="co">## Call: xtabs(formula = ~Treatment + Improved, data = Arthritis)</span></span>
<span><span class="co">## Number of cases in table: 84 </span></span>
<span><span class="co">## Number of factors: 2 </span></span>
<span><span class="co">## Test for independence of all factors:</span></span>
<span><span class="co">##  Chisq = 13.055, df = 2, p-value = 0.001463</span></span></code></pre></div>
<p>In contrast, one of the other shading schemes, from <span class="citation">Friendly (1994)</span> (use:
<code>gp = shading_Friendly</code>), uses fixed cutoffs of <span class="math inline">\(\pm 2, \pm 4\)</span>, to shade cells which are
<em>individually</em> significant at approximately <span class="math inline">\(\alpha = 0.05\)</span> and <span class="math inline">\(\alpha = 0.001\)</span> levels, respectively. The
plot below uses <code>gp = shading_Friendly</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">art</span>, gp <span class="op">=</span> <span class="va">shading_Friendly</span>, </span>
<span>            split_vertical <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            main<span class="op">=</span><span class="st">"Arthritis: gp = shading_Friendly"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="a4-mosaics_files/figure-html/Arthritis2-1.png" class="r-plt" alt="Mosaic plot for the `Arthritis` data, using `shading_Friendly`" width="672"><p class="caption">
Mosaic plot for the <code>Arthritis</code> data, using
<code>shading_Friendly</code>
</p>
</div>
<div class="section level2">
<h2 id="permuting-variable-levels">Permuting variable levels<a class="anchor" aria-label="anchor" href="#permuting-variable-levels"></a>
</h2>
<p>Mosaic plots using tables or frequency data frames as input typically
take the levels of the table variables in the order presented in the
dataset. For character variables, this is often alphabetical order. That
might be helpful for looking up a value, but is unhelpful for seeing and
understanding the pattern of association.</p>
<p>It is usually much better to order the levels of the row and column
variables to help reveal the nature of their association. This is an
example of <strong>effect ordering for data display</strong> <span class="citation">(Friendly &amp; Kwan, 2003)</span>.</p>
<p><strong><em>Example</em></strong>:</p>
<p>Data from <span class="citation">Glass (1954)</span> gave this 5 x 5
table on the occupations of 3500 British fathers and their sons, where
the occupational categories are listed in alphabetic order.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Glass</span>, package<span class="op">=</span><span class="st">"vcdExtra"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">glass.tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">father</span> <span class="op">+</span> <span class="va">son</span>, data<span class="op">=</span><span class="va">Glass</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##               son</span></span>
<span><span class="co">## father         Managerial Professional Skilled Supervisory Unskilled</span></span>
<span><span class="co">##   Managerial          174           28     154          84        55</span></span>
<span><span class="co">##   Professional         45           50      18           8         8</span></span>
<span><span class="co">##   Skilled             150           14     714         185       447</span></span>
<span><span class="co">##   Supervisory          78           11     223         110        96</span></span>
<span><span class="co">##   Unskilled            42            3     320          72       411</span></span></code></pre></div>
<p>The mosaic display shows very strong association, but aside from the
diagonal cells, the pattern is unclear. Note the use of
<code>set_varnames</code> to give more descriptive labels for the
variables and abbreviate the occupational category labels. and
<code>interpolate</code> to set the shading levels for the mosaic.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">largs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>set_varnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>father<span class="op">=</span><span class="st">"Father's Occupation"</span>, </span>
<span>                                son<span class="op">=</span><span class="st">"Son's Occupation"</span><span class="op">)</span>,</span>
<span>              abbreviate<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">gargs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>interpolate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">glass.tab</span>, </span>
<span>  shade<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  labeling_args<span class="op">=</span><span class="va">largs</span>, </span>
<span>  gp_args<span class="op">=</span><span class="va">gargs</span>,</span>
<span>  main<span class="op">=</span><span class="st">"Alphabetic order"</span>, </span>
<span>  legend<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>  rot_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">90</span>,<span class="fl">0</span>,<span class="fl">70</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a4-mosaics_files/figure-html/glass-mosaic1-1.png" class="r-plt" alt="" width="672"></p>
<p>The occupational categories differ in <strong>status</strong>, and
can be reordered correctly as follows, from <code>Professional</code>
down to <code>Unskilled</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># reorder by status</span></span>
<span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">glass.tab</span><span class="op">)</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span></span>
<span><span class="co">## [1] "Professional" "Managerial"   "Supervisory"  "Skilled"      "Unskilled"</span></span></code></pre></div>
<p>The revised mosaic plot can be produced by indexing the rows and
columns of the table using <code>ord</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">glass.tab</span><span class="op">[</span><span class="va">ord</span>, <span class="va">ord</span><span class="op">]</span>, </span>
<span>  shade<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  labeling_args<span class="op">=</span><span class="va">largs</span>,  </span>
<span>  gp_args<span class="op">=</span><span class="va">gargs</span>,</span>
<span>  main<span class="op">=</span><span class="st">"Effect order"</span>, </span>
<span>  legend<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>  rot_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">90</span>,<span class="fl">0</span>,<span class="fl">70</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a4-mosaics_files/figure-html/glass-mosaic2-1.png" class="r-plt" alt="" width="672"></p>
<p>From this, and for the examples in the next section, it is useful to
re-define <code>father</code> and <code>son</code> as
<strong>ordered</strong> factors in the original <code>Glass</code>
frequency data.frame.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Glass.ord</span> <span class="op">&lt;-</span> <span class="va">Glass</span></span>
<span><span class="va">Glass.ord</span><span class="op">$</span><span class="va">father</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">Glass.ord</span><span class="op">$</span><span class="va">father</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Glass</span><span class="op">$</span><span class="va">father</span><span class="op">)</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Glass.ord</span><span class="op">$</span><span class="va">son</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">Glass.ord</span><span class="op">$</span><span class="va">son</span>,    levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Glass</span><span class="op">$</span><span class="va">son</span><span class="op">)</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Glass.ord</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    25 obs. of  3 variables:</span></span>
<span><span class="co">##  $ father: Ord.factor w/ 5 levels "Professional"&lt;..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ son   : Ord.factor w/ 5 levels "Professional"&lt;..: 1 2 3 4 5 1 2 3 4 5 ...</span></span>
<span><span class="co">##  $ Freq  : int  50 45 8 18 8 28 174 84 154 55 ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="square-tables">Square tables<a class="anchor" aria-label="anchor" href="#square-tables"></a>
</h2>
<p>For mobility tables such as this, where the rows and columns refer to
the same occupational categories it comes as no surprise that there is a
strong association in the diagonal cells: most often, sons remain in the
same occupational categories as their fathers.</p>
<p>However, the re-ordered mosaic display also reveals something
subtler: when a son differs in occupation from the father, it is more
likely that he will appear in a category one-step removed than more
steps removed. The residuals seem to decrease with the number of steps
from the diagonal.</p>
<p>For such tables, specialized loglinear models provide interesting
cases intermediate between the independence model, [A] [B], and the
saturated model, [A B]. These can be fit using <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>, with
the data in frequency form,</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">assoc</span>, data <span class="op">=</span> <span class="va">...</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span></code></pre>
<p>where <code>assoc</code> is a special term to handle a restricted
form of association, different from <code>A:B</code> which specifies the
saturated model in this notation.</p>
<ul>
<li><p><strong>Quasi-independence</strong>: Asserts independence, but
ignores the diagonal cells by fitting them exactly. The loglinear model
is: <span class="math inline">\(\log m_{ij} = \mu + \lambda^A_i +
\lambda^B_j + \delta_i I(i = j)\)</span>, where <span class="math inline">\(I()\)</span> is the indicator function.</p></li>
<li><p><strong>Symmetry</strong>: This model asserts that the joint
distribution of the row and column variables is symmetric, that is <span class="math inline">\(\pi_{ij} = \pi_{ji}\)</span>: A son is equally
likely to move from their father’s occupational category <span class="math inline">\(i\)</span> to another category, <span class="math inline">\(j\)</span>, as the reverse, moving from <span class="math inline">\(j\)</span> to <span class="math inline">\(i\)</span>. Symmetry is quite strong, because it
also implies <strong>marginal homogeneity</strong>, that the marginal
probabilities of the row and column variables are equal, <span class="math inline">\(\pi{i+} = \sum_j \pi_{ij} = \sum_j \pi_{ji} =
\pi_{+i}\)</span> for all <span class="math inline">\(i\)</span>.</p></li>
<li><p><strong>Quasi-symmetry</strong>: This model uses the standard
main-effect terms in the loglinear model, but asserts that the
association parameters are symmetric, <span class="math inline">\(\log
m_{ij} = \mu + \lambda^A_i + \lambda^B_j + \lambda^{AB}_{ij}\)</span>,
where <span class="math inline">\(\lambda^{AB}_{ij} =
\lambda^{AB}_{ji}\)</span>.</p></li>
</ul>
<p>The <a href="https://cran.r-project.org/package=gnm" class="external-link">gnm package</a>
provides a variety of these functions: <code><a href="https://rdrr.io/pkg/gnm/man/Diag.html" class="external-link">gnm::Diag()</a></code>,
<code><a href="https://rdrr.io/pkg/gnm/man/Symm.html" class="external-link">gnm::Symm()</a></code> and <code><a href="https://rdrr.io/pkg/gnm/man/Topo.html" class="external-link">gnm::Topo()</a></code> for an interaction
factor as specified by an array of levels, which may be arbitrarily
structured.</p>
<p>For example, the following generates a term for a diagonal factor in
a <span class="math inline">\(4 \times 4\)</span> table. The diagonal
values reflect parameters fitted for each diagonal cell. Off-diagonal
values, “.” are ignored.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rowfac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">colfac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">diag4by4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Diag.html" class="external-link">Diag</a></span><span class="op">(</span><span class="va">rowfac</span>, <span class="va">colfac</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Diag.html" class="external-link">Diag</a></span><span class="op">(</span><span class="va">rowfac</span>, <span class="va">colfac</span>, binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">## [1,] "1"  "."  "."  "." </span></span>
<span><span class="co">## [2,] "."  "2"  "."  "." </span></span>
<span><span class="co">## [3,] "."  "."  "3"  "." </span></span>
<span><span class="co">## [4,] "."  "."  "."  "4"</span></span></code></pre></div>
<p><code><a href="https://rdrr.io/pkg/gnm/man/Symm.html" class="external-link">Symm()</a></code> constructs parameters for symmetric cells. The
particular values don’t matter. All that does matter is that the same
value, e.g., <code>1:2</code> appears in both the (1,2) and (2,1)
cells.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">symm4by4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Symm.html" class="external-link">Symm</a></span><span class="op">(</span><span class="va">rowfac</span>, <span class="va">colfac</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">symm4by4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">##      [,1]  [,2]  [,3]  [,4] </span></span>
<span><span class="co">## [1,] "1:1" "1:2" "1:3" "1:4"</span></span>
<span><span class="co">## [2,] "1:2" "2:2" "2:3" "2:4"</span></span>
<span><span class="co">## [3,] "1:3" "2:3" "3:3" "3:4"</span></span>
<span><span class="co">## [4,] "1:4" "2:4" "3:4" "4:4"</span></span></code></pre></div>
<p><strong><em>Example</em></strong>: To illustrate, we fit the four
models below, starting with the independence model
<code>Freq ~ father + son</code> and then adding terms to reflect the
restricted forms of association, e.g., <code>Diag(father, son)</code>
for diagonal terms and <code>Symm(father, son)</code> for symmetry.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hturner/gnm" class="external-link">gnm</a></span><span class="op">)</span></span>
<span><span class="va">glass.indep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">father</span> <span class="op">+</span> <span class="va">son</span>, </span>
<span>                   data <span class="op">=</span> <span class="va">Glass.ord</span>, family<span class="op">=</span><span class="va">poisson</span><span class="op">)</span></span>
<span><span class="va">glass.quasi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">father</span> <span class="op">+</span> <span class="va">son</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Diag.html" class="external-link">Diag</a></span><span class="op">(</span><span class="va">father</span>, <span class="va">son</span><span class="op">)</span>,  </span>
<span>                   data <span class="op">=</span> <span class="va">Glass.ord</span>, family<span class="op">=</span><span class="va">poisson</span><span class="op">)</span></span>
<span><span class="va">glass.symm</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Symm.html" class="external-link">Symm</a></span><span class="op">(</span><span class="va">father</span>, <span class="va">son</span><span class="op">)</span>,  </span>
<span>                   data <span class="op">=</span> <span class="va">Glass.ord</span>, family<span class="op">=</span><span class="va">poisson</span><span class="op">)</span></span>
<span><span class="va">glass.qsymm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">father</span> <span class="op">+</span> <span class="va">son</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Symm.html" class="external-link">Symm</a></span><span class="op">(</span><span class="va">father</span>, <span class="va">son</span><span class="op">)</span>,  </span>
<span>                   data <span class="op">=</span> <span class="va">Glass.ord</span>, family<span class="op">=</span><span class="va">poisson</span><span class="op">)</span></span></code></pre></div>
<p>We can visualize these using the <code><a href="../reference/mosaic.glm.html">vcdExtra::mosaic.glm()</a></code>
method, which extends mosaic displays to handle fitted <code>glm</code>
objects. <em>Technical note</em>: for models fitted using
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>, standardized residuals,
<code>residuals_type="rstandard"</code> have better statistical
properties than the default Pearson residuals in mosaic plots and
analysis.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">glass.quasi</span>, </span>
<span>  residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span>
<span>  shade<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  labeling_args<span class="op">=</span><span class="va">largs</span>,  </span>
<span>  gp_args<span class="op">=</span><span class="va">gargs</span>,</span>
<span>  main<span class="op">=</span><span class="st">"Quasi-Independence"</span>,</span>
<span>  legend<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>  rot_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">90</span>,<span class="fl">0</span>,<span class="fl">70</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="a4-mosaics_files/figure-html/glass-quasi-1.png" class="r-plt" alt="" width="672"></p>
<p>Mosaic plots for the other models would give further visual
assessment of these models, however we can also test differences among
them. For nested models, <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> gives tests of how much
better a more complex model is compared to the previous one.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model comparisons: for *nested* models</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">glass.indep</span>, <span class="va">glass.quasi</span>, <span class="va">glass.qsymm</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Freq ~ father + son</span></span>
<span><span class="co">## Model 2: Freq ~ father + son + Diag(father, son)</span></span>
<span><span class="co">## Model 3: Freq ~ father + son + Symm(father, son)</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        16     792.19                          </span></span>
<span><span class="co">## 2        11     235.78  5   556.41 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## 3         6       4.66  5   231.12 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Alternatively, <code><a href="../reference/LRstats.html">vcdExtra::LRstats()</a></code> gives model summaries
for a collection of models, not necessarily nested, with AIC and BIC
statistics reflecting model parsimony.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmlist.html">glmlist</a></span><span class="op">(</span><span class="va">glass.indep</span>, <span class="va">glass.quasi</span>, <span class="va">glass.symm</span>, <span class="va">glass.qsymm</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/LRstats.html">LRstats</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span></span>
<span><span class="co">## Likelihood summary table:</span></span>
<span><span class="co">##                AIC    BIC LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## glass.indep 960.91 971.88   792.19 16  &lt; 2.2e-16 ***</span></span>
<span><span class="co">## glass.quasi 414.50 431.57   235.78 11  &lt; 2.2e-16 ***</span></span>
<span><span class="co">## glass.symm  218.18 236.47    37.46 10  4.704e-05 ***</span></span>
<span><span class="co">## glass.qsymm 193.38 216.54     4.66  6     0.5876    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>By all criteria, the model of quasi symmetry fits best. The residual
deviance $G^2 is not significant. The mosaic is largely unshaded,
indicating a good fit, but there are a few shaded cells that indicate
the remaining positive and negative residuals. For comparative mosaic
displays, it is sometimes useful to show the <span class="math inline">\(G^2\)</span> statistic in the main title, using
<code><a href="../reference/modFit.html">vcdExtra::modFit()</a></code> for this purpose.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">glass.qsymm</span>, </span>
<span>  residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span>
<span>  shade<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  labeling_args<span class="op">=</span><span class="va">largs</span>,  </span>
<span>  gp_args<span class="op">=</span><span class="va">gargs</span>,</span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Quasi-Symmetry"</span>, <span class="fu"><a href="../reference/modFit.html">modFit</a></span><span class="op">(</span><span class="va">glass.qsymm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  legend<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>  rot_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">90</span>,<span class="fl">0</span>,<span class="fl">70</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="a4-mosaics_files/figure-html/glass-qsymm-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level2">
<h2 id="correspondence-analysis-ordering">Correspondence analysis ordering<a class="anchor" aria-label="anchor" href="#correspondence-analysis-ordering"></a>
</h2>
<p>When natural orders for row and column levels are not given a priori,
we can find orderings that make more sense using correspondence
analysis.</p>
<p>The general ideas are that:</p>
<ul>
<li><p>Correspondence analysis assigns scores to the row and column
variables to best account for the association in 1, 2, …
dimensions</p></li>
<li><p>The first CA dimension accounts for largest proportion of the
Pearson <span class="math inline">\(\chi^2\)</span></p></li>
<li><p>Therefore, permuting the levels of the row and column variables
by the CA Dim1 scores gives a more coherent mosaic plot, more clearly
showing the nature of the association.</p></li>
<li><p>The <a href="https://cran.r-project.org/package=seriation" class="external-link">seriation
package</a> now has a method to order variables in frequency tables
using CA.</p></li>
</ul>
<p><strong><em>Example</em></strong>: As an example, consider the
<code>HouseTasks</code> dataset, a 13 x 4 table of frequencies of
household tasks performed by couples, either by the
<code>Husband</code>, <code>Wife</code>, <code>Alternating</code> or
<code>Jointly</code>. You can see from the table that some tasks
(Repairs) are done largely by the husband; some (laundry, main meal) are
largely done by the wife, while others are done jointly or alternating
between husband and wife. But the <code>Task</code> and <code>Who</code>
levels are both in alphabetical order.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"HouseTasks"</span>, package <span class="op">=</span> <span class="st">"vcdExtra"</span><span class="op">)</span></span>
<span><span class="va">HouseTasks</span></span>
<span><span class="co">##            Who</span></span>
<span><span class="co">## Task        Alternating Husband Jointly Wife</span></span>
<span><span class="co">##   Breakfast          36      15       7   82</span></span>
<span><span class="co">##   Dinner             11       7      13   77</span></span>
<span><span class="co">##   Dishes             24       4      53   32</span></span>
<span><span class="co">##   Driving            51      75       3   10</span></span>
<span><span class="co">##   Finances           13      21      66   13</span></span>
<span><span class="co">##   Holidays            1       6     153    0</span></span>
<span><span class="co">##   Insurance           1      53      77    8</span></span>
<span><span class="co">##   Laundry            14       2       4  156</span></span>
<span><span class="co">##   Main_meal          20       5       4  124</span></span>
<span><span class="co">##   Official           46      23      15   12</span></span>
<span><span class="co">##   Repairs             3     160       2    0</span></span>
<span><span class="co">##   Shopping           23       9      55   33</span></span>
<span><span class="co">##   Tidying            11       1      57   53</span></span></code></pre></div>
<p>The naive mosaic plot for this dataset is shown below, splitting
first by <code>Task</code> and then by <code>Who</code>. Due to the
length of the factor labels, some features of <code>labeling</code> were
used to make the display more readable.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">HouseTasks</span>, shade <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       labeling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcd/man/labeling_border.html" class="external-link">labeling_border</a></span><span class="op">(</span>rot_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                  offset_label <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">5</span>,<span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                                  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                  just_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"right"</span><span class="op">)</span>,</span>
<span>                                  tl_varnames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a4-mosaics_files/figure-html/housetasks-mos1-1.png" class="r-plt" alt="" width="672"></p>
<p>Correspondence analysis, using the <a href="https://cran.r-project.org/package=ca" class="external-link">ca package</a>, shows that
nearly 89% of the <span class="math inline">\(\chi^2\)</span> can be
accounted for in two dimensions.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.carme-n.org/" class="external-link">ca</a></span><span class="op">)</span></span>
<span><span class="co">## Loading required package: ca</span></span>
<span><span class="va">HT.ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ca/man/ca.html" class="external-link">ca</a></span><span class="op">(</span><span class="va">HouseTasks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">HT.ca</span>, rows<span class="op">=</span><span class="cn">FALSE</span>, columns<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Principal inertias (eigenvalues):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  dim    value      %   cum%   scree plot               </span></span>
<span><span class="co">##  1      0.542889  48.7  48.7  ************             </span></span>
<span><span class="co">##  2      0.445003  39.9  88.6  **********               </span></span>
<span><span class="co">##  3      0.127048  11.4 100.0  ***                      </span></span>
<span><span class="co">##         -------- -----                                 </span></span>
<span><span class="co">##  Total: 1.114940 100.0</span></span></code></pre></div>
<p>The CA plot has a fairly simple interpretation: Dim1 is largely the
distinction between tasks primarily done by the wife vs. the husband.
Dim2 distinguishes tasks that are done singly vs. those that are done
jointly.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">HT.ca</span>, lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a4-mosaics_files/figure-html/housetasks-ca-plot-1.png" class="r-plt" alt="" width="672"></p>
<p>So, we can use the <code>CA</code> method of
<code><a href="https://rdrr.io/pkg/seriation/man/seriate.html" class="external-link">seriation::seriate()</a></code> to find the order of permutations of
<code>Task</code> and <code>Who</code> along the CA dimensions.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/seriation" class="external-link">seriation</a></span><span class="op">)</span></span>
<span><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seriation/man/seriate.html" class="external-link">seriate</a></span><span class="op">(</span><span class="va">HouseTasks</span>, method <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span></span>
<span><span class="co"># the permuted row and column labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">HouseTasks</span><span class="op">)</span><span class="op">[</span><span class="va">order</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">##  [1] "Laundry"   "Main_meal" "Dinner"    "Breakfast" "Tidying"   "Dishes"   </span></span>
<span><span class="co">##  [7] "Shopping"  "Official"  "Holidays"  "Finances"  "Insurance" "Driving"  </span></span>
<span><span class="co">## [13] "Repairs"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">HouseTasks</span><span class="op">)</span><span class="op">[</span><span class="va">order</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">## [1] "Wife"        "Alternating" "Jointly"     "Husband"</span></span></code></pre></div>
<p>Now, use <code><a href="https://rdrr.io/pkg/seriation/man/permute.html" class="external-link">seriation::permute()</a></code> to use <code>order</code>
for the permutations of <code>Task</code> and <code>Who</code>, and plot
the resulting mosaic:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># do the permutation</span></span>
<span><span class="va">HT_perm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seriation/man/permute.html" class="external-link">permute</a></span><span class="op">(</span><span class="va">HouseTasks</span>, <span class="va">order</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">HT_perm</span>, shade <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       labeling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcd/man/labeling_border.html" class="external-link">labeling_border</a></span><span class="op">(</span>rot_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                  offset_label <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">5</span>,<span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                                  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                  just_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"right"</span><span class="op">)</span>,</span>
<span>                                  tl_varnames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a4-mosaics_files/figure-html/housetasks-mos2-1.png" class="r-plt" alt="" width="672"></p>
<p>It is now easy to see the cluster of tasks (laundry and cooking) done
largely by the wife at the top, and those (repairs, driving) done
largely by the husband at the bottom.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-vcd:Friendly:1994" class="csl-entry">
Friendly, M. (1994). Mosaic displays for multi-way contingency tables.
<em>Journal of the American Statistical Association</em>, <em>89</em>,
190–200.
</div>
<div id="ref-vcd:Friendly:1999" class="csl-entry">
Friendly, M. (1999). Extending mosaic displays: Marginal, conditional,
and partial views of categorical data. <em>Journal of Computational and
Graphical Statistics</em>, <em>8</em>(3), 373–395.
</div>
<div id="ref-FriendlyKwan:02:effect" class="csl-entry">
Friendly, M., &amp; Kwan, E. (2003). Effect ordering for data displays.
<em>Computational Statistics and Data Analysis</em>, <em>43</em>(4),
509–539. Retrieved from <a href="https://doi.org/10.1016/S0167-9473(02)00290-6" class="external-link">https://doi.org/10.1016/S0167-9473(02)00290-6</a>
</div>
<div id="ref-FriendlyMeyer:2016:DDAR" class="csl-entry">
Friendly, M., &amp; Meyer, D. (2016). <em>Discrete data analysis with
<span>R</span>: Visualization and modeling techniques for categorical
and count data</em>. Boca Raton, FL: Chapman &amp; Hall/CRC.
</div>
<div id="ref-Glass:54" class="csl-entry">
Glass, D. V. (1954). <em>Social mobility in britain</em>. Glencoe, IL:
The Free Press.
</div>
<div id="ref-vcd:Meyer+Zeileis+Hornik:2006b" class="csl-entry">
Meyer, D., Zeileis, A., &amp; Hornik, K. (2006). The strucplot
framework: Visualizing multi-way contingency tables with. <em>Journal of
Statistical Software</em>, <em>17</em>(3), 1–48. Retrieved from <a href="https://www.jstatsoft.org/v17/i03/" class="external-link">https://www.jstatsoft.org/v17/i03/</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
