<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7. Continuous predictors • vcdExtra</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="7. Continuous predictors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="../articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="../articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="../articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="../articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="../articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="../articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a></li>
    <li><a class="dropdown-item" href="../articles/tidyCats.html">tidyCat: Tidy Methods For Categorical Data Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>7. Continuous predictors</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly</h4>
            
            <h4 data-toc-skip class="date">2025-03-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/vcdExtra/blob/HEAD/vignettes/a7-continuous.Rmd" class="external-link"><code>vignettes/a7-continuous.Rmd</code></a></small>
      <div class="d-none name"><code>a7-continuous.Rmd</code></div>
    </div>

    
    
<p>When continuous predictors are available—and potentially important—in
explaining a categorical outcome, models for that outcome include:
logistic regression (binary response), the proportional odds model
(ordered polytomous response), multinomial (generalized) logistic
regression. Many of these are special cases of the generalized linear
model using the <code>"poisson"</code> or <code>"binomial"</code> family
and their relatives.</p>
<div class="section level3">
<h3 id="sec:spine">Spine and conditional density plots<a class="anchor" aria-label="anchor" href="#sec:spine"></a>
</h3>
<p>I don’t go into fitting such models here, but I would be remiss not
to illustrate some visualizations in <code>vcd</code> that are helpful
here. The first of these is the spine plot or spinogram <span class="citation">(Hummel, 1996)</span>, produced with
<code><a href="https://rdrr.io/pkg/vcd/man/spine.html" class="external-link">spine()</a></code>. These are special cases of mosaic plots with
specific spacing and shading to show how a categorical response varies
with a continuous or categorical predictor.</p>
<p>They are also a generalization of stacked bar plots where not the
heights but the <em>widths</em> of the bars corresponds to the relative
frequencies of <code>x</code>. The heights of the bars then correspond
to the conditional relative frequencies of <code>y</code> in every
<code>x</code> group.</p>
<p><strong><em>Example</em></strong>: For the <code>Arthritis</code>
data, we can see how <code>Improved</code> varies with <code>Age</code>
as follows. <code><a href="https://rdrr.io/pkg/vcd/man/spine.html" class="external-link">spine()</a></code> takes a formula of the form
<code>y ~ x</code> with a single dependent factor and a single
explanatory variable <code>x</code> (a numeric variable or a factor).
The range of a numeric variable<code>x</code> is divided into intervals
based on the <code>breaks</code> argument, and stacked bars are drawn to
show the distribution of <code>y</code> as <code>x</code> varies. As
shown below, the discrete table that is visualized is returned by the
function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/spine.html" class="external-link">spine</a></span><span class="op">(</span><span class="va">Improved</span> <span class="op">~</span> <span class="va">Age</span>, data <span class="op">=</span> <span class="va">Arthritis</span>, breaks <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##          Improved</span></span>
<span><span class="co">## Age       None Some Marked</span></span>
<span><span class="co">##   [20,40]   10    3      2</span></span>
<span><span class="co">##   (40,60]   21    3     17</span></span>
<span><span class="co">##   (60,80]   11    8      9</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/spine.html" class="external-link">spine</a></span><span class="op">(</span><span class="va">Improved</span> <span class="op">~</span> <span class="va">Age</span>, data <span class="op">=</span> <span class="va">Arthritis</span>, breaks <span class="op">=</span> <span class="st">"Scott"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##          Improved</span></span>
<span><span class="co">## Age       None Some Marked</span></span>
<span><span class="co">##   [20,30]    6    1      0</span></span>
<span><span class="co">##   (30,40]    4    2      2</span></span>
<span><span class="co">##   (40,50]    9    0      3</span></span>
<span><span class="co">##   (50,60]   12    3     14</span></span>
<span><span class="co">##   (60,70]   11    8      8</span></span>
<span><span class="co">##   (70,80]    0    0      1</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="a7-continuous_files/figure-html/spine1-1.png" alt="Spine plots for the `Arthritis` data" width="46%"><img src="a7-continuous_files/figure-html/spine1-2.png" alt="Spine plots for the `Arthritis` data" width="46%"><p class="caption">
Spine plots for the <code>Arthritis</code> data
</p>
</div>
<p>The conditional density plot <span class="citation">(Hofmann &amp;
Theus, 2005)</span> is a further generalization. This visualization
technique is similar to spinograms, but uses a smoothing approach rather
than discretizing the explanatory variable. As well, it uses the
original <code>x</code> axis and not a distorted one.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/cdplot.html" class="external-link">cdplot</a></span><span class="op">(</span><span class="va">Improved</span> <span class="op">~</span> <span class="va">Age</span>, data <span class="op">=</span> <span class="va">Arthritis</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="a7-continuous_files/figure-html/cdplot-1.png" alt="Conditional density plot for the `Arthritis` data showing the variation of Improved with Age." width="480"><p class="caption">
Conditional density plot for the <code>Arthritis</code> data showing the
variation of Improved with Age.
</p>
</div>
<p>In such plots, it is useful to also see the distribution of the
observations across the horizontal axis, e.g., with a <code><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug()</a></code>
plot. @ref{fig:cd-plot} uses <code><a href="https://rdrr.io/r/graphics/cdplot.html" class="external-link">cdplot()</a></code> from the
<code>graphics</code> package rather than <code><a href="https://rdrr.io/pkg/vcd/man/cd_plot.html" class="external-link">cd_plot()</a></code> from
<code>vcd</code>, and is produced with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/cdplot.html" class="external-link">cdplot</a></span><span class="op">(</span><span class="va">Improved</span> <span class="op">~</span> <span class="va">Age</span>, data <span class="op">=</span> <span class="va">Arthritis</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Arthritis</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"white"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a7-continuous_files/figure-html/cdplot1-1.png" width="480" style="display: block; margin: auto;"></p>
<p>From this figure it can be easily seen that the proportion of
patients reporting Some or Marked improvement increases with Age, but
there are some peculiar bumps in the distribution. These may be real or
artifactual, but they would be hard to see with most other visualization
methods. When we switch from non-parametric data exploration to
parametric statistical models, such effects are easily missed.</p>
</div>
<div class="section level3">
<h3 id="sec:modelplots">Model-based plots: effect plots and <code>ggplot2 plots</code><a class="anchor" aria-label="anchor" href="#sec:modelplots"></a>
</h3>
<p>The nonparametric conditional density plot uses smoothing methods to
convey the distributions of the response variable, but displays that are
simpler to interpret can often be obtained by plotting the predicted
response from a parametric model.</p>
<p>For complex <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> models with interaction effects, the
<code>effects</code> package provides the most useful displays, plotting
the predicted values for a given term, averaging over other predictors
not included in that term. I don’t illustrate this here, but see <span class="citation">Fox &amp; Weisberg (2018)</span>,<span class="citation">Fox (2003)</span> and
<code><a href="https://rdrr.io/pkg/effects/man" class="external-link">help(package="effects")</a></code>.</p>
<p>Here I just briefly illustrate the capabilities of the
<code>ggplot2</code> package for model-smoothed plots of categorical
responses in <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> models.</p>
<p><strong><em>Example</em></strong>: The <code>Donner</code> data frame
in <code>vcdExtra</code> gives details on the survival of 90 members of
the Donner party, a group of people who attempted to migrate to
California in 1846. They were trapped by an early blizzard on the
eastern side of the Sierra Nevada mountains, and before they could be
rescued, nearly half of the party had died. What factors affected who
lived and who died?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Donner</span>, package<span class="op">=</span><span class="st">"vcdExtra"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Donner</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    90 obs. of  5 variables:</span></span>
<span><span class="co">##  $ family  : Factor w/ 10 levels "Breen","Donner",..: 9 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ age     : int  23 13 1 5 14 40 51 9 3 8 ...</span></span>
<span><span class="co">##  $ sex     : Factor w/ 2 levels "Female","Male": 2 2 1 2 2 1 2 2 2 2 ...</span></span>
<span><span class="co">##  $ survived: int  0 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ death   : POSIXct, format: "1846-12-29" NA ...</span></span></code></pre></div>
<p>A potential model of interest is the logistic regression model for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Pr(survived)</annotation></semantics></math>,
allowing separate fits for males and females as a function of
<code>age</code>. The key to this is the <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth()</a></code>
function, using
<code>method = "glm", method.args = list(family = binomial)</code>. The
<code>formula = y ~ x</code> specifies a linear fit on the logit scale
(@ref{fig:donner3}, left)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># separate linear fits on age for M/F</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Donner</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">survived</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.02</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span>, </span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span>, </span>
<span>              formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.2</span>, size<span class="op">=</span><span class="fl">2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, we can allow a quadratic relation with
<code>age</code> by specifying <code>formula = y ~ poly(x,2)</code>
(<span class="citation">(<strong>ref?</strong>)</span>(fig:donner3),
right).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># separate quadratics</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Donner</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">survived</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.02</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span>, </span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span>, </span>
<span>              formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0.2</span>, size<span class="op">=</span><span class="fl">2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="a7-continuous_files/figure-html/donner3a-1.png" alt="Logistic regression plots for the  `Donner` data    showing survival vs. age, by sex. Left: linear logistic model; right: quadratic model {#fig:donner3}" width="46%"><img src="a7-continuous_files/figure-html/donner3a-2.png" alt="Logistic regression plots for the  `Donner` data    showing survival vs. age, by sex. Left: linear logistic model; right: quadratic model {#fig:donner3}" width="46%"><p class="caption">
Logistic regression plots for the <code>Donner</code> data showing
survival vs. age, by sex. Left: linear logistic model; right: quadratic
model {#fig:donner3}
</p>
</div>
<p>These plots very nicely show (a) the fitted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mi>u</mi><mi>r</mi><mi>v</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Pr(survived)</annotation></semantics></math>
for males and females; (b) confidence bands around the smoothed model
fits and (c) the individual observations by jittered points at 0 and 1
for those who died and survived, respectively.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-effects:2" class="csl-entry">
Fox, J. (2003). Effect displays in <span>R</span> for generalised linear
models. <em>Journal of Statistical Software</em>, <em>8</em>(15), 1–27.
http://doi.org/<a href="https://doi.org/10.18637/jss.v008.i15" class="external-link">10.18637/jss.v008.i15</a>
</div>
<div id="ref-effects:1" class="csl-entry">
Fox, J., &amp; Weisberg, S. (2018). Visualizing fit and lack of fit in
complex regression models with predictor effect plots and partial
residuals. <em>Journal of Statistical Software</em>, <em>87</em>(9),
1–27. http://doi.org/<a href="https://doi.org/10.18637/jss.v087.i09" class="external-link">10.18637/jss.v087.i09</a>
</div>
<div id="ref-vcd:Hofmann+Theus" class="csl-entry">
Hofmann, H., &amp; Theus, M. (2005). <em>Interactive graphics for
visualizing conditional distributions</em>.
</div>
<div id="ref-vcd:Hummel:1996" class="csl-entry">
Hummel, J. (1996). Linked bar charts: Analysing categorical data
graphically. <em>Computational Statistics</em>, <em>11</em>, 23–33.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
