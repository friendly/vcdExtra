<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="vcdExtra">
<title>Loglinear Models • vcdExtra</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loglinear Models">
<meta property="og:description" content="vcdExtra">
<meta property="og:image" content="http://friendly.github.io/vcdExtra/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/continuous.html">Continuous predictors</a>
    <a class="dropdown-item" href="../articles/creating.html">Creating and manipulating frequency tables</a>
    <a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a>
    <a class="dropdown-item" href="../articles/demo-housing.html">Demo - Housing Data</a>
    <a class="dropdown-item" href="../articles/loglinear.html">Loglinear Models</a>
    <a class="dropdown-item" href="../articles/mobility.html">Mobility tables</a>
    <a class="dropdown-item" href="../articles/mosaics.html">Mosaic plots</a>
    <a class="dropdown-item" href="../articles/tests.html">Tests of Independence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Loglinear Models</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly</h4>
            
            <h4 data-toc-skip class="date">2023-03-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/vcdExtra/blob/HEAD/vignettes/loglinear.Rmd" class="external-link"><code>vignettes/loglinear.Rmd</code></a></small>
      <div class="d-none name"><code>loglinear.Rmd</code></div>
    </div>

    
    
<p>You can use the <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm()</a></code> function in the
<code>MASS</code> package to fit log-linear models. Equivalent models
can also be fit (from a different perspective) as generalized linear
models with the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> function using the
<code>family='poisson'</code> argument, and the <code>gnm</code> package
provides a wider range of generalized <em>nonlinear</em> models,
particularly for testing structured associations.</p>
<p>The visualization methods for these models were originally developed
for models fit using <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm()</a></code>, so this approach is
emphasized here. Some extensions of these methods for models fit using
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> and <code><a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link">gnm()</a></code> are contained in the
<code>vcdExtra</code> package and illustrated in .</p>
<p>Assume we have a 3-way contingency table based on variables A, B, and
C. The possible different forms of loglinear models for a 3-way table
are shown in the table below. @(tab:loglin-3way) The <strong>Model
formula</strong> column shows how to express each model for
<code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm()</a></code> in R. <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;For &lt;code&gt;&lt;a href="https://rdrr.io/r/stats/glm.html" class="external-link"&gt;glm()&lt;/a&gt;&lt;/code&gt;, or &lt;code&gt;&lt;a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link"&gt;gnm()&lt;/a&gt;&lt;/code&gt;, with the
data in the form of a frequency data.frame, the same model is specified
in the form &lt;code&gt;glm(Freq&lt;/code&gt; &lt;span class="math inline"&gt;\(\sim\)&lt;/span&gt; &lt;code&gt;..., family="poisson")&lt;/code&gt;,
where &lt;code&gt;Freq&lt;/code&gt; is the name of the cell frequency variable and
&lt;code&gt;...&lt;/code&gt; specifies the &lt;em&gt;Model formula&lt;/em&gt;.&lt;/p&gt;'><sup>1</sup></a> In the <strong>Interpretation</strong>
column, the symbol “<span class="math inline">\(\perp\)</span>” is to be
read as “is independent of,” and “<span class="math inline">\(\;|\;\)</span>” means “conditional on,” or
“adjusting for,” or just “given”.</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="23%">
<col width="18%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="left"><strong>Model</strong></th>
<th align="left"><strong>Model formula</strong></th>
<th align="left"><strong>Symbol</strong></th>
<th align="left"><strong>Interpretation</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mutual independence</td>
<td align="left"><code>~A + B + C</code></td>
<td align="left"><span class="math inline">\([A][B][C]\)</span></td>
<td align="left"><span class="math inline">\(A \perp B \perp
C\)</span></td>
</tr>
<tr class="even">
<td align="left">Joint independence</td>
<td align="left"><code>~A*B + C</code></td>
<td align="left"><span class="math inline">\([AB][C]\)</span></td>
<td align="left"><span class="math inline">\((A \: B) \perp
C\)</span></td>
</tr>
<tr class="odd">
<td align="left">Conditional independence</td>
<td align="left"><code>~(A+B)*C</code></td>
<td align="left"><span class="math inline">\([AC][BC]\)</span></td>
<td align="left"><span class="math inline">\((A \perp B) \;|\;
C\)</span></td>
</tr>
<tr class="even">
<td align="left">All two-way associations</td>
<td align="left"><code>~A*B + A*C + B*C</code></td>
<td align="left"><span class="math inline">\([AB][AC][BC]\)</span></td>
<td align="left">homogeneous association</td>
</tr>
<tr class="odd">
<td align="left">Saturated model</td>
<td align="left"><code>~A*B*C</code></td>
<td align="left"><span class="math inline">\([ABC]\)</span></td>
<td align="left">3-way association</td>
</tr>
</tbody>
</table>
<p>For example, the formula <code>~A + B + C</code> specifies the model
of <em>mutual independence</em> with no associations among the three
factors. In standard notation for the expected frequencies <span class="math inline">\(m_{ijk}\)</span>, this corresponds to</p>
<p><span class="math display">\[  \log ( m_{ijk} ) = \mu + \lambda_i^A +
\lambda_j^B + \lambda_k^C \equiv  A + B + C \]</span></p>
<p>The parameters <span class="math inline">\(\lambda_i^A ,
\lambda_j^B\)</span> and <span class="math inline">\(\lambda_k^C\)</span> pertain to the differences
among the one-way marginal frequencies for the factors A, B and C.</p>
<p>Similarly, the model of <em>joint independence</em>, <span class="math inline">\((A \: B) \perp C\)</span>, allows an association
between A and B, but specifies that C is independent of both of these
and their combinations,</p>
<p><span class="math display">\[  \log ( m_{ijk} ) = \mu + \lambda_i^A +
\lambda_j^B + \lambda_k^C + \lambda_{ij}^{AB} \equiv A * B + C
\]</span></p>
<p>where the parameters <span class="math inline">\(\lambda_{ij}^{AB}\)</span> pertain to the overall
association between A and B (collapsing over C).</p>
<p>In the literature or text books, you will often find these models
expressed in shorthand symbolic notation, using brackets,
<code>[ ]</code> to enclose the <em>high-order terms</em> in the model.
Thus, the joint independence model can be denoted <code>[AB][C]</code>,
as shown in the <strong>Symbol</strong> column in the table.
@(tab:loglin-3way).</p>
<p>Models of <em>conditional independence</em> allow (and fit) two of
the three possible two-way associations. There are three such models,
depending on which variable is conditioned upon. For a given conditional
independence model, e.g., <code>[AB][AC]</code>, the given variable is
the one common to all terms, so this example has the interpretation
<span class="math inline">\((B \perp C) \;|\; A\)</span>.</p>
<div class="section level2">
<h2 id="sec:loglm">Fitting with <code>loglm()</code><a class="anchor" aria-label="anchor" href="#sec:loglm"></a>
</h2>
<p>For example, we can fit the model of mutual independence among hair
color, eye color and sex in <code>HairEyeColor</code> as</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="co">## Independence model of hair and eye color and sex.  </span></span>
<span><span class="va">hec.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></span><span class="op">(</span><span class="op">~</span><span class="va">Hair</span><span class="op">+</span><span class="va">Eye</span><span class="op">+</span><span class="va">Sex</span>, data<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span></span>
<span><span class="va">hec.1</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## loglm(formula = ~Hair + Eye + Sex, data = HairEyeColor)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Statistics:</span></span>
<span><span class="co">##                       X^2 df P(&gt; X^2)</span></span>
<span><span class="co">## Likelihood Ratio 166.3001 24        0</span></span>
<span><span class="co">## Pearson          164.9247 24        0</span></span></code></pre></div>
<p>Similarly, the models of conditional independence and joint
independence are specified as</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Conditional independence</span></span>
<span><span class="va">hec.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></span><span class="op">(</span><span class="op">~</span><span class="op">(</span><span class="va">Hair</span> <span class="op">+</span> <span class="va">Eye</span><span class="op">)</span> <span class="op">*</span> <span class="va">Sex</span>, data<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span></span>
<span><span class="va">hec.2</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## loglm(formula = ~(Hair + Eye) * Sex, data = HairEyeColor)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Statistics:</span></span>
<span><span class="co">##                       X^2 df P(&gt; X^2)</span></span>
<span><span class="co">## Likelihood Ratio 156.6779 18        0</span></span>
<span><span class="co">## Pearson          147.9440 18        0</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Joint independence model.  </span></span>
<span><span class="va">hec.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></span><span class="op">(</span><span class="op">~</span><span class="va">Hair</span><span class="op">*</span><span class="va">Eye</span> <span class="op">+</span> <span class="va">Sex</span>, data<span class="op">=</span><span class="va">HairEyeColor</span><span class="op">)</span></span>
<span><span class="va">hec.3</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## loglm(formula = ~Hair * Eye + Sex, data = HairEyeColor)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Statistics:</span></span>
<span><span class="co">##                       X^2 df  P(&gt; X^2)</span></span>
<span><span class="co">## Likelihood Ratio 19.85656 15 0.1775045</span></span>
<span><span class="co">## Pearson          19.56712 15 0.1891745</span></span></code></pre></div>
<p>Note that printing the model gives a brief summary of the goodness of
fit. A set of models can be compared using the <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code>
function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">hec.1</span>, <span class="va">hec.2</span>, <span class="va">hec.3</span><span class="op">)</span></span>
<span><span class="co">## LR tests for hierarchical log-linear models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1:</span></span>
<span><span class="co">##  ~Hair + Eye + Sex </span></span>
<span><span class="co">## Model 2:</span></span>
<span><span class="co">##  ~(Hair + Eye) * Sex </span></span>
<span><span class="co">## Model 3:</span></span>
<span><span class="co">##  ~Hair * Eye + Sex </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##            Deviance df Delta(Dev) Delta(df) P(&gt; Delta(Dev)</span></span>
<span><span class="co">## Model 1   166.30014 24                                    </span></span>
<span><span class="co">## Model 2   156.67789 18    9.62225         6        0.14149</span></span>
<span><span class="co">## Model 3    19.85656 15  136.82133         3        0.00000</span></span>
<span><span class="co">## Saturated   0.00000  0   19.85656        15        0.17750</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec:glm">Fitting with <code>glm()</code> and <code>gnm()</code><a class="anchor" aria-label="anchor" href="#sec:glm"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> approach, and extensions of this in the
<code>gnm</code> package allows a much wider class of models for
frequency data to be fit than can be handled by <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm()</a></code>. Of
particular importance are models for ordinal factors and for square
tables, where we can test more structured hypotheses about the patterns
of association than are provided in the tests of general association
under <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm()</a></code>. These are similar in spirit to the
non-parametric CMH tests described in .</p>
<p><strong><em>Example</em></strong>: The data <code>Mental</code> in
the <code>vcdExtra</code> package gives a two-way table in frequency
form classifying young people by their mental health status and parents’
socioeconomic status (SES), where both of these variables are ordered
factors.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    24 obs. of  3 variables:</span></span>
<span><span class="co">##  $ ses   : Ord.factor w/ 6 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 1 1 1 1 2 2 2 2 3 3 ...</span></span>
<span><span class="co">##  $ mental: Ord.factor w/ 4 levels "Well"&lt;"Mild"&lt;..: 1 2 3 4 1 2 3 4 1 2 ...</span></span>
<span><span class="co">##  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span>, data<span class="op">=</span><span class="va">Mental</span><span class="op">)</span>   <span class="co"># display the frequency table</span></span>
<span><span class="co">##           ses</span></span>
<span><span class="co">## mental       1   2   3   4   5   6</span></span>
<span><span class="co">##   Well      64  57  57  72  36  21</span></span>
<span><span class="co">##   Mild      94  94 105 141  97  71</span></span>
<span><span class="co">##   Moderate  58  54  65  77  54  54</span></span>
<span><span class="co">##   Impaired  46  40  60  94  78  71</span></span></code></pre></div>
<p>Simple ways of handling ordinal variables involve assigning scores to
the table categories, and the simplest cases are to use integer scores,
either for the row variable
(<code>column effects'' model), the column variable (</code>row
effects’’ model), or both (``uniform association’’ model).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span>, family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span>  <span class="co"># independence model</span></span></code></pre></div>
<p>To fit more parsimonious models than general association, we can
define numeric scores for the row and column categories</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use integer scores for rows/cols </span></span>
<span><span class="va">Cscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span></span>
<span><span class="va">Rscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">mental</span><span class="op">)</span> </span></code></pre></div>
<p>Then, the row effects model, the column effects model, and the
uniform association model can be fit as follows. The essential idea is
to replace a factor variable with its numeric equivalent in the model
formula for the association term.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># column effects model (ses)</span></span>
<span><span class="va">coleff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">Rscore</span><span class="op">:</span><span class="va">ses</span>, family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># row effects model (mental)</span></span>
<span><span class="va">roweff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">mental</span><span class="op">:</span><span class="va">Cscore</span>, family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># linear x linear association</span></span>
<span><span class="va">linlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">Rscore</span><span class="op">:</span><span class="va">Cscore</span>, family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/LRstats.html">LRstats()</a></code> function in <code>vcdExtra</code> provides
a nice, compact summary of the fit statistics for a set of models,
collected into a <em>glmlist</em> object. Smaller is better for AIC and
BIC.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare models using AIC, BIC, etc</span></span>
<span><span class="fu">vcdExtra</span><span class="fu">::</span><span class="fu"><a href="../reference/LRstats.html">LRstats</a></span><span class="op">(</span><span class="fu"><a href="../reference/glmlist.html">glmlist</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">roweff</span>, <span class="va">coleff</span>, <span class="va">linlin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Likelihood summary table:</span></span>
<span><span class="co">##           AIC    BIC LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## indep  209.59 220.19   47.418 15  3.155e-05 ***</span></span>
<span><span class="co">## roweff 174.45 188.59    6.281 12     0.9013    </span></span>
<span><span class="co">## coleff 179.00 195.50    6.829 10     0.7415    </span></span>
<span><span class="co">## linlin 174.07 185.85    9.895 14     0.7698    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>For specific model comparisons, we can also carry out tests of
<em>nested</em> models with <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> when those models are
listed from smallest to largest. Here, there are two separate paths from
the most restrictive (independence) model through the model of uniform
association, to those that allow only one of row effects or column
effects.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">linlin</span>, <span class="va">coleff</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span>  </span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Freq ~ mental + ses</span></span>
<span><span class="co">## Model 2: Freq ~ mental + ses + Rscore:Cscore</span></span>
<span><span class="co">## Model 3: Freq ~ mental + ses + Rscore:ses</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        15     47.418                          </span></span>
<span><span class="co">## 2        14      9.895  1   37.523 9.035e-10 ***</span></span>
<span><span class="co">## 3        10      6.829  4    3.066    0.5469    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">linlin</span>, <span class="va">roweff</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span>  </span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Freq ~ mental + ses</span></span>
<span><span class="co">## Model 2: Freq ~ mental + ses + Rscore:Cscore</span></span>
<span><span class="co">## Model 3: Freq ~ mental + ses + mental:Cscore</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        15     47.418                          </span></span>
<span><span class="co">## 2        14      9.895  1   37.523 9.035e-10 ***</span></span>
<span><span class="co">## 3        12      6.281  2    3.614    0.1641    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The model of linear by linear association seems best on all accounts.
For comparison, one might try the CMH tests on these data:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CMHtest.html">CMHtest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">~</span><span class="va">ses</span><span class="op">+</span><span class="va">mental</span>, data<span class="op">=</span><span class="va">Mental</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Cochran-Mantel-Haenszel Statistics for ses by mental </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                  AltHypothesis  Chisq Df       Prob</span></span>
<span><span class="co">## cor        Nonzero correlation 37.156  1 1.0907e-09</span></span>
<span><span class="co">## rmeans  Row mean scores differ 40.297  5 1.3012e-07</span></span>
<span><span class="co">## cmeans  Col mean scores differ 40.666  3 7.6971e-09</span></span>
<span><span class="co">## general    General association 45.958 15 5.4003e-05</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="non-linear-terms">Non-linear terms<a class="anchor" aria-label="anchor" href="#non-linear-terms"></a>
</h2>
<p>The strength of the <code>gnm</code> package is that it handles a
wide variety of models that handle non-linear terms, where the
parameters enter the model beyond a simple linear function. The simplest
example is the Goodman RC(1) model <span class="citation">(Goodman,
1979)</span>, which allows a multiplicative term to account for the
association of the table variables. In the notation of generalized
linear models with a log link, this can be expressed as</p>
<p><span class="math display">\[ \log \mu_{ij} = \alpha_i + \beta_j +
\gamma_{i} \delta_{j}   ,\]</span></p>
<p>where the row-multiplicative effect parameters <span class="math inline">\(\gamma_i\)</span> and corresponding column
parameters <span class="math inline">\(\delta_j\)</span> are estimated
from the data.% <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This is similar in spirit to a correspondence analysis
with a single dimension, but as a statistical model.&lt;/p&gt;"><sup>2</sup></a></p>
<p>Similarly, the RC(2) model adds two multiplicative terms to the
independence model,</p>
<p><span class="math display">\[ \log \mu_{ij} = \alpha_i + \beta_j +
\gamma_{i1} \delta_{j1} + \gamma_{i2} \delta_{j2} . \]</span></p>
<p>In the <code>gnm</code> package, these models may be fit using the
<code><a href="https://rdrr.io/pkg/gnm/man/Mult.html" class="external-link">Mult()</a></code> to specify the multiplicative term, and
<code><a href="https://rdrr.io/pkg/gnm/man/instances.html" class="external-link">instances()</a></code> to specify several such terms.</p>
<p><strong><em>Example</em></strong>: For the <code>Mental</code> data,
we fit the RC(1) and RC(2) models, and compare these with the
independence model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RC1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link">gnm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Mult.html" class="external-link">Mult</a></span><span class="op">(</span><span class="va">mental</span>,<span class="va">ses</span><span class="op">)</span>, data<span class="op">=</span><span class="va">Mental</span>, </span>
<span>             family<span class="op">=</span><span class="va">poisson</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">RC2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link">gnm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span><span class="op">+</span><span class="va">ses</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/gnm/man/instances.html" class="external-link">instances</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gnm/man/Mult.html" class="external-link">Mult</a></span><span class="op">(</span><span class="va">mental</span>,<span class="va">ses</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">Mental</span>, </span>
<span>             family<span class="op">=</span><span class="va">poisson</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">RC1</span>, <span class="va">RC2</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Freq ~ mental + ses</span></span>
<span><span class="co">## Model 2: Freq ~ mental + ses + Mult(mental, ses)</span></span>
<span><span class="co">## Model 3: Freq ~ mental + ses + Mult(mental, ses, inst = 1) + Mult(mental, </span></span>
<span><span class="co">##     ses, inst = 2)</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        15     47.418                         </span></span>
<span><span class="co">## 2         9     40.230  6    7.188   0.3038    </span></span>
<span><span class="co">## 3         3      0.523  6   39.707  5.2e-07 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Goodman:79" class="csl-entry">
Goodman, L. A. (1979). Simple models for the analysis of association in
cross-classifications having ordered categories. <em>Journal of the
American Statistical Association</em>, <em>74</em>, 537–552.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
