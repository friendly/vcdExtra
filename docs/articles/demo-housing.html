<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="vcdExtra">
<title>Demo - Housing Data • vcdExtra</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Demo - Housing Data">
<meta property="og:description" content="vcdExtra">
<meta property="og:image" content="http://friendly.github.io/vcdExtra/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/continuous.html">Continuous predictors</a>
    <a class="dropdown-item" href="../articles/creating.html">Creating and manipulating frequency tables</a>
    <a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a>
    <a class="dropdown-item" href="../articles/demo-housing.html">Demo - Housing Data</a>
    <a class="dropdown-item" href="../articles/loglinear.html">Loglinear Models</a>
    <a class="dropdown-item" href="../articles/mobility.html">Mobility tables</a>
    <a class="dropdown-item" href="../articles/mosaics.html">Mosaic plots</a>
    <a class="dropdown-item" href="../articles/tests.html">Tests of Independence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Demo - Housing Data</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly</h4>
            
            <h4 data-toc-skip class="date">2023-04-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/vcdExtra/blob/HEAD/vignettes/demo-housing.Rmd" class="external-link"><code>vignettes/demo-housing.Rmd</code></a></small>
      <div class="d-none name"><code>demo-housing.Rmd</code></div>
    </div>

    
    
<p>This vignette was one of a series of <code><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo()</a></code> files in the
package. It is still there as <code>demo("housing")</code>, but is now
presented here with additional commentary and analysis, designed to
highlight some aspects of analysis of categorical data and graphical
display.</p>
<div class="section level2">
<h2 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h2>
<p>I’ll use the following packages in this vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://friendly.github.io/vcdExtra/" class="external-link">vcdExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org" class="external-link">effects</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="housing-data">Housing data<a class="anchor" aria-label="anchor" href="#housing-data"></a>
</h2>
<p>The content here is the dataset <code><a href="https://rdrr.io/pkg/MASS/man/housing.html" class="external-link">MASS::housing</a></code>, giving a
4-way, <span class="math inline">\(3 \times 3 \times 4 \times 2\)</span>
frequency table of 1681 individuals from the <em>Copenhagen Housing
Conditions Survey</em>, classified by their:</p>
<ul>
<li>Satisfaction (<code>Sat</code>) with their housing circumstances
(low, medium or high),</li>
<li>
<code>Type</code> of rental dwelling (Tower, Apartment, Atrium or
Terrace)</li>
<li>perceived influence (<code>Infl</code>) on management of the
property (low, medium, high), and</li>
<li>degree of contact (<code>Cont</code>) with other residents (low or
high)</li>
</ul>
<p>Load the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">housing</span>, package<span class="op">=</span><span class="st">"MASS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">housing</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    72 obs. of  5 variables:</span></span>
<span><span class="co">##  $ Sat : Ord.factor w/ 3 levels "Low"&lt;"Medium"&lt;..: 1 2 3 1 2 3 1 2 3 1 ...</span></span>
<span><span class="co">##  $ Infl: Factor w/ 3 levels "Low","Medium",..: 1 1 1 2 2 2 3 3 3 1 ...</span></span>
<span><span class="co">##  $ Type: Factor w/ 4 levels "Tower","Apartment",..: 1 1 1 1 1 1 1 1 1 2 ...</span></span>
<span><span class="co">##  $ Cont: Factor w/ 2 levels "Low","High": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Freq: int  21 21 28 34 22 36 10 11 36 61 ...</span></span></code></pre></div>
<div class="section level3">
<h3 id="variables-levels-and-models">Variables, levels and models<a class="anchor" aria-label="anchor" href="#variables-levels-and-models"></a>
</h3>
<p>Satisfaction (<code>Sat</code>) of these householders with their
present housing circumstances is the <strong>outcome variable</strong>
here.</p>
<p>For purposes of analysis, note that <code>Sat</code> is an ordered
factor with levels <code>"Low" &lt; "Medium" &lt; "High"</code>.</p>
<p>Note also that Influence, with the same levels is just a “Factor”,
not an ordered one.</p>
<p>I consider here just models using
<code>glm(..., family=poisson)</code> or the equivalent in
<code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">MASS::loglm()</a></code>.</p>
<p>The ordering of factor levels is important in graphical displays. We
don’t want to see them ordered alphabetically, “High”, “Low”, “Medium”.
The <code>housing</code> data.frame was constructed so that the levels
of <code>Sat</code> and <code>Infl</code> appear in the dataset in their
appropriate order.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">housing</span><span class="op">$</span><span class="va">Sat</span><span class="op">)</span></span>
<span><span class="co">## [1] "Low"    "Medium" "High"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">housing</span><span class="op">$</span><span class="va">Infl</span><span class="op">)</span></span>
<span><span class="co">## [1] "Low"    "Medium" "High"</span></span></code></pre></div>
<p>Other models, e.g., the <strong>proportional odds</strong> model, fit
using <code>MASS:polr()</code> can take the ordinal nature of
satisfaction into account. In <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> one could re-assign
<code>Infl</code> as an ordered factor and examine linear vs. non-linear
associations for this factor. But I don’t do this here.</p>
</div>
</div>
<div class="section level2">
<h2 id="null-model">Null model<a class="anchor" aria-label="anchor" href="#null-model"></a>
</h2>
<p>The most ignorant model asserts that all the table factors are
mutually independent. In symbolic notation, this is
<code>[S] [I] [T] [C]</code> where all terms in separate
<code>[ ]</code> are supposed to be independent. This is
<code>Freq ~ Sat + Infl + Type + Cont</code> as a formula for
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house.null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Sat</span> <span class="op">+</span> <span class="va">Infl</span> <span class="op">+</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Cont</span>, family <span class="op">=</span> <span class="va">poisson</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">housing</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="baseline-model">Baseline model<a class="anchor" aria-label="anchor" href="#baseline-model"></a>
</h2>
<p>When <code>Sat</code> is the outcome variable, a minimal
<strong>baseline model</strong> should allow for all associations among
the predictors, symbolized as <code>[S] [I T C]</code>. That is,
Influence, Type and Contact may be associated in arbitrary ways, just as
multiple predictors can be correlated in regression models.</p>
<p>In this framework, what remains to be explained is whether/how
<code>Sat</code> depends on the combinations of the other variables. The
baseline model therefore includes the full three-way term for the
predictors.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house.glm0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Sat</span> <span class="op">+</span> <span class="va">Infl</span><span class="op">*</span><span class="va">Type</span><span class="op">*</span><span class="va">Cont</span>, family <span class="op">=</span> <span class="va">poisson</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">housing</span><span class="op">)</span></span></code></pre></div>
<p>Both of these models fit terribly, but we can always use
<code>anova(mod1, mod2,...)</code> to compare the <em>relative</em> fits
of <strong>nested</strong> models.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">house.null</span>, <span class="va">house.glm0</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Freq ~ Sat + Infl + Type + Cont</span></span>
<span><span class="co">## Model 2: Freq ~ Sat + Infl * Type * Cont</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        63     295.35                          </span></span>
<span><span class="co">## 2        46     217.46 17   77.896 9.045e-10 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualising-model-fit">Visualising model fit<a class="anchor" aria-label="anchor" href="#visualising-model-fit"></a>
</h2>
<p>The baseline model is shown in the mosaic plot below. Note that this
is applied not to the <code>housing</code> data, but rather to the
<code>house.glm0</code> object (of class <code>glm</code>) resulting to
a call to <code><a href="../reference/mosaic.glm.html">vcdExtra::mosaic.glm()</a></code>.</p>
<p>With four variables in the mosaic, labeling of the variable names and
factor levels is a bit tricky, because labels must appear on all four
sides of the plot. The <code>labeling_args</code> argument can be used
to set more informative variable names and abbreviate factor levels
where necessary.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># labeling_args for mosaic()</span></span>
<span><span class="va">largs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>set_varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      Infl<span class="op">=</span><span class="st">"Influence on management"</span>, </span>
<span>            Cont<span class="op">=</span><span class="st">"Contact among residents"</span>, </span>
<span>            Type<span class="op">=</span><span class="st">"Type of dwelling"</span>, </span>
<span>            Sat<span class="op">=</span><span class="st">"Satisfaction"</span><span class="op">)</span>,</span>
<span>    abbreviate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Type<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">house.glm0</span>, </span>
<span>       labeling_args<span class="op">=</span><span class="va">largs</span>, </span>
<span>       main<span class="op">=</span><span class="st">'Baseline model: [ITC][Sat]'</span><span class="op">)</span></span>
<span><span class="co">## Warning: no formula provided, assuming ~Sat + Infl + Type + Cont</span></span></code></pre></div>
<p><img src="fig/demo-housing-mosaic-glm0a-1.png" width="672"></p>
<p>In this plot we can see largish <span style="color: blue;">positive
residuals</span> in the blocks corresponding to (low satisfaction, low
influence) and (high satisfaction, high influence) and clusters of
largish <span style="color: red;">negative residuals</span> in the
opposite corners.</p>
<p>By default, variables are used in the mosaic display in their order
in the data table or frequency data.frame. The <span style="color: red;">warning</span> reminds us that the order of
conditioning used is <code>~Sat + Infl + Type + Cont</code>.</p>
<div class="section level3">
<h3 id="ordering-the-variables-in-the-mosaic">Ordering the variables in the mosaic<a class="anchor" aria-label="anchor" href="#ordering-the-variables-in-the-mosaic"></a>
</h3>
<p>For <code><a href="../reference/mosaic.glm.html">mosaic.glm()</a></code>, the conditioning order of variables in
the mosaic can be set using the <code>formula</code> argument. Here, I
rearrange the variables to put <code>Sat</code> as the last variable in
the splitting / conditioning sequence. I also use
<code><a href="../reference/modFit.html">vcdExtra::modFit()</a></code> to add the LR <span class="math inline">\(G^2\)</span> fit statistic to the plot title.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">house.glm0</span>, </span>
<span>       formula <span class="op">=</span> <span class="op">~</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Infl</span> <span class="op">+</span> <span class="va">Cont</span> <span class="op">+</span> <span class="va">Sat</span>, </span>
<span>       labeling_args<span class="op">=</span><span class="va">largs</span>, </span>
<span>       main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Baseline model: [ITC][Sat],'</span>, <span class="fu"><a href="../reference/modFit.html">modFit</a></span><span class="op">(</span><span class="va">house.glm0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="fig/demo-housing-mosaic-glm0b-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-association-terms">Adding association terms<a class="anchor" aria-label="anchor" href="#adding-association-terms"></a>
</h2>
<p>Clearly, satisfaction depends on one or more of the predictors,
<code>Infl</code>, <code>Type</code> and <code>Cont</code> and possibly
their interactions.</p>
<p>As a first step it is useful to consider sequentially adding the
association terms <code>Infl:Sat</code>, <code>Type:Sat</code>,
<code>Cont:Sat</code> one at a time. This analysis is carried out using
<code><a href="https://rdrr.io/pkg/MASS/man/addterm.html" class="external-link">MASS::addterm()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/addterm.html" class="external-link">addterm</a></span><span class="op">(</span><span class="va">house.glm0</span>, </span>
<span>              <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Sat</span><span class="op">:</span><span class="op">(</span><span class="va">Infl</span> <span class="op">+</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Cont</span><span class="op">)</span>, </span>
<span>              test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Single term additions</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model:</span></span>
<span><span class="co">## Freq ~ Sat + Infl * Type * Cont</span></span>
<span><span class="co">##          Df Deviance    AIC     LRT   Pr(Chi)    </span></span>
<span><span class="co">## &lt;none&gt;        217.46 610.43                      </span></span>
<span><span class="co">## Sat:Infl  4   111.08 512.05 106.371 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## Sat:Type  6   156.79 561.76  60.669 3.292e-11 ***</span></span>
<span><span class="co">## Sat:Cont  2   212.33 609.30   5.126   0.07708 .  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Based on this, it is useful to consider a “main-effects” model for
satisfaction, adding all three two-way terms involving satisfaction.</p>
<p>The <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> method provides an easy way to add (or
subtract) terms from a fitted model object. In the model formula,
<code>.</code> stands for whatever was on the left side
(<code>Freq</code>) or on the right side
(<code>Sat + Infl*Type*Cont</code>) of the model
(<code>house.glm0</code>) that is being updated.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house.glm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">house.glm0</span>, </span>
<span>                     <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Sat</span><span class="op">*</span><span class="op">(</span><span class="va">Infl</span> <span class="op">+</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Cont</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For comparison, we note that the same model can be fit using the
iterative proportional scaling algorithm of
<code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">MASS::loglm()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">house.loglm1</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">loglm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">Infl</span> <span class="op">*</span> <span class="va">Type</span> <span class="op">*</span> <span class="va">Cont</span> <span class="op">+</span> </span>
<span>                              <span class="va">Sat</span><span class="op">*</span><span class="op">(</span><span class="va">Infl</span> <span class="op">+</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Cont</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">housing</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## MASS::loglm(formula = Freq ~ Infl * Type * Cont + Sat * (Infl + </span></span>
<span><span class="co">##     Type + Cont), data = housing)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Statistics:</span></span>
<span><span class="co">##                       X^2 df  P(&gt; X^2)</span></span>
<span><span class="co">## Likelihood Ratio 38.66222 34 0.2671359</span></span>
<span><span class="co">## Pearson          38.90831 34 0.2582333</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="did-the-model-get-better">Did the model get better?<a class="anchor" aria-label="anchor" href="#did-the-model-get-better"></a>
</h2>
<p>As before, <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> tests the added contribution of each
more complex model over the one before. The residual deviance <span class="math inline">\(G^2\)</span> has been reduced from <span class="math inline">\(G^2 (46) = 217.46\)</span> for the baseline model
<code>house.glm0</code> to <span class="math inline">\(G^2 (34) =
38.66\)</span> for the revised model <code>house.glm1</code>. The
difference, <span class="math inline">\(G^2(M1 | M0) = G^2 (12) =
178.79\)</span> tests the collective additional fit provided by the
two-way association of satisfaction with the predictors.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">house.glm0</span>, <span class="va">house.glm1</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Freq ~ Sat + Infl * Type * Cont</span></span>
<span><span class="co">## Model 2: Freq ~ Sat + Infl + Type + Cont + Infl:Type + Infl:Cont + Type:Cont + </span></span>
<span><span class="co">##     Sat:Infl + Sat:Type + Sat:Cont + Infl:Type:Cont</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        46    217.456                          </span></span>
<span><span class="co">## 2        34     38.662 12   178.79 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-model-glm1">Visualize model <code>glm1</code><a class="anchor" aria-label="anchor" href="#visualize-model-glm1"></a>
</h2>
<p>The model <code>house.glm1</code> fits reasonably well,
G^2(34)=38.66, so most residuals are small. In the mosaic below, I use
<code>gp=shading_Friendly</code> to shade the tiles so that positive and
negative residuals are distinguished by color, and they are filled when
the absolute value of the residual is outside <span class="math inline">\(\pm 2, 4\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span><span class="va">house.glm1</span>, </span>
<span>       labeling_args<span class="op">=</span><span class="va">largs</span>, </span>
<span>       main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Model [IS][TS][CS],'</span>, <span class="fu"><a href="../reference/modFit.html">modFit</a></span><span class="op">(</span><span class="va">house.glm1</span><span class="op">)</span> <span class="op">)</span>, </span>
<span>       gp<span class="op">=</span><span class="va">shading_Friendly</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/demo-housing-mosaic-glm1-1.png" width="672"></p>
<p>One cell is highlighted here: The combination of medium influence,
low contact and tower type, is more likely to give low satisfaction than
the model predicts. Is this just an outlier, or is there something that
can be interpreted and perhaps improve the model fit? It is hard tell,
but the virtues of mosaic displays are that they help to:</p>
<ul>
<li>diagnose overall patterns of associations,</li>
<li>spot unusual cells in relation to lack of fit of a given model.</li>
</ul>
</div>
<div class="section level2">
<h2 id="can-we-drop-any-terms">Can we drop any terms?<a class="anchor" aria-label="anchor" href="#can-we-drop-any-terms"></a>
</h2>
<p>When we add terms using <code><a href="https://rdrr.io/pkg/MASS/man/addterm.html" class="external-link">MASS::addterm()</a></code>, they are added
sequentially. It might be the case that once some term is added, a
previously added term is no longer important. Running
<code><a href="https://rdrr.io/pkg/MASS/man/dropterm.html" class="external-link">MASS::dropterm()</a></code> on the <code>housel.glm1</code> model
checks for this.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/dropterm.html" class="external-link">dropterm</a></span><span class="op">(</span><span class="va">house.glm1</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Single term deletions</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model:</span></span>
<span><span class="co">## Freq ~ Sat + Infl + Type + Cont + Infl:Type + Infl:Cont + Type:Cont + </span></span>
<span><span class="co">##     Sat:Infl + Sat:Type + Sat:Cont + Infl:Type:Cont</span></span>
<span><span class="co">##                Df Deviance    AIC     LRT   Pr(Chi)    </span></span>
<span><span class="co">## &lt;none&gt;              38.662 455.63                      </span></span>
<span><span class="co">## Sat:Infl        4  147.780 556.75 109.117 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## Sat:Type        6  100.889 505.86  62.227 1.586e-11 ***</span></span>
<span><span class="co">## Sat:Cont        2   54.722 467.69  16.060 0.0003256 ***</span></span>
<span><span class="co">## Infl:Type:Cont  6   43.952 448.92   5.290 0.5072454    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Note that the three-way term <code>Infl:Type:Cont</code> is not
significant. However, with <code>Sat</code> as the response, the
associations of all predictors must be included in the model.</p>
</div>
<div class="section level2">
<h2 id="what-about-two-way-interactions">What about two-way interactions?<a class="anchor" aria-label="anchor" href="#what-about-two-way-interactions"></a>
</h2>
<p>The model so far says that each of influence, type and control have
separate, additive effects on the level of satisfaction, what I called a
“main-effects” model. It might be the case that some of the predictors
have <em>interaction</em> effects, e.g., that the effect of influence on
satisfaction might vary with the type of dwelling or the level of
control.</p>
<p>An easy way to test for these is to update the main-effects model,
adding all possible two-way interactions for <code>Sat</code>, one at a
time, with <code><a href="https://rdrr.io/pkg/MASS/man/addterm.html" class="external-link">addterm()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/addterm.html" class="external-link">addterm</a></span><span class="op">(</span><span class="va">house.glm1</span>,</span>
<span>               <span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">Sat</span><span class="op">:</span><span class="op">(</span><span class="va">Infl</span> <span class="op">+</span> <span class="va">Type</span> <span class="op">+</span> <span class="va">Cont</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>              test  <span class="op">=</span>  <span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Single term additions</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model:</span></span>
<span><span class="co">## Freq ~ Sat + Infl + Type + Cont + Infl:Type + Infl:Cont + Type:Cont + </span></span>
<span><span class="co">##     Sat:Infl + Sat:Type + Sat:Cont + Infl:Type:Cont</span></span>
<span><span class="co">##               Df Deviance    AIC     LRT Pr(Chi)  </span></span>
<span><span class="co">## &lt;none&gt;             38.662 455.63                  </span></span>
<span><span class="co">## Sat:Infl:Type 12   16.107 457.08 22.5550 0.03175 *</span></span>
<span><span class="co">## Sat:Infl:Cont  4   37.472 462.44  1.1901 0.87973  </span></span>
<span><span class="co">## Sat:Type:Cont  6   28.256 457.23 10.4064 0.10855  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The result shows that adding the term <code>Infl:Type:Sat</code>
reduces the deviance <span class="math inline">\(G^2\)</span> from 38.66
to 16.11. The difference, <span class="math inline">\(G^2(M1 + ITS | M1)
= G^2 (12) = 22.55\)</span> reflects a substantial improvement. The
remaining two-way interaction terms reduce the deviance by smaller and
non-significant amounts, relative to <code>house.glm1</code>.</p>
<p>Model fitting should be guided by substance, not just statistical
machinery. Nonetheless, it seems arguably sensible to add one two-way
term to the model, giving <code>house.glm2</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house.glm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">house.glm1</span>,</span>
<span>                     <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Sat</span><span class="op">:</span><span class="va">Infl</span><span class="op">:</span><span class="va">Type</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-parsimony-aic-bic">Model parsimony: AIC &amp; BIC<a class="anchor" aria-label="anchor" href="#model-parsimony-aic-bic"></a>
</h2>
<p>Adding more association terms to a model will always improve it. The
question is, whether that is “worth it”?</p>
<p>“Worth it” concerns the trade-off between model fit and parsimony.
Sometimes we might prefer a model with fewer parameters to one that has
a slightly better fit, but requires more model terms and parameters.</p>
<p>The AIC and BIC statistics are designed to adjust our assessment of
model fit by penalizing it for using more parameters. Equivalently, they
deduct from the likelihood ratio <span class="math inline">\(G^2\)</span> a term proportional to the residual
<span class="math inline">\(\text{df}\)</span> of the model. In any case
– <strong>smaller is better</strong> for both AIC and BIC.</p>
<p><span class="math display">\[AIC = G^2 - 2 \: \text{df}\]</span>
<span class="math display">\[BIC = G^2 - \log(n) \:
\text{df}\]</span></p>
<p>These measures are provided by <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code>,
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC()</a></code>, and can be used to compare models using
<code><a href="../reference/LRstats.html">vcdExtra::LRstats()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/LRstats.html">LRstats</a></span><span class="op">(</span><span class="va">house.glm0</span>, <span class="va">house.glm1</span>, <span class="va">house.glm2</span><span class="op">)</span></span>
<span><span class="co">## Likelihood summary table:</span></span>
<span><span class="co">##               AIC    BIC LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## house.glm0 610.43 669.62  217.456 46     &lt;2e-16 ***</span></span>
<span><span class="co">## house.glm1 455.63 542.15   38.662 34     0.2671    </span></span>
<span><span class="co">## house.glm2 457.08 570.91   16.107 22     0.8105    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>By these metrics, model <code>house.glm1</code> is best on both AIC
and BIC. The increased goodness-of-fit (smaller <span class="math inline">\(G^2\)</span>) of model <code>house.glm2</code> is
not worth the extra cost of parameters in the <code>house.glm2</code>
model.</p>
<!-- ## Effect plots -->
<!-- ```{r} -->
<!-- house.eff <-allEffects(house.glm1) -->
<!-- ``` -->
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
