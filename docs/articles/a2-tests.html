<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2. Tests of Independence • vcdExtra</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Tests of Independence">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="../articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="../articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="../articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="../articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="../articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="../articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="../articles/datasets.html">Datasets for categorical data analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2. Tests of Independence</h1>
                        <h4 data-toc-skip class="author">Michael
Friendly</h4>
            
            <h4 data-toc-skip class="date">2024-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/vcdExtra/blob/HEAD/vignettes/a2-tests.Rmd" class="external-link"><code>vignettes/a2-tests.Rmd</code></a></small>
      <div class="d-none name"><code>a2-tests.Rmd</code></div>
    </div>

    
    
<p>OK, now we’re ready to do some analyses. This vignette focuses on
relatively simple non-parametric tests and measures of association.</p>
<div class="section level2">
<h2 id="crosstable">CrossTable<a class="anchor" aria-label="anchor" href="#crosstable"></a>
</h2>
<p>For tabular displays, the <code><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html" class="external-link">CrossTable()</a></code> function in the
<code>gmodels</code> package produces cross-tabulations modeled after
<code>PROC FREQ</code> in SAS or <code>CROSSTABS</code> in SPSS. It has
a wealth of options for the quantities that can be shown in each
cell.</p>
<p>Recall the GSS data used earlier.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Agresti (2002), table 3.11, p. 106</span></span>
<span><span class="va">GSS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span>, </span>
<span>              party <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dem"</span>, <span class="st">"indep"</span>, <span class="st">"rep"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">279</span>,<span class="fl">165</span>,<span class="fl">73</span>,<span class="fl">47</span>,<span class="fl">225</span>,<span class="fl">191</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">GSStab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">party</span>, data<span class="op">=</span><span class="va">GSS</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##         party</span></span>
<span><span class="co">## sex      dem indep rep</span></span>
<span><span class="co">##   female 279    73 225</span></span>
<span><span class="co">##   male   165    47 191</span></span></code></pre></div>
<p>Generate a cross-table showing cell frequency and the cell
contribution to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2-Way Cross Tabulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-gregmisc/gmodels" class="external-link">gmodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html" class="external-link">CrossTable</a></span><span class="op">(</span><span class="va">GSStab</span>, prop.t<span class="op">=</span><span class="cn">FALSE</span>, prop.r<span class="op">=</span><span class="cn">FALSE</span>, prop.c<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##    Cell Contents</span></span>
<span><span class="co">## |-------------------------|</span></span>
<span><span class="co">## |                       N |</span></span>
<span><span class="co">## | Chi-square contribution |</span></span>
<span><span class="co">## |-------------------------|</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Total Observations in Table:  980 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##              | party </span></span>
<span><span class="co">##          sex |       dem |     indep |       rep | Row Total | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|-----------|</span></span>
<span><span class="co">##       female |       279 |        73 |       225 |       577 | </span></span>
<span><span class="co">##              |     1.183 |     0.078 |     1.622 |           | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|-----------|</span></span>
<span><span class="co">##         male |       165 |        47 |       191 |       403 | </span></span>
<span><span class="co">##              |     1.693 |     0.112 |     2.322 |           | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|-----------|</span></span>
<span><span class="co">## Column Total |       444 |       120 |       416 |       980 | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|-----------|</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span></code></pre></div>
<p>There are options to report percentages (row, column, cell), specify
decimal places, produce Chi-square, Fisher, and McNemar tests of
independence, report expected and residual values (pearson,
standardized, adjusted standardized), include missing values as valid,
annotate with row and column titles, and format as SAS or SPSS style
output! See <code><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html" class="external-link">help(CrossTable)</a></code> for details.</p>
</div>
<div class="section level2">
<h2 id="chi-square-test">Chi-square test<a class="anchor" aria-label="anchor" href="#chi-square-test"></a>
</h2>
<p>For 2-way tables you can use <code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test()</a></code> to test
independence of the row and column variable. By default, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
is calculated from the asymptotic chi-squared distribution of the test
statistic. Optionally, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
can be derived via Monte Carlo simulation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">HairEye</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/marginSums.html" class="external-link">margin.table</a></span><span class="op">(</span><span class="va">HairEyeColor</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##        Eye</span></span>
<span><span class="co">## Hair    Brown Blue Hazel Green</span></span>
<span><span class="co">##   Black    68   20    15     5</span></span>
<span><span class="co">##   Brown   119   84    54    29</span></span>
<span><span class="co">##   Red      26   17    14    14</span></span>
<span><span class="co">##   Blond     7   94    10    16</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">HairEye</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  HairEye</span></span>
<span><span class="co">## X-squared = 138.29, df = 9, p-value &lt; 2.2e-16</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">HairEye</span>, simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test with simulated p-value (based on 2000</span></span>
<span><span class="co">##  replicates)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  HairEye</span></span>
<span><span class="co">## X-squared = 138.29, df = NA, p-value = 0.0004998</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec:Fisher">Fisher Exact Test<a class="anchor" aria-label="anchor" href="#sec:Fisher"></a>
</h2>
<p><code>fisher.test(X)</code> provides an <strong>exact test</strong>
of independence. <code>X</code> must be a two-way contingency table in
table form. Another form, <code>fisher.test(X, Y)</code> takes two
categorical vectors of the same length.<br>
For tables larger than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math>
the method can be computationally intensive (or can fail) if the
frequencies are not small.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">GSStab</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  GSStab</span></span>
<span><span class="co">## p-value = 0.03115</span></span>
<span><span class="co">## alternative hypothesis: two.sided</span></span></code></pre></div>
<p>Fisher’s test is meant for tables with small total sample size. It
generates an error for the <code>HairEye</code> data with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>=592
total frequency.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">HairEye</span><span class="op">)</span></span>
<span><span class="co">## Error in fisher.test(HairEye): FEXACT error 6 (f5xact).  LDKEY=618 is too small for this problem: kval=238045028.</span></span>
<span><span class="co">## Try increasing the size of the workspace.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec:mantel">Mantel-Haenszel test and conditional association<a class="anchor" aria-label="anchor" href="#sec:mantel"></a>
</h2>
<p>Use the <code>mantelhaen.test(X)</code> function to perform a
Cochran-Mantel-Haenszel
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
chi test of the null hypothesis that two nominal variables are
<em>conditionally independent</em>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊥</mo><mi>B</mi><mspace width="0.278em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.278em"></mspace><mi>C</mi></mrow><annotation encoding="application/x-tex">A \perp B \; | \; C</annotation></semantics></math>,
in each stratum, assuming that there is no three-way interaction.
<code>X</code> is a 3 dimensional contingency table, where the last
dimension refers to the strata.</p>
<p>The <code>UCBAdmissions</code> serves as an example of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">2 \times 2 \times 6</annotation></semantics></math>
table, with <code>Dept</code> as the stratifying variable.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># UC Berkeley Student Admissions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/mantelhaen.test.html" class="external-link">mantelhaen.test</a></span><span class="op">(</span><span class="va">UCBAdmissions</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Mantel-Haenszel chi-squared test with continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  UCBAdmissions</span></span>
<span><span class="co">## Mantel-Haenszel X-squared = 1.4269, df = 1, p-value = 0.2323</span></span>
<span><span class="co">## alternative hypothesis: true common odds ratio is not equal to 1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.7719074 1.0603298</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## common odds ratio </span></span>
<span><span class="co">##         0.9046968</span></span></code></pre></div>
<p>The results show no evidence for association between admission and
gender when adjusted for department. However, we can easily see that the
assumption of equal association across the strata (no 3-way association)
is probably violated. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">2 \times 2 \times k</annotation></semantics></math>
tables, this can be examined from the odds ratios for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math>
table (<code><a href="https://rdrr.io/pkg/vcd/man/loddsratio.html" class="external-link">oddsratio()</a></code>), and tested by using
<code><a href="https://rdrr.io/pkg/vcd/man/woolf_test.html" class="external-link">woolf_test()</a></code> in <code>vcd</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/loddsratio.html" class="external-link">oddsratio</a></span><span class="op">(</span><span class="va">UCBAdmissions</span>, log<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">##  odds ratios for Admit and Gender by Dept </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##         A         B         C         D         E         F </span></span>
<span><span class="co">## 0.3492120 0.8025007 1.1330596 0.9212838 1.2216312 0.8278727</span></span>
<span></span>
<span><span class="va">lor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcd/man/loddsratio.html" class="external-link">oddsratio</a></span><span class="op">(</span><span class="va">UCBAdmissions</span><span class="op">)</span>  <span class="co"># capture log odds ratios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lor</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## z test of coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Estimate Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">## A -1.052076   0.262708 -4.0047 6.209e-05 ***</span></span>
<span><span class="co">## B -0.220023   0.437593 -0.5028    0.6151    </span></span>
<span><span class="co">## C  0.124922   0.143942  0.8679    0.3855    </span></span>
<span><span class="co">## D -0.081987   0.150208 -0.5458    0.5852    </span></span>
<span><span class="co">## E  0.200187   0.200243  0.9997    0.3174    </span></span>
<span><span class="co">## F -0.188896   0.305164 -0.6190    0.5359    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/woolf_test.html" class="external-link">woolf_test</a></span><span class="op">(</span><span class="va">UCBAdmissions</span><span class="op">)</span> </span>
<span><span class="co">## </span></span>
<span><span class="co">##  Woolf-test on Homogeneity of Odds Ratios (no 3-Way assoc.)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  UCBAdmissions</span></span>
<span><span class="co">## X-squared = 17.902, df = 5, p-value = 0.003072</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="some-plot-methods">Some plot methods<a class="anchor" aria-label="anchor" href="#some-plot-methods"></a>
</h2>
<div class="section level3">
<h3 id="fourfold-displays">Fourfold displays<a class="anchor" aria-label="anchor" href="#fourfold-displays"></a>
</h3>
<p>We can visualize the odds ratios of Admission for each department
with fourfold displays using <code><a href="https://rdrr.io/pkg/vcd/man/fourfold.html" class="external-link">fourfold()</a></code>. The cell
frequencies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">n_{ij}</annotation></semantics></math>
of each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times  2</annotation></semantics></math>
table are shown as a quarter circle whose radius is proportional to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><msub><mi>n</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msqrt><annotation encoding="application/x-tex">\sqrt{n_{ij}}</annotation></semantics></math>,
so that its area is proportional to the cell frequency.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UCB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/aperm.html" class="external-link">aperm</a></span><span class="op">(</span><span class="va">UCBAdmissions</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">UCB</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">UCB</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Admit?"</span>, <span class="st">"Department"</span><span class="op">)</span></span></code></pre></div>
<p>Confidence rings for the odds ratio allow a visual test of the null
of no association; the rings for adjacent quadrants overlap <em>iff</em>
the observed counts are consistent with the null hypothesis. In the
extended version (the default), brighter colors are used where the odds
ratio is significantly different from 1. The following lines produce
<span class="citation">(<strong>ref?</strong>)</span>(fig:fourfold1).
<!-- \footnote{The color values `col[3:4]` were modified from their default values -->
<!-- to show a greater contrast between significant and insignificant associations here.} --></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#99CCFF"</span>, <span class="st">"#6699CC"</span>, <span class="st">"#F9AFAF"</span>, <span class="st">"#6666A0"</span>, <span class="st">"#FF0000"</span>, <span class="st">"#000080"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/fourfold.html" class="external-link">fourfold</a></span><span class="op">(</span><span class="va">UCB</span>, mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, color<span class="op">=</span><span class="va">col</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="a2-tests_files/figure-html/fourfold1-1.png" alt="Fourfold display for the `UCBAdmissions` data. Where the odds ratio differs
    significantly from 1.0, the confidence bands do not overlap, and the circle quadrants are
    shaded more intensely." width="672"><p class="caption">
Fourfold display for the <code>UCBAdmissions</code> data. Where the odds
ratio differs significantly from 1.0, the confidence bands do not
overlap, and the circle quadrants are shaded more intensely.
</p>
</div>
<p>Another <code>vcd</code> function, <code><a href="https://rdrr.io/pkg/vcd/man/cotabplot.html" class="external-link">cotabplot()</a></code>, provides
a more general approach to visualizing conditional associations in
contingency tables, similar to trellis-like plots produced by
<code><a href="https://rdrr.io/r/graphics/coplot.html" class="external-link">coplot()</a></code> and lattice graphics. The <code>panel</code>
argument supplies a function used to render each conditional subtable.
The following gives a display (not shown) similar to <span class="citation">(<strong>ref?</strong>)</span>(fig:fourfold1).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/cotabplot.html" class="external-link">cotabplot</a></span><span class="op">(</span><span class="va">UCB</span>, panel <span class="op">=</span> <span class="va">cotab_fourfold</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="doubledecker-plots">Doubledecker plots<a class="anchor" aria-label="anchor" href="#doubledecker-plots"></a>
</h3>
<p>When we want to view the conditional probabilities of a response
variable (e.g., <code>Admit</code>) in relation to several factors, an
alternative visualization is a <code><a href="https://rdrr.io/pkg/vcd/man/doubledecker.html" class="external-link">doubledecker()</a></code> plot. This
plot is a specialized version of a mosaic plot, which highlights the
levels of a response variable (plotted vertically) in relation to the
factors (shown horizontally). The following call produces <span class="citation">(<strong>ref?</strong>)</span>(fig:doubledecker), where
we use indexing on the first factor (<code>Admit</code>) to make
<code>Admitted</code> the highlighted level.</p>
<p>In this plot, the association between <code>Admit</code> and
<code>Gender</code> is shown where the heights of the highlighted
conditional probabilities do not align. The excess of females admitted
in Dept A stands out here.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/doubledecker.html" class="external-link">doubledecker</a></span><span class="op">(</span><span class="va">Admit</span> <span class="op">~</span> <span class="va">Dept</span> <span class="op">+</span> <span class="va">Gender</span>, data<span class="op">=</span><span class="va">UCBAdmissions</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span>,,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="a2-tests_files/figure-html/doubledecker-1.png" alt="Doubledecker display for the `UCBAdmissions` data. The heights
    of the highlighted bars show the conditional probabilities of `Admit`,
    given `Dept` and `Gender`." width="75%"><p class="caption">
Doubledecker display for the <code>UCBAdmissions</code> data. The
heights of the highlighted bars show the conditional probabilities of
<code>Admit</code>, given <code>Dept</code> and <code>Gender</code>.
</p>
</div>
</div>
<div class="section level3">
<h3 id="odds-ratio-plots">Odds ratio plots<a class="anchor" aria-label="anchor" href="#odds-ratio-plots"></a>
</h3>
<p>Finally, the there is a <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for
<code>oddsratio</code> objects. By default, it shows the 95% confidence
interval for the log odds ratio. <span class="citation">(<strong>ref?</strong>)</span>(fig:oddsratio) is
produced by:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lor</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"Department"</span>, </span>
<span>     ylab<span class="op">=</span><span class="st">"Log Odds Ratio (Admit | Gender)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="a2-tests_files/figure-html/oddsratio-1.png" alt="Log odds ratio plot for the `UCBAdmissions` data." width="60%"><p class="caption">
Log odds ratio plot for the <code>UCBAdmissions</code> data.
</p>
</div>
<p>{#fig:oddsratio}</p>
</div>
</div>
<div class="section level2">
<h2 id="sec:CMH">Cochran-Mantel-Haenszel tests for ordinal factors<a class="anchor" aria-label="anchor" href="#sec:CMH"></a>
</h2>
<p>The standard
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
tests for association in a two-way table treat both table factors as
nominal (unordered) categories. When one or both factors of a two-way
table are quantitative or ordinal, more powerful tests of association
may be obtained by taking ordinality into account, using row and or
column scores to test for linear trends or differences in row or column
means.</p>
<p>More general versions of the CMH tests (Landis etal., 1978) <span class="citation">(Landis, Heyman, and Koch 1978)</span> are provided by
assigning numeric scores to the row and/or column variables. For
example, with two ordinal factors (assumed to be equally spaced),
assigning integer scores, <code>1:R</code> and <code>1:C</code> tests
the linear
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>×</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
linear component of association. This is statistically equivalent to the
Pearson correlation between the integer-scored table variables, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^2 = (n-1) r^2</annotation></semantics></math>,
with only 1
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">df</annotation></semantics></math>
rather than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(R-1)\times(C-1)</annotation></semantics></math>
for the test of general association.</p>
<p>When only one table variable is ordinal, these general CMH tests are
analogous to an ANOVA, testing whether the row mean scores or column
mean scores are equal, again consuming fewer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">df</annotation></semantics></math>
than the test of general association.</p>
<p>The <code><a href="../reference/CMHtest.html">CMHtest()</a></code> function in <code>vcdExtra</code>
calculates these various CMH tests for two possibly ordered factors,
optionally stratified other factor(s).</p>
<p><strong><em>Example</em></strong>:</p>
<p>Recall the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">4 \times 4</annotation></semantics></math>
table, <code>JobSat</code> introduced in @ref(sec:creating),</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">JobSat</span></span>
<span><span class="co">##         satisfaction</span></span>
<span><span class="co">## income   VeryD LittleD ModerateS VeryS</span></span>
<span><span class="co">##   &lt; 15k      1       3        10     6</span></span>
<span><span class="co">##   15-25k     2       3        10     7</span></span>
<span><span class="co">##   25-40k     1       6        14    12</span></span>
<span><span class="co">##   &gt; 40k      0       1         9    11</span></span></code></pre></div>
<p>Treating the <code>satisfaction</code> levels as equally spaced, but
using midpoints of the <code>income</code> categories as row scores
gives the following results:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CMHtest.html">CMHtest</a></span><span class="op">(</span><span class="va">JobSat</span>, rscores<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.5</span>,<span class="fl">20</span>,<span class="fl">32.5</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Cochran-Mantel-Haenszel Statistics for income by satisfaction </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                  AltHypothesis  Chisq Df     Prob</span></span>
<span><span class="co">## cor        Nonzero correlation 3.8075  1 0.051025</span></span>
<span><span class="co">## rmeans  Row mean scores differ 4.4774  3 0.214318</span></span>
<span><span class="co">## cmeans  Col mean scores differ 3.8404  3 0.279218</span></span>
<span><span class="co">## general    General association 5.9034  9 0.749549</span></span></code></pre></div>
<p>Note that with the relatively small cell frequencies, the test for
general give no evidence for association. However, the the
<code>cor</code> test for linear x linear association on 1 df is nearly
significant. The <code>coin</code> package contains the functions
<code>cmh_test()</code> and <code>lbl_test()</code> for CMH tests of
general association and linear x linear association respectively.</p>
</div>
<div class="section level2">
<h2 id="measures-of-association">Measures of Association<a class="anchor" aria-label="anchor" href="#measures-of-association"></a>
</h2>
<p>There are a variety of statistical measures of <em>strength</em> of
association for contingency tables— similar in spirit to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>r</mi><mn>2</mn></msup><annotation encoding="application/x-tex">r^2</annotation></semantics></math>
for continuous variables. With a large sample size, even a small degree
of association can show a significant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>,
as in the example below for the <code>GSS</code> data.</p>
<p>The <code><a href="https://rdrr.io/pkg/vcd/man/assocstats.html" class="external-link">assocstats()</a></code> function in <code>vcd</code> calculates
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
contingency coefficient, and Cramer’s V for an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>×</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">r \times c</annotation></semantics></math>
table. The input must be in table form, a two-way
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>×</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">r \times c</annotation></semantics></math>
table. It won’t work with <code>GSS</code> in frequency form, but by now
you should know how to convert.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/assocstats.html" class="external-link">assocstats</a></span><span class="op">(</span><span class="va">GSStab</span><span class="op">)</span></span>
<span><span class="co">##                     X^2 df P(&gt; X^2)</span></span>
<span><span class="co">## Likelihood Ratio 7.0026  2 0.030158</span></span>
<span><span class="co">## Pearson          7.0095  2 0.030054</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Phi-Coefficient   : NA </span></span>
<span><span class="co">## Contingency Coeff.: 0.084 </span></span>
<span><span class="co">## Cramer's V        : 0.085</span></span></code></pre></div>
<p>For tables with ordinal variables, like <code>JobSat</code>, some
people prefer the Goodman-Kruskal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
statistic <span class="citation">(Agresti 2002, 2.4.3)</span> based on a
comparison of concordant and discordant pairs of observations in the
case-form equivalent of a two-way table.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GKgamma.html">GKgamma</a></span><span class="op">(</span><span class="va">JobSat</span><span class="op">)</span></span>
<span><span class="co">## gamma        : 0.221 </span></span>
<span><span class="co">## std. error   : 0.117 </span></span>
<span><span class="co">## CI           : -0.009 0.451</span></span></code></pre></div>
<p>A web article by Richard Darlington, [<a href="http://node101.psych.cornell.edu/Darlington/crosstab/TABLE0.HTM" class="external-link uri">http://node101.psych.cornell.edu/Darlington/crosstab/TABLE0.HTM</a>]
gives further description of these and other measures of
association.</p>
</div>
<div class="section level2">
<h2 id="measures-of-agreement">Measures of Agreement<a class="anchor" aria-label="anchor" href="#measures-of-agreement"></a>
</h2>
<p>The <code><a href="https://rdrr.io/pkg/vcd/man/Kappa.html" class="external-link">Kappa()</a></code> function in the <code>vcd</code> package
calculates Cohen’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
and weighted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
for a square two-way table with the same row and column categories <span class="citation">(Cohen 1960)</span>. Normal-theory
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>-tests
are obtained by dividing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
by its asymptotic standard error (ASE). A <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> method
for <code>Kappa</code> objects provides confidence intervals.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SexualFun</span>, package <span class="op">=</span> <span class="st">"vcd"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcd/man/Kappa.html" class="external-link">Kappa</a></span><span class="op">(</span><span class="va">SexualFun</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##             value     ASE     z Pr(&gt;|z|)</span></span>
<span><span class="co">## Unweighted 0.1293 0.06860 1.885 0.059387</span></span>
<span><span class="co">## Weighted   0.2374 0.07832 3.031 0.002437</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span></span>
<span><span class="co">##             </span></span>
<span><span class="co">## Kappa                 lwr       upr</span></span>
<span><span class="co">##   Unweighted -0.005120399 0.2637809</span></span>
<span><span class="co">##   Weighted    0.083883432 0.3908778</span></span></code></pre></div>
<p>A visualization of agreement <span class="citation">(Bangdiwala
1987)</span>, both unweighted and weighted for degree of departure from
exact agreement is provided by the <code><a href="https://rdrr.io/pkg/vcd/man/agreementplot.html" class="external-link">agreementplot()</a></code>
function. <span class="citation">(<strong>fig?</strong>)</span>(fig:agreesex) shows the
agreementplot for the <code>SexualFun</code> data, produced as shown
below.</p>
<p>The Bangdiwala measures (returned by the function) represent the
proportion of the shaded areas of the diagonal rectangles, using weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
for exact agreement, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>2</mn></msub><annotation encoding="application/x-tex">w_2</annotation></semantics></math>
for partial agreement one step from the main diagonal.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcd/man/agreementplot.html" class="external-link">agreementplot</a></span><span class="op">(</span><span class="va">SexualFun</span>, main<span class="op">=</span><span class="st">"Is sex fun?"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="a2-tests_files/figure-html/agreesex-1.png" alt="Agreement plot for the `SexualFun` data." width="70%"><p class="caption">
Agreement plot for the <code>SexualFun</code> data.
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">agree</span><span class="op">)</span></span>
<span><span class="co">##          Bangdiwala Bangdiwala_Weighted            weights1            weights2 </span></span>
<span><span class="co">##           0.1464624           0.4981723           1.0000000           0.8888889</span></span></code></pre></div>
<p>In other examples, the agreement plot can help to show
<em>sources</em> of disagreement. For example, when the shaded boxes are
above or below the diagonal (red) line, a lack of exact agreement can be
attributed in part to different frequency of use of categories by the
two raters– lack of <em>marginal homogeneity</em>.</p>
</div>
<div class="section level2">
<h2 id="correspondence-analysis">Correspondence analysis<a class="anchor" aria-label="anchor" href="#correspondence-analysis"></a>
</h2>
<p>Correspondence analysis is a technique for visually exploring
relationships between rows and columns in contingency tables. The
<code>ca</code> package gives one implementation. For an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>×</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">r \times c</annotation></semantics></math>
table, the method provides a breakdown of the Pearson
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
for association in up to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>c</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M = \min(r-1, c-1)</annotation></semantics></math>
dimensions, and finds scores for the row
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">x_{im}</annotation></semantics></math>)
and column
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>j</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">y_{jm}</annotation></semantics></math>)
categories such that the observations have the maximum possible
correlations.% <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Related methods are the non-parametric CMH tests using
assumed row/column scores (@ref(sec:CMH), the analogous
&lt;code&gt;&lt;a href="https://rdrr.io/r/stats/glm.html" class="external-link"&gt;glm()&lt;/a&gt;&lt;/code&gt; model-based methods (@ref(sec:CMH), and the more
general RC models which can be fit using &lt;code&gt;&lt;a href="https://rdrr.io/pkg/gnm/man/gnm.html" class="external-link"&gt;gnm()&lt;/a&gt;&lt;/code&gt;.
Correspondence analysis differs in that it is a primarily
descriptive/exploratory method (no significance tests), but is directly
tied to informative graphic displays of the row/column categories.&lt;/p&gt;'><sup>1</sup></a></p>
<p>Here, we carry out a simple correspondence analysis of the
<code>HairEye</code> data. The printed results show that nearly 99% of
the association between hair color and eye color can be accounted for in
2 dimensions, of which the first dimension accounts for 90%.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.carme-n.org/" class="external-link">ca</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ca/man/ca.html" class="external-link">ca</a></span><span class="op">(</span><span class="va">HairEye</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Principal inertias (eigenvalues):</span></span>
<span><span class="co">##            1        2        3       </span></span>
<span><span class="co">## Value      0.208773 0.022227 0.002598</span></span>
<span><span class="co">## Percentage 89.37%   9.52%    1.11%   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Rows:</span></span>
<span><span class="co">##             Black     Brown       Red    Blond</span></span>
<span><span class="co">## Mass     0.182432  0.483108  0.119932 0.214527</span></span>
<span><span class="co">## ChiDist  0.551192  0.159461  0.354770 0.838397</span></span>
<span><span class="co">## Inertia  0.055425  0.012284  0.015095 0.150793</span></span>
<span><span class="co">## Dim. 1  -1.104277 -0.324463 -0.283473 1.828229</span></span>
<span><span class="co">## Dim. 2   1.440917 -0.219111 -2.144015 0.466706</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Columns:</span></span>
<span><span class="co">##             Brown     Blue     Hazel     Green</span></span>
<span><span class="co">## Mass     0.371622 0.363176  0.157095  0.108108</span></span>
<span><span class="co">## ChiDist  0.500487 0.553684  0.288654  0.385727</span></span>
<span><span class="co">## Inertia  0.093086 0.111337  0.013089  0.016085</span></span>
<span><span class="co">## Dim. 1  -1.077128 1.198061 -0.465286  0.354011</span></span>
<span><span class="co">## Dim. 2   0.592420 0.556419 -1.122783 -2.274122</span></span></code></pre></div>
<p>The resulting <code>ca</code> object can be plotted just by running
the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method on the <code>ca</code> object, giving the
result in @ref(fig:ca-haireye). <code><a href="https://rdrr.io/pkg/ca/man/plot.ca.html" class="external-link">plot.ca()</a></code> does not allow
labels for dimensions; these can be added with <code><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title()</a></code>. It
can be seen that most of the association is accounted for by the
ordering of both hair color and eye color along Dimension 1, a dark to
light dimension.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ca/man/ca.html" class="external-link">ca</a></span><span class="op">(</span><span class="va">HairEye</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Hair Color and Eye Color"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="a2-tests_files/figure-html/ca-haireye-1.png" alt="Correspondence analysis plot for the `HairEye` data" width="672"><p class="caption">
Correspondence analysis plot for the <code>HairEye</code> data
</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-vcd:Agresti:2002" class="csl-entry">
Agresti, Alan. 2002. <em>Categorical Data Analysis</em>. 2nd ed.
Hoboken, New Jersey: John Wiley &amp; Sons.
</div>
<div id="ref-Bangdiwala:87" class="csl-entry">
Bangdiwala, Shrikant I. 1987. <span>“Using <span>SAS</span> Software
Graphical Procedures for the Observer Agreement Chart.”</span>
<em>Proceedings of the <span>SAS</span> User’s Group International
Conference</em> 12: 1083–88.
</div>
<div id="ref-Cohen:60" class="csl-entry">
Cohen, J. 1960. <span>“A Coefficient of Agreement for Nominal
Scales.”</span> <em>Educational and Psychological Measurement</em> 20:
37–46.
</div>
<div id="ref-Landis-etal:1978" class="csl-entry">
Landis, R. J., E. R. Heyman, and G. G. Koch. 1978. <span>“Average
Partial Association in Three-Way Contingency Tables: A Review and
Discussion of Alternative Tests,”</span> <em>International Statistical
Review</em> 46: 237–54.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
