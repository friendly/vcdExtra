<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>vcd Extensions and Additions • vcdExtra</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="vcd Extensions and Additions">
<meta name="description" content='Provides additional data sets, methods and documentation to complement the vcd package for Visualizing Categorical Data and the gnm package for Generalized Nonlinear Models. In particular, vcdExtra extends mosaic, assoc and sieve plots from vcd to handle glm() and gnm() models and adds a 3D version in mosaic3d. Additionally, methods are provided for comparing and visualizing lists of glm and loglm objects. This package is now a support package for the book, "Discrete Data Analysis with R" by Michael Friendly and David Meyer.'>
<meta property="og:description" content='Provides additional data sets, methods and documentation to complement the vcd package for Visualizing Categorical Data and the gnm package for Generalized Nonlinear Models. In particular, vcdExtra extends mosaic, assoc and sieve plots from vcd to handle glm() and gnm() models and adds a 3D version in mosaic3d. Additionally, methods are provided for comparing and visualizing lists of glm and loglm objects. This package is now a support package for the book, "Discrete Data Analysis with R" by Michael Friendly and David Meyer.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">vcdExtra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8-7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/a1-creating.html">1. Creating and manipulating frequency tables</a></li>
    <li><a class="dropdown-item" href="articles/a2-tests.html">2. Tests of Independence</a></li>
    <li><a class="dropdown-item" href="articles/a3-loglinear.html">3. Loglinear Models</a></li>
    <li><a class="dropdown-item" href="articles/a4-mosaics.html">4. Mosaic plots</a></li>
    <li><a class="dropdown-item" href="articles/a5-demo-housing.html">5. Demo - Housing Data</a></li>
    <li><a class="dropdown-item" href="articles/a6-mobility.html">6. Mobility tables</a></li>
    <li><a class="dropdown-item" href="articles/a7-continuous.html">7. Continuous predictors</a></li>
    <li><a class="dropdown-item" href="articles/datasets.html">Datasets for categorical data analysis</a></li>
    <li><a class="dropdown-item" href="articles/tidyCats.html">tidyCat: Tidy Methods For Categorical Data Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/vcdExtra/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<!-- badges: end -->
<div class="section level1">
<div class="page-header"><h1 id="vcdextra-">vcdExtra <img src="reference/figures/logo.png" style="float:right; height:200px;"><a class="anchor" aria-label="anchor" href="#vcdextra-"></a>
</h1></div>
<div class="section level2">
<h2 id="extensions-and-additions-to-vcd-visualizing-categorical-data">Extensions and additions to vcd: Visualizing Categorical Data<a class="anchor" aria-label="anchor" href="#extensions-and-additions-to-vcd-visualizing-categorical-data"></a>
</h2>
<!-- Version 0.8-6 -->
<p>Version 0.8-7; documentation built for <code>pkgdown</code> 2025-12-07</p>
<p>This package provides additional data sets, documentation, and many functions designed to extend the <a href="https://CRAN.R-project.org/package=vcd" class="external-link">vcd</a> package for <em>Visualizing Categorical Data</em> and the <a href="https://CRAN.R-project.org/package=gnm" class="external-link">gnm</a> package for <em>Generalized Nonlinear Models</em>. In particular, <code>vcdExtra</code> extends mosaic, assoc and sieve plots from vcd to handle <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> and <code>gnm()</code> models and adds a 3D version in <code><a href="reference/mosaic3d.html">mosaic3d()</a></code>.</p>
<p><code>vcdExtra</code> is a support package for the book <a href="https://www.routledge.com/Discrete-Data-Analysis-with-R-Visualization-and-Modeling-Techniques-for/Friendly-Meyer/p/book/9781498725835" class="external-link"><em>Discrete Data Analysis with R</em></a> (DDAR) by Michael Friendly and David Meyer. There is also a <a href="http://ddar.datavis.ca" class="external-link">web site for DDAR</a> with all figures and code samples from the book. It is also used in my graduate course, <a href="https://friendly.github.io/psy6136/" class="external-link">Psy 6136: Categorical Data Analysis</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Get the released version from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a> <span class="fu">install.packages</span>(<span class="st">"vcdExtra"</span>)</span></code></pre></div>
<p>The development version can be installed to your R library from <a href="https://friendly.r-universe.dev/vcdExtra" class="external-link">R-universe</a> or directly from the <a href="https://github.com/friendly/vcdExtra" class="external-link">GitHub repo</a> via:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(remotes)) <span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a> </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a> <span class="fu">install.packages</span>(<span class="st">"mvinfluence"</span>, <span class="at">repos =</span> <span class="fu">c</span>(<span class="st">'https://friendly.r-universe.dev'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a> <span class="co"># or</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a> remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"friendly/vcdExtra"</span>, <span class="at">build_vignettes =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>The original purpose of this package was to serve as a sandbox for introducing extensions of mosaic plots and related graphical methods that apply to loglinear models fitted using <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">MASS::loglm()</a></code>, generalized linear models using <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code> and the related, generalized <em>nonlinear</em> models fitted with <code>gnm()</code> in the <a href="https://CRAN.R-project.org/package=gnm" class="external-link">gnm</a> package.</p>
<p>A related purpose was to fill in some holes in the analysis of categorical data in R, not provided in base R, <a href="https://CRAN.R-project.org/package=vcd" class="external-link">vcd</a>, or other commonly used packages.</p>
<div class="section level5">
<h5 id="see-also">See also:<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h5>
<p><a href="https://www.routledge.com/Discrete-Data-Analysis-with-R-Visualization-and-Modeling-Techniques-for/Friendly-Meyer/p/book/9781498725835" class="external-link"><img src="http://ddar.datavis.ca/images/ddar-cover.png" style="height:70px;"></a>      <a href="https://friendly.github.io/psy6136/" class="external-link"><img src="https://friendly.github.io/psy6136/icons/psy6136-highres.png" style="height:70px;"></a>      <a href="https://friendly.github.io/nestedLogit/" class="external-link"><img src="https://friendly.github.io/nestedLogit/logo.png" style="height:70px;"></a></p>
<ul>
<li><p>My book, <a href="https://www.routledge.com/Discrete-Data-Analysis-with-R-Visualization-and-Modeling-Techniques-for/Friendly-Meyer/p/book/9781498725835" class="external-link"><em>Discrete Data Analysis with R: Visualization and Modeling Techniques for Categorical and Count Data</em></a></p></li>
<li><p>My graduate course, <a href="https://friendly.github.io/psy6136/" class="external-link">Psy 6136: Categorical Data Analysis</a></p></li>
<li><p>A companion package, <a href="https://friendly.github.io/nestedLogit/" class="external-link"><code>nestedLogit</code></a>, for fitting nested dichotomy logistic regression models for a polytomous response.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="vcdextra-highlights">vcdExtra Highlights<a class="anchor" aria-label="anchor" href="#vcdextra-highlights"></a>
</h4>
<div class="section level5">
<h5 id="mosaic-plot-extensions">mosaic plot extensions<a class="anchor" aria-label="anchor" href="#mosaic-plot-extensions"></a>
</h5>
<ul>
<li><p>The method <code><a href="reference/mosaic.glm.html">mosaic.glm()</a></code> extends the <code>mosaic.loglm()</code> method in the vcd package to this wider class of models, e.g., models for ordinal factors, which can’t be handled with <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">MASS::loglm()</a></code>. This method also works for the generalized <em>nonlinear</em> models fit with the <a href="https://CRAN.R-project.org/package=gnm" class="external-link">gnm</a> package, including models for square tables and models with multiplicative associations (RC models).</p></li>
<li><p><code><a href="reference/mosaic3d.html">mosaic3d()</a></code> introduces a 3D generalization of mosaic displays using the <a href="https://CRAN.R-project.org/package=rgl" class="external-link">rgl</a> package.</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="model-extensions">model extensions<a class="anchor" aria-label="anchor" href="#model-extensions"></a>
</h5>
<ul>
<li><p>A new class, <code>glmlist</code>, is introduced for working with collections of glm objects, e.g., <code><a href="reference/Kway.html">Kway()</a></code> for fitting all K-way models from a basic marginal model, and <code><a href="reference/LRstats.html">LRstats()</a></code> for brief statistical summaries of goodness-of-fit for a collection of models.</p></li>
<li><p>Similarly, for loglinear models fit using <code><a href="https://rdrr.io/pkg/MASS/man/loglm.html" class="external-link">MASS::loglm()</a></code>, the function <code><a href="reference/seq_loglm.html">seq_loglm()</a></code> fits a series of sequential models to the 1-, 2-, … <em>n</em>-way marginal tables, corresponding to a variety of types of models for joint, conditional, mutual, … independence. It returns an object of class <code>loglmlist</code>, each of which is a class <code>loglm</code> object. The function <code><a href="reference/seq_mosaic.html">seq_mosaic()</a></code> generates the mosaic plots and other plots in the <code><a href="https://rdrr.io/pkg/vcd/man/strucplot.html" class="external-link">vcd::strucplot()</a></code> framework.</p></li>
<li><p>For <strong>square tables</strong> with ordered factors, <code><a href="reference/Crossings.html">Crossings()</a></code> supplements the specification of terms in model formulas using <code><a href="https://rdrr.io/pkg/gnm/man/Symm.html" class="external-link">gnm::Symm()</a></code>, <code><a href="https://rdrr.io/pkg/gnm/man/Diag.html" class="external-link">gnm::Diag()</a></code>, <code>gnm::Topo(),</code> etc. in the <a href="https://CRAN.R-project.org/package=gnm" class="external-link">gnm</a> package.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="other-additions">Other additions<a class="anchor" aria-label="anchor" href="#other-additions"></a>
</h4>
<ul>
<li>many new data sets; use <code>datasets("vcdExtra")</code> to see a list with titles and descriptions. The vignette, <code><a href="articles/datasets.html">vignette("datasets", package="vcdExtra")</a></code> provides a classification of these according to methods of analysis.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vcdExtra</span><span class="fu">::</span><span class="fu"><a href="reference/datasets.html">datasets</a></span><span class="op">(</span><span class="st">"vcdExtra"</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">##  [1] "Abortion"       "Accident"       "AirCrash"       "Alligator"     </span></span>
<span><span class="co">##  [5] "Asbestos"       "Bartlett"       "Burt"           "Caesar"        </span></span>
<span><span class="co">##  [9] "Cancer"         "Cormorants"     "CyclingDeaths"  "DaytonSurvey"  </span></span>
<span><span class="co">## [13] "Depends"        "Detergent"      "Donner"         "Draft1970"     </span></span>
<span><span class="co">## [17] "Draft1970table" "Dyke"           "Fungicide"      "GSS"           </span></span>
<span><span class="co">## [21] "Geissler"       "Gilby"          "Glass"          "HairEyePlace"  </span></span>
<span><span class="co">## [25] "Hauser79"       "Heart"          "Heckman"        "HospVisits"    </span></span>
<span><span class="co">## [29] "HouseTasks"     "Hoyt"           "ICU"            "JobSat"        </span></span>
<span><span class="co">## [33] "Mammograms"     "Mental"         "Mice"           "Mobility"      </span></span>
<span><span class="co">## [37] "PhdPubs"        "ShakeWords"     "TV"             "Titanicp"      </span></span>
<span><span class="co">## [41] "Toxaemia"       "Vietnam"        "Vote1980"       "WorkerSat"     </span></span>
<span><span class="co">## [45] "Yamaguchi87"</span></span></code></pre></div>
<ul>
<li>a <a href="https://cran.r-project.org/web/packages/vcdExtra/vignettes/" class="external-link">collection of tutorial vignettes</a>. In the installed package, they can be viewed using <code>browseVignettes(package = "vcdExtra")</code>;</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/getVignetteInfo.html" class="external-link">getVignetteInfo</a></span><span class="op">(</span><span class="st">"vcdExtra"</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"File"</span>, <span class="st">"Title"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="28%">
<col width="71%">
</colgroup>
<thead><tr>
<th align="left">File</th>
<th align="left">Title</th>
</tr></thead>
<tbody>
<tr>
<td align="left">a1-creating.Rmd</td>
<td align="left">1. Creating and manipulating frequency tables</td>
</tr>
<tr>
<td align="left">a2-tests.Rmd</td>
<td align="left">2. Tests of Independence</td>
</tr>
<tr>
<td align="left">a3-loglinear.Rmd</td>
<td align="left">3. Loglinear Models</td>
</tr>
<tr>
<td align="left">a4-mosaics.Rmd</td>
<td align="left">4. Mosaic plots</td>
</tr>
<tr>
<td align="left">a5-demo-housing.Rmd</td>
<td align="left">5. Demo - Housing Data</td>
</tr>
<tr>
<td align="left">a6-mobility.Rmd</td>
<td align="left">6. Mobility tables</td>
</tr>
<tr>
<td align="left">a7-continuous.Rmd</td>
<td align="left">7. Continuous predictors</td>
</tr>
<tr>
<td align="left">datasets.Rmd</td>
<td align="left">Datasets for categorical data analysis</td>
</tr>
<tr>
<td align="left">tidyCats.Rmd</td>
<td align="left">tidyCat: Tidy Methods For Categorical Data Analysis</td>
</tr>
</tbody>
</table>
<ul>
<li>a few useful utility functions for manipulating categorical data sets and working with models for categorical data.</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>These <code>README</code> examples simply provide illustrations of using some of the package functions in the context of loglinear models for frequency tables fit using <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>, including models for <em>structured associations</em> taking ordinality into account.</p>
<p>The dataset <code>Mental</code> is a data frame frequency table representing the cross-classification of mental health status (<code>mental</code>) of 1660 young New York residents by their parents’ socioeconomic status (<code>ses</code>). Both are <em>ordered</em> factors.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    24 obs. of  3 variables:</span></span>
<span><span class="co">##  $ ses   : Ord.factor w/ 6 levels "1"&lt;"2"&lt;"3"&lt;"4"&lt;..: 1 1 1 1 2 2 2 2 3 3 ...</span></span>
<span><span class="co">##  $ mental: Ord.factor w/ 4 levels "Well"&lt;"Mild"&lt;..: 1 2 3 4 1 2 3 4 1 2 ...</span></span>
<span><span class="co">##  $ Freq  : int  64 94 58 46 57 94 54 40 57 105 ...</span></span>
<span></span>
<span><span class="co"># show as frequency table</span></span>
<span><span class="op">(</span><span class="va">Mental.tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">ses</span><span class="op">+</span><span class="va">mental</span>, data<span class="op">=</span><span class="va">Mental</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##    mental</span></span>
<span><span class="co">## ses Well Mild Moderate Impaired</span></span>
<span><span class="co">##   1   64   94       58       46</span></span>
<span><span class="co">##   2   57   94       54       40</span></span>
<span><span class="co">##   3   57  105       65       60</span></span>
<span><span class="co">##   4   72  141       77       94</span></span>
<span><span class="co">##   5   36   97       54       78</span></span>
<span><span class="co">##   6   21   71       54       71</span></span></code></pre></div>
<div class="section level4">
<h4 id="independence-model">Independence model<a class="anchor" aria-label="anchor" href="#independence-model"></a>
</h4>
<p>Fit the independence model, <code>Freq ~ mental + ses</code>, using <code>glm(..., family = poisson)</code> This model is equivalent to the <code>chisq.test(Mental)</code> for general association; it does not take ordinality into account. <code><a href="reference/LRstats.html">LRstats()</a></code> provides a compact summary of fit statistics for one or more models.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span>,</span>
<span>             family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/LRstats.html">LRstats</a></span><span class="op">(</span><span class="va">indep</span><span class="op">)</span></span>
<span><span class="co">## Likelihood summary table:</span></span>
<span><span class="co">##          AIC    BIC LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## indep 209.59 220.19   47.418 15  3.155e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><code><a href="reference/mosaic.glm.html">mosaic.glm()</a></code> is the mosaic method for <code>glm</code> objects. The default mosaic display for these data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mosaic</span><span class="op">(</span><span class="va">indep</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-mental1-1.png"><!-- --></p>
<p>It is usually better to use <em>standardized residuals</em> (<code>residuals_type="rstandard"</code>) in mosaic displays, rather than the default Pearson residuals. Here we also add longer labels for the table factors (<code>set_varnames</code>) and display the values of residuals (<code>labeling=labeling_residuals</code>) in the cells.</p>
<p>The strucplot <code>formula</code> argument, <code>~ ses + mental</code> here gives the order of the factors in the mosaic display, not the statistical model for independence. That is, the unit square is first split by <code>ses</code>, then by <code>mental</code> within each level of <code>ses</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># labels for table factors</span></span>
<span><span class="va">long.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>set_varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mental<span class="op">=</span><span class="st">"Mental Health Status"</span>, </span>
<span>                                     ses<span class="op">=</span><span class="st">"Parent SES"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mosaic</span><span class="op">(</span><span class="va">indep</span>, formula <span class="op">=</span> <span class="op">~</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">mental</span>,</span>
<span>       residuals_type<span class="op">=</span><span class="st">"rstandard"</span>,</span>
<span>       labeling_args <span class="op">=</span> <span class="va">long.labels</span>, </span>
<span>       labeling<span class="op">=</span><span class="va">labeling_residuals</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-mental2-1.png"><!-- --></p>
<p>The <strong>opposite-corner</strong> pattern of the residuals clearly shows that association between Parent SES and mental health depends on the <em>ordered</em> levels of the factors: higher Parent SES is associated with better mental health status. A principal virtue of mosaic plots is to show the pattern of association that remains after a model has been fit, and thus help suggest a better model.</p>
</div>
<div class="section level4">
<h4 id="ordinal-models">Ordinal models<a class="anchor" aria-label="anchor" href="#ordinal-models"></a>
</h4>
<p>Ordinal models use <strong>numeric</strong> scores for the row and/or column variables. These models typically use equally spaced <em>integer</em> scores. The test for association here is analogous to a test of the correlation between the frequency-weighted scores, carried out using <code><a href="reference/CMHtest.html">CMHtest()</a></code>.</p>
<p>In the data, <code>ses</code> and <code>mental</code> were declared to be ordered factors, so using <code>as.numeric(Mental$ses)</code> is sufficient to create a new <code>Cscore</code> variable. Similarly for the numeric version of <code>mental</code>, giving <code>Rscore</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span></span>
<span><span class="va">Rscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">mental</span><span class="op">)</span></span></code></pre></div>
<p>Using these, the term <code>Rscore:Cscore</code> represents an association constrained to be <strong>linear x linear</strong>; that is, the slopes for profiles of mental health status are assumed to vary linearly with those for Parent SES. (This model asserts that only one parameter (a local odds ratio) is sufficient to account for all association, and is also called the model of “uniform association”.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit linear x linear (uniform) association.  Use integer scores for rows/cols </span></span>
<span><span class="va">Cscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span></span>
<span><span class="va">Rscore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Mental</span><span class="op">$</span><span class="va">mental</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Freq</span> <span class="op">~</span> <span class="va">mental</span> <span class="op">+</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">Rscore</span><span class="op">:</span><span class="va">Cscore</span>,</span>
<span>              family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">Mental</span><span class="op">)</span></span>
<span><span class="fu">mosaic</span><span class="op">(</span><span class="va">linlin</span>, <span class="op">~</span> <span class="va">ses</span> <span class="op">+</span> <span class="va">mental</span>,</span>
<span>       residuals_type<span class="op">=</span><span class="st">"rstandard"</span>, </span>
<span>       labeling_args <span class="op">=</span> <span class="va">long.labels</span>, </span>
<span>       labeling<span class="op">=</span><span class="va">labeling_residuals</span>, </span>
<span>       suppress<span class="op">=</span><span class="fl">1</span>, </span>
<span>       gp<span class="op">=</span><span class="va">shading_Friendly</span>,</span>
<span>       main<span class="op">=</span><span class="st">"Lin x Lin model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-mental3-1.png"><!-- --></p>
<p>Note that the test for linear x linear association consumes only 1 degree of freedom, compared to the <code>(r-1)*(c-1) = 15</code> degrees of freedom for general association.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">linlin</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model: poisson, link: log</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: Freq</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Terms added sequentially (first to last)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    </span></span>
<span><span class="co">## NULL                             23    217.400              </span></span>
<span><span class="co">## mental         3  113.525        20    103.875 &lt; 2.2e-16 ***</span></span>
<span><span class="co">## ses            5   56.457        15     47.418 6.543e-11 ***</span></span>
<span><span class="co">## Rscore:Cscore  1   37.523        14      9.895 9.035e-10 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Other models are possible between the independence model, <code>Freq ~ mental + ses</code>, and the saturated model <code>Freq ~ mental + ses + mental:ses</code>. The <code>update.glm()</code> method make these easy to specify, as addition of terms to the independence model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use update.glm method to fit other models</span></span>
<span></span>
<span><span class="va">linlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Rscore</span><span class="op">:</span><span class="va">Cscore</span><span class="op">)</span></span>
<span><span class="va">roweff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">mental</span><span class="op">:</span><span class="va">Cscore</span><span class="op">)</span></span>
<span><span class="va">coleff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Rscore</span><span class="op">:</span><span class="va">ses</span><span class="op">)</span></span>
<span><span class="va">rowcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">Rscore</span><span class="op">:</span><span class="va">ses</span> <span class="op">+</span> <span class="va">mental</span><span class="op">:</span><span class="va">Cscore</span><span class="op">)</span></span></code></pre></div>
<p><strong>Compare the models</strong>: For <code>glm</code> objects, the <code>print</code> and <code>summary</code> methods give too much information if all one wants to see is a brief summary of model goodness of fit, and there is no easy way to display a compact comparison of model goodness of fit for a collection of models fit to the same data.</p>
<p><code><a href="reference/LRstats.html">LRstats()</a></code> provides a brief summary for one or more models fit to the same dataset. The likelihood ratio <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math> values (<code>LR Chisq</code>)test lack of fit. By these tests, none of the ordinal models show significant lack of fit. By the AIC and BIC statistics, the <code>linlin</code> model is the best, combining parsimony and goodness of fit.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/LRstats.html">LRstats</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">linlin</span>, <span class="va">roweff</span>, <span class="va">coleff</span>, <span class="va">rowcol</span><span class="op">)</span></span>
<span><span class="co">## Likelihood summary table:</span></span>
<span><span class="co">##           AIC    BIC LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## indep  209.59 220.19   47.418 15  3.155e-05 ***</span></span>
<span><span class="co">## linlin 174.07 185.85    9.895 14     0.7698    </span></span>
<span><span class="co">## roweff 174.45 188.59    6.281 12     0.9013    </span></span>
<span><span class="co">## coleff 179.00 195.50    6.829 10     0.7415    </span></span>
<span><span class="co">## rowcol 179.22 198.07    3.045  8     0.9315    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The <code>anova.glm()</code> function gives tests of nested models.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">indep</span>, <span class="va">linlin</span>, <span class="va">roweff</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Freq ~ mental + ses</span></span>
<span><span class="co">## Model 2: Freq ~ mental + ses + Rscore:Cscore</span></span>
<span><span class="co">## Model 3: Freq ~ mental + ses + mental:Cscore</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        15     47.418                          </span></span>
<span><span class="co">## 2        14      9.895  1   37.523 9.035e-10 ***</span></span>
<span><span class="co">## 3        12      6.281  2    3.614    0.1641    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Friendly, M. &amp; Meyer, D. (2016). <em>Discrete Data Analysis with R: Visualization and Modeling Techniques for Categorical and Count Data</em>. Boca Raton, FL: Chapman &amp; Hall/CRC.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=vcdExtra" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/friendly/vcdExtra/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/friendly/vcdExtra/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing vcdExtra</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael Friendly <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3237-0941" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=vcdExtra" class="external-link"><img src="http://www.r-pkg.org/badges/version/vcdExtra" alt="CRAN_Status"></a></li>
<li><a href="https://friendly.r-universe.dev/vcdExtra" class="external-link"><img src="https://friendly.r-universe.dev/badges/vcdExtra" alt="R_Universe"></a></li>
<li><a href="https://cran.r-project.org/package=vcdExtra" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/vcdExtra"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-2.0.html" class="external-link"><img src="https://img.shields.io/badge/license-GPL%20%28%3E=%202%29-brightgreen.svg?style=flat" alt="License"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
