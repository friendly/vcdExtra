% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/woolf_test.R
\name{woolf_test}
\alias{woolf_test}
\alias{print.woolf_test}
\title{Woolf Test for Homogeneity of Odds Ratios}
\usage{
woolf_test(x, decompose = FALSE)

\method{print}{woolf_test}(x, ...)
}
\arguments{
\item{x}{An object of class \code{"woolf_test"}}

\item{decompose}{Logical. If \code{TRUE} and \code{x} is 4-dimensional
(a \eqn{2 \times 2 \times R \times C}{2 x 2 x R x C} table), the test
is decomposed into row effects, column effects, and residual (interaction).
Defaults to \code{FALSE}. Ignored for non-4-dimensional tables.}

\item{...}{Additional arguments (currently unused)}
}
\value{
A list of class \code{"woolf_test"} (also inheriting from \code{"htest"})
containing the following components:
\item{statistic}{the chi-squared test statistic.}
\item{parameter}{degrees of freedom of the approximate chi-squared
distribution of the test statistic.}
\item{p.value}{\eqn{p}-value for the test.}
\item{method}{a character string indicating the type of test performed.}
\item{data.name}{a character string giving the name of the data.}
\item{or_vars}{names of the first two dimensions (the 2x2 table variables).}
\item{strata_vars}{names of the stratifying variables (dimensions 3 and beyond).}
\item{observed}{the observed log odds ratios.}
\item{expected}{the expected log odds ratio under the null hypothesis (weighted mean).}
\item{decomposed}{logical indicating if decomposition was performed.}

When \code{decompose = TRUE} (only for 4-dimensional tables), additional components:
\item{rows}{list with statistic, df, p.value, observed, expected for row effects.}
\item{cols}{list with statistic, df, p.value, observed, expected for column effects.}
\item{residual}{list with statistic, df, p.value for residual (interaction).}
}
\description{
Test for homogeneity on \eqn{2 \times 2 \times k}{2 x 2 x k} tables
over strata (i.e., whether the log odds ratios are the same in all
strata). Generalized to handle tables of any dimensionality beyond 3.
For 4-dimensional tables, optionally provides a two-way decomposition
of the homogeneity test into row effects, column effects, and residual.
}
\examples{
# 3-way tables
data(CoalMiners, package = "vcd")
woolf_test(CoalMiners)

data(Heart, package = "vcdExtra")
woolf_test(Heart)

# 4-way table without decomposition
data(Fungicide, package = "vcdExtra")
woolf_test(Fungicide)

# 4-way table with decomposition
woolf_test(Fungicide, decompose = TRUE)

# 4-way table, but need to rearrange dimensions
# How does association between `Preference` and `M_User` vary over strata?
data(Detergent, package = "vcdExtra")
dimnames(Detergent) |> names()
Detergent <- aperm(Detergent, c(3, 2, 1, 4))
woolf_test(Detergent)


}
\references{
Woolf, B. (1955). On estimating the relation between blood group and disease.
\emph{Annals of Human Genetics}, \bold{19}, 251-253.
}
\seealso{
\code{\link[stats]{mantelhaen.test}}

Other association tests: 
\code{\link{CMHtest}()},
\code{\link{GKgamma}()},
\code{\link{HLtest}()},
\code{\link{zero.test}()}
}
\concept{association tests}
